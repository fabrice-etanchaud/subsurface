{"results": [{"node": {"raw_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  {{ source('land_values', 'valeurs_foncieres') }}", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "staging", "stg__land_values"], "unique_id": "model.subsurface.stg__land_values", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "staging/stg__land_values.sql", "original_file_path": "models/staging/stg__land_values.sql", "name": "stg__land_values", "resource_type": "model", "alias": "stg__land_values", "checksum": {"name": "sha256", "checksum": "555b4faf0b8f88f60605fe9011a839275b4355067aced56885ad38ed24e5a32a"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [], "sources": [["land_values", "valeurs_foncieres"]], "depends_on": {"macros": [], "nodes": ["source.subsurface.land_values.valeurs_foncieres"]}, "description": "land value at transaction time", "columns": {"transaction_date": {"name": "transaction_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transaction_amount": {"name": "transaction_amount", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transfer_label_fr": {"name": "transfer_label_fr", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_type": {"name": "lane_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_code": {"name": "lane_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane": {"name": "lane", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "zip_code": {"name": "zip_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lots_count": {"name": "lots_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "built_surface": {"name": "built_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "land_surface": {"name": "land_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "main_rooms_count": {"name": "main_rooms_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/staging/schema.yml", "build_path": "target/compiled/subsurface/models/staging/stg__land_values.sql", "deferred": false, "compiled_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  \"fs\".\"valeurs_foncieres\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  \"fs\".\"valeurs_foncieres\""}, "error": null, "status": null, "execution_time": 0.08866047859191895, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.130494Z", "completed_at": "2021-01-26T10:58:24.214692Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.216328Z", "completed_at": "2021-01-26T10:58:24.216358Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  {{ source('geo', 'communes') }}", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "staging", "stg__municipalities"], "unique_id": "model.subsurface.stg__municipalities", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "staging/stg__municipalities.sql", "original_file_path": "models/staging/stg__municipalities.sql", "name": "stg__municipalities", "resource_type": "model", "alias": "stg__municipalities", "checksum": {"name": "sha256", "checksum": "5adeecc802c4c28b6af1066b08ed6f06b1bb7879851dbec2b4e578e75ecbe123"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [], "sources": [["geo", "communes"]], "depends_on": {"macros": [], "nodes": ["source.subsurface.geo.communes"]}, "description": "municipalities, departement and region", "columns": {"municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_label": {"name": "municipality_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "department_code": {"name": "department_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "departement_label": {"name": "departement_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "region_code": {"name": "region_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "region_label": {"name": "region_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/staging/schema.yml", "build_path": "target/compiled/subsurface/models/staging/stg__municipalities.sql", "deferred": false, "compiled_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  \"fs\".\"geo\".\"communes.csv\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  \"fs\".\"geo\".\"communes.csv\""}, "error": null, "status": null, "execution_time": 0.02596449851989746, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.222424Z", "completed_at": "2021-01-26T10:58:24.245629Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.246466Z", "completed_at": "2021-01-26T10:58:24.246487Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "crop_types"], "unique_id": "seed.subsurface.crop_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "crop_types.csv", "original_file_path": "data/crop_types.csv", "name": "crop_types", "resource_type": "seed", "alias": "crop_types", "checksum": {"name": "sha256", "checksum": "0fb1cb330e03437324b0528c9ae45059b5ff4949e75d7ee493b705d6aa4ad253"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": true, "quote_columns": false}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "types of crops, cultures", "columns": {"crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "crop_label": {"name": "crop_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "data/seeds.yml", "build_path": null, "deferred": false, "compiled_sql": "", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": ""}, "error": null, "status": null, "execution_time": 0.029998779296875, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.249901Z", "completed_at": "2021-01-26T10:58:24.277275Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.277957Z", "completed_at": "2021-01-26T10:58:24.277974Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "premises_types"], "unique_id": "seed.subsurface.premises_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "premises_types.csv", "original_file_path": "data/premises_types.csv", "name": "premises_types", "resource_type": "seed", "alias": "premises_types", "checksum": {"name": "sha256", "checksum": "c6d3eb8439e47bdf095c2018df7c9c5e11dc949f4331ee27ff7ccc23f3e75c3b"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {"premises_code": "varchar"}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": true, "quote_columns": false}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "types of premises", "columns": {"premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_label_fr": {"name": "premises_label_fr", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_label_en": {"name": "premises_label_en", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "data/seeds.yml", "build_path": null, "deferred": false, "compiled_sql": "", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": ""}, "error": null, "status": null, "execution_time": 0.019876718521118164, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.281367Z", "completed_at": "2021-01-26T10:58:24.298623Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.299295Z", "completed_at": "2021-01-26T10:58:24.299314Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "transfer_types"], "unique_id": "seed.subsurface.transfer_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "transfer_types.csv", "original_file_path": "data/transfer_types.csv", "name": "transfer_types", "resource_type": "seed", "alias": "transfer_types", "checksum": {"name": "sha256", "checksum": "1a3481a7f2fd36a646ea6b60510dbee0857eedebb81b064e3e2bfffc1944b50c"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": true, "quote_columns": false}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "types of transfer of ownership", "columns": {"transfer_label_fr": {"name": "transfer_label_fr", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transfer_label_en": {"name": "transfer_label_en", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "data/seeds.yml", "build_path": null, "deferred": false, "compiled_sql": "", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": ""}, "error": null, "status": null, "execution_time": 0.01773357391357422, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.302737Z", "completed_at": "2021-01-26T10:58:24.317522Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.318232Z", "completed_at": "2021-01-26T10:58:24.318252Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lots_count", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__land_values_lots_count"], "unique_id": "test.subsurface.not_null_stg__land_values_lots_count", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__land_values_lots_count.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__land_values_lots_count", "resource_type": "test", "alias": "not_null_stg__land_values_lots_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_lots_count.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere lots_count is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere lots_count is null\n\n\n", "column_name": "lots_count"}, "error": null, "status": null, "execution_time": 0.03863978385925293, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.322290Z", "completed_at": "2021-01-26T10:58:24.357848Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.358719Z", "completed_at": "2021-01-26T10:58:24.358740Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__land_values_municipality_code"], "unique_id": "test.subsurface.not_null_stg__land_values_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__land_values_municipality_code.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__land_values_municipality_code", "resource_type": "test", "alias": "not_null_stg__land_values_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere municipality_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere municipality_code is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.025363922119140625, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.362158Z", "completed_at": "2021-01-26T10:58:24.384325Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.385337Z", "completed_at": "2021-01-26T10:58:24.385359Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transaction_date", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__land_values_transaction_date"], "unique_id": "test.subsurface.not_null_stg__land_values_transaction_date", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__land_values_transaction_date.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__land_values_transaction_date", "resource_type": "test", "alias": "not_null_stg__land_values_transaction_date", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_transaction_date.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere transaction_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere transaction_date is null\n\n\n", "column_name": "transaction_date"}, "error": null, "status": null, "execution_time": 0.025882959365844727, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.388997Z", "completed_at": "2021-01-26T10:58:24.411890Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.412696Z", "completed_at": "2021-01-26T10:58:24.412717Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transfer_label_fr", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__land_values_transfer_label_fr"], "unique_id": "test.subsurface.not_null_stg__land_values_transfer_label_fr", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__land_values_transfer_label_fr.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__land_values_transfer_label_fr", "resource_type": "test", "alias": "not_null_stg__land_values_transfer_label_fr", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_transfer_label_fr.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere transfer_label_fr is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere transfer_label_fr is null\n\n\n", "column_name": "transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.025562286376953125, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.416123Z", "completed_at": "2021-01-26T10:58:24.438787Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.439645Z", "completed_at": "2021-01-26T10:58:24.439667Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  *\nfrom\n  {{ ref('stg__land_values') }}\nwhere\n  built_surface is not null\n  and premises_code is null", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "data_test", "stg__land_values_built_surface_implies_premises_code"], "unique_id": "test.subsurface.stg__land_values_built_surface_implies_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "data_test/stg__land_values_built_surface_implies_premises_code.sql", "original_file_path": "tests/stg__land_values_built_surface_implies_premises_code.sql", "name": "stg__land_values_built_surface_implies_premises_code", "resource_type": "test", "alias": "stg__land_values_built_surface_implies_premises_code", "checksum": {"name": "sha256", "checksum": "ee115489939204acab69a1a5ed24c9b53acb4b5b1eb2d965316e08877157e6c5"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["data"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/tests/stg__land_values_built_surface_implies_premises_code.sql", "deferred": false, "compiled_sql": "\nselect count(*) from dbt__CTE__INTERNAL_test", "extra_ctes_injected": true, "extra_ctes": [{"id": "dbt__CTE__INTERNAL_test", "sql": " dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  \"@fab4\".\"stg__land_values\"\nwhere\n  built_surface is not null\n  and premises_code is null\n)"}], "injected_sql": "\nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  \"@fab4\".\"stg__land_values\"\nwhere\n  built_surface is not null\n  and premises_code is null\n)select count(*) from dbt__CTE__INTERNAL_test"}, "error": null, "status": null, "execution_time": 0.03698253631591797, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.443112Z", "completed_at": "2021-01-26T10:58:24.477122Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.477833Z", "completed_at": "2021-01-26T10:58:24.477853Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  *\nfrom\n  {{ ref('stg__land_values') }}\nwhere\n  land_surface is not null\n  and crop_code is null", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "data_test", "stg__land_values_land_surface_implies_crop_code"], "unique_id": "test.subsurface.stg__land_values_land_surface_implies_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "data_test/stg__land_values_land_surface_implies_crop_code.sql", "original_file_path": "tests/stg__land_values_land_surface_implies_crop_code.sql", "name": "stg__land_values_land_surface_implies_crop_code", "resource_type": "test", "alias": "stg__land_values_land_surface_implies_crop_code", "checksum": {"name": "sha256", "checksum": "77a8e26efb4ac6b047f65f3e1ed1e67bed46914ecf349437d15df8480cc6a537"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["data"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/tests/stg__land_values_land_surface_implies_crop_code.sql", "deferred": false, "compiled_sql": "\nselect count(*) from dbt__CTE__INTERNAL_test", "extra_ctes_injected": true, "extra_ctes": [{"id": "dbt__CTE__INTERNAL_test", "sql": " dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  \"@fab4\".\"stg__land_values\"\nwhere\n  land_surface is not null\n  and crop_code is null\n)"}], "injected_sql": "\nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  \"@fab4\".\"stg__land_values\"\nwhere\n  land_surface is not null\n  and crop_code is null\n)select count(*) from dbt__CTE__INTERNAL_test"}, "error": null, "status": null, "execution_time": 0.022469758987426758, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.480944Z", "completed_at": "2021-01-26T10:58:24.500635Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.501406Z", "completed_at": "2021-01-26T10:58:24.501427Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  municipality_code\n  ,municipality_label\n  ,department_code\n  ,department_label\n  ,region_code\n  ,region_label\nfrom\n  {{ ref('stg__municipalities') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_municipalities"], "unique_id": "model.subsurface.d_municipalities", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "marts/d_municipalities.sql", "original_file_path": "models/marts/d_municipalities.sql", "name": "d_municipalities", "resource_type": "model", "alias": "d_municipalities", "checksum": {"name": "sha256", "checksum": "ed1d87fc91f2263321bdde597caa8fd9bdc18de8ab045cf394a960526a82cc3b"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "hierarchical geographic dimension", "columns": {"municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/compiled/subsurface/models/marts/d_municipalities.sql", "deferred": false, "compiled_sql": "select\n  municipality_code\n  ,municipality_label\n  ,department_code\n  ,department_label\n  ,region_code\n  ,region_label\nfrom\n  \"@fab4\".\"stg__municipalities\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  municipality_code\n  ,municipality_label\n  ,department_code\n  ,department_label\n  ,region_code\n  ,region_label\nfrom\n  \"@fab4\".\"stg__municipalities\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'"}, "error": null, "status": null, "execution_time": 0.022528409957885742, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.505033Z", "completed_at": "2021-01-26T10:58:24.524643Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.525448Z", "completed_at": "2021-01-26T10:58:24.525469Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "departement_label", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_departement_label"], "unique_id": "test.subsurface.not_null_stg__municipalities_departement_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_departement_label.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_departement_label", "resource_type": "test", "alias": "not_null_stg__municipalities_departement_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_departement_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere departement_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere departement_label is null\n\n\n", "column_name": "departement_label"}, "error": null, "status": null, "execution_time": 0.024342060089111328, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.528891Z", "completed_at": "2021-01-26T10:58:24.550456Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.551222Z", "completed_at": "2021-01-26T10:58:24.551244Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "department_code", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_department_code"], "unique_id": "test.subsurface.not_null_stg__municipalities_department_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_department_code.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_department_code", "resource_type": "test", "alias": "not_null_stg__municipalities_department_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_department_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere department_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere department_code is null\n\n\n", "column_name": "department_code"}, "error": null, "status": null, "execution_time": 0.025598764419555664, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.554442Z", "completed_at": "2021-01-26T10:58:24.577169Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.577891Z", "completed_at": "2021-01-26T10:58:24.577912Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_municipality_code"], "unique_id": "test.subsurface.not_null_stg__municipalities_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_municipality_code.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_municipality_code", "resource_type": "test", "alias": "not_null_stg__municipalities_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere municipality_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere municipality_code is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.02735424041748047, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.581418Z", "completed_at": "2021-01-26T10:58:24.605903Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.606712Z", "completed_at": "2021-01-26T10:58:24.606733Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_label", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_municipality_label"], "unique_id": "test.subsurface.not_null_stg__municipalities_municipality_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_municipality_label.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_municipality_label", "resource_type": "test", "alias": "not_null_stg__municipalities_municipality_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_municipality_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere municipality_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere municipality_label is null\n\n\n", "column_name": "municipality_label"}, "error": null, "status": null, "execution_time": 0.025416851043701172, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.609900Z", "completed_at": "2021-01-26T10:58:24.632385Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.633269Z", "completed_at": "2021-01-26T10:58:24.633291Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "region_code", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_region_code"], "unique_id": "test.subsurface.not_null_stg__municipalities_region_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_region_code.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_region_code", "resource_type": "test", "alias": "not_null_stg__municipalities_region_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_region_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere region_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere region_code is null\n\n\n", "column_name": "region_code"}, "error": null, "status": null, "execution_time": 0.02588033676147461, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.636910Z", "completed_at": "2021-01-26T10:58:24.659891Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.660669Z", "completed_at": "2021-01-26T10:58:24.660689Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "region_label", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_region_label"], "unique_id": "test.subsurface.not_null_stg__municipalities_region_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_region_label.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_region_label", "resource_type": "test", "alias": "not_null_stg__municipalities_region_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_region_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere region_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere region_label is null\n\n\n", "column_name": "region_label"}, "error": null, "status": null, "execution_time": 0.025566577911376953, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.664019Z", "completed_at": "2021-01-26T10:58:24.686764Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.687524Z", "completed_at": "2021-01-26T10:58:24.687543Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_stg__municipalities_municipality_code"], "unique_id": "test.subsurface.unique_stg__municipalities_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_stg__municipalities_municipality_code.sql", "original_file_path": "models/staging/schema.yml", "name": "unique_stg__municipalities_municipality_code", "resource_type": "test", "alias": "unique_stg__municipalities_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/unique_stg__municipalities_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        municipality_code\n\n    from \"@fab4\".\"stg__municipalities\"\n    where municipality_code is not null\n    group by municipality_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        municipality_code\n\n    from \"@fab4\".\"stg__municipalities\"\n    where municipality_code is not null\n    group by municipality_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.025751829147338867, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.690744Z", "completed_at": "2021-01-26T10:58:24.713224Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.714290Z", "completed_at": "2021-01-26T10:58:24.714312Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  {{ ref('crop_types') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_crop_types"], "unique_id": "model.subsurface.d_crop_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "marts/d_crop_types.sql", "original_file_path": "models/marts/d_crop_types.sql", "name": "d_crop_types", "resource_type": "model", "alias": "d_crop_types", "checksum": {"name": "sha256", "checksum": "53a9062c52f2aa6095993d0a9925fa2ea9f2d15651a973f92d56d22c63b0e315"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": [], "nodes": ["seed.subsurface.crop_types"]}, "description": "land value at transaction time", "columns": {"crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/compiled/subsurface/models/marts/d_crop_types.sql", "deferred": false, "compiled_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  \"@fab4\".\"crop_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  \"@fab4\".\"crop_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'"}, "error": null, "status": null, "execution_time": 0.024962425231933594, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.717562Z", "completed_at": "2021-01-26T10:58:24.738579Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.739370Z", "completed_at": "2021-01-26T10:58:24.739391Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "crop_code", "model": "{{ ref('crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_crop_types_crop_code"], "unique_id": "test.subsurface.not_null_crop_types_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_crop_types_crop_code.sql", "original_file_path": "data/seeds.yml", "name": "not_null_crop_types_crop_code", "resource_type": "test", "alias": "not_null_crop_types_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_crop_types_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"crop_types\"\nwhere crop_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"crop_types\"\nwhere crop_code is null\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.0285184383392334, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.745705Z", "completed_at": "2021-01-26T10:58:24.770579Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.771259Z", "completed_at": "2021-01-26T10:58:24.771278Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "crop_label", "model": "{{ ref('crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_crop_types_crop_label"], "unique_id": "test.subsurface.not_null_crop_types_crop_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_crop_types_crop_label.sql", "original_file_path": "data/seeds.yml", "name": "not_null_crop_types_crop_label", "resource_type": "test", "alias": "not_null_crop_types_crop_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_crop_types_crop_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"crop_types\"\nwhere crop_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"crop_types\"\nwhere crop_label is null\n\n\n", "column_name": "crop_label"}, "error": null, "status": null, "execution_time": 0.02498030662536621, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.774760Z", "completed_at": "2021-01-26T10:58:24.796870Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.797657Z", "completed_at": "2021-01-26T10:58:24.797678Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "crop_code", "model": "{{ ref('crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_crop_types_crop_code"], "unique_id": "test.subsurface.unique_crop_types_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_crop_types_crop_code.sql", "original_file_path": "data/seeds.yml", "name": "unique_crop_types_crop_code", "resource_type": "test", "alias": "unique_crop_types_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.subsurface.crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/unique_crop_types_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        crop_code\n\n    from \"@fab4\".\"crop_types\"\n    where crop_code is not null\n    group by crop_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        crop_code\n\n    from \"@fab4\".\"crop_types\"\n    where crop_code is not null\n    group by crop_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.02462458610534668, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.800873Z", "completed_at": "2021-01-26T10:58:24.822675Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.823458Z", "completed_at": "2021-01-26T10:58:24.823480Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  {{ ref('premises_types') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_premises_types"], "unique_id": "model.subsurface.d_premises_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "marts/d_premises_types.sql", "original_file_path": "models/marts/d_premises_types.sql", "name": "d_premises_types", "resource_type": "model", "alias": "d_premises_types", "checksum": {"name": "sha256", "checksum": "55bbe47a9febead545427c14159bd2f12c66ee55c7f03da191794ab24ff1a013"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": [], "nodes": ["seed.subsurface.premises_types"]}, "description": "type of premises", "columns": {"premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/compiled/subsurface/models/marts/d_premises_types.sql", "deferred": false, "compiled_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  \"@fab4\".\"premises_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  \"@fab4\".\"premises_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'"}, "error": null, "status": null, "execution_time": 0.021674633026123047, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.826866Z", "completed_at": "2021-01-26T10:58:24.845453Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.846247Z", "completed_at": "2021-01-26T10:58:24.846266Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_code", "model": "{{ ref('premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_premises_types_premises_code"], "unique_id": "test.subsurface.not_null_premises_types_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_premises_types_premises_code.sql", "original_file_path": "data/seeds.yml", "name": "not_null_premises_types_premises_code", "resource_type": "test", "alias": "not_null_premises_types_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_premises_types_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_code is null\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.026147127151489258, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.850232Z", "completed_at": "2021-01-26T10:58:24.873369Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.874273Z", "completed_at": "2021-01-26T10:58:24.874294Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_label_en", "model": "{{ ref('premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_premises_types_premises_label_en"], "unique_id": "test.subsurface.not_null_premises_types_premises_label_en", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_premises_types_premises_label_en.sql", "original_file_path": "data/seeds.yml", "name": "not_null_premises_types_premises_label_en", "resource_type": "test", "alias": "not_null_premises_types_premises_label_en", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_premises_types_premises_label_en.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_label_en is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_label_en is null\n\n\n", "column_name": "premises_label_en"}, "error": null, "status": null, "execution_time": 0.03430747985839844, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.877808Z", "completed_at": "2021-01-26T10:58:24.909100Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.910051Z", "completed_at": "2021-01-26T10:58:24.910076Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_label_fr", "model": "{{ ref('premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_premises_types_premises_label_fr"], "unique_id": "test.subsurface.not_null_premises_types_premises_label_fr", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_premises_types_premises_label_fr.sql", "original_file_path": "data/seeds.yml", "name": "not_null_premises_types_premises_label_fr", "resource_type": "test", "alias": "not_null_premises_types_premises_label_fr", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_premises_types_premises_label_fr.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_label_fr is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_label_fr is null\n\n\n", "column_name": "premises_label_fr"}, "error": null, "status": null, "execution_time": 0.022623777389526367, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.913036Z", "completed_at": "2021-01-26T10:58:24.933090Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.933812Z", "completed_at": "2021-01-26T10:58:24.933831Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "premises_code", "model": "{{ ref('premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_premises_types_premises_code"], "unique_id": "test.subsurface.unique_premises_types_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_premises_types_premises_code.sql", "original_file_path": "data/seeds.yml", "name": "unique_premises_types_premises_code", "resource_type": "test", "alias": "unique_premises_types_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.subsurface.premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/unique_premises_types_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        premises_code\n\n    from \"@fab4\".\"premises_types\"\n    where premises_code is not null\n    group by premises_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        premises_code\n\n    from \"@fab4\".\"premises_types\"\n    where premises_code is not null\n    group by premises_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.02376556396484375, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.936823Z", "completed_at": "2021-01-26T10:58:24.957894Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.958641Z", "completed_at": "2021-01-26T10:58:24.958661Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, 'N/A') as lane_type\n  ,coalesce(lane_code, 'N/A') as lane_code\n  ,coalesce(lane, 'N/A') as lane\n  ,coalesce(zip_code, 'N/A') as zip_code\n  ,municipality_code\n  ,lots_count\n  ,coalesce(premises_code, 'N/A') as premises_code\n  ,coalesce(built_surface, 0) as built_surface\n  ,coalesce(land_surface, 0) as land_surface\n  ,coalesce(main_rooms_count, 0) as main_rooms_count\n  ,coalesce(crop_code, 'N/A') as crop_code\nfrom\n  {{ ref('stg__land_values') }} as stg__land_values\n  join {{ ref('transfer_types') }} transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "f_land_values"], "unique_id": "model.subsurface.f_land_values", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "marts/f_land_values.sql", "original_file_path": "models/marts/f_land_values.sql", "name": "f_land_values", "resource_type": "model", "alias": "f_land_values", "checksum": {"name": "sha256", "checksum": "f99cb619d828f59ecfe70bf27c4d200ef26042e930a0c3d3d1e6af3431e0e31a"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["stg__land_values"], ["transfer_types"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__land_values", "seed.subsurface.transfer_types"]}, "description": "land value at transaction time", "columns": {"transaction_date": {"name": "transaction_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transaction_amount": {"name": "transaction_amount", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transfer_label": {"name": "transfer_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_type": {"name": "lane_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_code": {"name": "lane_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane": {"name": "lane", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "zip_code": {"name": "zip_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lots_count": {"name": "lots_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "built_surface": {"name": "built_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "land_surface": {"name": "land_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "main_rooms_count": {"name": "main_rooms_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/compiled/subsurface/models/marts/f_land_values.sql", "deferred": false, "compiled_sql": "select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, 'N/A') as lane_type\n  ,coalesce(lane_code, 'N/A') as lane_code\n  ,coalesce(lane, 'N/A') as lane\n  ,coalesce(zip_code, 'N/A') as zip_code\n  ,municipality_code\n  ,lots_count\n  ,coalesce(premises_code, 'N/A') as premises_code\n  ,coalesce(built_surface, 0) as built_surface\n  ,coalesce(land_surface, 0) as land_surface\n  ,coalesce(main_rooms_count, 0) as main_rooms_count\n  ,coalesce(crop_code, 'N/A') as crop_code\nfrom\n  \"@fab4\".\"stg__land_values\" as stg__land_values\n  join \"@fab4\".\"transfer_types\" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, 'N/A') as lane_type\n  ,coalesce(lane_code, 'N/A') as lane_code\n  ,coalesce(lane, 'N/A') as lane\n  ,coalesce(zip_code, 'N/A') as zip_code\n  ,municipality_code\n  ,lots_count\n  ,coalesce(premises_code, 'N/A') as premises_code\n  ,coalesce(built_surface, 0) as built_surface\n  ,coalesce(land_surface, 0) as land_surface\n  ,coalesce(main_rooms_count, 0) as main_rooms_count\n  ,coalesce(crop_code, 'N/A') as crop_code\nfrom\n  \"@fab4\".\"stg__land_values\" as stg__land_values\n  join \"@fab4\".\"transfer_types\" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.03113722801208496, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.962186Z", "completed_at": "2021-01-26T10:58:24.990740Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:24.991457Z", "completed_at": "2021-01-26T10:58:24.991477Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transfer_label_en", "model": "{{ ref('transfer_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_transfer_types_transfer_label_en"], "unique_id": "test.subsurface.not_null_transfer_types_transfer_label_en", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_transfer_types_transfer_label_en.sql", "original_file_path": "data/seeds.yml", "name": "not_null_transfer_types_transfer_label_en", "resource_type": "test", "alias": "not_null_transfer_types_transfer_label_en", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.transfer_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_transfer_types_transfer_label_en.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"transfer_types\"\nwhere transfer_label_en is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"transfer_types\"\nwhere transfer_label_en is null\n\n\n", "column_name": "transfer_label_en"}, "error": null, "status": null, "execution_time": 0.02268695831298828, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:24.995794Z", "completed_at": "2021-01-26T10:58:25.016152Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.016817Z", "completed_at": "2021-01-26T10:58:25.016837Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transfer_label_fr", "model": "{{ ref('transfer_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_transfer_types_transfer_label_fr"], "unique_id": "test.subsurface.not_null_transfer_types_transfer_label_fr", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_transfer_types_transfer_label_fr.sql", "original_file_path": "data/seeds.yml", "name": "not_null_transfer_types_transfer_label_fr", "resource_type": "test", "alias": "not_null_transfer_types_transfer_label_fr", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.transfer_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_transfer_types_transfer_label_fr.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"transfer_types\"\nwhere transfer_label_fr is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"transfer_types\"\nwhere transfer_label_fr is null\n\n\n", "column_name": "transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.020936965942382812, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.019519Z", "completed_at": "2021-01-26T10:58:25.037774Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.038482Z", "completed_at": "2021-01-26T10:58:25.038501Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('transfer_types')", "field": "transfer_label_fr", "column_name": "transfer_label_fr", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"], "unique_id": "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/relationships_stg__land_values_b2e0c79b749681716848ecd78df2f275.sql", "original_file_path": "models/staging/schema.yml", "name": "relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_", "resource_type": "test", "alias": "relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"], ["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["seed.subsurface.transfer_types", "model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/relationships_stg__land_values_b2e0c79b749681716848ecd78df2f275.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select transfer_label_fr as id from \"@fab4\".\"stg__land_values\"\n) as child\nleft join (\n    select transfer_label_fr as id from \"@fab4\".\"transfer_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select transfer_label_fr as id from \"@fab4\".\"stg__land_values\"\n) as child\nleft join (\n    select transfer_label_fr as id from \"@fab4\".\"transfer_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "column_name": "transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.02478194236755371, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.041222Z", "completed_at": "2021-01-26T10:58:25.063478Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.064153Z", "completed_at": "2021-01-26T10:58:25.064172Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "transfer_label_en", "model": "{{ ref('transfer_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_transfer_types_transfer_label_en"], "unique_id": "test.subsurface.unique_transfer_types_transfer_label_en", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_transfer_types_transfer_label_en.sql", "original_file_path": "data/seeds.yml", "name": "unique_transfer_types_transfer_label_en", "resource_type": "test", "alias": "unique_transfer_types_transfer_label_en", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.subsurface.transfer_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/unique_transfer_types_transfer_label_en.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        transfer_label_en\n\n    from \"@fab4\".\"transfer_types\"\n    where transfer_label_en is not null\n    group by transfer_label_en\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        transfer_label_en\n\n    from \"@fab4\".\"transfer_types\"\n    where transfer_label_en is not null\n    group by transfer_label_en\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "transfer_label_en"}, "error": null, "status": null, "execution_time": 0.021109819412231445, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.066884Z", "completed_at": "2021-01-26T10:58:25.085543Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.086244Z", "completed_at": "2021-01-26T10:58:25.086264Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "transfer_label_fr", "model": "{{ ref('transfer_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_transfer_types_transfer_label_fr"], "unique_id": "test.subsurface.unique_transfer_types_transfer_label_fr", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_transfer_types_transfer_label_fr.sql", "original_file_path": "data/seeds.yml", "name": "unique_transfer_types_transfer_label_fr", "resource_type": "test", "alias": "unique_transfer_types_transfer_label_fr", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.subsurface.transfer_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/unique_transfer_types_transfer_label_fr.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        transfer_label_fr\n\n    from \"@fab4\".\"transfer_types\"\n    where transfer_label_fr is not null\n    group by transfer_label_fr\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        transfer_label_fr\n\n    from \"@fab4\".\"transfer_types\"\n    where transfer_label_fr is not null\n    group by transfer_label_fr\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.033629417419433594, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.089006Z", "completed_at": "2021-01-26T10:58:25.117721Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.120252Z", "completed_at": "2021-01-26T10:58:25.120272Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('d_municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_d_municipalities_municipality_code"], "unique_id": "test.subsurface.not_null_d_municipalities_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_d_municipalities_municipality_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_d_municipalities_municipality_code", "resource_type": "test", "alias": "not_null_d_municipalities_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.d_municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_d_municipalities_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_municipalities\"\nwhere municipality_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_municipalities\"\nwhere municipality_code is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.02264261245727539, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.125168Z", "completed_at": "2021-01-26T10:58:25.145458Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.146116Z", "completed_at": "2021-01-26T10:58:25.146136Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('d_municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_d_municipalities_municipality_code"], "unique_id": "test.subsurface.unique_d_municipalities_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_d_municipalities_municipality_code.sql", "original_file_path": "models/marts/schema.yml", "name": "unique_d_municipalities_municipality_code", "resource_type": "test", "alias": "unique_d_municipalities_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.subsurface.d_municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/unique_d_municipalities_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        municipality_code\n\n    from \"@fab4\".\"d_municipalities\"\n    where municipality_code is not null\n    group by municipality_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        municipality_code\n\n    from \"@fab4\".\"d_municipalities\"\n    where municipality_code is not null\n    group by municipality_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.02971792221069336, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.148793Z", "completed_at": "2021-01-26T10:58:25.175955Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.176618Z", "completed_at": "2021-01-26T10:58:25.176637Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "crop_code", "model": "{{ ref('d_crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_d_crop_types_crop_code"], "unique_id": "test.subsurface.not_null_d_crop_types_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_d_crop_types_crop_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_d_crop_types_crop_code", "resource_type": "test", "alias": "not_null_d_crop_types_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.d_crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_d_crop_types_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_crop_types\"\nwhere crop_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_crop_types\"\nwhere crop_code is null\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.08084917068481445, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.179565Z", "completed_at": "2021-01-26T10:58:25.257639Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.258458Z", "completed_at": "2021-01-26T10:58:25.258479Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "crop_code", "model": "{{ ref('d_crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_d_crop_types_crop_code"], "unique_id": "test.subsurface.unique_d_crop_types_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_d_crop_types_crop_code.sql", "original_file_path": "models/marts/schema.yml", "name": "unique_d_crop_types_crop_code", "resource_type": "test", "alias": "unique_d_crop_types_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.subsurface.d_crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/unique_d_crop_types_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        crop_code\n\n    from \"@fab4\".\"d_crop_types\"\n    where crop_code is not null\n    group by crop_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        crop_code\n\n    from \"@fab4\".\"d_crop_types\"\n    where crop_code is not null\n    group by crop_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.02179241180419922, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.261288Z", "completed_at": "2021-01-26T10:58:25.280317Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.281168Z", "completed_at": "2021-01-26T10:58:25.281188Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_code", "model": "{{ ref('d_premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_d_premises_types_premises_code"], "unique_id": "test.subsurface.not_null_d_premises_types_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_d_premises_types_premises_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_d_premises_types_premises_code", "resource_type": "test", "alias": "not_null_d_premises_types_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.d_premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_d_premises_types_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_premises_types\"\nwhere premises_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_premises_types\"\nwhere premises_code is null\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.021292686462402344, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.284079Z", "completed_at": "2021-01-26T10:58:25.302609Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.303351Z", "completed_at": "2021-01-26T10:58:25.303370Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "premises_code", "model": "{{ ref('d_premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_d_premises_types_premises_code"], "unique_id": "test.subsurface.unique_d_premises_types_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_d_premises_types_premises_code.sql", "original_file_path": "models/marts/schema.yml", "name": "unique_d_premises_types_premises_code", "resource_type": "test", "alias": "unique_d_premises_types_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.subsurface.d_premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/unique_d_premises_types_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        premises_code\n\n    from \"@fab4\".\"d_premises_types\"\n    where premises_code is not null\n    group by premises_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        premises_code\n\n    from \"@fab4\".\"d_premises_types\"\n    where premises_code is not null\n    group by premises_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.02062702178955078, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.306330Z", "completed_at": "2021-01-26T10:58:25.324270Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.324983Z", "completed_at": "2021-01-26T10:58:25.325002Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  d_municipalities.department_code\n  ,d_municipalities.department_label\n  ,avg(f_land_values.transaction_amount / f_land_values.built_surface) as mean_square_meter_price\nfrom\n  {{ ref('f_land_values') }} as f_land_values\n  join {{ ref('d_municipalities') }} as d_municipalities on d_municipalities.municipality_code = f_land_values.municipality_code\nwhere\n  f_land_values.premises_code = '2'\n  and f_land_values.built_surface > 0\n  and f_land_values.land_surface = 0\n  and f_land_values.transfer_label = 'Sale'\ngroup by\n  d_municipalities.department_code\n  ,d_municipalities.department_label\norder by\n  3 desc", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "analysis", "most_expensive_departments_for_flats"], "unique_id": "analysis.subsurface.most_expensive_departments_for_flats", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "analysis/most_expensive_departments_for_flats.sql", "original_file_path": "analysis/most_expensive_departments_for_flats.sql", "name": "most_expensive_departments_for_flats", "resource_type": "analysis", "alias": "most_expensive_departments_for_flats", "checksum": {"name": "sha256", "checksum": "e392f643ee1f84d97785ed9e13aa12923bd4731d6b1d58a71af73fecb4222f81"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["f_land_values"], ["d_municipalities"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.f_land_values", "model.subsurface.d_municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/analysis/most_expensive_departments_for_flats.sql", "deferred": false, "compiled_sql": "select\n  d_municipalities.department_code\n  ,d_municipalities.department_label\n  ,avg(f_land_values.transaction_amount / f_land_values.built_surface) as mean_square_meter_price\nfrom\n  \"@fab4\".\"f_land_values\" as f_land_values\n  join \"@fab4\".\"d_municipalities\" as d_municipalities on d_municipalities.municipality_code = f_land_values.municipality_code\nwhere\n  f_land_values.premises_code = '2'\n  and f_land_values.built_surface > 0\n  and f_land_values.land_surface = 0\n  and f_land_values.transfer_label = 'Sale'\ngroup by\n  d_municipalities.department_code\n  ,d_municipalities.department_label\norder by\n  3 desc", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  d_municipalities.department_code\n  ,d_municipalities.department_label\n  ,avg(f_land_values.transaction_amount / f_land_values.built_surface) as mean_square_meter_price\nfrom\n  \"@fab4\".\"f_land_values\" as f_land_values\n  join \"@fab4\".\"d_municipalities\" as d_municipalities on d_municipalities.municipality_code = f_land_values.municipality_code\nwhere\n  f_land_values.premises_code = '2'\n  and f_land_values.built_surface > 0\n  and f_land_values.land_surface = 0\n  and f_land_values.transfer_label = 'Sale'\ngroup by\n  d_municipalities.department_code\n  ,d_municipalities.department_label\norder by\n  3 desc"}, "error": null, "status": null, "execution_time": 0.029021263122558594, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.328007Z", "completed_at": "2021-01-26T10:58:25.354364Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.355170Z", "completed_at": "2021-01-26T10:58:25.355189Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n    date_part('month', transaction_date) as month_number\n    ,to_char(transaction_date, 'MON') as month_label\n    ,transfer_label\n    ,count(*) as transactions_count\nfrom\n    {{ ref('f_land_values') }}\ngroup by\n    1, 2, 3\norder by\n    3, 1", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "analysis", "transactions_seasonality"], "unique_id": "analysis.subsurface.transactions_seasonality", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "analysis/transactions_seasonality.sql", "original_file_path": "analysis/transactions_seasonality.sql", "name": "transactions_seasonality", "resource_type": "analysis", "alias": "transactions_seasonality", "checksum": {"name": "sha256", "checksum": "8a7176935450fa721143f87f7080b89f51c01fb735dc986795608f9a657db8c8"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.f_land_values"]}, "description": "what is the transactions monthly frequency", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": "analysis/schema.yml", "build_path": "target/compiled/subsurface/analysis/transactions_seasonality.sql", "deferred": false, "compiled_sql": "select\n    date_part('month', transaction_date) as month_number\n    ,to_char(transaction_date, 'MON') as month_label\n    ,transfer_label\n    ,count(*) as transactions_count\nfrom\n    \"@fab4\".\"f_land_values\"\ngroup by\n    1, 2, 3\norder by\n    3, 1", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n    date_part('month', transaction_date) as month_number\n    ,to_char(transaction_date, 'MON') as month_label\n    ,transfer_label\n    ,count(*) as transactions_count\nfrom\n    \"@fab4\".\"f_land_values\"\ngroup by\n    1, 2, 3\norder by\n    3, 1"}, "error": null, "status": null, "execution_time": 0.018100976943969727, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.357871Z", "completed_at": "2021-01-26T10:58:25.373266Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.374079Z", "completed_at": "2021-01-26T10:58:25.374098Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "built_surface", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_built_surface"], "unique_id": "test.subsurface.not_null_f_land_values_built_surface", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_built_surface.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_built_surface", "resource_type": "test", "alias": "not_null_f_land_values_built_surface", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_built_surface.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere built_surface is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere built_surface is null\n\n\n", "column_name": "built_surface"}, "error": null, "status": null, "execution_time": 0.021582603454589844, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.376925Z", "completed_at": "2021-01-26T10:58:25.395760Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.396558Z", "completed_at": "2021-01-26T10:58:25.396578Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "crop_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_crop_code"], "unique_id": "test.subsurface.not_null_f_land_values_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_crop_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_crop_code", "resource_type": "test", "alias": "not_null_f_land_values_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere crop_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere crop_code is null\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.022994279861450195, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.399567Z", "completed_at": "2021-01-26T10:58:25.419964Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.420677Z", "completed_at": "2021-01-26T10:58:25.420699Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "land_surface", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_land_surface"], "unique_id": "test.subsurface.not_null_f_land_values_land_surface", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_land_surface.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_land_surface", "resource_type": "test", "alias": "not_null_f_land_values_land_surface", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_land_surface.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere land_surface is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere land_surface is null\n\n\n", "column_name": "land_surface"}, "error": null, "status": null, "execution_time": 0.02069711685180664, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.423512Z", "completed_at": "2021-01-26T10:58:25.441564Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.442326Z", "completed_at": "2021-01-26T10:58:25.442346Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lane", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_lane"], "unique_id": "test.subsurface.not_null_f_land_values_lane", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_lane.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_lane", "resource_type": "test", "alias": "not_null_f_land_values_lane", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lane.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane is null\n\n\n", "column_name": "lane"}, "error": null, "status": null, "execution_time": 0.021242380142211914, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.445169Z", "completed_at": "2021-01-26T10:58:25.463846Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.464578Z", "completed_at": "2021-01-26T10:58:25.464598Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lane_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_lane_code"], "unique_id": "test.subsurface.not_null_f_land_values_lane_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_lane_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_lane_code", "resource_type": "test", "alias": "not_null_f_land_values_lane_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lane_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane_code is null\n\n\n", "column_name": "lane_code"}, "error": null, "status": null, "execution_time": 0.021443605422973633, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.467502Z", "completed_at": "2021-01-26T10:58:25.486357Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.487088Z", "completed_at": "2021-01-26T10:58:25.487109Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lane_type", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_lane_type"], "unique_id": "test.subsurface.not_null_f_land_values_lane_type", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_lane_type.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_lane_type", "resource_type": "test", "alias": "not_null_f_land_values_lane_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lane_type.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane_type is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane_type is null\n\n\n", "column_name": "lane_type"}, "error": null, "status": null, "execution_time": 0.022890329360961914, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.490172Z", "completed_at": "2021-01-26T10:58:25.510023Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.510730Z", "completed_at": "2021-01-26T10:58:25.510749Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lots_count", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_lots_count"], "unique_id": "test.subsurface.not_null_f_land_values_lots_count", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_lots_count.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_lots_count", "resource_type": "test", "alias": "not_null_f_land_values_lots_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lots_count.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lots_count is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lots_count is null\n\n\n", "column_name": "lots_count"}, "error": null, "status": null, "execution_time": 0.021701574325561523, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.514076Z", "completed_at": "2021-01-26T10:58:25.532853Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.533566Z", "completed_at": "2021-01-26T10:58:25.533586Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "main_rooms_count", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_main_rooms_count"], "unique_id": "test.subsurface.not_null_f_land_values_main_rooms_count", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_main_rooms_count.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_main_rooms_count", "resource_type": "test", "alias": "not_null_f_land_values_main_rooms_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_main_rooms_count.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere main_rooms_count is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere main_rooms_count is null\n\n\n", "column_name": "main_rooms_count"}, "error": null, "status": null, "execution_time": 0.023266315460205078, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.536807Z", "completed_at": "2021-01-26T10:58:25.557092Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.558051Z", "completed_at": "2021-01-26T10:58:25.558073Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_municipality_code"], "unique_id": "test.subsurface.not_null_f_land_values_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_municipality_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_municipality_code", "resource_type": "test", "alias": "not_null_f_land_values_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere municipality_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere municipality_code is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.02545642852783203, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.561292Z", "completed_at": "2021-01-26T10:58:25.583809Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.584623Z", "completed_at": "2021-01-26T10:58:25.584645Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_premises_code"], "unique_id": "test.subsurface.not_null_f_land_values_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_premises_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_premises_code", "resource_type": "test", "alias": "not_null_f_land_values_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere premises_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere premises_code is null\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.02630019187927246, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.587729Z", "completed_at": "2021-01-26T10:58:25.611053Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.611829Z", "completed_at": "2021-01-26T10:58:25.611851Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transaction_amount", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_transaction_amount"], "unique_id": "test.subsurface.not_null_f_land_values_transaction_amount", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_transaction_amount.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_transaction_amount", "resource_type": "test", "alias": "not_null_f_land_values_transaction_amount", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_transaction_amount.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transaction_amount is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transaction_amount is null\n\n\n", "column_name": "transaction_amount"}, "error": null, "status": null, "execution_time": 0.029063940048217773, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.615515Z", "completed_at": "2021-01-26T10:58:25.641620Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.642459Z", "completed_at": "2021-01-26T10:58:25.642480Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transaction_date", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_transaction_date"], "unique_id": "test.subsurface.not_null_f_land_values_transaction_date", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_transaction_date.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_transaction_date", "resource_type": "test", "alias": "not_null_f_land_values_transaction_date", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_transaction_date.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transaction_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transaction_date is null\n\n\n", "column_name": "transaction_date"}, "error": null, "status": null, "execution_time": 0.025404930114746094, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.645630Z", "completed_at": "2021-01-26T10:58:25.667837Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.668661Z", "completed_at": "2021-01-26T10:58:25.668682Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transfer_label", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_transfer_label"], "unique_id": "test.subsurface.not_null_f_land_values_transfer_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_transfer_label.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_transfer_label", "resource_type": "test", "alias": "not_null_f_land_values_transfer_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_transfer_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transfer_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transfer_label is null\n\n\n", "column_name": "transfer_label"}, "error": null, "status": null, "execution_time": 0.024923324584960938, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.672191Z", "completed_at": "2021-01-26T10:58:25.694092Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.694966Z", "completed_at": "2021-01-26T10:58:25.694987Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "zip_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_zip_code"], "unique_id": "test.subsurface.not_null_f_land_values_zip_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_zip_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_zip_code", "resource_type": "test", "alias": "not_null_f_land_values_zip_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_zip_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere zip_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere zip_code is null\n\n\n", "column_name": "zip_code"}, "error": null, "status": null, "execution_time": 0.02545762062072754, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.698103Z", "completed_at": "2021-01-26T10:58:25.720601Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.721461Z", "completed_at": "2021-01-26T10:58:25.721482Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('d_crop_types')", "field": "crop_code", "column_name": "crop_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"], "unique_id": "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/relationships_f_land_values_31e8b560f7a066055d2e9e3cbda4d4fd.sql", "original_file_path": "models/marts/schema.yml", "name": "relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_", "resource_type": "test", "alias": "relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_crop_types"], ["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["model.subsurface.d_crop_types", "model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/relationships_f_land_values_31e8b560f7a066055d2e9e3cbda4d4fd.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select crop_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select crop_code as id from \"@fab4\".\"d_crop_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select crop_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select crop_code as id from \"@fab4\".\"d_crop_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.02982950210571289, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.724591Z", "completed_at": "2021-01-26T10:58:25.751431Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.752333Z", "completed_at": "2021-01-26T10:58:25.752355Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('d_municipalities')", "field": "municipality_code", "column_name": "municipality_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"], "unique_id": "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/relationships_f_land_values_9963e82f8f09f5f13345aec2b504b5a5.sql", "original_file_path": "models/marts/schema.yml", "name": "relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_", "resource_type": "test", "alias": "relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_municipalities"], ["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["model.subsurface.d_municipalities", "model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/relationships_f_land_values_9963e82f8f09f5f13345aec2b504b5a5.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select municipality_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select municipality_code as id from \"@fab4\".\"d_municipalities\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select municipality_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select municipality_code as id from \"@fab4\".\"d_municipalities\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.030353546142578125, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.755531Z", "completed_at": "2021-01-26T10:58:25.783015Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.783787Z", "completed_at": "2021-01-26T10:58:25.783808Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('d_premises_types')", "field": "premises_code", "column_name": "premises_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"], "unique_id": "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/relationships_f_land_values_601770e576bb02eea8f782d8b9657f09.sql", "original_file_path": "models/marts/schema.yml", "name": "relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_", "resource_type": "test", "alias": "relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_premises_types"], ["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["model.subsurface.d_premises_types", "model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/relationships_f_land_values_601770e576bb02eea8f782d8b9657f09.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select premises_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select premises_code as id from \"@fab4\".\"d_premises_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select premises_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select premises_code as id from \"@fab4\".\"d_premises_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.029741287231445312, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T10:58:25.787209Z", "completed_at": "2021-01-26T10:58:25.813925Z"}, {"name": "execute", "started_at": "2021-01-26T10:58:25.814718Z", "completed_at": "2021-01-26T10:58:25.814739Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2021-01-26T10:58:25.878430Z", "elapsed_time": 2.6952965259552}