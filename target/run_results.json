{"results": [{"node": {"raw_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  {{ ref('premises_types') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_premises_types"], "unique_id": "model.subsurface.d_premises_types", "package_name": "subsurface", "root_path": "/root/git/subsurface", "path": "marts/d_premises_types.sql", "original_file_path": "models/marts/d_premises_types.sql", "name": "d_premises_types", "resource_type": "model", "alias": "d_premises_types", "checksum": {"name": "sha256", "checksum": "55bbe47a9febead545427c14159bd2f12c66ee55c7f03da191794ab24ff1a013"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt_dremio.dremio_create_or_replace_view"], "nodes": ["seed.subsurface.premises_types"]}, "description": "type of premises", "columns": {"premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/run/subsurface/models/marts/d_premises_types.sql", "deferred": false, "compiled_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  \"@fab4\".\"premises_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  \"@fab4\".\"premises_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'"}, "error": null, "status": "OK", "execution_time": 1.3766303062438965, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2021-01-28T15:45:30.416503Z", "completed_at": "2021-01-28T15:45:30.604038Z"}, {"name": "execute", "started_at": "2021-01-28T15:45:30.616074Z", "completed_at": "2021-01-28T15:45:31.733304Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  {{ ref('crop_types') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_crop_types"], "unique_id": "model.subsurface.d_crop_types", "package_name": "subsurface", "root_path": "/root/git/subsurface", "path": "marts/d_crop_types.sql", "original_file_path": "models/marts/d_crop_types.sql", "name": "d_crop_types", "resource_type": "model", "alias": "d_crop_types", "checksum": {"name": "sha256", "checksum": "53a9062c52f2aa6095993d0a9925fa2ea9f2d15651a973f92d56d22c63b0e315"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt_dremio.dremio_create_or_replace_view"], "nodes": ["seed.subsurface.crop_types"]}, "description": "land value at transaction time", "columns": {"crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/run/subsurface/models/marts/d_crop_types.sql", "deferred": false, "compiled_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  \"@fab4\".\"crop_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  \"@fab4\".\"crop_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'"}, "error": null, "status": "OK", "execution_time": 1.4143598079681396, "thread_id": "Thread-3", "timing": [{"name": "compile", "started_at": "2021-01-28T15:45:30.346695Z", "completed_at": "2021-01-28T15:45:30.634671Z"}, {"name": "execute", "started_at": "2021-01-28T15:45:30.636061Z", "completed_at": "2021-01-28T15:45:31.751010Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  {{ source('geo', 'communes') }}", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "staging", "stg__municipalities"], "unique_id": "model.subsurface.stg__municipalities", "package_name": "subsurface", "root_path": "/root/git/subsurface", "path": "staging/stg__municipalities.sql", "original_file_path": "models/staging/stg__municipalities.sql", "name": "stg__municipalities", "resource_type": "model", "alias": "stg__municipalities", "checksum": {"name": "sha256", "checksum": "5adeecc802c4c28b6af1066b08ed6f06b1bb7879851dbec2b4e578e75ecbe123"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [], "sources": [["geo", "communes"]], "depends_on": {"macros": ["macro.dbt_dremio.dremio_create_or_replace_view"], "nodes": ["source.subsurface.geo.communes"]}, "description": "municipalities, departement and region", "columns": {"municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_label": {"name": "municipality_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "department_code": {"name": "department_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "department_label": {"name": "department_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "region_code": {"name": "region_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "region_label": {"name": "region_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/staging/schema.yml", "build_path": "target/run/subsurface/models/staging/stg__municipalities.sql", "deferred": false, "compiled_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  \"fs\".\"geo\".\"communes.csv\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  \"fs\".\"geo\".\"communes.csv\""}, "error": "Runtime Error in model stg__municipalities (models/staging/stg__municipalities.sql)\n  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \\n  create or replace view \"@fab4\".\"stg__municipalities\" as (\\n    select\\n    com_code as municipality_code\\n    ,com_nom as municipality_label\\n    ,dep_code as department_code\\n    ,dep_nom_num as department_label\\n    ,reg_code as region_code\\n    ,reg_nom as region_label\\nfrom\\n   \"fs\".\"geo\".\"communes.csv\"\\n  )\\n\\n[30038]Query execution error. Details:[ \\nSYSTEM ERROR: SqlValida...[see log] (1040) (SQLExecDirectW)')", "status": "ERROR", "execution_time": 1.4427812099456787, "thread_id": "Thread-4", "timing": [], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  {{ source('land_values', 'valeurs_foncieres') }}", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "staging", "stg__land_values"], "unique_id": "model.subsurface.stg__land_values", "package_name": "subsurface", "root_path": "/root/git/subsurface", "path": "staging/stg__land_values.sql", "original_file_path": "models/staging/stg__land_values.sql", "name": "stg__land_values", "resource_type": "model", "alias": "stg__land_values", "checksum": {"name": "sha256", "checksum": "555b4faf0b8f88f60605fe9011a839275b4355067aced56885ad38ed24e5a32a"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [], "sources": [["land_values", "valeurs_foncieres"]], "depends_on": {"macros": ["macro.dbt_dremio.dremio_create_or_replace_view"], "nodes": ["source.subsurface.land_values.valeurs_foncieres"]}, "description": "land value at transaction time", "columns": {"transaction_date": {"name": "transaction_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transaction_amount": {"name": "transaction_amount", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transfer_label_fr": {"name": "transfer_label_fr", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_type": {"name": "lane_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_code": {"name": "lane_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane": {"name": "lane", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "zip_code": {"name": "zip_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lots_count": {"name": "lots_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "built_surface": {"name": "built_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "land_surface": {"name": "land_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "main_rooms_count": {"name": "main_rooms_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/staging/schema.yml", "build_path": "target/run/subsurface/models/staging/stg__land_values.sql", "deferred": false, "compiled_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  \"fs\".\"valeurs_foncieres\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  \"fs\".\"valeurs_foncieres\""}, "error": "Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)\n  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \\n  create or replace view \"@fab4\".\"stg__land_values\" as (\\n    select\\n  cast(regexp_replace(nullif(\"Date mutation\", \\'\\'), \\'([0-9]{2})/([0-9]{2})/([0-9]{4})\\', \\'$3-$2-$1\\') as date) as transaction_date\\n  ,cast(replace(nullif(\"Valeur fonciere\", \\'\\'), \\',\\', \\'.\\') as decimal) as transaction_amount\\n  ,nullif(\"Nature mutation\", \\'\\') as transfer_label_fr\\n  ,nullif(\"type de voie\", \\'\\') ...[see log] (1040) (SQLExecDirectW)')", "status": "ERROR", "execution_time": 1.456932783126831, "thread_id": "Thread-1", "timing": [], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  municipality_code\n  ,municipality_label\n  ,department_code\n  ,department_label\n  ,region_code\n  ,region_label\nfrom\n  {{ ref('stg__municipalities') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'", "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_municipalities"], "unique_id": "model.subsurface.d_municipalities", "package_name": "subsurface", "root_path": "/root/git/subsurface", "path": "marts/d_municipalities.sql", "original_file_path": "models/marts/d_municipalities.sql", "name": "d_municipalities", "resource_type": "model", "alias": "d_municipalities", "checksum": {"name": "sha256", "checksum": "ed1d87fc91f2263321bdde597caa8fd9bdc18de8ab045cf394a960526a82cc3b"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "hierarchical geographic dimension", "columns": {"municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": null, "deferred": false}, "error": null, "status": null, "execution_time": 0, "thread_id": null, "timing": [], "fail": null, "warn": null, "skip": true}, {"node": {"raw_sql": "select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, 'N/A') as lane_type\n  ,coalesce(lane_code, 'N/A') as lane_code\n  ,coalesce(lane, 'N/A') as lane\n  ,coalesce(zip_code, 'N/A') as zip_code\n  ,municipality_code\n  ,lots_count\n  ,coalesce(premises_code, 'N/A') as premises_code\n  ,coalesce(built_surface, 0) as built_surface\n  ,coalesce(land_surface, 0) as land_surface\n  ,coalesce(main_rooms_count, 0) as main_rooms_count\n  ,coalesce(crop_code, 'N/A') as crop_code\nfrom\n  {{ ref('stg__land_values') }} as stg__land_values\n  join {{ ref('transfer_types') }} transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr", "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "f_land_values"], "unique_id": "model.subsurface.f_land_values", "package_name": "subsurface", "root_path": "/root/git/subsurface", "path": "marts/f_land_values.sql", "original_file_path": "models/marts/f_land_values.sql", "name": "f_land_values", "resource_type": "model", "alias": "f_land_values", "checksum": {"name": "sha256", "checksum": "f99cb619d828f59ecfe70bf27c4d200ef26042e930a0c3d3d1e6af3431e0e31a"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["stg__land_values"], ["transfer_types"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__land_values", "seed.subsurface.transfer_types"]}, "description": "land value at transaction time", "columns": {"transaction_date": {"name": "transaction_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transaction_amount": {"name": "transaction_amount", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transfer_label": {"name": "transfer_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_type": {"name": "lane_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_code": {"name": "lane_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane": {"name": "lane", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "zip_code": {"name": "zip_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lots_count": {"name": "lots_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "built_surface": {"name": "built_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "land_surface": {"name": "land_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "main_rooms_count": {"name": "main_rooms_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": null, "deferred": false}, "error": null, "status": null, "execution_time": 0, "thread_id": null, "timing": [], "fail": null, "warn": null, "skip": true}], "generated_at": "2021-01-28T15:45:32.104978Z", "elapsed_time": 3.330291748046875}