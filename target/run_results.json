{"results": [{"node": {"raw_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  {{ source('land_values', 'valeurs_foncieres') }}", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "staging", "stg__land_values"], "unique_id": "model.subsurface.stg__land_values", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "staging/stg__land_values.sql", "original_file_path": "models/staging/stg__land_values.sql", "name": "stg__land_values", "resource_type": "model", "alias": "stg__land_values", "checksum": {"name": "sha256", "checksum": "555b4faf0b8f88f60605fe9011a839275b4355067aced56885ad38ed24e5a32a"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [], "sources": [["land_values", "valeurs_foncieres"]], "depends_on": {"macros": [], "nodes": ["source.subsurface.land_values.valeurs_foncieres"]}, "description": "land value at transaction time", "columns": {"transaction_date": {"name": "transaction_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transaction_amount": {"name": "transaction_amount", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transfer_label_fr": {"name": "transfer_label_fr", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_type": {"name": "lane_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_code": {"name": "lane_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane": {"name": "lane", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "zip_code": {"name": "zip_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lots_count": {"name": "lots_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "built_surface": {"name": "built_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "land_surface": {"name": "land_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "main_rooms_count": {"name": "main_rooms_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/staging/schema.yml", "build_path": "target/compiled/subsurface/models/staging/stg__land_values.sql", "deferred": false, "compiled_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  \"fs\".\"valeurs_foncieres\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  cast(regexp_replace(nullif(\"Date mutation\", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date\n  ,cast(replace(nullif(\"Valeur fonciere\", ''), ',', '.') as decimal) as transaction_amount\n  ,nullif(\"Nature mutation\", '') as transfer_label_fr\n  ,nullif(\"type de voie\", '') as lane_type\n  ,lpad(nullif(\"Code voie\", ''), 4, '0') as lane_code\n  ,nullif(\"Voie\", '') as lane\n  ,lpad(nullif(\"Code postal\", ''), 5, '0') as zip_code\n  ,case when \"Code departement\" not like '97%'\n    then lpad(nullif(\"Code departement\", ''), 2, '0') || lpad(nullif(\"Code commune\", ''), 3, '0')\n    else lpad(nullif(\"Code departement\", ''), 3, '0') || lpad(nullif(\"Code commune\", ''), 2, '0')\n  end as municipality_code\n  ,cast(nullif(\"Nombre de lots\", '') as decimal) as lots_count\n  ,nullif(\"code type local\", '') as premises_code\n  ,cast(nullif(\"Surface reelle bati\", '') as decimal) as built_surface\n  ,cast(nullif(\"Surface terrain\", '') as decimal) as land_surface\n  ,cast(nullif(\"Nombre pieces principales\", '') as decimal) as main_rooms_count\n  ,nullif(\"Nature culture\", '') as crop_code\nfrom\n  \"fs\".\"valeurs_foncieres\""}, "error": null, "status": null, "execution_time": 0.057656288146972656, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.280755Z", "completed_at": "2021-01-26T00:18:05.335868Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.336666Z", "completed_at": "2021-01-26T00:18:05.336703Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  {{ source('geo', 'communes') }}", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "staging", "stg__municipalities"], "unique_id": "model.subsurface.stg__municipalities", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "staging/stg__municipalities.sql", "original_file_path": "models/staging/stg__municipalities.sql", "name": "stg__municipalities", "resource_type": "model", "alias": "stg__municipalities", "checksum": {"name": "sha256", "checksum": "5adeecc802c4c28b6af1066b08ed6f06b1bb7879851dbec2b4e578e75ecbe123"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [], "sources": [["geo", "communes"]], "depends_on": {"macros": [], "nodes": ["source.subsurface.geo.communes"]}, "description": "municipalities, departement and region", "columns": {"municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_label": {"name": "municipality_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "department_code": {"name": "department_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "departement_label": {"name": "departement_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "region_code": {"name": "region_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "region_label": {"name": "region_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/staging/schema.yml", "build_path": "target/compiled/subsurface/models/staging/stg__municipalities.sql", "deferred": false, "compiled_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  \"fs\".\"geo\".\"communes.csv\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n  \"fs\".\"geo\".\"communes.csv\""}, "error": null, "status": null, "execution_time": 0.02236461639404297, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.339865Z", "completed_at": "2021-01-26T00:18:05.359242Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.360025Z", "completed_at": "2021-01-26T00:18:05.360046Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "crop_types"], "unique_id": "seed.subsurface.crop_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "crop_types.csv", "original_file_path": "data/crop_types.csv", "name": "crop_types", "resource_type": "seed", "alias": "crop_types", "checksum": {"name": "sha256", "checksum": "0fb1cb330e03437324b0528c9ae45059b5ff4949e75d7ee493b705d6aa4ad253"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": true, "quote_columns": false}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "types of crops, cultures", "columns": {"crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "crop_label": {"name": "crop_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "data/seeds.yml", "build_path": null, "deferred": false, "compiled_sql": "", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": ""}, "error": null, "status": null, "execution_time": 0.02643561363220215, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.363216Z", "completed_at": "2021-01-26T00:18:05.387412Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.387964Z", "completed_at": "2021-01-26T00:18:05.387982Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "premises_types"], "unique_id": "seed.subsurface.premises_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "premises_types.csv", "original_file_path": "data/premises_types.csv", "name": "premises_types", "resource_type": "seed", "alias": "premises_types", "checksum": {"name": "sha256", "checksum": "c6d3eb8439e47bdf095c2018df7c9c5e11dc949f4331ee27ff7ccc23f3e75c3b"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {"premises_code": "varchar"}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": true, "quote_columns": false}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "types of premises", "columns": {"premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_label_fr": {"name": "premises_label_fr", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_label_en": {"name": "premises_label_en", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "data/seeds.yml", "build_path": null, "deferred": false, "compiled_sql": "", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": ""}, "error": null, "status": null, "execution_time": 0.017342567443847656, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.390307Z", "completed_at": "2021-01-26T00:18:05.405354Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.405918Z", "completed_at": "2021-01-26T00:18:05.405937Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "transfer_types"], "unique_id": "seed.subsurface.transfer_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "transfer_types.csv", "original_file_path": "data/transfer_types.csv", "name": "transfer_types", "resource_type": "seed", "alias": "transfer_types", "checksum": {"name": "sha256", "checksum": "1a3481a7f2fd36a646ea6b60510dbee0857eedebb81b064e3e2bfffc1944b50c"}, "config": {"enabled": true, "materialized": "seed", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": true, "quote_columns": false}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": [], "nodes": []}, "description": "types of transfer of ownership", "columns": {"transfer_label_fr": {"name": "transfer_label_fr", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transfer_label_en": {"name": "transfer_label_en", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "data/seeds.yml", "build_path": null, "deferred": false, "compiled_sql": "", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": ""}, "error": null, "status": null, "execution_time": 0.01621222496032715, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.408967Z", "completed_at": "2021-01-26T00:18:05.422909Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.423458Z", "completed_at": "2021-01-26T00:18:05.423476Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lots_count", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__land_values_lots_count"], "unique_id": "test.subsurface.not_null_stg__land_values_lots_count", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__land_values_lots_count.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__land_values_lots_count", "resource_type": "test", "alias": "not_null_stg__land_values_lots_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_lots_count.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere lots_count is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere lots_count is null\n\n\n", "column_name": "lots_count"}, "error": null, "status": null, "execution_time": 0.03189516067504883, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.426519Z", "completed_at": "2021-01-26T00:18:05.455496Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.456263Z", "completed_at": "2021-01-26T00:18:05.456284Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__land_values_municipality_code"], "unique_id": "test.subsurface.not_null_stg__land_values_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__land_values_municipality_code.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__land_values_municipality_code", "resource_type": "test", "alias": "not_null_stg__land_values_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere municipality_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere municipality_code is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.020612001419067383, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.458929Z", "completed_at": "2021-01-26T00:18:05.476843Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.477692Z", "completed_at": "2021-01-26T00:18:05.477712Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transaction_date", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__land_values_transaction_date"], "unique_id": "test.subsurface.not_null_stg__land_values_transaction_date", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__land_values_transaction_date.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__land_values_transaction_date", "resource_type": "test", "alias": "not_null_stg__land_values_transaction_date", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_transaction_date.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere transaction_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere transaction_date is null\n\n\n", "column_name": "transaction_date"}, "error": null, "status": null, "execution_time": 0.020932912826538086, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.480494Z", "completed_at": "2021-01-26T00:18:05.498723Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.499607Z", "completed_at": "2021-01-26T00:18:05.499629Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transfer_label_fr", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__land_values_transfer_label_fr"], "unique_id": "test.subsurface.not_null_stg__land_values_transfer_label_fr", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__land_values_transfer_label_fr.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__land_values_transfer_label_fr", "resource_type": "test", "alias": "not_null_stg__land_values_transfer_label_fr", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_transfer_label_fr.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere transfer_label_fr is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__land_values\"\nwhere transfer_label_fr is null\n\n\n", "column_name": "transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.020243406295776367, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.502425Z", "completed_at": "2021-01-26T00:18:05.520171Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.520906Z", "completed_at": "2021-01-26T00:18:05.520928Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  *\nfrom\n  {{ ref('stg__land_values') }}\nwhere\n  built_surface is not null\n  and premises_code is null", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "data_test", "stg__land_values_built_surface_implies_premises_code"], "unique_id": "test.subsurface.stg__land_values_built_surface_implies_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "data_test/stg__land_values_built_surface_implies_premises_code.sql", "original_file_path": "tests/stg__land_values_built_surface_implies_premises_code.sql", "name": "stg__land_values_built_surface_implies_premises_code", "resource_type": "test", "alias": "stg__land_values_built_surface_implies_premises_code", "checksum": {"name": "sha256", "checksum": "ee115489939204acab69a1a5ed24c9b53acb4b5b1eb2d965316e08877157e6c5"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["data"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/tests/stg__land_values_built_surface_implies_premises_code.sql", "deferred": false, "compiled_sql": "\nselect count(*) from dbt__CTE__INTERNAL_test", "extra_ctes_injected": true, "extra_ctes": [{"id": "dbt__CTE__INTERNAL_test", "sql": " dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  \"@fab4\".\"stg__land_values\"\nwhere\n  built_surface is not null\n  and premises_code is null\n)"}], "injected_sql": "\nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  \"@fab4\".\"stg__land_values\"\nwhere\n  built_surface is not null\n  and premises_code is null\n)select count(*) from dbt__CTE__INTERNAL_test"}, "error": null, "status": null, "execution_time": 0.029368877410888672, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.523607Z", "completed_at": "2021-01-26T00:18:05.550269Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.551171Z", "completed_at": "2021-01-26T00:18:05.551193Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  *\nfrom\n  {{ ref('stg__land_values') }}\nwhere\n  land_surface is not null\n  and crop_code is null", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "data_test", "stg__land_values_land_surface_implies_crop_code"], "unique_id": "test.subsurface.stg__land_values_land_surface_implies_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "data_test/stg__land_values_land_surface_implies_crop_code.sql", "original_file_path": "tests/stg__land_values_land_surface_implies_crop_code.sql", "name": "stg__land_values_land_surface_implies_crop_code", "resource_type": "test", "alias": "stg__land_values_land_surface_implies_crop_code", "checksum": {"name": "sha256", "checksum": "77a8e26efb4ac6b047f65f3e1ed1e67bed46914ecf349437d15df8480cc6a537"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["data"], "refs": [["stg__land_values"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/tests/stg__land_values_land_surface_implies_crop_code.sql", "deferred": false, "compiled_sql": "\nselect count(*) from dbt__CTE__INTERNAL_test", "extra_ctes_injected": true, "extra_ctes": [{"id": "dbt__CTE__INTERNAL_test", "sql": " dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  \"@fab4\".\"stg__land_values\"\nwhere\n  land_surface is not null\n  and crop_code is null\n)"}], "injected_sql": "\nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  \"@fab4\".\"stg__land_values\"\nwhere\n  land_surface is not null\n  and crop_code is null\n)select count(*) from dbt__CTE__INTERNAL_test"}, "error": null, "status": null, "execution_time": 0.018457651138305664, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.553949Z", "completed_at": "2021-01-26T00:18:05.569856Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.570653Z", "completed_at": "2021-01-26T00:18:05.570674Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  municipality_code\n  ,municipality_label\n  ,department_code\n  ,department_label\n  ,region_code\n  ,region_label\nfrom\n  {{ ref('stg__municipalities') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_municipalities"], "unique_id": "model.subsurface.d_municipalities", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "marts/d_municipalities.sql", "original_file_path": "models/marts/d_municipalities.sql", "name": "d_municipalities", "resource_type": "model", "alias": "d_municipalities", "checksum": {"name": "sha256", "checksum": "ed1d87fc91f2263321bdde597caa8fd9bdc18de8ab045cf394a960526a82cc3b"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "hierarchical geographic dimension", "columns": {"municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/compiled/subsurface/models/marts/d_municipalities.sql", "deferred": false, "compiled_sql": "select\n  municipality_code\n  ,municipality_label\n  ,department_code\n  ,department_label\n  ,region_code\n  ,region_label\nfrom\n  \"@fab4\".\"stg__municipalities\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  municipality_code\n  ,municipality_label\n  ,department_code\n  ,department_label\n  ,region_code\n  ,region_label\nfrom\n  \"@fab4\".\"stg__municipalities\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'\n  ,'N/A'"}, "error": null, "status": null, "execution_time": 0.018354415893554688, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.573335Z", "completed_at": "2021-01-26T00:18:05.588969Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.589730Z", "completed_at": "2021-01-26T00:18:05.589752Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "departement_label", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_departement_label"], "unique_id": "test.subsurface.not_null_stg__municipalities_departement_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_departement_label.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_departement_label", "resource_type": "test", "alias": "not_null_stg__municipalities_departement_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_departement_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere departement_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere departement_label is null\n\n\n", "column_name": "departement_label"}, "error": null, "status": null, "execution_time": 0.01989579200744629, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.592597Z", "completed_at": "2021-01-26T00:18:05.610086Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.610831Z", "completed_at": "2021-01-26T00:18:05.610854Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "department_code", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_department_code"], "unique_id": "test.subsurface.not_null_stg__municipalities_department_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_department_code.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_department_code", "resource_type": "test", "alias": "not_null_stg__municipalities_department_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_department_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere department_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere department_code is null\n\n\n", "column_name": "department_code"}, "error": null, "status": null, "execution_time": 0.020929813385009766, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.613505Z", "completed_at": "2021-01-26T00:18:05.631769Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.632510Z", "completed_at": "2021-01-26T00:18:05.632530Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_municipality_code"], "unique_id": "test.subsurface.not_null_stg__municipalities_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_municipality_code.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_municipality_code", "resource_type": "test", "alias": "not_null_stg__municipalities_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere municipality_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere municipality_code is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.019716739654541016, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.635428Z", "completed_at": "2021-01-26T00:18:05.652672Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.653382Z", "completed_at": "2021-01-26T00:18:05.653403Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_label", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_municipality_label"], "unique_id": "test.subsurface.not_null_stg__municipalities_municipality_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_municipality_label.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_municipality_label", "resource_type": "test", "alias": "not_null_stg__municipalities_municipality_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_municipality_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere municipality_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere municipality_label is null\n\n\n", "column_name": "municipality_label"}, "error": null, "status": null, "execution_time": 0.0221707820892334, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.656074Z", "completed_at": "2021-01-26T00:18:05.675784Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.676499Z", "completed_at": "2021-01-26T00:18:05.676520Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "region_code", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_region_code"], "unique_id": "test.subsurface.not_null_stg__municipalities_region_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_region_code.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_region_code", "resource_type": "test", "alias": "not_null_stg__municipalities_region_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_region_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere region_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere region_code is null\n\n\n", "column_name": "region_code"}, "error": null, "status": null, "execution_time": 0.02100968360900879, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.679148Z", "completed_at": "2021-01-26T00:18:05.697482Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.698198Z", "completed_at": "2021-01-26T00:18:05.698219Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "region_label", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_stg__municipalities_region_label"], "unique_id": "test.subsurface.not_null_stg__municipalities_region_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_stg__municipalities_region_label.sql", "original_file_path": "models/staging/schema.yml", "name": "not_null_stg__municipalities_region_label", "resource_type": "test", "alias": "not_null_stg__municipalities_region_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__municipalities_region_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere region_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"stg__municipalities\"\nwhere region_label is null\n\n\n", "column_name": "region_label"}, "error": null, "status": null, "execution_time": 0.019831418991088867, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.701105Z", "completed_at": "2021-01-26T00:18:05.718247Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.718984Z", "completed_at": "2021-01-26T00:18:05.719004Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('stg__municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_stg__municipalities_municipality_code"], "unique_id": "test.subsurface.unique_stg__municipalities_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_stg__municipalities_municipality_code.sql", "original_file_path": "models/staging/schema.yml", "name": "unique_stg__municipalities_municipality_code", "resource_type": "test", "alias": "unique_stg__municipalities_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["stg__municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.subsurface.stg__municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/unique_stg__municipalities_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        municipality_code\n\n    from \"@fab4\".\"stg__municipalities\"\n    where municipality_code is not null\n    group by municipality_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        municipality_code\n\n    from \"@fab4\".\"stg__municipalities\"\n    where municipality_code is not null\n    group by municipality_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.019954204559326172, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.721611Z", "completed_at": "2021-01-26T00:18:05.739110Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.739822Z", "completed_at": "2021-01-26T00:18:05.739842Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  {{ ref('crop_types') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_crop_types"], "unique_id": "model.subsurface.d_crop_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "marts/d_crop_types.sql", "original_file_path": "models/marts/d_crop_types.sql", "name": "d_crop_types", "resource_type": "model", "alias": "d_crop_types", "checksum": {"name": "sha256", "checksum": "53a9062c52f2aa6095993d0a9925fa2ea9f2d15651a973f92d56d22c63b0e315"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": [], "nodes": ["seed.subsurface.crop_types"]}, "description": "land value at transaction time", "columns": {"crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/compiled/subsurface/models/marts/d_crop_types.sql", "deferred": false, "compiled_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  \"@fab4\".\"crop_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  crop_code\n  ,crop_label\nfrom\n  \"@fab4\".\"crop_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'"}, "error": null, "status": null, "execution_time": 0.01802682876586914, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.742472Z", "completed_at": "2021-01-26T00:18:05.757964Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.758703Z", "completed_at": "2021-01-26T00:18:05.758723Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "crop_code", "model": "{{ ref('crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_crop_types_crop_code"], "unique_id": "test.subsurface.not_null_crop_types_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_crop_types_crop_code.sql", "original_file_path": "data/seeds.yml", "name": "not_null_crop_types_crop_code", "resource_type": "test", "alias": "not_null_crop_types_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_crop_types_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"crop_types\"\nwhere crop_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"crop_types\"\nwhere crop_code is null\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.020371437072753906, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.761690Z", "completed_at": "2021-01-26T00:18:05.779598Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.780309Z", "completed_at": "2021-01-26T00:18:05.780329Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "crop_label", "model": "{{ ref('crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_crop_types_crop_label"], "unique_id": "test.subsurface.not_null_crop_types_crop_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_crop_types_crop_label.sql", "original_file_path": "data/seeds.yml", "name": "not_null_crop_types_crop_label", "resource_type": "test", "alias": "not_null_crop_types_crop_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_crop_types_crop_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"crop_types\"\nwhere crop_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"crop_types\"\nwhere crop_label is null\n\n\n", "column_name": "crop_label"}, "error": null, "status": null, "execution_time": 0.021524429321289062, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.783266Z", "completed_at": "2021-01-26T00:18:05.801830Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.802605Z", "completed_at": "2021-01-26T00:18:05.802626Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "crop_code", "model": "{{ ref('crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_crop_types_crop_code"], "unique_id": "test.subsurface.unique_crop_types_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_crop_types_crop_code.sql", "original_file_path": "data/seeds.yml", "name": "unique_crop_types_crop_code", "resource_type": "test", "alias": "unique_crop_types_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.subsurface.crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/unique_crop_types_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        crop_code\n\n    from \"@fab4\".\"crop_types\"\n    where crop_code is not null\n    group by crop_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        crop_code\n\n    from \"@fab4\".\"crop_types\"\n    where crop_code is not null\n    group by crop_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.020305395126342773, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.805186Z", "completed_at": "2021-01-26T00:18:05.823038Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.823740Z", "completed_at": "2021-01-26T00:18:05.823760Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  {{ ref('premises_types') }}\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "d_premises_types"], "unique_id": "model.subsurface.d_premises_types", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "marts/d_premises_types.sql", "original_file_path": "models/marts/d_premises_types.sql", "name": "d_premises_types", "resource_type": "model", "alias": "d_premises_types", "checksum": {"name": "sha256", "checksum": "55bbe47a9febead545427c14159bd2f12c66ee55c7f03da191794ab24ff1a013"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": [], "nodes": ["seed.subsurface.premises_types"]}, "description": "type of premises", "columns": {"premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/compiled/subsurface/models/marts/d_premises_types.sql", "deferred": false, "compiled_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  \"@fab4\".\"premises_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  \"@fab4\".\"premises_types\"\n\nunion all\n\nselect\n  'N/A'\n  ,'N/A'"}, "error": null, "status": null, "execution_time": 0.01815342903137207, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.826397Z", "completed_at": "2021-01-26T00:18:05.841908Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.842758Z", "completed_at": "2021-01-26T00:18:05.842780Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_code", "model": "{{ ref('premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_premises_types_premises_code"], "unique_id": "test.subsurface.not_null_premises_types_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_premises_types_premises_code.sql", "original_file_path": "data/seeds.yml", "name": "not_null_premises_types_premises_code", "resource_type": "test", "alias": "not_null_premises_types_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_premises_types_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_code is null\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.01995062828063965, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.845747Z", "completed_at": "2021-01-26T00:18:05.863176Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.863928Z", "completed_at": "2021-01-26T00:18:05.863949Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_label_en", "model": "{{ ref('premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_premises_types_premises_label_en"], "unique_id": "test.subsurface.not_null_premises_types_premises_label_en", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_premises_types_premises_label_en.sql", "original_file_path": "data/seeds.yml", "name": "not_null_premises_types_premises_label_en", "resource_type": "test", "alias": "not_null_premises_types_premises_label_en", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_premises_types_premises_label_en.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_label_en is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_label_en is null\n\n\n", "column_name": "premises_label_en"}, "error": null, "status": null, "execution_time": 0.020704269409179688, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.867072Z", "completed_at": "2021-01-26T00:18:05.884913Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.885606Z", "completed_at": "2021-01-26T00:18:05.885627Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_label_fr", "model": "{{ ref('premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_premises_types_premises_label_fr"], "unique_id": "test.subsurface.not_null_premises_types_premises_label_fr", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_premises_types_premises_label_fr.sql", "original_file_path": "data/seeds.yml", "name": "not_null_premises_types_premises_label_fr", "resource_type": "test", "alias": "not_null_premises_types_premises_label_fr", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_premises_types_premises_label_fr.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_label_fr is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"premises_types\"\nwhere premises_label_fr is null\n\n\n", "column_name": "premises_label_fr"}, "error": null, "status": null, "execution_time": 0.022402286529541016, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.888225Z", "completed_at": "2021-01-26T00:18:05.908148Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.908867Z", "completed_at": "2021-01-26T00:18:05.908888Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "premises_code", "model": "{{ ref('premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_premises_types_premises_code"], "unique_id": "test.subsurface.unique_premises_types_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_premises_types_premises_code.sql", "original_file_path": "data/seeds.yml", "name": "unique_premises_types_premises_code", "resource_type": "test", "alias": "unique_premises_types_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.subsurface.premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/unique_premises_types_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        premises_code\n\n    from \"@fab4\".\"premises_types\"\n    where premises_code is not null\n    group by premises_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        premises_code\n\n    from \"@fab4\".\"premises_types\"\n    where premises_code is not null\n    group by premises_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.019949674606323242, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.911549Z", "completed_at": "2021-01-26T00:18:05.929046Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.929739Z", "completed_at": "2021-01-26T00:18:05.929760Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, 'N/A') as lane_type\n  ,coalesce(lane_code, 'N/A') as lane_code\n  ,coalesce(lane, 'N/A') as lane\n  ,coalesce(zip_code, 'N/A') as zip_code\n  ,municipality_code\n  ,lots_count\n  ,coalesce(premises_code, 'N/A') as premises_code\n  ,coalesce(built_surface, 0) as built_surface\n  ,coalesce(land_surface, 0) as land_surface\n  ,coalesce(main_rooms_count, 0) as main_rooms_count\n  ,coalesce(crop_code, 'N/A') as crop_code\nfrom\n  {{ ref('stg__land_values') }} as stg__land_values\n  join {{ ref('transfer_types') }} transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "marts", "f_land_values"], "unique_id": "model.subsurface.f_land_values", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "marts/f_land_values.sql", "original_file_path": "models/marts/f_land_values.sql", "name": "f_land_values", "resource_type": "model", "alias": "f_land_values", "checksum": {"name": "sha256", "checksum": "f99cb619d828f59ecfe70bf27c4d200ef26042e930a0c3d3d1e6af3431e0e31a"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["stg__land_values"], ["transfer_types"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.stg__land_values", "seed.subsurface.transfer_types"]}, "description": "land value at transaction time", "columns": {"transaction_date": {"name": "transaction_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transaction_amount": {"name": "transaction_amount", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "transfer_label": {"name": "transfer_label", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_type": {"name": "lane_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane_code": {"name": "lane_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lane": {"name": "lane", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "zip_code": {"name": "zip_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "municipality_code": {"name": "municipality_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "lots_count": {"name": "lots_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "premises_code": {"name": "premises_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "built_surface": {"name": "built_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "land_surface": {"name": "land_surface", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "main_rooms_count": {"name": "main_rooms_count", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "crop_code": {"name": "crop_code", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/marts/schema.yml", "build_path": "target/compiled/subsurface/models/marts/f_land_values.sql", "deferred": false, "compiled_sql": "select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, 'N/A') as lane_type\n  ,coalesce(lane_code, 'N/A') as lane_code\n  ,coalesce(lane, 'N/A') as lane\n  ,coalesce(zip_code, 'N/A') as zip_code\n  ,municipality_code\n  ,lots_count\n  ,coalesce(premises_code, 'N/A') as premises_code\n  ,coalesce(built_surface, 0) as built_surface\n  ,coalesce(land_surface, 0) as land_surface\n  ,coalesce(main_rooms_count, 0) as main_rooms_count\n  ,coalesce(crop_code, 'N/A') as crop_code\nfrom\n  \"@fab4\".\"stg__land_values\" as stg__land_values\n  join \"@fab4\".\"transfer_types\" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, 'N/A') as lane_type\n  ,coalesce(lane_code, 'N/A') as lane_code\n  ,coalesce(lane, 'N/A') as lane\n  ,coalesce(zip_code, 'N/A') as zip_code\n  ,municipality_code\n  ,lots_count\n  ,coalesce(premises_code, 'N/A') as premises_code\n  ,coalesce(built_surface, 0) as built_surface\n  ,coalesce(land_surface, 0) as land_surface\n  ,coalesce(main_rooms_count, 0) as main_rooms_count\n  ,coalesce(crop_code, 'N/A') as crop_code\nfrom\n  \"@fab4\".\"stg__land_values\" as stg__land_values\n  join \"@fab4\".\"transfer_types\" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.03012251853942871, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.932368Z", "completed_at": "2021-01-26T00:18:05.959894Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.960692Z", "completed_at": "2021-01-26T00:18:05.960713Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transfer_label_en", "model": "{{ ref('transfer_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_transfer_types_transfer_label_en"], "unique_id": "test.subsurface.not_null_transfer_types_transfer_label_en", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_transfer_types_transfer_label_en.sql", "original_file_path": "data/seeds.yml", "name": "not_null_transfer_types_transfer_label_en", "resource_type": "test", "alias": "not_null_transfer_types_transfer_label_en", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.transfer_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_transfer_types_transfer_label_en.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"transfer_types\"\nwhere transfer_label_en is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"transfer_types\"\nwhere transfer_label_en is null\n\n\n", "column_name": "transfer_label_en"}, "error": null, "status": null, "execution_time": 0.020954370498657227, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.964210Z", "completed_at": "2021-01-26T00:18:05.981748Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:05.982605Z", "completed_at": "2021-01-26T00:18:05.982628Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transfer_label_fr", "model": "{{ ref('transfer_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_transfer_types_transfer_label_fr"], "unique_id": "test.subsurface.not_null_transfer_types_transfer_label_fr", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_transfer_types_transfer_label_fr.sql", "original_file_path": "data/seeds.yml", "name": "not_null_transfer_types_transfer_label_fr", "resource_type": "test", "alias": "not_null_transfer_types_transfer_label_fr", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["seed.subsurface.transfer_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/not_null_transfer_types_transfer_label_fr.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"transfer_types\"\nwhere transfer_label_fr is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"transfer_types\"\nwhere transfer_label_fr is null\n\n\n", "column_name": "transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.020049571990966797, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:05.985492Z", "completed_at": "2021-01-26T00:18:06.003097Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.003804Z", "completed_at": "2021-01-26T00:18:06.003824Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('transfer_types')", "field": "transfer_label_fr", "column_name": "transfer_label_fr", "model": "{{ ref('stg__land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"], "unique_id": "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/relationships_stg__land_values_b2e0c79b749681716848ecd78df2f275.sql", "original_file_path": "models/staging/schema.yml", "name": "relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_", "resource_type": "test", "alias": "relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"], ["stg__land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["seed.subsurface.transfer_types", "model.subsurface.stg__land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/staging/schema.yml/schema_test/relationships_stg__land_values_b2e0c79b749681716848ecd78df2f275.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select transfer_label_fr as id from \"@fab4\".\"stg__land_values\"\n) as child\nleft join (\n    select transfer_label_fr as id from \"@fab4\".\"transfer_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select transfer_label_fr as id from \"@fab4\".\"stg__land_values\"\n) as child\nleft join (\n    select transfer_label_fr as id from \"@fab4\".\"transfer_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "column_name": "transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.023822307586669922, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.006443Z", "completed_at": "2021-01-26T00:18:06.027743Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.028484Z", "completed_at": "2021-01-26T00:18:06.028506Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "transfer_label_en", "model": "{{ ref('transfer_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_transfer_types_transfer_label_en"], "unique_id": "test.subsurface.unique_transfer_types_transfer_label_en", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_transfer_types_transfer_label_en.sql", "original_file_path": "data/seeds.yml", "name": "unique_transfer_types_transfer_label_en", "resource_type": "test", "alias": "unique_transfer_types_transfer_label_en", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.subsurface.transfer_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/unique_transfer_types_transfer_label_en.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        transfer_label_en\n\n    from \"@fab4\".\"transfer_types\"\n    where transfer_label_en is not null\n    group by transfer_label_en\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        transfer_label_en\n\n    from \"@fab4\".\"transfer_types\"\n    where transfer_label_en is not null\n    group by transfer_label_en\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "transfer_label_en"}, "error": null, "status": null, "execution_time": 0.019931554794311523, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.031187Z", "completed_at": "2021-01-26T00:18:06.048533Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.049299Z", "completed_at": "2021-01-26T00:18:06.049320Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "transfer_label_fr", "model": "{{ ref('transfer_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_transfer_types_transfer_label_fr"], "unique_id": "test.subsurface.unique_transfer_types_transfer_label_fr", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_transfer_types_transfer_label_fr.sql", "original_file_path": "data/seeds.yml", "name": "unique_transfer_types_transfer_label_fr", "resource_type": "test", "alias": "unique_transfer_types_transfer_label_fr", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["transfer_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["seed.subsurface.transfer_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/data/seeds.yml/schema_test/unique_transfer_types_transfer_label_fr.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        transfer_label_fr\n\n    from \"@fab4\".\"transfer_types\"\n    where transfer_label_fr is not null\n    group by transfer_label_fr\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        transfer_label_fr\n\n    from \"@fab4\".\"transfer_types\"\n    where transfer_label_fr is not null\n    group by transfer_label_fr\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "transfer_label_fr"}, "error": null, "status": null, "execution_time": 0.020045995712280273, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.052121Z", "completed_at": "2021-01-26T00:18:06.069705Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.070426Z", "completed_at": "2021-01-26T00:18:06.070446Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('d_municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_d_municipalities_municipality_code"], "unique_id": "test.subsurface.not_null_d_municipalities_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_d_municipalities_municipality_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_d_municipalities_municipality_code", "resource_type": "test", "alias": "not_null_d_municipalities_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.d_municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_d_municipalities_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_municipalities\"\nwhere municipality_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_municipalities\"\nwhere municipality_code is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.02079296112060547, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.073070Z", "completed_at": "2021-01-26T00:18:06.091519Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.092227Z", "completed_at": "2021-01-26T00:18:06.092246Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('d_municipalities') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_d_municipalities_municipality_code"], "unique_id": "test.subsurface.unique_d_municipalities_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_d_municipalities_municipality_code.sql", "original_file_path": "models/marts/schema.yml", "name": "unique_d_municipalities_municipality_code", "resource_type": "test", "alias": "unique_d_municipalities_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_municipalities"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.subsurface.d_municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/unique_d_municipalities_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        municipality_code\n\n    from \"@fab4\".\"d_municipalities\"\n    where municipality_code is not null\n    group by municipality_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        municipality_code\n\n    from \"@fab4\".\"d_municipalities\"\n    where municipality_code is not null\n    group by municipality_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.02023005485534668, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.094747Z", "completed_at": "2021-01-26T00:18:06.112485Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.113197Z", "completed_at": "2021-01-26T00:18:06.113219Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "crop_code", "model": "{{ ref('d_crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_d_crop_types_crop_code"], "unique_id": "test.subsurface.not_null_d_crop_types_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_d_crop_types_crop_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_d_crop_types_crop_code", "resource_type": "test", "alias": "not_null_d_crop_types_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.d_crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_d_crop_types_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_crop_types\"\nwhere crop_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_crop_types\"\nwhere crop_code is null\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.022232770919799805, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.115896Z", "completed_at": "2021-01-26T00:18:06.135694Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.136390Z", "completed_at": "2021-01-26T00:18:06.136412Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "crop_code", "model": "{{ ref('d_crop_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_d_crop_types_crop_code"], "unique_id": "test.subsurface.unique_d_crop_types_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_d_crop_types_crop_code.sql", "original_file_path": "models/marts/schema.yml", "name": "unique_d_crop_types_crop_code", "resource_type": "test", "alias": "unique_d_crop_types_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_crop_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.subsurface.d_crop_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/unique_d_crop_types_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        crop_code\n\n    from \"@fab4\".\"d_crop_types\"\n    where crop_code is not null\n    group by crop_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        crop_code\n\n    from \"@fab4\".\"d_crop_types\"\n    where crop_code is not null\n    group by crop_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.07717752456665039, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.139011Z", "completed_at": "2021-01-26T00:18:06.213592Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.214384Z", "completed_at": "2021-01-26T00:18:06.214405Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_code", "model": "{{ ref('d_premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_d_premises_types_premises_code"], "unique_id": "test.subsurface.not_null_d_premises_types_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_d_premises_types_premises_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_d_premises_types_premises_code", "resource_type": "test", "alias": "not_null_d_premises_types_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.d_premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_d_premises_types_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_premises_types\"\nwhere premises_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"d_premises_types\"\nwhere premises_code is null\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.02010202407836914, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.217020Z", "completed_at": "2021-01-26T00:18:06.234539Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.235356Z", "completed_at": "2021-01-26T00:18:06.235377Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "premises_code", "model": "{{ ref('d_premises_types') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "unique_d_premises_types_premises_code"], "unique_id": "test.subsurface.unique_d_premises_types_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/unique_d_premises_types_premises_code.sql", "original_file_path": "models/marts/schema.yml", "name": "unique_d_premises_types_premises_code", "resource_type": "test", "alias": "unique_d_premises_types_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_premises_types"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.subsurface.d_premises_types"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/unique_d_premises_types_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        premises_code\n\n    from \"@fab4\".\"d_premises_types\"\n    where premises_code is not null\n    group by premises_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        premises_code\n\n    from \"@fab4\".\"d_premises_types\"\n    where premises_code is not null\n    group by premises_code\n    having count(*) > 1\n\n) validation_errors\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.020040512084960938, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.237962Z", "completed_at": "2021-01-26T00:18:06.255463Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.256183Z", "completed_at": "2021-01-26T00:18:06.256203Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select\n  d_municipalities.department_code\n  ,d_municipalities.department_label\n  ,avg(f_land_values.transaction_amount / f_land_values.built_surface)\nfrom\n  {{ ref('f_land_values') }} as f_land_values\n  join {{ ref('d_municipalities') }} as d_municipalities on d_municipalities.municipality_code = f_land_values.municipality_code\nwhere\n  f_land_values.premises_code = '2'\n  and f_land_values.built_surface > 0\n  and f_land_values.land_surface = 0\n  and f_land_values.transfer_label = 'Sale'\ngroup by\n  d_municipalities.department_code\n  ,d_municipalities.department_label\norder by\n  3 desc", "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "analysis", "most_expensive_departments_for_flats"], "unique_id": "analysis.subsurface.most_expensive_departments_for_flats", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "analysis/most_expensive_departments_for_flats.sql", "original_file_path": "analysis/most_expensive_departments_for_flats.sql", "name": "most_expensive_departments_for_flats", "resource_type": "analysis", "alias": "most_expensive_departments_for_flats", "checksum": {"name": "sha256", "checksum": "9fb06e769782350221c2f0b90f413d3873c7cbe9f38faaa10b7458d2598c44c0"}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null}, "tags": [], "refs": [["f_land_values"], ["d_municipalities"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.subsurface.f_land_values", "model.subsurface.d_municipalities"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/analysis/most_expensive_departments_for_flats.sql", "deferred": false, "compiled_sql": "select\n  d_municipalities.department_code\n  ,d_municipalities.department_label\n  ,avg(f_land_values.transaction_amount / f_land_values.built_surface)\nfrom\n  \"@fab4\".\"f_land_values\" as f_land_values\n  join \"@fab4\".\"d_municipalities\" as d_municipalities on d_municipalities.municipality_code = f_land_values.municipality_code\nwhere\n  f_land_values.premises_code = '2'\n  and f_land_values.built_surface > 0\n  and f_land_values.land_surface = 0\n  and f_land_values.transfer_label = 'Sale'\ngroup by\n  d_municipalities.department_code\n  ,d_municipalities.department_label\norder by\n  3 desc", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select\n  d_municipalities.department_code\n  ,d_municipalities.department_label\n  ,avg(f_land_values.transaction_amount / f_land_values.built_surface)\nfrom\n  \"@fab4\".\"f_land_values\" as f_land_values\n  join \"@fab4\".\"d_municipalities\" as d_municipalities on d_municipalities.municipality_code = f_land_values.municipality_code\nwhere\n  f_land_values.premises_code = '2'\n  and f_land_values.built_surface > 0\n  and f_land_values.land_surface = 0\n  and f_land_values.transfer_label = 'Sale'\ngroup by\n  d_municipalities.department_code\n  ,d_municipalities.department_label\norder by\n  3 desc"}, "error": null, "status": null, "execution_time": 0.027951717376708984, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.258885Z", "completed_at": "2021-01-26T00:18:06.284254Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.284968Z", "completed_at": "2021-01-26T00:18:06.284988Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "built_surface", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_built_surface"], "unique_id": "test.subsurface.not_null_f_land_values_built_surface", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_built_surface.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_built_surface", "resource_type": "test", "alias": "not_null_f_land_values_built_surface", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_built_surface.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere built_surface is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere built_surface is null\n\n\n", "column_name": "built_surface"}, "error": null, "status": null, "execution_time": 0.03116440773010254, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.287847Z", "completed_at": "2021-01-26T00:18:06.314898Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.315802Z", "completed_at": "2021-01-26T00:18:06.315823Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "crop_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_crop_code"], "unique_id": "test.subsurface.not_null_f_land_values_crop_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_crop_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_crop_code", "resource_type": "test", "alias": "not_null_f_land_values_crop_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_crop_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere crop_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere crop_code is null\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.026835918426513672, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.321582Z", "completed_at": "2021-01-26T00:18:06.345264Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.346064Z", "completed_at": "2021-01-26T00:18:06.346084Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "land_surface", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_land_surface"], "unique_id": "test.subsurface.not_null_f_land_values_land_surface", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_land_surface.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_land_surface", "resource_type": "test", "alias": "not_null_f_land_values_land_surface", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_land_surface.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere land_surface is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere land_surface is null\n\n\n", "column_name": "land_surface"}, "error": null, "status": null, "execution_time": 0.02007317543029785, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.348687Z", "completed_at": "2021-01-26T00:18:06.366082Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.366869Z", "completed_at": "2021-01-26T00:18:06.366890Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lane", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_lane"], "unique_id": "test.subsurface.not_null_f_land_values_lane", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_lane.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_lane", "resource_type": "test", "alias": "not_null_f_land_values_lane", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lane.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane is null\n\n\n", "column_name": "lane"}, "error": null, "status": null, "execution_time": 0.02156686782836914, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.369699Z", "completed_at": "2021-01-26T00:18:06.388789Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.389496Z", "completed_at": "2021-01-26T00:18:06.389517Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lane_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_lane_code"], "unique_id": "test.subsurface.not_null_f_land_values_lane_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_lane_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_lane_code", "resource_type": "test", "alias": "not_null_f_land_values_lane_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lane_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane_code is null\n\n\n", "column_name": "lane_code"}, "error": null, "status": null, "execution_time": 0.019976377487182617, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.392083Z", "completed_at": "2021-01-26T00:18:06.409573Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.410294Z", "completed_at": "2021-01-26T00:18:06.410330Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lane_type", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_lane_type"], "unique_id": "test.subsurface.not_null_f_land_values_lane_type", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_lane_type.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_lane_type", "resource_type": "test", "alias": "not_null_f_land_values_lane_type", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lane_type.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane_type is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lane_type is null\n\n\n", "column_name": "lane_type"}, "error": null, "status": null, "execution_time": 0.02564382553100586, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.412952Z", "completed_at": "2021-01-26T00:18:06.436003Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.436839Z", "completed_at": "2021-01-26T00:18:06.436862Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "lots_count", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_lots_count"], "unique_id": "test.subsurface.not_null_f_land_values_lots_count", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_lots_count.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_lots_count", "resource_type": "test", "alias": "not_null_f_land_values_lots_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lots_count.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lots_count is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere lots_count is null\n\n\n", "column_name": "lots_count"}, "error": null, "status": null, "execution_time": 0.02159857749938965, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.439482Z", "completed_at": "2021-01-26T00:18:06.458580Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.459334Z", "completed_at": "2021-01-26T00:18:06.459355Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "main_rooms_count", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_main_rooms_count"], "unique_id": "test.subsurface.not_null_f_land_values_main_rooms_count", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_main_rooms_count.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_main_rooms_count", "resource_type": "test", "alias": "not_null_f_land_values_main_rooms_count", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_main_rooms_count.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere main_rooms_count is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere main_rooms_count is null\n\n\n", "column_name": "main_rooms_count"}, "error": null, "status": null, "execution_time": 0.02036142349243164, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.461964Z", "completed_at": "2021-01-26T00:18:06.479730Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.480439Z", "completed_at": "2021-01-26T00:18:06.480459Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "municipality_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_municipality_code"], "unique_id": "test.subsurface.not_null_f_land_values_municipality_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_municipality_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_municipality_code", "resource_type": "test", "alias": "not_null_f_land_values_municipality_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_municipality_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere municipality_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere municipality_code is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.021097660064697266, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.483172Z", "completed_at": "2021-01-26T00:18:06.501571Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.502274Z", "completed_at": "2021-01-26T00:18:06.502295Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "premises_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_premises_code"], "unique_id": "test.subsurface.not_null_f_land_values_premises_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_premises_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_premises_code", "resource_type": "test", "alias": "not_null_f_land_values_premises_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_premises_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere premises_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere premises_code is null\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.020205974578857422, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.504896Z", "completed_at": "2021-01-26T00:18:06.522640Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.523354Z", "completed_at": "2021-01-26T00:18:06.523375Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transaction_amount", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_transaction_amount"], "unique_id": "test.subsurface.not_null_f_land_values_transaction_amount", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_transaction_amount.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_transaction_amount", "resource_type": "test", "alias": "not_null_f_land_values_transaction_amount", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_transaction_amount.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transaction_amount is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transaction_amount is null\n\n\n", "column_name": "transaction_amount"}, "error": null, "status": null, "execution_time": 0.019989967346191406, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.525924Z", "completed_at": "2021-01-26T00:18:06.543482Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.544191Z", "completed_at": "2021-01-26T00:18:06.544212Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transaction_date", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_transaction_date"], "unique_id": "test.subsurface.not_null_f_land_values_transaction_date", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_transaction_date.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_transaction_date", "resource_type": "test", "alias": "not_null_f_land_values_transaction_date", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_transaction_date.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transaction_date is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transaction_date is null\n\n\n", "column_name": "transaction_date"}, "error": null, "status": null, "execution_time": 0.02258443832397461, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.546859Z", "completed_at": "2021-01-26T00:18:06.566859Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.567628Z", "completed_at": "2021-01-26T00:18:06.567649Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "transfer_label", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_transfer_label"], "unique_id": "test.subsurface.not_null_f_land_values_transfer_label", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_transfer_label.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_transfer_label", "resource_type": "test", "alias": "not_null_f_land_values_transfer_label", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_transfer_label.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transfer_label is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere transfer_label is null\n\n\n", "column_name": "transfer_label"}, "error": null, "status": null, "execution_time": 0.019968748092651367, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.570366Z", "completed_at": "2021-01-26T00:18:06.587877Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.588581Z", "completed_at": "2021-01-26T00:18:06.588602Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "zip_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "not_null_f_land_values_zip_code"], "unique_id": "test.subsurface.not_null_f_land_values_zip_code", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/not_null_f_land_values_zip_code.sql", "original_file_path": "models/marts/schema.yml", "name": "not_null_f_land_values_zip_code", "resource_type": "test", "alias": "not_null_f_land_values_zip_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_zip_code.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere zip_code is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom \"@fab4\".\"f_land_values\"\nwhere zip_code is null\n\n\n", "column_name": "zip_code"}, "error": null, "status": null, "execution_time": 0.020262479782104492, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.591164Z", "completed_at": "2021-01-26T00:18:06.608972Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.609649Z", "completed_at": "2021-01-26T00:18:06.609670Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('d_crop_types')", "field": "crop_code", "column_name": "crop_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"], "unique_id": "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/relationships_f_land_values_31e8b560f7a066055d2e9e3cbda4d4fd.sql", "original_file_path": "models/marts/schema.yml", "name": "relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_", "resource_type": "test", "alias": "relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_crop_types"], ["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["model.subsurface.d_crop_types", "model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/relationships_f_land_values_31e8b560f7a066055d2e9e3cbda4d4fd.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select crop_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select crop_code as id from \"@fab4\".\"d_crop_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select crop_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select crop_code as id from \"@fab4\".\"d_crop_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "column_name": "crop_code"}, "error": null, "status": null, "execution_time": 0.024553298950195312, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.612358Z", "completed_at": "2021-01-26T00:18:06.634348Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.635121Z", "completed_at": "2021-01-26T00:18:06.635142Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('d_municipalities')", "field": "municipality_code", "column_name": "municipality_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"], "unique_id": "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/relationships_f_land_values_9963e82f8f09f5f13345aec2b504b5a5.sql", "original_file_path": "models/marts/schema.yml", "name": "relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_", "resource_type": "test", "alias": "relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_municipalities"], ["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["model.subsurface.d_municipalities", "model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/relationships_f_land_values_9963e82f8f09f5f13345aec2b504b5a5.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select municipality_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select municipality_code as id from \"@fab4\".\"d_municipalities\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select municipality_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select municipality_code as id from \"@fab4\".\"d_municipalities\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "column_name": "municipality_code"}, "error": null, "status": null, "execution_time": 0.024344205856323242, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.637703Z", "completed_at": "2021-01-26T00:18:06.659612Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.660284Z", "completed_at": "2021-01-26T00:18:06.660304Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_relationships(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "relationships", "kwargs": {"to": "ref('d_premises_types')", "field": "premises_code", "column_name": "premises_code", "model": "{{ ref('f_land_values') }}"}}, "compiled": true, "database": "@fab4", "schema": "no_schema", "fqn": ["subsurface", "schema_test", "relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"], "unique_id": "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_", "package_name": "subsurface", "root_path": "/home/fabrice/subsurface", "path": "schema_test/relationships_f_land_values_601770e576bb02eea8f782d8b9657f09.sql", "original_file_path": "models/marts/schema.yml", "name": "relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_", "resource_type": "test", "alias": "relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "severity": "ERROR"}, "tags": ["schema"], "refs": [["d_premises_types"], ["f_land_values"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_relationships"], "nodes": ["model.subsurface.d_premises_types", "model.subsurface.f_land_values"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/subsurface/models/marts/schema.yml/schema_test/relationships_f_land_values_601770e576bb02eea8f782d8b9657f09.sql", "deferred": false, "compiled_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select premises_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select premises_code as id from \"@fab4\".\"d_premises_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n    \n    \n\n\n\n\nselect count(*) as validation_errors\nfrom (\n    select premises_code as id from \"@fab4\".\"f_land_values\"\n) as child\nleft join (\n    select premises_code as id from \"@fab4\".\"d_premises_types\"\n) as parent on parent.id = child.id\nwhere child.id is not null\n  and parent.id is null\n\n\n", "column_name": "premises_code"}, "error": null, "status": null, "execution_time": 0.024924278259277344, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-01-26T00:18:06.662988Z", "completed_at": "2021-01-26T00:18:06.685268Z"}, {"name": "execute", "started_at": "2021-01-26T00:18:06.686067Z", "completed_at": "2021-01-26T00:18:06.686088Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2021-01-26T00:18:06.729433Z", "elapsed_time": 1.9986040592193604}