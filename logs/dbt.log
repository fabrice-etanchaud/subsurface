2021-01-24 09:17:58.324423 (MainThread): Running with dbt=0.18.1
2021-01-24 09:17:58.439843 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-24 09:17:58.441434 (MainThread): Tracking: tracking
2021-01-24 09:17:58.476581 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f3b81bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f3b834eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f3b834f28>]}
2021-01-24 09:17:58.536896 (MainThread): Partial parsing not enabled
2021-01-24 09:17:58.551105 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 09:17:58.565848 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 09:17:58.571169 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 09:17:58.577371 (MainThread): Parsing macros/helpers.sql
2021-01-24 09:17:58.602632 (MainThread): Parsing macros/catalog.sql
2021-01-24 09:17:58.607234 (MainThread): Parsing macros/adapters.sql
2021-01-24 09:17:58.653367 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 09:17:58.655890 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-24 09:17:58.662930 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-24 09:17:58.663428 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-24 09:17:58.669086 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-24 09:17:58.687835 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 09:17:58.705649 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 09:17:58.714744 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-24 09:17:58.729834 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 09:17:58.741233 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 09:17:58.771061 (MainThread): Parsing macros/core.sql
2021-01-24 09:17:58.778932 (MainThread): Parsing macros/adapters/common.sql
2021-01-24 09:17:58.859511 (MainThread): Parsing macros/etc/datetime.sql
2021-01-24 09:17:58.880275 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-24 09:17:58.884006 (MainThread): Parsing macros/etc/query.sql
2021-01-24 09:17:58.886525 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-24 09:17:58.888788 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-24 09:17:58.893054 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-24 09:17:58.897700 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-24 09:17:58.916347 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-24 09:17:58.920316 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 09:17:58.933430 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-24 09:17:58.986383 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-24 09:17:59.019949 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-24 09:17:59.023728 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-24 09:17:59.034292 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 09:17:59.047197 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-24 09:17:59.074664 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 09:17:59.088359 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 09:17:59.129749 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-24 09:17:59.133810 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-24 09:17:59.137161 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-24 09:17:59.140878 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-24 09:17:59.156732 (MainThread): Partial parsing not enabled
2021-01-24 09:17:59.274699 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values_aggregate_reflection".
2021-01-24 09:17:59.318693 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:17:59.703356 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-24 09:17:59.704683 (MainThread): 
2021-01-24 09:17:59.705413 (MainThread): Acquiring new dremio connection "master".
2021-01-24 09:17:59.709018 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-24 09:17:59.736806 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-24 09:17:59.737067 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-24 09:17:59.737236 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-24 09:17:59.737429 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:18:00.861476 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-24 09:18:03.983904 (ThreadPoolExecutor-0_0): SQL status: OK in 4.25 seconds
2021-01-24 09:18:04.264477 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-24 09:18:04.272458 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-24 09:18:04.286057 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-24 09:18:04.286412 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-24 09:18:04.286685 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-24 09:18:04.286910 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:18:04.477363 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-24 09:18:11.116949 (ThreadPoolExecutor-1_0): SQL status: OK in 6.83 seconds
2021-01-24 09:18:11.154762 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-24 09:18:11.155160 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-24 09:18:11.158289 (MainThread): 10:18:11 | Concurrency: 2 threads (target='managed')
2021-01-24 09:18:11.158698 (MainThread): 10:18:11 | 
2021-01-24 09:18:11.193492 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-24 09:18:11.196795 (Thread-1): 10:18:11 | 1 of 1 START table model subsurface.stg__land_values................. [RUN]
2021-01-24 09:18:11.197634 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:18:11.198026 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-24 09:18:11.260378 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-24 09:18:11.270804 (Thread-1): finished collecting timing info
2021-01-24 09:18:11.357856 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-24 09:18:11.366828 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:18:11.368043 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-24 09:18:11.369139 (Thread-1): Opening a new connection, currently in state closed
2021-01-24 09:18:11.370187 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:18:11.545695 (Thread-1): Connected to db: None
2021-01-24 09:18:12.656818 (Thread-1): SQL status: OK in 1.29 seconds
2021-01-24 09:18:12.657674 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[]
2021-01-24 09:18:12.658381 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-24 09:18:12.664962 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:18:12.669611 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-24 09:18:13.638826 (Thread-1): SQL status: OK in 0.97 seconds
2021-01-24 09:18:13.639523 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[]
2021-01-24 09:18:13.661475 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:18:13.662465 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_green"
2021-01-24 09:18:13.708981 (Thread-1): SQL status: OK in 0.05 seconds
2021-01-24 09:18:13.732593 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-24 09:18:13.734259 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:18:13.735512 (Thread-1): On model.subsurface.stg__land_values: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '85'
  )

  
2021-01-24 09:18:16.132594 (Thread-1): SQL status: OK in 2.40 seconds
2021-01-24 09:18:16.146620 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:18:16.146973 (Thread-1): On model.subsurface.stg__land_values: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  )

  
2021-01-24 09:18:16.434648 (Thread-1): Error running SQL: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  )

  
2021-01-24 09:18:16.435822 (Thread-1): Rolling back transaction.
2021-01-24 09:18:16.436940 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-24 09:18:16.438162 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-24 09:18:16.440101 (Thread-1): finished collecting timing info
2021-01-24 09:18:16.442542 (Thread-1): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "subsurface"."stg__land_values" as (\n    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.subsurface.stg__land_values_green\' not found\n\n\n[Error Id: 98ca5d17-5564-4b36-a52b-d85efe76346f on fabrice-pc:31...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "subsurface"."stg__land_values" as (\n    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.subsurface.stg__land_values_green\' not found\n\n\n[Error Id: 98ca5d17-5564-4b36-a52b-d85efe76346f on fabrice-pc:31...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "subsurface"."stg__land_values" as (\n    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.subsurface.stg__land_values_green\' not found\n\n\n[Error Id: 98ca5d17-5564-4b36-a52b-d85efe76346f on fabrice-pc:31...[see log] (1040) (SQLExecDirectW)')
2021-01-24 09:18:16.512894 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '718fb654-538e-4c99-94e8-7c72c3e3eb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f3b48d128>]}
2021-01-24 09:18:16.518383 (Thread-1): 10:18:16 | 1 of 1 ERROR creating table model subsurface.stg__land_values........ [ERROR in 5.32s]
2021-01-24 09:18:16.520536 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-24 09:18:16.604571 (MainThread): Acquiring new dremio connection "master".
2021-01-24 09:18:16.604994 (MainThread): On master: ROLLBACK
2021-01-24 09:18:16.605209 (MainThread): Opening a new connection, currently in state init
2021-01-24 09:18:16.605359 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:18:16.774452 (MainThread): Connected to db: None
2021-01-24 09:18:16.774886 (MainThread): On master: ROLLBACK
2021-01-24 09:18:16.775141 (MainThread): On master: Close
2021-01-24 09:18:16.777290 (MainThread): 10:18:16 | 
2021-01-24 09:18:16.781442 (MainThread): 10:18:16 | Finished running 1 table model in 17.07s.
2021-01-24 09:18:16.791794 (MainThread): Connection 'master' was properly closed.
2021-01-24 09:18:16.792108 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-24 09:18:16.807476 (MainThread): 
2021-01-24 09:18:16.810173 (MainThread): Completed with 1 error and 0 warnings:
2021-01-24 09:18:16.814346 (MainThread): 
2021-01-24 09:18:16.815816 (MainThread): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
2021-01-24 09:18:16.817924 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "subsurface"."stg__land_values" as (\n    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.subsurface.stg__land_values_green\' not found\n\n\n[Error Id: 98ca5d17-5564-4b36-a52b-d85efe76346f on fabrice-pc:31...[see log] (1040) (SQLExecDirectW)')
2021-01-24 09:18:16.818376 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-24 09:18:16.818879 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f3b5a7198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f3b5a7b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f3b53e4e0>]}
2021-01-24 09:18:16.819726 (MainThread): Flushing usage events
2021-01-24 09:25:36.680667 (MainThread): Running with dbt=0.18.1
2021-01-24 09:25:36.801471 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-24 09:25:36.802996 (MainThread): Tracking: tracking
2021-01-24 09:25:36.814932 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7bde2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7b8f5e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7b8f5eb8>]}
2021-01-24 09:25:36.876981 (MainThread): Partial parsing not enabled
2021-01-24 09:25:36.878545 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 09:25:36.883621 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 09:25:36.923389 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 09:25:36.930905 (MainThread): Parsing macros/helpers.sql
2021-01-24 09:25:36.958988 (MainThread): Parsing macros/catalog.sql
2021-01-24 09:25:36.964695 (MainThread): Parsing macros/adapters.sql
2021-01-24 09:25:37.011012 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 09:25:37.013501 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-24 09:25:37.019354 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-24 09:25:37.019864 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-24 09:25:37.025476 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-24 09:25:37.044110 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 09:25:37.062414 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 09:25:37.071034 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-24 09:25:37.085719 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 09:25:37.096994 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 09:25:37.125698 (MainThread): Parsing macros/core.sql
2021-01-24 09:25:37.133109 (MainThread): Parsing macros/adapters/common.sql
2021-01-24 09:25:37.211939 (MainThread): Parsing macros/etc/datetime.sql
2021-01-24 09:25:37.229400 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-24 09:25:37.233014 (MainThread): Parsing macros/etc/query.sql
2021-01-24 09:25:37.235535 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-24 09:25:37.237900 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-24 09:25:37.242173 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-24 09:25:37.245723 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-24 09:25:37.263672 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-24 09:25:37.267658 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 09:25:37.279794 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-24 09:25:37.330865 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-24 09:25:37.363341 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-24 09:25:37.367166 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-24 09:25:37.377109 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 09:25:37.388986 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-24 09:25:37.415265 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 09:25:37.428457 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 09:25:37.467980 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-24 09:25:37.472043 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-24 09:25:37.475418 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-24 09:25:37.479152 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-24 09:25:37.494189 (MainThread): Partial parsing not enabled
2021-01-24 09:25:37.610279 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values_aggregate_reflection".
2021-01-24 09:25:37.652174 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:38.067573 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-24 09:25:38.068935 (MainThread): 
2021-01-24 09:25:38.069746 (MainThread): Acquiring new dremio connection "master".
2021-01-24 09:25:38.073287 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-24 09:25:38.100591 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-24 09:25:38.100881 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-24 09:25:38.101057 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-24 09:25:38.101242 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:25:38.296220 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-24 09:25:38.660627 (ThreadPoolExecutor-0_0): SQL status: OK in 0.56 seconds
2021-01-24 09:25:38.687244 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-24 09:25:38.700402 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-24 09:25:38.719799 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-24 09:25:38.720969 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-24 09:25:38.722165 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-24 09:25:38.723171 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:25:38.876960 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-24 09:25:39.708022 (ThreadPoolExecutor-1_0): SQL status: OK in 0.99 seconds
2021-01-24 09:25:39.760069 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-24 09:25:39.760400 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-24 09:25:39.767650 (MainThread): 10:25:39 | Concurrency: 2 threads (target='managed')
2021-01-24 09:25:39.768019 (MainThread): 10:25:39 | 
2021-01-24 09:25:39.777846 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-24 09:25:39.781358 (Thread-1): 10:25:39 | 1 of 1 START table model subsurface.stg__land_values................. [RUN]
2021-01-24 09:25:39.783134 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:39.783498 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-24 09:25:39.855492 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-24 09:25:39.856296 (Thread-1): finished collecting timing info
2021-01-24 09:25:39.938112 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-24 09:25:39.944101 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:39.944387 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-24 09:25:39.944589 (Thread-1): Opening a new connection, currently in state closed
2021-01-24 09:25:39.944788 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:25:40.082803 (Thread-1): Connected to db: None
2021-01-24 09:25:40.794442 (Thread-1): SQL status: OK in 0.85 seconds
2021-01-24 09:25:40.795193 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[]
2021-01-24 09:25:40.795790 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-24 09:25:40.810662 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:40.811042 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-24 09:25:41.612172 (Thread-1): SQL status: OK in 0.80 seconds
2021-01-24 09:25:41.612896 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[]
2021-01-24 09:25:41.631515 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:41.632508 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_green"
2021-01-24 09:25:41.671507 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-24 09:25:41.686631 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-24 09:25:41.690305 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:41.691526 (Thread-1): On model.subsurface.stg__land_values: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '85'
  )

  
2021-01-24 09:25:42.898069 (Thread-1): SQL status: OK in 1.21 seconds
2021-01-24 09:25:42.909308 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:42.912556 (Thread-1): On model.subsurface.stg__land_values: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  )

  
2021-01-24 09:25:43.075809 (Thread-1): SQL status: OK in 0.16 seconds
2021-01-24 09:25:43.081218 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:43.083665 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
2021-01-24 09:25:43.116621 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-24 09:25:43.149703 (Thread-1): finished collecting timing info
2021-01-24 09:25:43.150504 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-24 09:25:43.150838 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-24 09:25:43.152686 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f9a0a75-ccd4-4027-9534-a584db6560ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7b5cb4e0>]}
2021-01-24 09:25:43.155315 (Thread-1): 10:25:43 | 1 of 1 OK created table model subsurface.stg__land_values............ [OK in 3.37s]
2021-01-24 09:25:43.157166 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-24 09:25:43.194280 (MainThread): Acquiring new dremio connection "master".
2021-01-24 09:25:43.194815 (MainThread): On master: ROLLBACK
2021-01-24 09:25:43.195146 (MainThread): Opening a new connection, currently in state init
2021-01-24 09:25:43.195390 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:25:43.341908 (MainThread): Connected to db: None
2021-01-24 09:25:43.342445 (MainThread): On master: ROLLBACK
2021-01-24 09:25:43.343423 (MainThread): On master: Close
2021-01-24 09:25:43.345493 (MainThread): 10:25:43 | 
2021-01-24 09:25:43.347209 (MainThread): 10:25:43 | Finished running 1 table model in 5.28s.
2021-01-24 09:25:43.347954 (MainThread): Connection 'master' was properly closed.
2021-01-24 09:25:43.348218 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-24 09:25:43.363090 (MainThread): 
2021-01-24 09:25:43.363436 (MainThread): Completed successfully
2021-01-24 09:25:43.363610 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-24 09:25:43.363870 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7b66d518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7b664b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7b664a90>]}
2021-01-24 09:25:43.364164 (MainThread): Flushing usage events
2021-01-24 09:25:49.686521 (MainThread): Running with dbt=0.18.1
2021-01-24 09:25:49.807717 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-24 09:25:49.809247 (MainThread): Tracking: tracking
2021-01-24 09:25:49.818197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4a092ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b49ba4eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b49ba4f28>]}
2021-01-24 09:25:49.876655 (MainThread): Partial parsing not enabled
2021-01-24 09:25:49.878379 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 09:25:49.884622 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 09:25:49.888189 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 09:25:49.892446 (MainThread): Parsing macros/helpers.sql
2021-01-24 09:25:49.917375 (MainThread): Parsing macros/catalog.sql
2021-01-24 09:25:49.922287 (MainThread): Parsing macros/adapters.sql
2021-01-24 09:25:49.968067 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 09:25:49.970619 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-24 09:25:49.976532 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-24 09:25:49.977031 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-24 09:25:49.982737 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-24 09:25:50.000891 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 09:25:50.018330 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 09:25:50.027098 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-24 09:25:50.042095 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 09:25:50.053109 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 09:25:50.081076 (MainThread): Parsing macros/core.sql
2021-01-24 09:25:50.088657 (MainThread): Parsing macros/adapters/common.sql
2021-01-24 09:25:50.169227 (MainThread): Parsing macros/etc/datetime.sql
2021-01-24 09:25:50.186519 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-24 09:25:50.190255 (MainThread): Parsing macros/etc/query.sql
2021-01-24 09:25:50.192722 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-24 09:25:50.194978 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-24 09:25:50.199285 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-24 09:25:50.202951 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-24 09:25:50.220665 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-24 09:25:50.224689 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 09:25:50.237121 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-24 09:25:50.288700 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-24 09:25:50.322214 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-24 09:25:50.326005 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-24 09:25:50.336028 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 09:25:50.348226 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-24 09:25:50.374245 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 09:25:50.387405 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 09:25:50.427462 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-24 09:25:50.431646 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-24 09:25:50.435097 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-24 09:25:50.438922 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-24 09:25:50.453845 (MainThread): Partial parsing not enabled
2021-01-24 09:25:50.568596 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values_aggregate_reflection".
2021-01-24 09:25:50.611231 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:51.019418 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-24 09:25:51.020740 (MainThread): 
2021-01-24 09:25:51.021475 (MainThread): Acquiring new dremio connection "master".
2021-01-24 09:25:51.025051 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-24 09:25:51.051731 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-24 09:25:51.052021 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-24 09:25:51.052203 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-24 09:25:51.052381 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:25:51.225275 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-24 09:25:51.568449 (ThreadPoolExecutor-0_0): SQL status: OK in 0.52 seconds
2021-01-24 09:25:51.593057 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-24 09:25:51.605913 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-24 09:25:51.624466 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-24 09:25:51.632044 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-24 09:25:51.632405 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-24 09:25:51.632700 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:25:51.826928 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-24 09:25:52.443892 (ThreadPoolExecutor-1_0): SQL status: OK in 0.81 seconds
2021-01-24 09:25:52.501679 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-24 09:25:52.502065 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-24 09:25:52.510512 (MainThread): 10:25:52 | Concurrency: 2 threads (target='managed')
2021-01-24 09:25:52.510885 (MainThread): 10:25:52 | 
2021-01-24 09:25:52.534512 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-24 09:25:52.537602 (Thread-1): 10:25:52 | 1 of 1 START table model subsurface.stg__land_values................. [RUN]
2021-01-24 09:25:52.538477 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:52.538875 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-24 09:25:52.631711 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-24 09:25:52.633818 (Thread-1): finished collecting timing info
2021-01-24 09:25:52.745667 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-24 09:25:52.754005 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:52.755345 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-24 09:25:52.756492 (Thread-1): Opening a new connection, currently in state closed
2021-01-24 09:25:52.757723 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:25:52.899981 (Thread-1): Connected to db: None
2021-01-24 09:25:53.452411 (Thread-1): SQL status: OK in 0.70 seconds
2021-01-24 09:25:53.488312 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-24 09:25:53.489092 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-24 09:25:53.506467 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:53.506816 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-24 09:25:54.142004 (Thread-1): SQL status: OK in 0.63 seconds
2021-01-24 09:25:54.193784 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-24 09:25:54.232438 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:54.232792 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
2021-01-24 09:25:54.266165 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-24 09:25:54.301425 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-24 09:25:54.302397 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:54.302897 (Thread-1): On model.subsurface.stg__land_values: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '85'
  )

  
2021-01-24 09:25:55.295532 (Thread-1): SQL status: OK in 0.99 seconds
2021-01-24 09:25:55.307892 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:55.311064 (Thread-1): On model.subsurface.stg__land_values: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
  )

  
2021-01-24 09:25:55.390638 (Thread-1): SQL status: OK in 0.08 seconds
2021-01-24 09:25:55.397080 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:25:55.398588 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_green"
2021-01-24 09:25:55.418498 (Thread-1): SQL status: OK in 0.02 seconds
2021-01-24 09:25:55.442506 (Thread-1): finished collecting timing info
2021-01-24 09:25:55.444093 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-24 09:25:55.445272 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-24 09:25:55.449243 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9abb2a50-8d5f-47fd-92a8-c4a678d7f70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b498a95f8>]}
2021-01-24 09:25:55.453030 (Thread-1): 10:25:55 | 1 of 1 OK created table model subsurface.stg__land_values............ [OK in 2.91s]
2021-01-24 09:25:55.454407 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-24 09:25:55.462155 (MainThread): Acquiring new dremio connection "master".
2021-01-24 09:25:55.462564 (MainThread): On master: ROLLBACK
2021-01-24 09:25:55.462842 (MainThread): Opening a new connection, currently in state init
2021-01-24 09:25:55.463065 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:25:55.615760 (MainThread): Connected to db: None
2021-01-24 09:25:55.616188 (MainThread): On master: ROLLBACK
2021-01-24 09:25:55.616459 (MainThread): On master: Close
2021-01-24 09:25:55.620055 (MainThread): 10:25:55 | 
2021-01-24 09:25:55.621920 (MainThread): 10:25:55 | Finished running 1 table model in 4.60s.
2021-01-24 09:25:55.624111 (MainThread): Connection 'master' was properly closed.
2021-01-24 09:25:55.624447 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-24 09:25:55.624669 (MainThread): Connection 'list_subsurface_no_schema' was properly closed.
2021-01-24 09:25:55.646740 (MainThread): 
2021-01-24 09:25:55.649586 (MainThread): Completed successfully
2021-01-24 09:25:55.649990 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-24 09:25:55.650475 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b498a95f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b499d0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b499d0438>]}
2021-01-24 09:25:55.650990 (MainThread): Flushing usage events
2021-01-24 09:26:16.186539 (MainThread): Running with dbt=0.18.1
2021-01-24 09:26:16.347314 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-24 09:26:16.350317 (MainThread): Tracking: tracking
2021-01-24 09:26:16.366794 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adad5d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad98ce7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad8635e80>]}
2021-01-24 09:26:16.430462 (MainThread): Partial parsing not enabled
2021-01-24 09:26:16.432732 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 09:26:16.439560 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 09:26:16.443116 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 09:26:16.447316 (MainThread): Parsing macros/helpers.sql
2021-01-24 09:26:16.473813 (MainThread): Parsing macros/catalog.sql
2021-01-24 09:26:16.478468 (MainThread): Parsing macros/adapters.sql
2021-01-24 09:26:16.525925 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 09:26:16.528485 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-24 09:26:16.534299 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-24 09:26:16.534807 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-24 09:26:16.540552 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-24 09:26:16.559245 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 09:26:16.577189 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 09:26:16.585959 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-24 09:26:16.600639 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 09:26:16.611709 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 09:26:16.639859 (MainThread): Parsing macros/core.sql
2021-01-24 09:26:16.647306 (MainThread): Parsing macros/adapters/common.sql
2021-01-24 09:26:16.728003 (MainThread): Parsing macros/etc/datetime.sql
2021-01-24 09:26:16.745141 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-24 09:26:16.748752 (MainThread): Parsing macros/etc/query.sql
2021-01-24 09:26:16.751206 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-24 09:26:16.753447 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-24 09:26:16.757656 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-24 09:26:16.761370 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-24 09:26:16.780397 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-24 09:26:16.784455 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 09:26:16.796784 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-24 09:26:16.849980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-24 09:26:16.884488 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-24 09:26:16.888927 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-24 09:26:16.899303 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 09:26:16.912454 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-24 09:26:16.941239 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 09:26:16.954861 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 09:26:16.996048 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-24 09:26:17.000372 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-24 09:26:17.004024 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-24 09:26:17.008137 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-24 09:26:17.023554 (MainThread): Partial parsing not enabled
2021-01-24 09:26:17.138626 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values_aggregate_reflection".
2021-01-24 09:26:17.181273 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:26:17.654488 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-24 09:26:17.655829 (MainThread): 
2021-01-24 09:26:17.656620 (MainThread): Acquiring new dremio connection "master".
2021-01-24 09:26:17.660105 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-24 09:26:17.686704 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-24 09:26:17.687233 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-24 09:26:17.687573 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-24 09:26:17.687827 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:26:17.942087 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-24 09:26:18.308342 (ThreadPoolExecutor-0_0): SQL status: OK in 0.62 seconds
2021-01-24 09:26:18.339476 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-24 09:26:18.377967 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-24 09:26:18.455565 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-24 09:26:18.457061 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-24 09:26:18.463911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-24 09:26:18.464275 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:26:18.710027 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-24 09:26:19.152678 (ThreadPoolExecutor-1_0): SQL status: OK in 0.69 seconds
2021-01-24 09:26:19.176996 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-24 09:26:19.177455 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-24 09:26:19.180331 (MainThread): 10:26:19 | Concurrency: 2 threads (target='managed')
2021-01-24 09:26:19.182695 (MainThread): 10:26:19 | 
2021-01-24 09:26:19.191357 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-24 09:26:19.197035 (Thread-1): 10:26:19 | 1 of 1 START table model subsurface.stg__land_values................. [RUN]
2021-01-24 09:26:19.199430 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:26:19.201416 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-24 09:26:19.333317 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-24 09:26:19.350286 (Thread-1): finished collecting timing info
2021-01-24 09:26:19.509356 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-24 09:26:19.518194 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:26:19.518534 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-24 09:26:19.518792 (Thread-1): Opening a new connection, currently in state init
2021-01-24 09:26:19.519014 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:26:19.685866 (Thread-1): Connected to db: None
2021-01-24 09:26:20.092690 (Thread-1): SQL status: OK in 0.57 seconds
2021-01-24 09:26:20.116116 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-24 09:26:20.117851 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-24 09:26:20.125252 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:26:20.130140 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-24 09:26:20.895058 (Thread-1): SQL status: OK in 0.76 seconds
2021-01-24 09:26:20.922807 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-24 09:26:20.957581 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:26:20.957960 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_green"
2021-01-24 09:26:20.990659 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-24 09:26:21.034198 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-24 09:26:21.035227 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:26:21.035650 (Thread-1): On model.subsurface.stg__land_values: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '85'
  )

  
2021-01-24 09:26:21.956079 (Thread-1): SQL status: OK in 0.92 seconds
2021-01-24 09:26:21.975410 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:26:21.981738 (Thread-1): On model.subsurface.stg__land_values: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  )

  
2021-01-24 09:26:22.154040 (Thread-1): SQL status: OK in 0.17 seconds
2021-01-24 09:26:22.160071 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-24 09:26:22.162917 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
2021-01-24 09:26:22.203341 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-24 09:26:22.231740 (Thread-1): finished collecting timing info
2021-01-24 09:26:22.233273 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-24 09:26:22.234441 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-24 09:26:22.237129 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc8861bd-783b-4b33-a461-839b82007d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad8400b00>]}
2021-01-24 09:26:22.242481 (Thread-1): 10:26:22 | 1 of 1 OK created table model subsurface.stg__land_values............ [OK in 3.04s]
2021-01-24 09:26:22.244356 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-24 09:26:22.337320 (MainThread): Acquiring new dremio connection "master".
2021-01-24 09:26:22.337733 (MainThread): On master: ROLLBACK
2021-01-24 09:26:22.337855 (MainThread): Opening a new connection, currently in state init
2021-01-24 09:26:22.337967 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 09:26:22.515130 (MainThread): Connected to db: None
2021-01-24 09:26:22.516711 (MainThread): On master: ROLLBACK
2021-01-24 09:26:22.517017 (MainThread): On master: Close
2021-01-24 09:26:22.520200 (MainThread): 10:26:22 | 
2021-01-24 09:26:22.521981 (MainThread): 10:26:22 | Finished running 1 table model in 4.86s.
2021-01-24 09:26:22.523054 (MainThread): Connection 'master' was properly closed.
2021-01-24 09:26:22.523337 (MainThread): Connection 'list_subsurface_no_schema' was properly closed.
2021-01-24 09:26:22.523518 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-24 09:26:22.543512 (MainThread): 
2021-01-24 09:26:22.548078 (MainThread): Completed successfully
2021-01-24 09:26:22.548407 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-24 09:26:22.550755 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad98ce7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad84a6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad828b358>]}
2021-01-24 09:26:22.551279 (MainThread): Flushing usage events
2021-01-24 10:02:43.822898 (MainThread): Running with dbt=0.18.1
2021-01-24 10:02:43.949078 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values_aggregate_reflection'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-24 10:02:43.950606 (MainThread): Tracking: tracking
2021-01-24 10:02:43.959888 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b5a16780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b477de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b477def0>]}
2021-01-24 10:02:44.032891 (MainThread): Partial parsing not enabled
2021-01-24 10:02:44.034194 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 10:02:44.039086 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 10:02:44.043025 (MainThread): Parsing macros/get_custom_database.sql
2021-01-24 10:02:44.047070 (MainThread): Parsing macros/helpers.sql
2021-01-24 10:02:44.073357 (MainThread): Parsing macros/catalog.sql
2021-01-24 10:02:44.078332 (MainThread): Parsing macros/adapters.sql
2021-01-24 10:02:44.125428 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-24 10:02:44.127808 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-24 10:02:44.133545 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-24 10:02:44.134032 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-24 10:02:44.139472 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-24 10:02:44.159399 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 10:02:44.179041 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 10:02:44.187513 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-24 10:02:44.202630 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 10:02:44.213976 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 10:02:44.243303 (MainThread): Parsing macros/core.sql
2021-01-24 10:02:44.250612 (MainThread): Parsing macros/adapters/common.sql
2021-01-24 10:02:44.332264 (MainThread): Parsing macros/etc/datetime.sql
2021-01-24 10:02:44.349927 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-24 10:02:44.353388 (MainThread): Parsing macros/etc/query.sql
2021-01-24 10:02:44.355744 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-24 10:02:44.358475 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-24 10:02:44.362865 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-24 10:02:44.366282 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-24 10:02:44.384416 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-24 10:02:44.388256 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-24 10:02:44.400503 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-24 10:02:44.453405 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-24 10:02:44.486990 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-24 10:02:44.490734 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-24 10:02:44.500994 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-24 10:02:44.513606 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-24 10:02:44.542013 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-24 10:02:44.555096 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-24 10:02:44.596796 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-24 10:02:44.601035 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-24 10:02:44.604270 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-24 10:02:44.608759 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-24 10:02:44.623891 (MainThread): Partial parsing not enabled
2021-01-24 10:02:44.742174 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values_aggregate_reflection".
2021-01-24 10:02:44.785388 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-24 10:02:45.179796 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-24 10:02:45.181042 (MainThread): 
2021-01-24 10:02:45.181797 (MainThread): Acquiring new dremio connection "master".
2021-01-24 10:02:45.186198 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-24 10:02:45.216491 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-24 10:02:45.216761 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-24 10:02:45.216945 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-24 10:02:45.217103 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 10:02:45.534728 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-24 10:02:45.922670 (ThreadPoolExecutor-0_0): SQL status: OK in 0.71 seconds
2021-01-24 10:02:45.962301 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-24 10:02:45.977004 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-24 10:02:46.019207 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-24 10:02:46.019506 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-24 10:02:46.019658 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-24 10:02:46.019776 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 10:02:46.193093 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-24 10:02:46.549333 (ThreadPoolExecutor-1_0): SQL status: OK in 0.53 seconds
2021-01-24 10:02:46.579082 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-24 10:02:46.579643 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-24 10:02:46.582331 (MainThread): 11:02:46 | Concurrency: 2 threads (target='managed')
2021-01-24 10:02:46.585837 (MainThread): 11:02:46 | 
2021-01-24 10:02:46.589480 (Thread-1): Began running node model.subsurface.stg__land_values_aggregate_reflection
2021-01-24 10:02:46.593031 (Thread-1): 11:02:46 | 1 of 1 START raw_reflection model subsurface.stg__land_values_aggregate_reflection [RUN]
2021-01-24 10:02:46.598195 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values_aggregate_reflection".
2021-01-24 10:02:46.598592 (Thread-1): Compiling model.subsurface.stg__land_values_aggregate_reflection
2021-01-24 10:02:46.666165 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values_aggregate_reflection"
2021-01-24 10:02:46.666924 (Thread-1): finished collecting timing info
2021-01-24 10:02:46.705194 (Thread-1): finished collecting timing info
2021-01-24 10:02:46.711239 (Thread-1): Unhandled error while executing model.subsurface.stg__land_values_aggregate_reflection
Additional properties are not allowed ('database', 'schema' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'definitions': {'DremioIncludePolicy': {'additionalProperties': False,
                                             'description': 'DremioIncludePolicy(*args, '
                                                            '**kwds)',
                                             'properties': {'database': {'default': True,
                                                                         'type': 'boolean'},
                                                            'identifier': {'default': True,
                                                                           'type': 'boolean'},
                                                            'schema': {'default': True,
                                                                       'type': 'boolean'}},
                                             'required': [],
                                             'type': 'object'},
                     'DremioQuotePolicy': {'additionalProperties': False,
                                           'description': 'DremioQuotePolicy(*args, '
                                                          '**kwds)',
                                           'properties': {'database': {'default': True,
                                                                       'type': 'boolean'},
                                                          'identifier': {'default': True,
                                                                         'type': 'boolean'},
                                                          'schema': {'default': True,
                                                                     'type': 'boolean'}},
                                           'required': [],
                                           'type': 'object'},
                     'Path': {'additionalProperties': False,
                              'description': 'Path(*args, **kwds)',
                              'properties': {'database': {'oneOf': [{'type': 'string'},
                                                                    {'type': 'null'}]},
                                             'identifier': {'oneOf': [{'type': 'string'},
                                                                      {'type': 'null'}]},
                                             'schema': {'oneOf': [{'type': 'string'},
                                                                  {'type': 'null'}]}},
                              'required': [],
                              'type': 'object'}},
     'description': 'DremioRelation(type: '
                    'Union[dbt.contracts.relation.RelationType, NoneType], '
                    'path: dbt.contracts.relation.Path, quote_character: '
                    'str = \'"\', include_policy: '
                    'dbt.adapters.dremio.relation.DremioIncludePolicy = '
                    'DremioIncludePolicy(database=True, schema=True, '
                    'identifier=True), quote_policy: '
                    'dbt.adapters.dremio.relation.DremioQuotePolicy = '
                    'DremioQuotePolicy(database=True, schema=True, '
                    'identifier=True), dbt_created: bool = False)',
     'properties': {'dbt_created': {'default': False, 'type': 'boolean'},
                    'include_policy': {'$ref': '#/definitions/DremioIncludePolicy',
                                       'default': {'database': True,
                                                   'identifier': True,
                                                   'schema': True}},
                    'path': {'$ref': '#/definitions/Path'},
                    'quote_character': {'default': '"', 'type': 'string'},
                    'quote_policy': {'$ref': '#/definitions/DremioQuotePolicy',
                                     'default': {'database': True,
                                                 'identifier': True,
                                                 'schema': True}},
                    'type': {'oneOf': [{'enum': ['table',
                                                 'view',
                                                 'cte',
                                                 'materializedview',
                                                 'external'],
                                        'type': 'string'},
                                       {'type': 'null'}]}},
     'required': ['path'],
     'type': 'object'}

On instance:
    {'database': 'subsurface',
     'dbt_created': False,
     'include_policy': {'database': True,
                        'identifier': True,
                        'schema': True},
     'path': {'database': 'subsurface',
              'identifier': 'stg__land_values_aggregate_reflection',
              'schema': 'no_schema'},
     'quote_character': '"',
     'quote_policy': {'database': True, 'identifier': True, 'schema': True},
     'schema': 'no_schema',
     'type': 'materializedview'}
2021-01-24 10:02:46.712207 (Thread-1): 
jsonschema.exceptions.ValidationError: Additional properties are not allowed ('database', 'schema' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'definitions': {'DremioIncludePolicy': {'additionalProperties': False,
                                             'description': 'DremioIncludePolicy(*args, '
                                                            '**kwds)',
                                             'properties': {'database': {'default': True,
                                                                         'type': 'boolean'},
                                                            'identifier': {'default': True,
                                                                           'type': 'boolean'},
                                                            'schema': {'default': True,
                                                                       'type': 'boolean'}},
                                             'required': [],
                                             'type': 'object'},
                     'DremioQuotePolicy': {'additionalProperties': False,
                                           'description': 'DremioQuotePolicy(*args, '
                                                          '**kwds)',
                                           'properties': {'database': {'default': True,
                                                                       'type': 'boolean'},
                                                          'identifier': {'default': True,
                                                                         'type': 'boolean'},
                                                          'schema': {'default': True,
                                                                     'type': 'boolean'}},
                                           'required': [],
                                           'type': 'object'},
                     'Path': {'additionalProperties': False,
                              'description': 'Path(*args, **kwds)',
                              'properties': {'database': {'oneOf': [{'type': 'string'},
                                                                    {'type': 'null'}]},
                                             'identifier': {'oneOf': [{'type': 'string'},
                                                                      {'type': 'null'}]},
                                             'schema': {'oneOf': [{'type': 'string'},
                                                                  {'type': 'null'}]}},
                              'required': [],
                              'type': 'object'}},
     'description': 'DremioRelation(type: '
                    'Union[dbt.contracts.relation.RelationType, NoneType], '
                    'path: dbt.contracts.relation.Path, quote_character: '
                    'str = \'"\', include_policy: '
                    'dbt.adapters.dremio.relation.DremioIncludePolicy = '
                    'DremioIncludePolicy(database=True, schema=True, '
                    'identifier=True), quote_policy: '
                    'dbt.adapters.dremio.relation.DremioQuotePolicy = '
                    'DremioQuotePolicy(database=True, schema=True, '
                    'identifier=True), dbt_created: bool = False)',
     'properties': {'dbt_created': {'default': False, 'type': 'boolean'},
                    'include_policy': {'$ref': '#/definitions/DremioIncludePolicy',
                                       'default': {'database': True,
                                                   'identifier': True,
                                                   'schema': True}},
                    'path': {'$ref': '#/definitions/Path'},
                    'quote_character': {'default': '"', 'type': 'string'},
                    'quote_policy': {'$ref': '#/definitions/DremioQuotePolicy',
                                     'default': {'database': True,
                                                 'identifier': True,
                                                 'schema': True}},
                    'type': {'oneOf': [{'enum': ['table',
                                                 'view',
                                                 'cte',
                                                 'materializedview',
                                                 'external'],
                                        'type': 'string'},
                                       {'type': 'null'}]}},
     'required': ['path'],
     'type': 'object'}

On instance:
    {'database': 'subsurface',
     'dbt_created': False,
     'include_policy': {'database': True,
                        'identifier': True,
                        'schema': True},
     'path': {'database': 'subsurface',
              'identifier': 'stg__land_values_aggregate_reflection',
              'schema': 'no_schema'},
     'quote_character': '"',
     'quote_policy': {'database': True, 'identifier': True, 'schema': True},
     'schema': 'no_schema',
     'type': 'materializedview'}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 59, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/contracts/relation.py", line 58, in incorporate
    return self.from_dict(value)
  File "/home/fabrice/.local/lib/python3.7/site-packages/hologram/__init__.py", line 618, in from_dict
    cls.validate(data)
  File "/home/fabrice/.local/lib/python3.7/site-packages/hologram/__init__.py", line 961, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: Additional properties are not allowed ('database', 'schema' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'definitions': {'DremioIncludePolicy': {'additionalProperties': False,
                                             'description': 'DremioIncludePolicy(*args, '
                                                            '**kwds)',
                                             'properties': {'database': {'default': True,
                                                                         'type': 'boolean'},
                                                            'identifier': {'default': True,
                                                                           'type': 'boolean'},
                                                            'schema': {'default': True,
                                                                       'type': 'boolean'}},
                                             'required': [],
                                             'type': 'object'},
                     'DremioQuotePolicy': {'additionalProperties': False,
                                           'description': 'DremioQuotePolicy(*args, '
                                                          '**kwds)',
                                           'properties': {'database': {'default': True,
                                                                       'type': 'boolean'},
                                                          'identifier': {'default': True,
                                                                         'type': 'boolean'},
                                                          'schema': {'default': True,
                                                                     'type': 'boolean'}},
                                           'required': [],
                                           'type': 'object'},
                     'Path': {'additionalProperties': False,
                              'description': 'Path(*args, **kwds)',
                              'properties': {'database': {'oneOf': [{'type': 'string'},
                                                                    {'type': 'null'}]},
                                             'identifier': {'oneOf': [{'type': 'string'},
                                                                      {'type': 'null'}]},
                                             'schema': {'oneOf': [{'type': 'string'},
                                                                  {'type': 'null'}]}},
                              'required': [],
                              'type': 'object'}},
     'description': 'DremioRelation(type: '
                    'Union[dbt.contracts.relation.RelationType, NoneType], '
                    'path: dbt.contracts.relation.Path, quote_character: '
                    'str = \'"\', include_policy: '
                    'dbt.adapters.dremio.relation.DremioIncludePolicy = '
                    'DremioIncludePolicy(database=True, schema=True, '
                    'identifier=True), quote_policy: '
                    'dbt.adapters.dremio.relation.DremioQuotePolicy = '
                    'DremioQuotePolicy(database=True, schema=True, '
                    'identifier=True), dbt_created: bool = False)',
     'properties': {'dbt_created': {'default': False, 'type': 'boolean'},
                    'include_policy': {'$ref': '#/definitions/DremioIncludePolicy',
                                       'default': {'database': True,
                                                   'identifier': True,
                                                   'schema': True}},
                    'path': {'$ref': '#/definitions/Path'},
                    'quote_character': {'default': '"', 'type': 'string'},
                    'quote_policy': {'$ref': '#/definitions/DremioQuotePolicy',
                                     'default': {'database': True,
                                                 'identifier': True,
                                                 'schema': True}},
                    'type': {'oneOf': [{'enum': ['table',
                                                 'view',
                                                 'cte',
                                                 'materializedview',
                                                 'external'],
                                        'type': 'string'},
                                       {'type': 'null'}]}},
     'required': ['path'],
     'type': 'object'}

On instance:
    {'database': 'subsurface',
     'dbt_created': False,
     'include_policy': {'database': True,
                        'identifier': True,
                        'schema': True},
     'path': {'database': 'subsurface',
              'identifier': 'stg__land_values_aggregate_reflection',
              'schema': 'no_schema'},
     'quote_character': '"',
     'quote_policy': {'database': True, 'identifier': True, 'schema': True},
     'schema': 'no_schema',
     'type': 'materializedview'}
2021-01-24 10:02:46.965085 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e16b9f8-df79-4727-9d06-211ae3ec0a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b43e2828>]}
2021-01-24 10:02:46.968222 (Thread-1): 11:02:46 | 1 of 1 ERROR creating raw_reflection model subsurface.stg__land_values_aggregate_reflection [ERROR in 0.37s]
2021-01-24 10:02:46.968697 (Thread-1): Finished running node model.subsurface.stg__land_values_aggregate_reflection
2021-01-24 10:02:46.994522 (MainThread): Acquiring new dremio connection "master".
2021-01-24 10:02:46.994871 (MainThread): On master: ROLLBACK
2021-01-24 10:02:46.995076 (MainThread): Opening a new connection, currently in state init
2021-01-24 10:02:46.995250 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-24 10:02:47.164982 (MainThread): Connected to db: None
2021-01-24 10:02:47.165413 (MainThread): On master: ROLLBACK
2021-01-24 10:02:47.165723 (MainThread): On master: Close
2021-01-24 10:02:47.167259 (MainThread): 11:02:47 | 
2021-01-24 10:02:47.169775 (MainThread): 11:02:47 | Finished running 1 raw_reflection model in 1.99s.
2021-01-24 10:02:47.170203 (MainThread): Connection 'master' was properly closed.
2021-01-24 10:02:47.170517 (MainThread): Connection 'model.subsurface.stg__land_values_aggregate_reflection' was properly closed.
2021-01-24 10:02:47.170768 (MainThread): Connection 'list_subsurface_no_schema' was properly closed.
2021-01-24 10:02:47.179538 (MainThread): 
2021-01-24 10:02:47.180012 (MainThread): Completed with 1 error and 0 warnings:
2021-01-24 10:02:47.180401 (MainThread): 
2021-01-24 10:02:47.180827 (MainThread): Additional properties are not allowed ('database', 'schema' were unexpected)
2021-01-24 10:02:47.181109 (MainThread): 
2021-01-24 10:02:47.181299 (MainThread): Failed validating 'additionalProperties' in schema:
2021-01-24 10:02:47.181444 (MainThread):     {'$schema': 'http://json-schema.org/draft-07/schema#',
2021-01-24 10:02:47.181633 (MainThread):      'additionalProperties': False,
2021-01-24 10:02:47.181834 (MainThread):      'definitions': {'DremioIncludePolicy': {'additionalProperties': False,
2021-01-24 10:02:47.181989 (MainThread):                                              'description': 'DremioIncludePolicy(*args, '
2021-01-24 10:02:47.182131 (MainThread):                                                             '**kwds)',
2021-01-24 10:02:47.182297 (MainThread):                                              'properties': {'database': {'default': True,
2021-01-24 10:02:47.182445 (MainThread):                                                                          'type': 'boolean'},
2021-01-24 10:02:47.182580 (MainThread):                                                             'identifier': {'default': True,
2021-01-24 10:02:47.182729 (MainThread):                                                                            'type': 'boolean'},
2021-01-24 10:02:47.182872 (MainThread):                                                             'schema': {'default': True,
2021-01-24 10:02:47.183023 (MainThread):                                                                        'type': 'boolean'}},
2021-01-24 10:02:47.183178 (MainThread):                                              'required': [],
2021-01-24 10:02:47.183351 (MainThread):                                              'type': 'object'},
2021-01-24 10:02:47.183544 (MainThread):                      'DremioQuotePolicy': {'additionalProperties': False,
2021-01-24 10:02:47.183733 (MainThread):                                            'description': 'DremioQuotePolicy(*args, '
2021-01-24 10:02:47.183940 (MainThread):                                                           '**kwds)',
2021-01-24 10:02:47.184114 (MainThread):                                            'properties': {'database': {'default': True,
2021-01-24 10:02:47.184303 (MainThread):                                                                        'type': 'boolean'},
2021-01-24 10:02:47.184633 (MainThread):                                                           'identifier': {'default': True,
2021-01-24 10:02:47.184867 (MainThread):                                                                          'type': 'boolean'},
2021-01-24 10:02:47.185077 (MainThread):                                                           'schema': {'default': True,
2021-01-24 10:02:47.185280 (MainThread):                                                                      'type': 'boolean'}},
2021-01-24 10:02:47.185494 (MainThread):                                            'required': [],
2021-01-24 10:02:47.185968 (MainThread):                                            'type': 'object'},
2021-01-24 10:02:47.186271 (MainThread):                      'Path': {'additionalProperties': False,
2021-01-24 10:02:47.186519 (MainThread):                               'description': 'Path(*args, **kwds)',
2021-01-24 10:02:47.186740 (MainThread):                               'properties': {'database': {'oneOf': [{'type': 'string'},
2021-01-24 10:02:47.186962 (MainThread):                                                                     {'type': 'null'}]},
2021-01-24 10:02:47.187181 (MainThread):                                              'identifier': {'oneOf': [{'type': 'string'},
2021-01-24 10:02:47.187439 (MainThread):                                                                       {'type': 'null'}]},
2021-01-24 10:02:47.187692 (MainThread):                                              'schema': {'oneOf': [{'type': 'string'},
2021-01-24 10:02:47.187959 (MainThread):                                                                   {'type': 'null'}]}},
2021-01-24 10:02:47.188262 (MainThread):                               'required': [],
2021-01-24 10:02:47.191516 (MainThread):                               'type': 'object'}},
2021-01-24 10:02:47.191796 (MainThread):      'description': 'DremioRelation(type: '
2021-01-24 10:02:47.192013 (MainThread):                     'Union[dbt.contracts.relation.RelationType, NoneType], '
2021-01-24 10:02:47.192619 (MainThread):                     'path: dbt.contracts.relation.Path, quote_character: '
2021-01-24 10:02:47.193238 (MainThread):                     'str = \'"\', include_policy: '
2021-01-24 10:02:47.193843 (MainThread):                     'dbt.adapters.dremio.relation.DremioIncludePolicy = '
2021-01-24 10:02:47.194286 (MainThread):                     'DremioIncludePolicy(database=True, schema=True, '
2021-01-24 10:02:47.194794 (MainThread):                     'identifier=True), quote_policy: '
2021-01-24 10:02:47.196508 (MainThread):                     'dbt.adapters.dremio.relation.DremioQuotePolicy = '
2021-01-24 10:02:47.196838 (MainThread):                     'DremioQuotePolicy(database=True, schema=True, '
2021-01-24 10:02:47.197041 (MainThread):                     'identifier=True), dbt_created: bool = False)',
2021-01-24 10:02:47.197216 (MainThread):      'properties': {'dbt_created': {'default': False, 'type': 'boolean'},
2021-01-24 10:02:47.197391 (MainThread):                     'include_policy': {'$ref': '#/definitions/DremioIncludePolicy',
2021-01-24 10:02:47.197656 (MainThread):                                        'default': {'database': True,
2021-01-24 10:02:47.197927 (MainThread):                                                    'identifier': True,
2021-01-24 10:02:47.198168 (MainThread):                                                    'schema': True}},
2021-01-24 10:02:47.198448 (MainThread):                     'path': {'$ref': '#/definitions/Path'},
2021-01-24 10:02:47.198779 (MainThread):                     'quote_character': {'default': '"', 'type': 'string'},
2021-01-24 10:02:47.199047 (MainThread):                     'quote_policy': {'$ref': '#/definitions/DremioQuotePolicy',
2021-01-24 10:02:47.199284 (MainThread):                                      'default': {'database': True,
2021-01-24 10:02:47.199525 (MainThread):                                                  'identifier': True,
2021-01-24 10:02:47.199794 (MainThread):                                                  'schema': True}},
2021-01-24 10:02:47.200019 (MainThread):                     'type': {'oneOf': [{'enum': ['table',
2021-01-24 10:02:47.200215 (MainThread):                                                  'view',
2021-01-24 10:02:47.200436 (MainThread):                                                  'cte',
2021-01-24 10:02:47.200688 (MainThread):                                                  'materializedview',
2021-01-24 10:02:47.200955 (MainThread):                                                  'external'],
2021-01-24 10:02:47.201189 (MainThread):                                         'type': 'string'},
2021-01-24 10:02:47.201421 (MainThread):                                        {'type': 'null'}]}},
2021-01-24 10:02:47.201719 (MainThread):      'required': ['path'],
2021-01-24 10:02:47.201980 (MainThread):      'type': 'object'}
2021-01-24 10:02:47.202218 (MainThread): 
2021-01-24 10:02:47.202468 (MainThread): On instance:
2021-01-24 10:02:47.202709 (MainThread):     {'database': 'subsurface',
2021-01-24 10:02:47.202960 (MainThread):      'dbt_created': False,
2021-01-24 10:02:47.203192 (MainThread):      'include_policy': {'database': True,
2021-01-24 10:02:47.203423 (MainThread):                         'identifier': True,
2021-01-24 10:02:47.203694 (MainThread):                         'schema': True},
2021-01-24 10:02:47.203945 (MainThread):      'path': {'database': 'subsurface',
2021-01-24 10:02:47.204185 (MainThread):               'identifier': 'stg__land_values_aggregate_reflection',
2021-01-24 10:02:47.204434 (MainThread):               'schema': 'no_schema'},
2021-01-24 10:02:47.204727 (MainThread):      'quote_character': '"',
2021-01-24 10:02:47.205063 (MainThread):      'quote_policy': {'database': True, 'identifier': True, 'schema': True},
2021-01-24 10:02:47.205326 (MainThread):      'schema': 'no_schema',
2021-01-24 10:02:47.205599 (MainThread):      'type': 'materializedview'}
2021-01-24 10:02:47.205899 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-24 10:02:47.206504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b43c89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b4491908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b44913c8>]}
2021-01-24 10:02:47.206990 (MainThread): Flushing usage events
2021-01-25 10:15:57.922442 (MainThread): Running with dbt=0.18.1
2021-01-25 10:15:58.209599 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 10:15:58.211926 (MainThread): Tracking: tracking
2021-01-25 10:15:58.234956 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe530a95940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5305b8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5305b8e80>]}
2021-01-25 10:15:58.309276 (MainThread): Partial parsing not enabled
2021-01-25 10:15:58.320989 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 10:15:58.352154 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 10:15:58.375519 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 10:15:58.385718 (MainThread): Parsing macros/helpers.sql
2021-01-25 10:15:58.414685 (MainThread): Parsing macros/catalog.sql
2021-01-25 10:15:58.420294 (MainThread): Parsing macros/adapters.sql
2021-01-25 10:15:58.472805 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 10:15:58.483768 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 10:15:58.492790 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 10:15:58.494191 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 10:15:58.503147 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 10:15:58.525156 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 10:15:58.544692 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 10:15:58.554526 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 10:15:58.571981 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 10:15:58.585116 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 10:15:58.631241 (MainThread): Parsing macros/core.sql
2021-01-25 10:15:58.644254 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 10:15:58.734338 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 10:15:58.753243 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 10:15:58.757218 (MainThread): Parsing macros/etc/query.sql
2021-01-25 10:15:58.760255 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 10:15:58.762634 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 10:15:58.767597 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 10:15:58.771740 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 10:15:58.791744 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 10:15:58.796243 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 10:15:58.812499 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 10:15:58.871229 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 10:15:58.907855 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 10:15:58.911872 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 10:15:58.923425 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 10:15:58.937014 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 10:15:58.966749 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 10:15:58.981076 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 10:15:59.023924 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 10:15:59.028585 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 10:15:59.032675 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 10:15:59.037082 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 10:15:59.053175 (MainThread): Partial parsing not enabled
2021-01-25 10:15:59.178591 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values_aggregate_reflection".
2021-01-25 10:15:59.225930 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:15:59.250093 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:15:59.821611 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 10:15:59.823131 (MainThread): 
2021-01-25 10:15:59.823911 (MainThread): Acquiring new dremio connection "master".
2021-01-25 10:15:59.832966 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-25 10:15:59.872039 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-25 10:15:59.872335 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 10:15:59.872591 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 10:15:59.872925 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:16:01.550821 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 10:16:04.598283 (ThreadPoolExecutor-0_0): SQL status: OK in 4.73 seconds
2021-01-25 10:16:04.724523 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-25 10:16:04.737413 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-25 10:16:04.756303 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-25 10:16:04.756701 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 10:16:04.757084 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 10:16:04.757526 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:16:04.973700 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 10:16:12.940941 (ThreadPoolExecutor-1_0): SQL status: OK in 8.18 seconds
2021-01-25 10:16:13.012898 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-25 10:16:13.013259 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-25 10:16:13.020940 (MainThread): 11:16:13 | Concurrency: 2 threads (target='managed')
2021-01-25 10:16:13.021303 (MainThread): 11:16:13 | 
2021-01-25 10:16:13.061247 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 10:16:13.061590 (Thread-2): Began running node model.subsurface.stg__land_values0
2021-01-25 10:16:13.074104 (Thread-2): 11:16:13 | 2 of 3 START table model subsurface.stg__land_values0................ [RUN]
2021-01-25 10:16:13.075557 (Thread-2): Acquiring new dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:16:13.077244 (Thread-2): Compiling model.subsurface.stg__land_values0
2021-01-25 10:16:13.091119 (Thread-1): 11:16:13 | 1 of 3 START table model subsurface.stg__land_values................. [RUN]
2021-01-25 10:16:13.093157 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:16:13.096683 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 10:16:13.182384 (Thread-2): Writing injected SQL for node "model.subsurface.stg__land_values0"
2021-01-25 10:16:13.184706 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 10:16:13.185405 (Thread-2): finished collecting timing info
2021-01-25 10:16:13.196677 (Thread-1): finished collecting timing info
2021-01-25 10:16:13.380206 (Thread-2): On "model.subsurface.stg__land_values0": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:16:13.380504 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:16:13.388495 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:16:13.395505 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:16:13.396248 (Thread-2): On model.subsurface.stg__land_values0: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:16:13.396606 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:16:13.397010 (Thread-2): Opening a new connection, currently in state init
2021-01-25 10:16:13.397309 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 10:16:13.397860 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:16:13.398218 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:16:13.780823 (Thread-1): Connected to db: None
2021-01-25 10:16:13.805035 (Thread-2): Connected to db: None
2021-01-25 10:16:16.084613 (Thread-2): SQL status: OK in 2.69 seconds
2021-01-25 10:16:16.129677 (Thread-1): SQL status: OK in 2.73 seconds
2021-01-25 10:16:16.159129 (Thread-2): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-25 10:16:16.160168 (Thread-2): On "model.subsurface.stg__land_values0": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:16:16.174842 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:16:16.175562 (Thread-2): On model.subsurface.stg__land_values0: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:16:16.243966 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-25 10:16:16.244794 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:16:16.269096 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:16:16.269496 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:16:18.522279 (Thread-1): SQL status: OK in 2.25 seconds
2021-01-25 10:16:18.532334 (Thread-2): SQL status: OK in 2.36 seconds
2021-01-25 10:16:18.578143 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-25 10:16:18.605896 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:16:18.611665 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
2021-01-25 10:16:18.633868 (Thread-2): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-25 10:16:18.645425 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:16:18.645977 (Thread-2): On model.subsurface.stg__land_values0: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values0_green"
2021-01-25 10:16:18.679494 (Thread-1): SQL status: OK in 0.07 seconds
2021-01-25 10:16:18.700363 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 10:16:18.703719 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:16:18.704870 (Thread-1): On model.subsurface.stg__land_values: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '85'
  )

  
2021-01-25 10:16:18.719135 (Thread-2): SQL status: OK in 0.07 seconds
2021-01-25 10:16:18.723529 (Thread-2): Writing runtime SQL for node "model.subsurface.stg__land_values0"
2021-01-25 10:16:18.724906 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:16:18.725488 (Thread-2): On model.subsurface.stg__land_values0: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values0_green"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '79'
  )

  
2021-01-25 10:16:23.363419 (Thread-2): SQL status: OK in 4.64 seconds
2021-01-25 10:16:23.382748 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:16:23.387437 (Thread-2): On model.subsurface.stg__land_values0: 
    
  create or replace view "subsurface"."stg__land_values0" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values0_green"
  )

  
2021-01-25 10:16:24.170847 (Thread-1): SQL status: OK in 5.47 seconds
2021-01-25 10:16:24.174047 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:16:24.174653 (Thread-1): On model.subsurface.stg__land_values: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
  )

  
2021-01-25 10:16:24.788642 (Thread-2): SQL status: OK in 1.40 seconds
2021-01-25 10:16:24.826534 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:16:24.852165 (Thread-2): On model.subsurface.stg__land_values0: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values0_blue"
2021-01-25 10:16:25.156436 (Thread-1): SQL status: OK in 0.98 seconds
2021-01-25 10:16:25.172677 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:16:25.173013 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_green"
2021-01-25 10:16:25.204160 (Thread-2): SQL status: OK in 0.35 seconds
2021-01-25 10:16:25.275812 (Thread-1): SQL status: OK in 0.10 seconds
2021-01-25 10:16:25.293490 (Thread-1): finished collecting timing info
2021-01-25 10:16:25.296448 (Thread-2): finished collecting timing info
2021-01-25 10:16:25.312278 (Thread-2): On model.subsurface.stg__land_values0: ROLLBACK
2021-01-25 10:16:25.312463 (Thread-2): On model.subsurface.stg__land_values0: Close
2021-01-25 10:16:25.315112 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce123242-e13d-473c-8742-33b90e74deaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe53031a198>]}
2021-01-25 10:16:25.311942 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 10:16:25.331299 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 10:16:25.333675 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce123242-e13d-473c-8742-33b90e74deaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe530249978>]}
2021-01-25 10:16:25.324655 (Thread-2): 11:16:25 | 2 of 3 OK created table model subsurface.stg__land_values0........... [OK in 12.24s]
2021-01-25 10:16:25.351427 (Thread-2): Finished running node model.subsurface.stg__land_values0
2021-01-25 10:16:25.346179 (Thread-1): 11:16:25 | 1 of 3 OK created table model subsurface.stg__land_values............ [OK in 12.24s]
2021-01-25 10:16:25.352532 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 10:16:25.353326 (Thread-2): Began running node model.subsurface.stg__land_values_aggregate_reflection
2021-01-25 10:16:25.367556 (Thread-2): 11:16:25 | 3 of 3 START raw_reflection model subsurface.stg__land_values_aggregate_reflection [RUN]
2021-01-25 10:16:25.368529 (Thread-2): Acquiring new dremio connection "model.subsurface.stg__land_values_aggregate_reflection".
2021-01-25 10:16:25.368879 (Thread-2): Compiling model.subsurface.stg__land_values_aggregate_reflection
2021-01-25 10:16:25.431191 (Thread-2): Writing injected SQL for node "model.subsurface.stg__land_values_aggregate_reflection"
2021-01-25 10:16:25.434299 (Thread-2): finished collecting timing info
2021-01-25 10:16:25.496486 (Thread-2): finished collecting timing info
2021-01-25 10:16:25.506036 (Thread-2): Unhandled error while executing model.subsurface.stg__land_values_aggregate_reflection
Additional properties are not allowed ('schema', 'database' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'definitions': {'DremioIncludePolicy': {'additionalProperties': False,
                                             'description': 'DremioIncludePolicy(*args, '
                                                            '**kwds)',
                                             'properties': {'database': {'default': True,
                                                                         'type': 'boolean'},
                                                            'identifier': {'default': True,
                                                                           'type': 'boolean'},
                                                            'schema': {'default': True,
                                                                       'type': 'boolean'}},
                                             'required': [],
                                             'type': 'object'},
                     'DremioQuotePolicy': {'additionalProperties': False,
                                           'description': 'DremioQuotePolicy(*args, '
                                                          '**kwds)',
                                           'properties': {'database': {'default': True,
                                                                       'type': 'boolean'},
                                                          'identifier': {'default': True,
                                                                         'type': 'boolean'},
                                                          'schema': {'default': True,
                                                                     'type': 'boolean'}},
                                           'required': [],
                                           'type': 'object'},
                     'Path': {'additionalProperties': False,
                              'description': 'Path(*args, **kwds)',
                              'properties': {'database': {'oneOf': [{'type': 'string'},
                                                                    {'type': 'null'}]},
                                             'identifier': {'oneOf': [{'type': 'string'},
                                                                      {'type': 'null'}]},
                                             'schema': {'oneOf': [{'type': 'string'},
                                                                  {'type': 'null'}]}},
                              'required': [],
                              'type': 'object'}},
     'description': 'DremioRelation(type: '
                    'Union[dbt.contracts.relation.RelationType, NoneType], '
                    'path: dbt.contracts.relation.Path, quote_character: '
                    'str = \'"\', include_policy: '
                    'dbt.adapters.dremio.relation.DremioIncludePolicy = '
                    'DremioIncludePolicy(database=True, schema=True, '
                    'identifier=True), quote_policy: '
                    'dbt.adapters.dremio.relation.DremioQuotePolicy = '
                    'DremioQuotePolicy(database=True, schema=True, '
                    'identifier=True), dbt_created: bool = False)',
     'properties': {'dbt_created': {'default': False, 'type': 'boolean'},
                    'include_policy': {'$ref': '#/definitions/DremioIncludePolicy',
                                       'default': {'database': True,
                                                   'identifier': True,
                                                   'schema': True}},
                    'path': {'$ref': '#/definitions/Path'},
                    'quote_character': {'default': '"', 'type': 'string'},
                    'quote_policy': {'$ref': '#/definitions/DremioQuotePolicy',
                                     'default': {'database': True,
                                                 'identifier': True,
                                                 'schema': True}},
                    'type': {'oneOf': [{'enum': ['table',
                                                 'view',
                                                 'cte',
                                                 'materializedview',
                                                 'external'],
                                        'type': 'string'},
                                       {'type': 'null'}]}},
     'required': ['path'],
     'type': 'object'}

On instance:
    {'database': 'subsurface',
     'dbt_created': False,
     'include_policy': {'database': True,
                        'identifier': True,
                        'schema': True},
     'path': {'database': 'subsurface',
              'identifier': 'stg__land_values_aggregate_reflection',
              'schema': 'no_schema'},
     'quote_character': '"',
     'quote_policy': {'database': True, 'identifier': True, 'schema': True},
     'schema': 'no_schema',
     'type': 'materializedview'}
2021-01-25 10:16:25.515428 (Thread-2): 
jsonschema.exceptions.ValidationError: Additional properties are not allowed ('schema', 'database' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'definitions': {'DremioIncludePolicy': {'additionalProperties': False,
                                             'description': 'DremioIncludePolicy(*args, '
                                                            '**kwds)',
                                             'properties': {'database': {'default': True,
                                                                         'type': 'boolean'},
                                                            'identifier': {'default': True,
                                                                           'type': 'boolean'},
                                                            'schema': {'default': True,
                                                                       'type': 'boolean'}},
                                             'required': [],
                                             'type': 'object'},
                     'DremioQuotePolicy': {'additionalProperties': False,
                                           'description': 'DremioQuotePolicy(*args, '
                                                          '**kwds)',
                                           'properties': {'database': {'default': True,
                                                                       'type': 'boolean'},
                                                          'identifier': {'default': True,
                                                                         'type': 'boolean'},
                                                          'schema': {'default': True,
                                                                     'type': 'boolean'}},
                                           'required': [],
                                           'type': 'object'},
                     'Path': {'additionalProperties': False,
                              'description': 'Path(*args, **kwds)',
                              'properties': {'database': {'oneOf': [{'type': 'string'},
                                                                    {'type': 'null'}]},
                                             'identifier': {'oneOf': [{'type': 'string'},
                                                                      {'type': 'null'}]},
                                             'schema': {'oneOf': [{'type': 'string'},
                                                                  {'type': 'null'}]}},
                              'required': [],
                              'type': 'object'}},
     'description': 'DremioRelation(type: '
                    'Union[dbt.contracts.relation.RelationType, NoneType], '
                    'path: dbt.contracts.relation.Path, quote_character: '
                    'str = \'"\', include_policy: '
                    'dbt.adapters.dremio.relation.DremioIncludePolicy = '
                    'DremioIncludePolicy(database=True, schema=True, '
                    'identifier=True), quote_policy: '
                    'dbt.adapters.dremio.relation.DremioQuotePolicy = '
                    'DremioQuotePolicy(database=True, schema=True, '
                    'identifier=True), dbt_created: bool = False)',
     'properties': {'dbt_created': {'default': False, 'type': 'boolean'},
                    'include_policy': {'$ref': '#/definitions/DremioIncludePolicy',
                                       'default': {'database': True,
                                                   'identifier': True,
                                                   'schema': True}},
                    'path': {'$ref': '#/definitions/Path'},
                    'quote_character': {'default': '"', 'type': 'string'},
                    'quote_policy': {'$ref': '#/definitions/DremioQuotePolicy',
                                     'default': {'database': True,
                                                 'identifier': True,
                                                 'schema': True}},
                    'type': {'oneOf': [{'enum': ['table',
                                                 'view',
                                                 'cte',
                                                 'materializedview',
                                                 'external'],
                                        'type': 'string'},
                                       {'type': 'null'}]}},
     'required': ['path'],
     'type': 'object'}

On instance:
    {'database': 'subsurface',
     'dbt_created': False,
     'include_policy': {'database': True,
                        'identifier': True,
                        'schema': True},
     'path': {'database': 'subsurface',
              'identifier': 'stg__land_values_aggregate_reflection',
              'schema': 'no_schema'},
     'quote_character': '"',
     'quote_policy': {'database': True, 'identifier': True, 'schema': True},
     'schema': 'no_schema',
     'type': 'materializedview'}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 59, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/contracts/relation.py", line 58, in incorporate
    return self.from_dict(value)
  File "/home/fabrice/.local/lib/python3.7/site-packages/hologram/__init__.py", line 618, in from_dict
    cls.validate(data)
  File "/home/fabrice/.local/lib/python3.7/site-packages/hologram/__init__.py", line 961, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: Additional properties are not allowed ('schema', 'database' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'definitions': {'DremioIncludePolicy': {'additionalProperties': False,
                                             'description': 'DremioIncludePolicy(*args, '
                                                            '**kwds)',
                                             'properties': {'database': {'default': True,
                                                                         'type': 'boolean'},
                                                            'identifier': {'default': True,
                                                                           'type': 'boolean'},
                                                            'schema': {'default': True,
                                                                       'type': 'boolean'}},
                                             'required': [],
                                             'type': 'object'},
                     'DremioQuotePolicy': {'additionalProperties': False,
                                           'description': 'DremioQuotePolicy(*args, '
                                                          '**kwds)',
                                           'properties': {'database': {'default': True,
                                                                       'type': 'boolean'},
                                                          'identifier': {'default': True,
                                                                         'type': 'boolean'},
                                                          'schema': {'default': True,
                                                                     'type': 'boolean'}},
                                           'required': [],
                                           'type': 'object'},
                     'Path': {'additionalProperties': False,
                              'description': 'Path(*args, **kwds)',
                              'properties': {'database': {'oneOf': [{'type': 'string'},
                                                                    {'type': 'null'}]},
                                             'identifier': {'oneOf': [{'type': 'string'},
                                                                      {'type': 'null'}]},
                                             'schema': {'oneOf': [{'type': 'string'},
                                                                  {'type': 'null'}]}},
                              'required': [],
                              'type': 'object'}},
     'description': 'DremioRelation(type: '
                    'Union[dbt.contracts.relation.RelationType, NoneType], '
                    'path: dbt.contracts.relation.Path, quote_character: '
                    'str = \'"\', include_policy: '
                    'dbt.adapters.dremio.relation.DremioIncludePolicy = '
                    'DremioIncludePolicy(database=True, schema=True, '
                    'identifier=True), quote_policy: '
                    'dbt.adapters.dremio.relation.DremioQuotePolicy = '
                    'DremioQuotePolicy(database=True, schema=True, '
                    'identifier=True), dbt_created: bool = False)',
     'properties': {'dbt_created': {'default': False, 'type': 'boolean'},
                    'include_policy': {'$ref': '#/definitions/DremioIncludePolicy',
                                       'default': {'database': True,
                                                   'identifier': True,
                                                   'schema': True}},
                    'path': {'$ref': '#/definitions/Path'},
                    'quote_character': {'default': '"', 'type': 'string'},
                    'quote_policy': {'$ref': '#/definitions/DremioQuotePolicy',
                                     'default': {'database': True,
                                                 'identifier': True,
                                                 'schema': True}},
                    'type': {'oneOf': [{'enum': ['table',
                                                 'view',
                                                 'cte',
                                                 'materializedview',
                                                 'external'],
                                        'type': 'string'},
                                       {'type': 'null'}]}},
     'required': ['path'],
     'type': 'object'}

On instance:
    {'database': 'subsurface',
     'dbt_created': False,
     'include_policy': {'database': True,
                        'identifier': True,
                        'schema': True},
     'path': {'database': 'subsurface',
              'identifier': 'stg__land_values_aggregate_reflection',
              'schema': 'no_schema'},
     'quote_character': '"',
     'quote_policy': {'database': True, 'identifier': True, 'schema': True},
     'schema': 'no_schema',
     'type': 'materializedview'}
2021-01-25 10:16:25.585642 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce123242-e13d-473c-8742-33b90e74deaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe53027cb38>]}
2021-01-25 10:16:25.600702 (Thread-2): 11:16:25 | 3 of 3 ERROR creating raw_reflection model subsurface.stg__land_values_aggregate_reflection [ERROR in 0.22s]
2021-01-25 10:16:25.606451 (Thread-2): Finished running node model.subsurface.stg__land_values_aggregate_reflection
2021-01-25 10:16:25.688872 (MainThread): Acquiring new dremio connection "master".
2021-01-25 10:16:25.691137 (MainThread): On master: ROLLBACK
2021-01-25 10:16:25.691544 (MainThread): Opening a new connection, currently in state init
2021-01-25 10:16:25.691871 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:16:25.896716 (MainThread): Connected to db: None
2021-01-25 10:16:25.897229 (MainThread): On master: ROLLBACK
2021-01-25 10:16:25.897493 (MainThread): On master: Close
2021-01-25 10:16:25.900342 (MainThread): 11:16:25 | 
2021-01-25 10:16:25.901189 (MainThread): 11:16:25 | Finished running 2 table models, 1 raw_reflection model in 26.08s.
2021-01-25 10:16:25.901542 (MainThread): Connection 'master' was properly closed.
2021-01-25 10:16:25.901768 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 10:16:25.901974 (MainThread): Connection 'model.subsurface.stg__land_values_aggregate_reflection' was properly closed.
2021-01-25 10:16:25.941599 (MainThread): 
2021-01-25 10:16:25.942286 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 10:16:25.942646 (MainThread): 
2021-01-25 10:16:25.943220 (MainThread): Additional properties are not allowed ('schema', 'database' were unexpected)
2021-01-25 10:16:25.943620 (MainThread): 
2021-01-25 10:16:25.943903 (MainThread): Failed validating 'additionalProperties' in schema:
2021-01-25 10:16:25.944391 (MainThread):     {'$schema': 'http://json-schema.org/draft-07/schema#',
2021-01-25 10:16:25.944680 (MainThread):      'additionalProperties': False,
2021-01-25 10:16:25.944924 (MainThread):      'definitions': {'DremioIncludePolicy': {'additionalProperties': False,
2021-01-25 10:16:25.945157 (MainThread):                                              'description': 'DremioIncludePolicy(*args, '
2021-01-25 10:16:25.945319 (MainThread):                                                             '**kwds)',
2021-01-25 10:16:25.945839 (MainThread):                                              'properties': {'database': {'default': True,
2021-01-25 10:16:25.946251 (MainThread):                                                                          'type': 'boolean'},
2021-01-25 10:16:25.946457 (MainThread):                                                             'identifier': {'default': True,
2021-01-25 10:16:25.946627 (MainThread):                                                                            'type': 'boolean'},
2021-01-25 10:16:25.946781 (MainThread):                                                             'schema': {'default': True,
2021-01-25 10:16:25.947245 (MainThread):                                                                        'type': 'boolean'}},
2021-01-25 10:16:25.947552 (MainThread):                                              'required': [],
2021-01-25 10:16:25.947783 (MainThread):                                              'type': 'object'},
2021-01-25 10:16:25.947962 (MainThread):                      'DremioQuotePolicy': {'additionalProperties': False,
2021-01-25 10:16:25.948100 (MainThread):                                            'description': 'DremioQuotePolicy(*args, '
2021-01-25 10:16:25.948659 (MainThread):                                                           '**kwds)',
2021-01-25 10:16:25.950777 (MainThread):                                            'properties': {'database': {'default': True,
2021-01-25 10:16:25.951116 (MainThread):                                                                        'type': 'boolean'},
2021-01-25 10:16:25.951394 (MainThread):                                                           'identifier': {'default': True,
2021-01-25 10:16:25.951576 (MainThread):                                                                          'type': 'boolean'},
2021-01-25 10:16:25.951823 (MainThread):                                                           'schema': {'default': True,
2021-01-25 10:16:25.952436 (MainThread):                                                                      'type': 'boolean'}},
2021-01-25 10:16:25.952783 (MainThread):                                            'required': [],
2021-01-25 10:16:25.952985 (MainThread):                                            'type': 'object'},
2021-01-25 10:16:25.953149 (MainThread):                      'Path': {'additionalProperties': False,
2021-01-25 10:16:25.953288 (MainThread):                               'description': 'Path(*args, **kwds)',
2021-01-25 10:16:25.954180 (MainThread):                               'properties': {'database': {'oneOf': [{'type': 'string'},
2021-01-25 10:16:25.954477 (MainThread):                                                                     {'type': 'null'}]},
2021-01-25 10:16:25.954711 (MainThread):                                              'identifier': {'oneOf': [{'type': 'string'},
2021-01-25 10:16:25.955427 (MainThread):                                                                       {'type': 'null'}]},
2021-01-25 10:16:25.955667 (MainThread):                                              'schema': {'oneOf': [{'type': 'string'},
2021-01-25 10:16:25.956221 (MainThread):                                                                   {'type': 'null'}]}},
2021-01-25 10:16:25.956530 (MainThread):                               'required': [],
2021-01-25 10:16:25.956749 (MainThread):                               'type': 'object'}},
2021-01-25 10:16:25.956913 (MainThread):      'description': 'DremioRelation(type: '
2021-01-25 10:16:25.957078 (MainThread):                     'Union[dbt.contracts.relation.RelationType, NoneType], '
2021-01-25 10:16:25.957291 (MainThread):                     'path: dbt.contracts.relation.Path, quote_character: '
2021-01-25 10:16:25.957461 (MainThread):                     'str = \'"\', include_policy: '
2021-01-25 10:16:25.957619 (MainThread):                     'dbt.adapters.dremio.relation.DremioIncludePolicy = '
2021-01-25 10:16:25.958055 (MainThread):                     'DremioIncludePolicy(database=True, schema=True, '
2021-01-25 10:16:25.958353 (MainThread):                     'identifier=True), quote_policy: '
2021-01-25 10:16:25.958555 (MainThread):                     'dbt.adapters.dremio.relation.DremioQuotePolicy = '
2021-01-25 10:16:25.958726 (MainThread):                     'DremioQuotePolicy(database=True, schema=True, '
2021-01-25 10:16:25.959060 (MainThread):                     'identifier=True), dbt_created: bool = False)',
2021-01-25 10:16:25.959413 (MainThread):      'properties': {'dbt_created': {'default': False, 'type': 'boolean'},
2021-01-25 10:16:25.959632 (MainThread):                     'include_policy': {'$ref': '#/definitions/DremioIncludePolicy',
2021-01-25 10:16:25.959796 (MainThread):                                        'default': {'database': True,
2021-01-25 10:16:25.959945 (MainThread):                                                    'identifier': True,
2021-01-25 10:16:25.960084 (MainThread):                                                    'schema': True}},
2021-01-25 10:16:25.960250 (MainThread):                     'path': {'$ref': '#/definitions/Path'},
2021-01-25 10:16:25.960418 (MainThread):                     'quote_character': {'default': '"', 'type': 'string'},
2021-01-25 10:16:25.960573 (MainThread):                     'quote_policy': {'$ref': '#/definitions/DremioQuotePolicy',
2021-01-25 10:16:25.960739 (MainThread):                                      'default': {'database': True,
2021-01-25 10:16:25.960898 (MainThread):                                                  'identifier': True,
2021-01-25 10:16:25.961082 (MainThread):                                                  'schema': True}},
2021-01-25 10:16:25.961255 (MainThread):                     'type': {'oneOf': [{'enum': ['table',
2021-01-25 10:16:25.961405 (MainThread):                                                  'view',
2021-01-25 10:16:25.961549 (MainThread):                                                  'cte',
2021-01-25 10:16:25.961737 (MainThread):                                                  'materializedview',
2021-01-25 10:16:25.962012 (MainThread):                                                  'external'],
2021-01-25 10:16:25.962334 (MainThread):                                         'type': 'string'},
2021-01-25 10:16:25.962623 (MainThread):                                        {'type': 'null'}]}},
2021-01-25 10:16:25.962849 (MainThread):      'required': ['path'],
2021-01-25 10:16:25.963057 (MainThread):      'type': 'object'}
2021-01-25 10:16:25.963251 (MainThread): 
2021-01-25 10:16:25.963457 (MainThread): On instance:
2021-01-25 10:16:25.963954 (MainThread):     {'database': 'subsurface',
2021-01-25 10:16:25.964442 (MainThread):      'dbt_created': False,
2021-01-25 10:16:25.967039 (MainThread):      'include_policy': {'database': True,
2021-01-25 10:16:25.967415 (MainThread):                         'identifier': True,
2021-01-25 10:16:25.967690 (MainThread):                         'schema': True},
2021-01-25 10:16:25.967970 (MainThread):      'path': {'database': 'subsurface',
2021-01-25 10:16:25.968285 (MainThread):               'identifier': 'stg__land_values_aggregate_reflection',
2021-01-25 10:16:25.968531 (MainThread):               'schema': 'no_schema'},
2021-01-25 10:16:25.968721 (MainThread):      'quote_character': '"',
2021-01-25 10:16:25.968906 (MainThread):      'quote_policy': {'database': True, 'identifier': True, 'schema': True},
2021-01-25 10:16:25.969085 (MainThread):      'schema': 'no_schema',
2021-01-25 10:16:25.969490 (MainThread):      'type': 'materializedview'}
2021-01-25 10:16:25.969789 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-01-25 10:16:25.970341 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5302f2a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe530280390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe530280eb8>]}
2021-01-25 10:16:25.970908 (MainThread): Flushing usage events
2021-01-25 10:16:59.760459 (MainThread): Running with dbt=0.18.1
2021-01-25 10:16:59.924559 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 10:16:59.926209 (MainThread): Tracking: tracking
2021-01-25 10:16:59.937883 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77881e5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7787d07ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7787d07f60>]}
2021-01-25 10:17:00.016208 (MainThread): Partial parsing not enabled
2021-01-25 10:17:00.018046 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 10:17:00.027337 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 10:17:00.032338 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 10:17:00.038399 (MainThread): Parsing macros/helpers.sql
2021-01-25 10:17:00.072473 (MainThread): Parsing macros/catalog.sql
2021-01-25 10:17:00.077420 (MainThread): Parsing macros/adapters.sql
2021-01-25 10:17:00.154698 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 10:17:00.158059 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 10:17:00.166130 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 10:17:00.166975 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 10:17:00.175252 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 10:17:00.222402 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 10:17:00.246635 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 10:17:00.258971 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 10:17:00.294196 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 10:17:00.313162 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 10:17:00.348138 (MainThread): Parsing macros/core.sql
2021-01-25 10:17:00.355965 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 10:17:00.445297 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 10:17:00.464362 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 10:17:00.468161 (MainThread): Parsing macros/etc/query.sql
2021-01-25 10:17:00.471160 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 10:17:00.473502 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 10:17:00.478125 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 10:17:00.481976 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 10:17:00.501956 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 10:17:00.506656 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 10:17:00.519864 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 10:17:00.575862 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 10:17:00.612453 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 10:17:00.617223 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 10:17:00.627941 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 10:17:00.641137 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 10:17:00.670164 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 10:17:00.684322 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 10:17:00.733412 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 10:17:00.738039 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 10:17:00.741726 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 10:17:00.745584 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 10:17:00.762377 (MainThread): Partial parsing not enabled
2021-01-25 10:17:00.900060 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:00.989987 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:01.489580 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 10:17:01.490922 (MainThread): 
2021-01-25 10:17:01.491697 (MainThread): Acquiring new dremio connection "master".
2021-01-25 10:17:01.499001 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-25 10:17:01.537103 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-25 10:17:01.537438 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 10:17:01.537697 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 10:17:01.537885 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:01.789529 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 10:17:02.344484 (ThreadPoolExecutor-0_0): SQL status: OK in 0.81 seconds
2021-01-25 10:17:02.402911 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-25 10:17:02.443941 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-25 10:17:02.476472 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-25 10:17:02.481256 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 10:17:02.482056 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 10:17:02.483315 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:02.710542 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 10:17:03.813654 (ThreadPoolExecutor-1_0): SQL status: OK in 1.33 seconds
2021-01-25 10:17:03.880307 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-25 10:17:03.884298 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-25 10:17:03.886708 (MainThread): 11:17:03 | Concurrency: 2 threads (target='managed')
2021-01-25 10:17:03.888499 (MainThread): 11:17:03 | 
2021-01-25 10:17:03.927834 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 10:17:03.930563 (Thread-1): 11:17:03 | 1 of 2 START table model subsurface.stg__land_values................. [RUN]
2021-01-25 10:17:03.931580 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:03.931927 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 10:17:03.940676 (Thread-2): Began running node model.subsurface.stg__land_values0
2021-01-25 10:17:03.945430 (Thread-2): 11:17:03 | 2 of 2 START table model subsurface.stg__land_values0................ [RUN]
2021-01-25 10:17:03.965487 (Thread-2): Acquiring new dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:03.965844 (Thread-2): Compiling model.subsurface.stg__land_values0
2021-01-25 10:17:04.084088 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 10:17:04.084989 (Thread-1): finished collecting timing info
2021-01-25 10:17:04.099499 (Thread-2): Writing injected SQL for node "model.subsurface.stg__land_values0"
2021-01-25 10:17:04.100503 (Thread-2): finished collecting timing info
2021-01-25 10:17:04.491624 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:04.501251 (Thread-2): On "model.subsurface.stg__land_values0": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:04.512985 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:04.523106 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:04.523426 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:04.523598 (Thread-2): On model.subsurface.stg__land_values0: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:04.523764 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 10:17:04.523913 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 10:17:04.524107 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:04.524294 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:04.882946 (Thread-2): Connected to db: None
2021-01-25 10:17:04.926178 (Thread-1): Connected to db: None
2021-01-25 10:17:06.770003 (Thread-2): SQL status: OK in 2.25 seconds
2021-01-25 10:17:06.815202 (Thread-2): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_green">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-25 10:17:06.816847 (Thread-2): On "model.subsurface.stg__land_values0": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:06.840585 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:06.843271 (Thread-1): SQL status: OK in 2.32 seconds
2021-01-25 10:17:06.844762 (Thread-2): On model.subsurface.stg__land_values0: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:06.929454 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_green">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-25 10:17:06.944700 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:06.977901 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:06.978923 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:08.149842 (Thread-2): SQL status: OK in 1.30 seconds
2021-01-25 10:17:08.253435 (Thread-2): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_green">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-25 10:17:08.297132 (Thread-1): SQL status: OK in 1.32 seconds
2021-01-25 10:17:08.321281 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:08.328604 (Thread-2): On model.subsurface.stg__land_values0: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values0_blue"
2021-01-25 10:17:08.417887 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_green">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-25 10:17:08.433166 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:08.433744 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_green"
2021-01-25 10:17:08.443042 (Thread-2): SQL status: OK in 0.11 seconds
2021-01-25 10:17:08.493213 (Thread-2): Writing runtime SQL for node "model.subsurface.stg__land_values0"
2021-01-25 10:17:08.494226 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:08.494600 (Thread-2): On model.subsurface.stg__land_values0: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values0_blue"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '79'
  )

  
2021-01-25 10:17:08.495468 (Thread-1): SQL status: OK in 0.06 seconds
2021-01-25 10:17:08.508925 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 10:17:08.516663 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:08.524067 (Thread-1): On model.subsurface.stg__land_values: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '85'
  )

  
2021-01-25 10:17:10.673134 (Thread-2): SQL status: OK in 2.17 seconds
2021-01-25 10:17:10.697969 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:10.698320 (Thread-2): On model.subsurface.stg__land_values0: 
    
  create or replace view "subsurface"."stg__land_values0" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values0_blue"
  )

  
2021-01-25 10:17:10.992384 (Thread-2): SQL status: OK in 0.29 seconds
2021-01-25 10:17:11.009154 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:11.009534 (Thread-2): On model.subsurface.stg__land_values0: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values0_green"
2021-01-25 10:17:11.063572 (Thread-2): SQL status: OK in 0.05 seconds
2021-01-25 10:17:11.130311 (Thread-2): finished collecting timing info
2021-01-25 10:17:11.131070 (Thread-2): On model.subsurface.stg__land_values0: ROLLBACK
2021-01-25 10:17:11.131357 (Thread-2): On model.subsurface.stg__land_values0: Close
2021-01-25 10:17:11.136722 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07ae05e0-2c1b-4f89-b1f8-27805b90d30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7787b79860>]}
2021-01-25 10:17:11.144155 (Thread-2): 11:17:11 | 2 of 2 OK created table model subsurface.stg__land_values0........... [OK in 7.17s]
2021-01-25 10:17:11.144589 (Thread-2): Finished running node model.subsurface.stg__land_values0
2021-01-25 10:17:11.410896 (Thread-1): SQL status: OK in 2.89 seconds
2021-01-25 10:17:11.419229 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:11.419622 (Thread-1): On model.subsurface.stg__land_values: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  )

  
2021-01-25 10:17:11.682089 (Thread-1): SQL status: OK in 0.26 seconds
2021-01-25 10:17:11.694476 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:11.701472 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
2021-01-25 10:17:11.739360 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-25 10:17:11.749054 (Thread-1): finished collecting timing info
2021-01-25 10:17:11.757865 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 10:17:11.759649 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 10:17:11.771788 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07ae05e0-2c1b-4f89-b1f8-27805b90d30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778796cdd8>]}
2021-01-25 10:17:11.774642 (Thread-1): 11:17:11 | 1 of 2 OK created table model subsurface.stg__land_values............ [OK in 7.83s]
2021-01-25 10:17:11.775195 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 10:17:11.861281 (MainThread): Acquiring new dremio connection "master".
2021-01-25 10:17:11.861591 (MainThread): On master: ROLLBACK
2021-01-25 10:17:11.861782 (MainThread): Opening a new connection, currently in state init
2021-01-25 10:17:11.861947 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:12.145232 (MainThread): Connected to db: None
2021-01-25 10:17:12.145641 (MainThread): On master: ROLLBACK
2021-01-25 10:17:12.145860 (MainThread): On master: Close
2021-01-25 10:17:12.147544 (MainThread): 11:17:12 | 
2021-01-25 10:17:12.151536 (MainThread): 11:17:12 | Finished running 2 table models in 10.66s.
2021-01-25 10:17:12.152028 (MainThread): Connection 'master' was properly closed.
2021-01-25 10:17:12.152358 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 10:17:12.152703 (MainThread): Connection 'model.subsurface.stg__land_values0' was properly closed.
2021-01-25 10:17:12.190584 (MainThread): 
2021-01-25 10:17:12.192361 (MainThread): Completed successfully
2021-01-25 10:17:12.193327 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-25 10:17:12.197517 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7787bb2080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7787a6a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7787a6a550>]}
2021-01-25 10:17:12.199000 (MainThread): Flushing usage events
2021-01-25 10:17:21.582413 (MainThread): Running with dbt=0.18.1
2021-01-25 10:17:21.718478 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 10:17:21.720158 (MainThread): Tracking: tracking
2021-01-25 10:17:21.730106 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b6200b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b6200dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b6200e48>]}
2021-01-25 10:17:21.791848 (MainThread): Partial parsing not enabled
2021-01-25 10:17:21.793792 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 10:17:21.802002 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 10:17:21.807672 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 10:17:21.814572 (MainThread): Parsing macros/helpers.sql
2021-01-25 10:17:21.853087 (MainThread): Parsing macros/catalog.sql
2021-01-25 10:17:21.858598 (MainThread): Parsing macros/adapters.sql
2021-01-25 10:17:21.910124 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 10:17:21.912606 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 10:17:21.919069 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 10:17:21.919597 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 10:17:21.925156 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 10:17:21.945059 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 10:17:21.963652 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 10:17:21.972329 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 10:17:21.987736 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 10:17:21.999732 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 10:17:22.029323 (MainThread): Parsing macros/core.sql
2021-01-25 10:17:22.036985 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 10:17:22.124966 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 10:17:22.168561 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 10:17:22.173003 (MainThread): Parsing macros/etc/query.sql
2021-01-25 10:17:22.175811 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 10:17:22.178367 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 10:17:22.183738 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 10:17:22.187928 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 10:17:22.210496 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 10:17:22.215195 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 10:17:22.229812 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 10:17:22.290527 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 10:17:22.325435 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 10:17:22.329260 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 10:17:22.341315 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 10:17:22.354218 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 10:17:22.382808 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 10:17:22.396330 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 10:17:22.438083 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 10:17:22.443191 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 10:17:22.446661 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 10:17:22.450652 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 10:17:22.467050 (MainThread): Partial parsing not enabled
2021-01-25 10:17:22.589606 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:22.636815 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:23.082914 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 10:17:23.084173 (MainThread): 
2021-01-25 10:17:23.084869 (MainThread): Acquiring new dremio connection "master".
2021-01-25 10:17:23.103450 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-25 10:17:23.131820 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-25 10:17:23.132106 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 10:17:23.132300 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 10:17:23.132468 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:23.317998 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 10:17:23.625669 (ThreadPoolExecutor-0_0): SQL status: OK in 0.49 seconds
2021-01-25 10:17:23.651875 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-25 10:17:23.666995 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-25 10:17:23.707229 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-25 10:17:23.709175 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 10:17:23.709744 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 10:17:23.710629 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:23.920551 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 10:17:24.796432 (ThreadPoolExecutor-1_0): SQL status: OK in 1.09 seconds
2021-01-25 10:17:24.864920 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-25 10:17:24.865371 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-25 10:17:24.879349 (MainThread): 11:17:24 | Concurrency: 2 threads (target='managed')
2021-01-25 10:17:24.880091 (MainThread): 11:17:24 | 
2021-01-25 10:17:24.919168 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 10:17:24.919644 (Thread-2): Began running node model.subsurface.stg__land_values0
2021-01-25 10:17:24.934785 (Thread-2): 11:17:24 | 2 of 2 START table model subsurface.stg__land_values0................ [RUN]
2021-01-25 10:17:24.939883 (Thread-2): Acquiring new dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:24.940345 (Thread-2): Compiling model.subsurface.stg__land_values0
2021-01-25 10:17:24.922794 (Thread-1): 11:17:24 | 1 of 2 START table model subsurface.stg__land_values................. [RUN]
2021-01-25 10:17:24.980047 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:24.980419 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 10:17:25.076959 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 10:17:25.077889 (Thread-1): finished collecting timing info
2021-01-25 10:17:25.086509 (Thread-2): Writing injected SQL for node "model.subsurface.stg__land_values0"
2021-01-25 10:17:25.087380 (Thread-2): finished collecting timing info
2021-01-25 10:17:25.266015 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:25.275991 (Thread-2): On "model.subsurface.stg__land_values0": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:25.289858 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:25.290281 (Thread-2): On model.subsurface.stg__land_values0: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:25.290652 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 10:17:25.283337 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:25.291372 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:25.291721 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 10:17:25.292047 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:25.291001 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:25.632868 (Thread-1): Connected to db: None
2021-01-25 10:17:25.665681 (Thread-2): Connected to db: None
2021-01-25 10:17:26.850056 (Thread-2): SQL status: OK in 1.56 seconds
2021-01-25 10:17:26.885562 (Thread-1): SQL status: OK in 1.59 seconds
2021-01-25 10:17:26.902434 (Thread-2): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_blue">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-25 10:17:26.903121 (Thread-2): On "model.subsurface.stg__land_values0": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:26.921765 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:26.922091 (Thread-2): On model.subsurface.stg__land_values0: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:26.950475 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_blue">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-25 10:17:26.951212 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:26.965723 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:26.966052 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:28.189664 (Thread-1): SQL status: OK in 1.22 seconds
2021-01-25 10:17:28.214055 (Thread-2): SQL status: OK in 1.29 seconds
2021-01-25 10:17:28.294876 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_blue">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-25 10:17:28.340756 (Thread-2): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_blue">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_green">]
2021-01-25 10:17:28.360896 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:28.361395 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
2021-01-25 10:17:28.363659 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:28.369245 (Thread-2): On model.subsurface.stg__land_values0: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values0_green"
2021-01-25 10:17:28.426084 (Thread-1): SQL status: OK in 0.06 seconds
2021-01-25 10:17:28.470488 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 10:17:28.477852 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:28.478514 (Thread-1): On model.subsurface.stg__land_values: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '85'
  )

  
2021-01-25 10:17:28.483181 (Thread-2): SQL status: OK in 0.11 seconds
2021-01-25 10:17:28.487520 (Thread-2): Writing runtime SQL for node "model.subsurface.stg__land_values0"
2021-01-25 10:17:28.489224 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:28.489588 (Thread-2): On model.subsurface.stg__land_values0: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values0_green"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '79'
  )

  
2021-01-25 10:17:30.902536 (Thread-2): SQL status: OK in 2.41 seconds
2021-01-25 10:17:30.934114 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:30.935974 (Thread-2): On model.subsurface.stg__land_values0: 
    
  create or replace view "subsurface"."stg__land_values0" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values0_green"
  )

  
2021-01-25 10:17:31.220438 (Thread-2): SQL status: OK in 0.28 seconds
2021-01-25 10:17:31.235866 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:31.236280 (Thread-2): On model.subsurface.stg__land_values0: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values0_blue"
2021-01-25 10:17:31.291833 (Thread-2): SQL status: OK in 0.06 seconds
2021-01-25 10:17:31.331181 (Thread-2): finished collecting timing info
2021-01-25 10:17:31.332255 (Thread-2): On model.subsurface.stg__land_values0: ROLLBACK
2021-01-25 10:17:31.332762 (Thread-2): On model.subsurface.stg__land_values0: Close
2021-01-25 10:17:31.338263 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '222075b8-8c0f-4c31-8916-c730f5332528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b5e64630>]}
2021-01-25 10:17:31.341877 (Thread-2): 11:17:31 | 2 of 2 OK created table model subsurface.stg__land_values0........... [OK in 6.40s]
2021-01-25 10:17:31.342362 (Thread-2): Finished running node model.subsurface.stg__land_values0
2021-01-25 10:17:31.517063 (Thread-1): SQL status: OK in 3.03 seconds
2021-01-25 10:17:31.519801 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:31.520158 (Thread-1): On model.subsurface.stg__land_values: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
  )

  
2021-01-25 10:17:31.774155 (Thread-1): SQL status: OK in 0.25 seconds
2021-01-25 10:17:31.809606 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:31.810385 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_green"
2021-01-25 10:17:31.870767 (Thread-1): SQL status: OK in 0.05 seconds
2021-01-25 10:17:31.905200 (Thread-1): finished collecting timing info
2021-01-25 10:17:31.905908 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 10:17:31.906189 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 10:17:31.915122 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '222075b8-8c0f-4c31-8916-c730f5332528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b5ecad30>]}
2021-01-25 10:17:31.918357 (Thread-1): 11:17:31 | 1 of 2 OK created table model subsurface.stg__land_values............ [OK in 6.93s]
2021-01-25 10:17:31.923270 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 10:17:32.007888 (MainThread): Acquiring new dremio connection "master".
2021-01-25 10:17:32.008317 (MainThread): On master: ROLLBACK
2021-01-25 10:17:32.008578 (MainThread): Opening a new connection, currently in state init
2021-01-25 10:17:32.008914 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:32.359682 (MainThread): Connected to db: None
2021-01-25 10:17:32.360089 (MainThread): On master: ROLLBACK
2021-01-25 10:17:32.360309 (MainThread): On master: Close
2021-01-25 10:17:32.361795 (MainThread): 11:17:32 | 
2021-01-25 10:17:32.362170 (MainThread): 11:17:32 | Finished running 2 table models in 9.28s.
2021-01-25 10:17:32.362485 (MainThread): Connection 'master' was properly closed.
2021-01-25 10:17:32.362708 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 10:17:32.363415 (MainThread): Connection 'model.subsurface.stg__land_values0' was properly closed.
2021-01-25 10:17:32.425255 (MainThread): 
2021-01-25 10:17:32.425741 (MainThread): Completed successfully
2021-01-25 10:17:32.426038 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-25 10:17:32.426484 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b5f13828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b61af860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b608f9b0>]}
2021-01-25 10:17:32.433138 (MainThread): Flushing usage events
2021-01-25 10:17:51.079273 (MainThread): Running with dbt=0.18.1
2021-01-25 10:17:51.214989 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 10:17:51.216755 (MainThread): Tracking: tracking
2021-01-25 10:17:51.226699 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62cea50b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62cea50e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62cea50e80>]}
2021-01-25 10:17:51.287131 (MainThread): Partial parsing not enabled
2021-01-25 10:17:51.289010 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 10:17:51.295780 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 10:17:51.300986 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 10:17:51.306747 (MainThread): Parsing macros/helpers.sql
2021-01-25 10:17:51.335811 (MainThread): Parsing macros/catalog.sql
2021-01-25 10:17:51.340737 (MainThread): Parsing macros/adapters.sql
2021-01-25 10:17:51.390911 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 10:17:51.393744 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 10:17:51.400071 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 10:17:51.400605 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 10:17:51.406970 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 10:17:51.427340 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 10:17:51.446818 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 10:17:51.456179 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 10:17:51.472532 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 10:17:51.485002 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 10:17:51.516162 (MainThread): Parsing macros/core.sql
2021-01-25 10:17:51.524575 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 10:17:51.616621 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 10:17:51.635661 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 10:17:51.639577 (MainThread): Parsing macros/etc/query.sql
2021-01-25 10:17:51.642109 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 10:17:51.644495 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 10:17:51.649574 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 10:17:51.653492 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 10:17:51.673393 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 10:17:51.677491 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 10:17:51.691447 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 10:17:51.748609 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 10:17:51.784890 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 10:17:51.789281 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 10:17:51.800170 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 10:17:51.816648 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 10:17:51.850119 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 10:17:51.864025 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 10:17:51.907055 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 10:17:51.911936 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 10:17:51.915959 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 10:17:51.920046 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 10:17:51.936842 (MainThread): Partial parsing not enabled
2021-01-25 10:17:52.062758 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:52.111140 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:52.568456 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 10:17:52.569796 (MainThread): 
2021-01-25 10:17:52.570673 (MainThread): Acquiring new dremio connection "master".
2021-01-25 10:17:52.578566 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface".
2021-01-25 10:17:52.614151 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface".
2021-01-25 10:17:52.614460 (ThreadPoolExecutor-0_0): On list_subsurface: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 10:17:52.614632 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 10:17:52.614780 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:52.792771 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 10:17:53.111417 (ThreadPoolExecutor-0_0): SQL status: OK in 0.50 seconds
2021-01-25 10:17:53.154879 (ThreadPoolExecutor-0_0): On list_subsurface: Close
2021-01-25 10:17:53.191564 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_no_schema".
2021-01-25 10:17:53.228664 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_no_schema".
2021-01-25 10:17:53.231418 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 10:17:53.231911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 10:17:53.232314 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:53.438831 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 10:17:54.285658 (ThreadPoolExecutor-1_0): SQL status: OK in 1.05 seconds
2021-01-25 10:17:54.332225 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: ROLLBACK
2021-01-25 10:17:54.332560 (ThreadPoolExecutor-1_0): On list_subsurface_no_schema: Close
2021-01-25 10:17:54.337979 (MainThread): 11:17:54 | Concurrency: 2 threads (target='managed')
2021-01-25 10:17:54.338396 (MainThread): 11:17:54 | 
2021-01-25 10:17:54.355221 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 10:17:54.357893 (Thread-1): 11:17:54 | 1 of 2 START table model subsurface.stg__land_values................. [RUN]
2021-01-25 10:17:54.364651 (Thread-2): Began running node model.subsurface.stg__land_values0
2021-01-25 10:17:54.373859 (Thread-2): 11:17:54 | 2 of 2 START table model subsurface.stg__land_values0................ [RUN]
2021-01-25 10:17:54.374549 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:54.375092 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 10:17:54.383086 (Thread-2): Acquiring new dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:54.383419 (Thread-2): Compiling model.subsurface.stg__land_values0
2021-01-25 10:17:54.461345 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 10:17:54.462101 (Thread-1): finished collecting timing info
2021-01-25 10:17:54.470458 (Thread-2): Writing injected SQL for node "model.subsurface.stg__land_values0"
2021-01-25 10:17:54.471235 (Thread-2): finished collecting timing info
2021-01-25 10:17:54.683224 (Thread-2): On "model.subsurface.stg__land_values0": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:54.684482 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:54.692931 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:54.700648 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:54.700982 (Thread-2): On model.subsurface.stg__land_values0: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:54.701167 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:54.701348 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 10:17:54.701509 (Thread-1): Opening a new connection, currently in state init
2021-01-25 10:17:54.701656 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:54.701791 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:17:55.030386 (Thread-2): Connected to db: None
2021-01-25 10:17:55.067329 (Thread-1): Connected to db: None
2021-01-25 10:17:56.068332 (Thread-1): SQL status: OK in 1.37 seconds
2021-01-25 10:17:56.122790 (Thread-2): SQL status: OK in 1.42 seconds
2021-01-25 10:17:56.140461 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_green">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-25 10:17:56.141314 (Thread-1): On "model.subsurface.stg__land_values": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:56.154999 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:56.155414 (Thread-1): On model.subsurface.stg__land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:56.195798 (Thread-2): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_green">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-25 10:17:56.200981 (Thread-2): On "model.subsurface.stg__land_values0": cache miss for schema "$scratch.subsurface.subsurface", this is inefficient
2021-01-25 10:17:56.226352 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:56.228610 (Thread-2): On model.subsurface.stg__land_values0: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.subsurface')
      and table_type <> 'system_table'
  
2021-01-25 10:17:57.489120 (Thread-1): SQL status: OK in 1.33 seconds
2021-01-25 10:17:57.561834 (Thread-1): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_green">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-25 10:17:57.609569 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:57.614948 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_green"
2021-01-25 10:17:57.615464 (Thread-2): SQL status: OK in 1.39 seconds
2021-01-25 10:17:57.653355 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-25 10:17:57.684964 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 10:17:57.699006 (Thread-2): with database=$scratch, schema=subsurface.subsurface, relations=[<DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values0_green">, <DremioRelation "$scratch"."subsurface"."subsurface"."stg__land_values_blue">]
2021-01-25 10:17:57.699931 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:57.708034 (Thread-1): On model.subsurface.stg__land_values: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '85'
  )

  
2021-01-25 10:17:57.715704 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:57.716112 (Thread-2): On model.subsurface.stg__land_values0: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values0_blue"
2021-01-25 10:17:57.902743 (Thread-2): SQL status: OK in 0.18 seconds
2021-01-25 10:17:57.912269 (Thread-2): Writing runtime SQL for node "model.subsurface.stg__land_values0"
2021-01-25 10:17:57.913319 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:57.913731 (Thread-2): On model.subsurface.stg__land_values0: 
    

  create table
    "$scratch"."subsurface"."subsurface"."stg__land_values0_blue"
  
  
  as (
    

select
  "Valeur fonciere" as amount
  ,"Code departement" as departement
  ,"Code commune" as code_commune
from
  "fs"."valeurs_foncieres"
where
  "Code departement" = '79'
  )

  
2021-01-25 10:17:59.363137 (Thread-2): SQL status: OK in 1.45 seconds
2021-01-25 10:17:59.406739 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:59.415501 (Thread-2): On model.subsurface.stg__land_values0: 
    
  create or replace view "subsurface"."stg__land_values0" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values0_blue"
  )

  
2021-01-25 10:17:59.711045 (Thread-2): SQL status: OK in 0.30 seconds
2021-01-25 10:17:59.725740 (Thread-2): Using dremio connection "model.subsurface.stg__land_values0".
2021-01-25 10:17:59.732758 (Thread-2): On model.subsurface.stg__land_values0: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values0_green"
2021-01-25 10:17:59.773737 (Thread-2): SQL status: OK in 0.04 seconds
2021-01-25 10:17:59.864261 (Thread-1): SQL status: OK in 2.16 seconds
2021-01-25 10:17:59.873725 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:17:59.878508 (Thread-1): On model.subsurface.stg__land_values: 
    
  create or replace view "subsurface"."stg__land_values" as (
    select * from "$scratch"."subsurface"."subsurface"."stg__land_values_green"
  )

  
2021-01-25 10:17:59.894768 (Thread-2): finished collecting timing info
2021-01-25 10:17:59.908096 (Thread-2): On model.subsurface.stg__land_values0: ROLLBACK
2021-01-25 10:17:59.908607 (Thread-2): On model.subsurface.stg__land_values0: Close
2021-01-25 10:17:59.920345 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beadc61-bef7-4209-b4c8-d45295c9a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ce87c710>]}
2021-01-25 10:17:59.924202 (Thread-2): 11:17:59 | 2 of 2 OK created table model subsurface.stg__land_values0........... [OK in 5.54s]
2021-01-25 10:17:59.929438 (Thread-2): Finished running node model.subsurface.stg__land_values0
2021-01-25 10:18:00.092637 (Thread-1): SQL status: OK in 0.21 seconds
2021-01-25 10:18:00.111037 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 10:18:00.112421 (Thread-1): On model.subsurface.stg__land_values: drop table if exists "$scratch"."subsurface"."subsurface"."stg__land_values_blue"
2021-01-25 10:18:00.143578 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-25 10:18:00.160643 (Thread-1): finished collecting timing info
2021-01-25 10:18:00.162213 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 10:18:00.162696 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 10:18:00.168909 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beadc61-bef7-4209-b4c8-d45295c9a316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ce6ae8d0>]}
2021-01-25 10:18:00.173532 (Thread-1): 11:18:00 | 1 of 2 OK created table model subsurface.stg__land_values............ [OK in 5.79s]
2021-01-25 10:18:00.174019 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 10:18:00.235550 (MainThread): Acquiring new dremio connection "master".
2021-01-25 10:18:00.235944 (MainThread): On master: ROLLBACK
2021-01-25 10:18:00.236205 (MainThread): Opening a new connection, currently in state init
2021-01-25 10:18:00.236417 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 10:18:00.481748 (MainThread): Connected to db: None
2021-01-25 10:18:00.482176 (MainThread): On master: ROLLBACK
2021-01-25 10:18:00.482573 (MainThread): On master: Close
2021-01-25 10:18:00.484370 (MainThread): 11:18:00 | 
2021-01-25 10:18:00.484814 (MainThread): 11:18:00 | Finished running 2 table models in 7.91s.
2021-01-25 10:18:00.485188 (MainThread): Connection 'master' was properly closed.
2021-01-25 10:18:00.485561 (MainThread): Connection 'model.subsurface.stg__land_values0' was properly closed.
2021-01-25 10:18:00.485867 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 10:18:00.503576 (MainThread): 
2021-01-25 10:18:00.504175 (MainThread): Completed successfully
2021-01-25 10:18:00.504642 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-25 10:18:00.505322 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62cdc4cf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ce7906d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ce7afba8>]}
2021-01-25 10:18:00.505949 (MainThread): Flushing usage events
2021-01-25 12:47:28.372177 (MainThread): Running with dbt=0.18.1
2021-01-25 12:47:28.820604 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 12:47:28.837735 (MainThread): Tracking: tracking
2021-01-25 12:47:28.862084 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d0b04d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d0618e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d0618ef0>]}
2021-01-25 12:47:28.977594 (MainThread): Partial parsing not enabled
2021-01-25 12:47:28.993191 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 12:47:29.024740 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 12:47:29.039901 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 12:47:29.046297 (MainThread): Parsing macros/helpers.sql
2021-01-25 12:47:29.091043 (MainThread): Parsing macros/catalog.sql
2021-01-25 12:47:29.098042 (MainThread): Parsing macros/adapters.sql
2021-01-25 12:47:29.164138 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 12:47:29.173419 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 12:47:29.182547 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 12:47:29.184407 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 12:47:29.193409 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 12:47:29.221097 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 12:47:29.247821 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 12:47:29.260481 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 12:47:29.288035 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 12:47:29.306473 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 12:47:29.361853 (MainThread): Parsing macros/core.sql
2021-01-25 12:47:29.378790 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 12:47:29.516457 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 12:47:29.544160 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 12:47:29.549229 (MainThread): Parsing macros/etc/query.sql
2021-01-25 12:47:29.553581 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 12:47:29.557246 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 12:47:29.563453 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 12:47:29.571658 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 12:47:29.602680 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 12:47:29.608878 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 12:47:29.633583 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 12:47:29.714720 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 12:47:29.788360 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 12:47:29.803446 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 12:47:29.827672 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 12:47:29.848482 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 12:47:29.890951 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 12:47:29.915509 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 12:47:29.999320 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 12:47:30.013535 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 12:47:30.024769 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 12:47:30.047200 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 12:47:30.102781 (MainThread): Partial parsing not enabled
2021-01-25 12:47:30.606606 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:47:31.634096 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 12:47:31.636998 (MainThread): 
2021-01-25 12:47:31.638553 (MainThread): Acquiring new dremio connection "master".
2021-01-25 12:47:31.642472 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 12:47:31.703001 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 12:47:31.703346 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 12:47:31.703535 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 12:47:31.703793 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:47:32.577657 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 12:47:32.970028 (ThreadPoolExecutor-0_0): SQL status: OK in 1.27 seconds
2021-01-25 12:47:33.052709 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 12:47:33.067690 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 12:47:33.145629 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 12:47:33.151155 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 12:47:33.151464 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 12:47:33.151677 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:47:33.403794 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 12:47:34.168561 (ThreadPoolExecutor-1_0): SQL status: OK in 1.02 seconds
2021-01-25 12:47:34.170017 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 12:47:34.172587 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 12:47:34.176132 (MainThread): 13:47:34 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 12:47:34.176545 (MainThread): 13:47:34 | 
2021-01-25 12:47:34.274356 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 12:47:34.277129 (Thread-1): 13:47:34 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 12:47:34.278025 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:47:34.279074 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 12:47:34.406365 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 12:47:34.432176 (Thread-1): finished collecting timing info
2021-01-25 12:47:34.489242 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 12:47:34.502950 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:47:34.503195 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  "Date mutation" as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as "land_surface"
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 12:47:34.503308 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 12:47:34.503630 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:47:34.665140 (Thread-1): Connected to db: None
2021-01-25 12:47:34.740913 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  "Date mutation" as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as "land_surface"
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 12:47:34.744995 (Thread-1): Rolling back transaction.
2021-01-25 12:47:34.745387 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 12:47:34.745698 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 12:47:34.749884 (Thread-1): finished collecting timing info
2021-01-25 12:47:34.754590 (Thread-1): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  "Date mutation" as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municipality\n  ,"Code departement" as department_code\n  ,"Code commune" as municipality_...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  "Date mutation" as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municipality\n  ,"Code departement" as department_code\n  ,"Code commune" as municipality_...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  "Date mutation" as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municipality\n  ,"Code departement" as department_code\n  ,"Code commune" as municipality_...[see log] (1040) (SQLExecDirectW)')
2021-01-25 12:47:34.808552 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '308fd154-2e35-4958-99ed-77e0931837ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d0387eb8>]}
2021-01-25 12:47:34.813707 (Thread-1): 13:47:34 | 1 of 1 ERROR creating view model @fab4.stg__land_values.............. [ERROR in 0.53s]
2021-01-25 12:47:34.814966 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 12:47:34.875684 (MainThread): Acquiring new dremio connection "master".
2021-01-25 12:47:34.876508 (MainThread): On master: ROLLBACK
2021-01-25 12:47:34.876709 (MainThread): Opening a new connection, currently in state init
2021-01-25 12:47:34.876846 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:47:35.036648 (MainThread): Connected to db: None
2021-01-25 12:47:35.037046 (MainThread): On master: ROLLBACK
2021-01-25 12:47:35.037268 (MainThread): On master: Close
2021-01-25 12:47:35.039020 (MainThread): 13:47:35 | 
2021-01-25 12:47:35.040157 (MainThread): 13:47:35 | Finished running 1 view model in 3.40s.
2021-01-25 12:47:35.042217 (MainThread): Connection 'master' was properly closed.
2021-01-25 12:47:35.043931 (MainThread): Connection 'list_@fab4' was properly closed.
2021-01-25 12:47:35.048301 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 12:47:35.083364 (MainThread): 
2021-01-25 12:47:35.086446 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 12:47:35.087717 (MainThread): 
2021-01-25 12:47:35.091193 (MainThread): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
2021-01-25 12:47:35.092188 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  "Date mutation" as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municipality\n  ,"Code departement" as department_code\n  ,"Code commune" as municipality_...[see log] (1040) (SQLExecDirectW)')
2021-01-25 12:47:35.094318 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 12:47:35.095964 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d038d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d04c1198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d0482278>]}
2021-01-25 12:47:35.098842 (MainThread): Flushing usage events
2021-01-25 12:48:04.240737 (MainThread): Running with dbt=0.18.1
2021-01-25 12:48:04.549334 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 12:48:04.553180 (MainThread): Tracking: tracking
2021-01-25 12:48:04.594231 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe9c8b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe9c8e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe9c8eb8>]}
2021-01-25 12:48:04.838144 (MainThread): Partial parsing not enabled
2021-01-25 12:48:04.843744 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 12:48:04.869209 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 12:48:04.875179 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 12:48:04.884598 (MainThread): Parsing macros/helpers.sql
2021-01-25 12:48:04.950194 (MainThread): Parsing macros/catalog.sql
2021-01-25 12:48:04.977639 (MainThread): Parsing macros/adapters.sql
2021-01-25 12:48:05.114330 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 12:48:05.117865 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 12:48:05.126257 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 12:48:05.127056 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 12:48:05.136242 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 12:48:05.171871 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 12:48:05.205309 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 12:48:05.226609 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 12:48:05.256663 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 12:48:05.275946 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 12:48:05.325885 (MainThread): Parsing macros/core.sql
2021-01-25 12:48:05.339366 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 12:48:05.471995 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 12:48:05.525836 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 12:48:05.530990 (MainThread): Parsing macros/etc/query.sql
2021-01-25 12:48:05.534574 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 12:48:05.538172 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 12:48:05.548046 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 12:48:05.552674 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 12:48:05.593570 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 12:48:05.598940 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 12:48:05.619337 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 12:48:05.710422 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 12:48:05.770480 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 12:48:05.775254 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 12:48:05.793597 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 12:48:05.826309 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 12:48:05.869731 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 12:48:05.888922 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 12:48:05.950676 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 12:48:05.958452 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 12:48:05.971107 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 12:48:05.978216 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 12:48:06.014233 (MainThread): Partial parsing not enabled
2021-01-25 12:48:06.209552 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:48:07.311812 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 12:48:07.323775 (MainThread): 
2021-01-25 12:48:07.328223 (MainThread): Acquiring new dremio connection "master".
2021-01-25 12:48:07.341277 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 12:48:07.437221 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 12:48:07.444299 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 12:48:07.444668 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 12:48:07.445026 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:48:07.682194 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 12:48:08.038425 (ThreadPoolExecutor-0_0): SQL status: OK in 0.59 seconds
2021-01-25 12:48:08.084300 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 12:48:08.119683 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 12:48:08.211396 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 12:48:08.215238 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 12:48:08.215786 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 12:48:08.217405 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:48:08.395504 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 12:48:09.208723 (ThreadPoolExecutor-1_0): SQL status: OK in 0.99 seconds
2021-01-25 12:48:09.209638 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 12:48:09.209948 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 12:48:09.217354 (MainThread): 13:48:09 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 12:48:09.218977 (MainThread): 13:48:09 | 
2021-01-25 12:48:09.264321 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 12:48:09.267624 (Thread-1): 13:48:09 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 12:48:09.268676 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:48:09.269011 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 12:48:09.405976 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 12:48:09.407019 (Thread-1): finished collecting timing info
2021-01-25 12:48:09.611289 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 12:48:09.615771 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:48:09.616210 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  "Date mutation" as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 12:48:09.622694 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 12:48:09.623099 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:48:09.939257 (Thread-1): Connected to db: None
2021-01-25 12:48:09.988967 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  "Date mutation" as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 12:48:09.989298 (Thread-1): Rolling back transaction.
2021-01-25 12:48:09.989520 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 12:48:09.991262 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 12:48:09.992555 (Thread-1): finished collecting timing info
2021-01-25 12:48:09.995418 (Thread-1): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  "Date mutation" as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municipality\n  ,"Code departement" as department_code\n  ,"Code commune" as municipality_...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  "Date mutation" as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municipality\n  ,"Code departement" as department_code\n  ,"Code commune" as municipality_...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  "Date mutation" as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municipality\n  ,"Code departement" as department_code\n  ,"Code commune" as municipality_...[see log] (1040) (SQLExecDirectW)')
2021-01-25 12:48:10.008087 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff4e5cfe-0178-4a84-84db-71690ec389c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe65bcc0>]}
2021-01-25 12:48:10.022674 (Thread-1): 13:48:10 | 1 of 1 ERROR creating view model @fab4.stg__land_values.............. [ERROR in 0.74s]
2021-01-25 12:48:10.050469 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 12:48:10.091361 (MainThread): Acquiring new dremio connection "master".
2021-01-25 12:48:10.091821 (MainThread): On master: ROLLBACK
2021-01-25 12:48:10.092141 (MainThread): Opening a new connection, currently in state init
2021-01-25 12:48:10.092413 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:48:10.311604 (MainThread): Connected to db: None
2021-01-25 12:48:10.312157 (MainThread): On master: ROLLBACK
2021-01-25 12:48:10.312375 (MainThread): On master: Close
2021-01-25 12:48:10.314373 (MainThread): 13:48:10 | 
2021-01-25 12:48:10.317592 (MainThread): 13:48:10 | Finished running 1 view model in 2.99s.
2021-01-25 12:48:10.323701 (MainThread): Connection 'master' was properly closed.
2021-01-25 12:48:10.324025 (MainThread): Connection 'list_@fab4' was properly closed.
2021-01-25 12:48:10.324221 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 12:48:10.357541 (MainThread): 
2021-01-25 12:48:10.358895 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 12:48:10.364863 (MainThread): 
2021-01-25 12:48:10.365282 (MainThread): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
2021-01-25 12:48:10.366558 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  "Date mutation" as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municipality\n  ,"Code departement" as department_code\n  ,"Code commune" as municipality_...[see log] (1040) (SQLExecDirectW)')
2021-01-25 12:48:10.374138 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 12:48:10.374700 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe73d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe73d320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe676470>]}
2021-01-25 12:48:10.378600 (MainThread): Flushing usage events
2021-01-25 12:49:51.946792 (MainThread): Running with dbt=0.18.1
2021-01-25 12:49:52.319339 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 12:49:52.349811 (MainThread): Tracking: tracking
2021-01-25 12:49:52.467789 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bf098be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bf098e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bf098ef0>]}
2021-01-25 12:49:52.570193 (MainThread): Partial parsing not enabled
2021-01-25 12:49:52.586484 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 12:49:52.651435 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 12:49:52.799437 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 12:49:52.806411 (MainThread): Parsing macros/helpers.sql
2021-01-25 12:49:52.838278 (MainThread): Parsing macros/catalog.sql
2021-01-25 12:49:52.851057 (MainThread): Parsing macros/adapters.sql
2021-01-25 12:49:52.919303 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 12:49:52.923284 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 12:49:52.932544 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 12:49:52.934453 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 12:49:52.947341 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 12:49:52.976612 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 12:49:53.001875 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 12:49:53.015453 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 12:49:53.046312 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 12:49:53.066221 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 12:49:53.231278 (MainThread): Parsing macros/core.sql
2021-01-25 12:49:53.242808 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 12:49:53.356382 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 12:49:53.379937 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 12:49:53.386687 (MainThread): Parsing macros/etc/query.sql
2021-01-25 12:49:53.389976 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 12:49:53.392281 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 12:49:53.398992 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 12:49:53.403605 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 12:49:53.432763 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 12:49:53.437813 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 12:49:53.455440 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 12:49:53.519670 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 12:49:53.557021 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 12:49:53.560983 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 12:49:53.572127 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 12:49:53.587480 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 12:49:53.619429 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 12:49:53.633782 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 12:49:53.677731 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 12:49:53.684952 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 12:49:53.689286 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 12:49:53.693417 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 12:49:53.710223 (MainThread): Partial parsing not enabled
2021-01-25 12:49:53.881598 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:49:54.493572 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 12:49:54.494729 (MainThread): 
2021-01-25 12:49:54.495499 (MainThread): Acquiring new dremio connection "master".
2021-01-25 12:49:54.511584 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 12:49:54.551145 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 12:49:54.551394 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 12:49:54.551503 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 12:49:54.551599 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:49:55.767801 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 12:49:56.256102 (ThreadPoolExecutor-0_0): SQL status: OK in 1.70 seconds
2021-01-25 12:49:56.316771 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 12:49:56.324793 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 12:49:56.356564 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 12:49:56.356890 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 12:49:56.357051 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 12:49:56.357171 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:49:56.559278 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 12:49:57.053681 (ThreadPoolExecutor-1_0): SQL status: OK in 0.70 seconds
2021-01-25 12:49:57.054373 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 12:49:57.054668 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 12:49:57.056433 (MainThread): 13:49:57 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 12:49:57.056898 (MainThread): 13:49:57 | 
2021-01-25 12:49:57.093078 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 12:49:57.099152 (Thread-1): 13:49:57 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 12:49:57.101721 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:49:57.102112 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 12:49:57.184559 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 12:49:57.208337 (Thread-1): finished collecting timing info
2021-01-25 12:49:57.256087 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 12:49:57.257473 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 12:49:57.257707 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  "Date mutation" as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 12:49:57.257830 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 12:49:57.257925 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:49:57.390507 (Thread-1): Connected to db: None
2021-01-25 12:49:57.891473 (Thread-1): SQL status: OK in 0.63 seconds
2021-01-25 12:49:57.907330 (Thread-1): finished collecting timing info
2021-01-25 12:49:57.908060 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 12:49:57.908415 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 12:49:57.911518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6cbb088-262b-4012-b339-2e866e24fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bed2bd30>]}
2021-01-25 12:49:57.925852 (Thread-1): 13:49:57 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.81s]
2021-01-25 12:49:57.927080 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 12:49:57.987548 (MainThread): Acquiring new dremio connection "master".
2021-01-25 12:49:57.987941 (MainThread): On master: ROLLBACK
2021-01-25 12:49:57.988174 (MainThread): Opening a new connection, currently in state init
2021-01-25 12:49:57.988435 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 12:49:58.146215 (MainThread): Connected to db: None
2021-01-25 12:49:58.146598 (MainThread): On master: ROLLBACK
2021-01-25 12:49:58.146904 (MainThread): On master: Close
2021-01-25 12:49:58.149370 (MainThread): 13:49:58 | 
2021-01-25 12:49:58.152297 (MainThread): 13:49:58 | Finished running 1 view model in 3.65s.
2021-01-25 12:49:58.154709 (MainThread): Connection 'master' was properly closed.
2021-01-25 12:49:58.155034 (MainThread): Connection 'list_@fab4' was properly closed.
2021-01-25 12:49:58.171039 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 12:49:58.189099 (MainThread): 
2021-01-25 12:49:58.191375 (MainThread): Completed successfully
2021-01-25 12:49:58.192649 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 12:49:58.195403 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bee0d3c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bf9cc240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bed1def0>]}
2021-01-25 12:49:58.196426 (MainThread): Flushing usage events
2021-01-25 13:07:52.812338 (MainThread): Running with dbt=0.18.1
2021-01-25 13:07:53.100074 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:07:53.119827 (MainThread): Tracking: tracking
2021-01-25 13:07:53.157596 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a6050b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a72ee320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a6050da0>]}
2021-01-25 13:07:53.227735 (MainThread): Partial parsing not enabled
2021-01-25 13:07:53.243683 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:07:53.275160 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:07:53.289738 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:07:53.297726 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:07:53.325165 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:07:53.330486 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:07:53.378657 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:07:53.381209 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:07:53.387422 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:07:53.388004 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:07:53.393530 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:07:53.412491 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:07:53.430518 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:07:53.439584 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:07:53.454579 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:07:53.466216 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:07:53.503719 (MainThread): Parsing macros/core.sql
2021-01-25 13:07:53.515777 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:07:53.599202 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:07:53.616970 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:07:53.620763 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:07:53.623545 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:07:53.626475 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:07:53.632327 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:07:53.636661 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:07:53.655822 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:07:53.659995 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:07:53.673072 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:07:53.727116 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:07:53.761907 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:07:53.765891 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:07:53.776502 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:07:53.789333 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:07:53.819230 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:07:53.836744 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:07:53.884027 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:07:53.888276 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:07:53.891925 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:07:53.895908 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:07:53.911456 (MainThread): Partial parsing not enabled
2021-01-25 13:07:54.054464 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:07:54.496357 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:07:54.497858 (MainThread): 
2021-01-25 13:07:54.498600 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:07:54.501898 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:07:54.534092 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:07:54.534442 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:07:54.534699 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:07:54.534966 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:07:55.328044 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:07:55.602437 (ThreadPoolExecutor-0_0): SQL status: OK in 1.07 seconds
2021-01-25 13:07:55.647229 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:07:55.652330 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:07:55.666128 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:07:55.666380 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:07:55.666495 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:07:55.666593 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:07:55.797148 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:07:56.115003 (ThreadPoolExecutor-1_0): SQL status: OK in 0.45 seconds
2021-01-25 13:07:56.137080 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:07:56.137443 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:07:56.140509 (MainThread): 14:07:56 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:07:56.141532 (MainThread): 14:07:56 | 
2021-01-25 13:07:56.172113 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:07:56.183338 (Thread-1): 14:07:56 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:07:56.184124 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:07:56.184449 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:07:56.256961 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:07:56.274800 (Thread-1): finished collecting timing info
2021-01-25 13:07:56.321780 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:07:56.336245 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:07:56.336617 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

with raw as (
select
  cast(regexp_replace("Date mutation", '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
)

select
  cast()
  )

2021-01-25 13:07:56.336804 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:07:56.336974 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:07:56.479330 (Thread-1): Connected to db: None
2021-01-25 13:07:56.581963 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."stg__land_values" as (
    

with raw as (
select
  cast(regexp_replace("Date mutation", '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
)

select
  cast()
  )

2021-01-25 13:07:56.582605 (Thread-1): Rolling back transaction.
2021-01-25 13:07:56.583121 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:07:56.583516 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:07:56.586007 (Thread-1): finished collecting timing info
2021-01-25 13:07:56.587768 (Thread-1): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nwith raw as (\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commu...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nwith raw as (\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commu...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nwith raw as (\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commu...[see log] (1040) (SQLExecDirectW)')
2021-01-25 13:07:56.641570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb244565-8b24-4248-ae16-eff13405dd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a5cc44e0>]}
2021-01-25 13:07:56.647353 (Thread-1): 14:07:56 | 1 of 1 ERROR creating view model @fab4.stg__land_values.............. [ERROR in 0.46s]
2021-01-25 13:07:56.648221 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:07:56.667115 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:07:56.668099 (MainThread): On master: ROLLBACK
2021-01-25 13:07:56.668366 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:07:56.668494 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:07:56.797648 (MainThread): Connected to db: None
2021-01-25 13:07:56.797999 (MainThread): On master: ROLLBACK
2021-01-25 13:07:56.798139 (MainThread): On master: Close
2021-01-25 13:07:56.799802 (MainThread): 14:07:56 | 
2021-01-25 13:07:56.800122 (MainThread): 14:07:56 | Finished running 1 view model in 2.30s.
2021-01-25 13:07:56.800386 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:07:56.800613 (MainThread): Connection 'list_@fab4' was properly closed.
2021-01-25 13:07:56.800773 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:07:56.807855 (MainThread): 
2021-01-25 13:07:56.808256 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 13:07:56.808509 (MainThread): 
2021-01-25 13:07:56.808812 (MainThread): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
2021-01-25 13:07:56.809057 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nwith raw as (\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commu...[see log] (1040) (SQLExecDirectW)')
2021-01-25 13:07:56.809281 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 13:07:56.809767 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a5dc6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a5eed208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a5cff5c0>]}
2021-01-25 13:07:56.810186 (MainThread): Flushing usage events
2021-01-25 13:08:36.993517 (MainThread): Running with dbt=0.18.1
2021-01-25 13:08:37.187747 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:08:37.190097 (MainThread): Tracking: tracking
2021-01-25 13:08:37.208970 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8850c74c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885075ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885076ab00>]}
2021-01-25 13:08:37.292079 (MainThread): Partial parsing not enabled
2021-01-25 13:08:37.293753 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:08:37.302753 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:08:37.308784 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:08:37.315291 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:08:37.347971 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:08:37.353342 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:08:37.401570 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:08:37.403898 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:08:37.409903 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:08:37.410362 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:08:37.416759 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:08:37.436581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:08:37.454768 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:08:37.465347 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:08:37.482309 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:08:37.493445 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:08:37.524696 (MainThread): Parsing macros/core.sql
2021-01-25 13:08:37.532891 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:08:37.622518 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:08:37.644951 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:08:37.650341 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:08:37.653445 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:08:37.656168 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:08:37.661428 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:08:37.666067 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:08:37.690580 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:08:37.695114 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:08:37.710694 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:08:37.776552 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:08:37.820533 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:08:37.825689 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:08:37.838149 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:08:37.850914 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:08:37.878304 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:08:37.892049 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:08:37.933974 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:08:37.937866 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:08:37.941325 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:08:37.944940 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:08:37.960341 (MainThread): Partial parsing not enabled
2021-01-25 13:08:38.083009 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:08:38.519164 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:08:38.520354 (MainThread): 
2021-01-25 13:08:38.521041 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:08:38.524673 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:08:38.553483 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:08:38.553733 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:08:38.553845 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:08:38.553963 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:08:38.704619 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:08:38.889782 (ThreadPoolExecutor-0_0): SQL status: OK in 0.34 seconds
2021-01-25 13:08:38.910006 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:08:38.918830 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:08:38.942853 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:08:38.945411 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:08:38.945728 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:08:38.945883 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:08:39.150876 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:08:39.558811 (ThreadPoolExecutor-1_0): SQL status: OK in 0.61 seconds
2021-01-25 13:08:39.586092 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:08:39.586922 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:08:39.589342 (MainThread): 14:08:39 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:08:39.595861 (MainThread): 14:08:39 | 
2021-01-25 13:08:39.620654 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:08:39.623699 (Thread-1): 14:08:39 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:08:39.624540 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:08:39.626154 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:08:39.695054 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:08:39.696011 (Thread-1): finished collecting timing info
2021-01-25 13:08:39.886894 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:08:39.900151 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:08:39.903160 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace("Date mutation", '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
)
  )

2021-01-25 13:08:39.905611 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:08:39.907281 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:08:40.317893 (Thread-1): Connected to db: None
2021-01-25 13:08:40.375942 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace("Date mutation", '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
)
  )

2021-01-25 13:08:40.376281 (Thread-1): Rolling back transaction.
2021-01-25 13:08:40.376511 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:08:40.376652 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:08:40.377496 (Thread-1): finished collecting timing info
2021-01-25 13:08:40.379326 (Thread-1): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municip...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municip...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municip...[see log] (1040) (SQLExecDirectW)')
2021-01-25 13:08:40.395755 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a16bc2-589b-4123-b100-691fb4a87ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8850625588>]}
2021-01-25 13:08:40.398359 (Thread-1): 14:08:40 | 1 of 1 ERROR creating view model @fab4.stg__land_values.............. [ERROR in 0.77s]
2021-01-25 13:08:40.411509 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:08:40.447217 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:08:40.447581 (MainThread): On master: ROLLBACK
2021-01-25 13:08:40.447756 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:08:40.447868 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:08:40.722905 (MainThread): Connected to db: None
2021-01-25 13:08:40.723337 (MainThread): On master: ROLLBACK
2021-01-25 13:08:40.723542 (MainThread): On master: Close
2021-01-25 13:08:40.724968 (MainThread): 14:08:40 | 
2021-01-25 13:08:40.725922 (MainThread): 14:08:40 | Finished running 1 view model in 2.20s.
2021-01-25 13:08:40.733640 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:08:40.733991 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:08:40.734281 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:08:40.748891 (MainThread): 
2021-01-25 13:08:40.749433 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 13:08:40.749857 (MainThread): 
2021-01-25 13:08:40.767643 (MainThread): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
2021-01-25 13:08:40.768270 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municip...[see log] (1040) (SQLExecDirectW)')
2021-01-25 13:08:40.771619 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 13:08:40.772239 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88504fd2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88505b7278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88506e9e80>]}
2021-01-25 13:08:40.776241 (MainThread): Flushing usage events
2021-01-25 13:09:48.953158 (MainThread): Running with dbt=0.18.1
2021-01-25 13:09:49.076518 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:09:49.077896 (MainThread): Tracking: tracking
2021-01-25 13:09:49.086661 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e46408b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e46408dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e46408e48>]}
2021-01-25 13:09:49.146482 (MainThread): Partial parsing not enabled
2021-01-25 13:09:49.148405 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:09:49.154595 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:09:49.158753 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:09:49.164529 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:09:49.192223 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:09:49.196815 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:09:49.243379 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:09:49.245827 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:09:49.251597 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:09:49.252060 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:09:49.257919 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:09:49.276893 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:09:49.294693 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:09:49.303215 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:09:49.318356 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:09:49.329247 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:09:49.357944 (MainThread): Parsing macros/core.sql
2021-01-25 13:09:49.365475 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:09:49.454564 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:09:49.473939 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:09:49.478262 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:09:49.480993 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:09:49.483861 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:09:49.489032 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:09:49.492468 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:09:49.511570 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:09:49.515568 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:09:49.529351 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:09:49.587167 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:09:49.620680 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:09:49.624829 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:09:49.634771 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:09:49.647251 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:09:49.673627 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:09:49.686896 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:09:49.727041 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:09:49.731484 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:09:49.734679 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:09:49.738169 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:09:49.753819 (MainThread): Partial parsing not enabled
2021-01-25 13:09:49.873988 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:09:50.274716 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:09:50.275891 (MainThread): 
2021-01-25 13:09:50.276574 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:09:50.280222 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:09:50.309483 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:09:50.309776 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:09:50.309905 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:09:50.310003 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:09:50.455475 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:09:50.668155 (ThreadPoolExecutor-0_0): SQL status: OK in 0.36 seconds
2021-01-25 13:09:50.690911 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:09:50.699265 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:09:50.715084 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:09:50.715474 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:09:50.715741 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:09:50.716027 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:09:50.866315 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:09:51.198807 (ThreadPoolExecutor-1_0): SQL status: OK in 0.48 seconds
2021-01-25 13:09:51.218531 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:09:51.218871 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:09:51.221090 (MainThread): 14:09:51 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:09:51.223308 (MainThread): 14:09:51 | 
2021-01-25 13:09:51.250645 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:09:51.258986 (Thread-1): 14:09:51 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:09:51.259749 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:09:51.260053 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:09:51.347345 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:09:51.348122 (Thread-1): finished collecting timing info
2021-01-25 13:09:51.389783 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:09:51.391167 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:09:51.391443 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace("Date mutation", '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
)
  )

2021-01-25 13:09:51.391599 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:09:51.391841 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:09:51.517962 (Thread-1): Connected to db: None
2021-01-25 13:09:51.531771 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace("Date mutation", '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
)
  )

2021-01-25 13:09:51.532556 (Thread-1): Rolling back transaction.
2021-01-25 13:09:51.532901 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:09:51.533144 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:09:51.534289 (Thread-1): finished collecting timing info
2021-01-25 13:09:51.535451 (Thread-1): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municip...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municip...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municip...[see log] (1040) (SQLExecDirectW)')
2021-01-25 13:09:51.538237 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c227aa1-a4ab-458d-9029-705c91f62f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e460fcb00>]}
2021-01-25 13:09:51.542334 (Thread-1): 14:09:51 | 1 of 1 ERROR creating view model @fab4.stg__land_values.............. [ERROR in 0.28s]
2021-01-25 13:09:51.542657 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:09:51.557423 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:09:51.557851 (MainThread): On master: ROLLBACK
2021-01-25 13:09:51.558120 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:09:51.558329 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:09:51.688283 (MainThread): Connected to db: None
2021-01-25 13:09:51.688678 (MainThread): On master: ROLLBACK
2021-01-25 13:09:51.688845 (MainThread): On master: Close
2021-01-25 13:09:51.690267 (MainThread): 14:09:51 | 
2021-01-25 13:09:51.690574 (MainThread): 14:09:51 | Finished running 1 view model in 1.41s.
2021-01-25 13:09:51.690904 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:09:51.691205 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:09:51.691342 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:09:51.699551 (MainThread): 
2021-01-25 13:09:51.700001 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 13:09:51.701172 (MainThread): 
2021-01-25 13:09:51.701479 (MainThread): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
2021-01-25 13:09:51.701687 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    \n\nselect\n  cast(regexp_replace("Date mutation", \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,"Valeur fonciere" as transaction_amount\n  ,"Nature mutation" as transaction_type\n  ,"type de voie" as lane_type\n  ,"Voie" as lane\n  ,"Code postal" as zip_code\n  ,"Commune" as municip...[see log] (1040) (SQLExecDirectW)')
2021-01-25 13:09:51.701879 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 13:09:51.702215 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e462a36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4617e198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4617e080>]}
2021-01-25 13:09:51.702613 (MainThread): Flushing usage events
2021-01-25 13:10:30.914630 (MainThread): Running with dbt=0.18.1
2021-01-25 13:10:31.106642 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:10:31.108671 (MainThread): Tracking: tracking
2021-01-25 13:10:31.135984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40b1749b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40b1749e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40b1749eb8>]}
2021-01-25 13:10:31.238515 (MainThread): Partial parsing not enabled
2021-01-25 13:10:31.242063 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:10:31.255470 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:10:31.262492 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:10:31.272187 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:10:31.312772 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:10:31.320121 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:10:31.388989 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:10:31.392600 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:10:31.401628 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:10:31.402987 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:10:31.412072 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:10:31.444892 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:10:31.475859 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:10:31.489125 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:10:31.509852 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:10:31.523992 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:10:31.555974 (MainThread): Parsing macros/core.sql
2021-01-25 13:10:31.563683 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:10:31.646604 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:10:31.664162 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:10:31.667887 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:10:31.670486 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:10:31.672967 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:10:31.677525 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:10:31.681071 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:10:31.702015 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:10:31.706200 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:10:31.725075 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:10:31.786650 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:10:31.822609 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:10:31.826692 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:10:31.837367 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:10:31.850417 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:10:31.877947 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:10:31.891799 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:10:31.932994 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:10:31.937215 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:10:31.940842 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:10:31.945147 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:10:31.960708 (MainThread): Partial parsing not enabled
2021-01-25 13:10:32.086877 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:10:32.567299 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:10:32.568699 (MainThread): 
2021-01-25 13:10:32.569556 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:10:32.586511 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:10:32.644191 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:10:32.647137 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:10:32.647455 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:10:32.647626 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:10:32.822527 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:10:33.056263 (ThreadPoolExecutor-0_0): SQL status: OK in 0.41 seconds
2021-01-25 13:10:33.085467 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:10:33.094715 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:10:33.114569 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:10:33.114861 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:10:33.115092 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:10:33.115263 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:10:33.285092 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:10:33.832626 (ThreadPoolExecutor-1_0): SQL status: OK in 0.72 seconds
2021-01-25 13:10:33.863163 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:10:33.863540 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:10:33.868269 (MainThread): 14:10:33 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:10:33.875223 (MainThread): 14:10:33 | 
2021-01-25 13:10:33.918733 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:10:33.921488 (Thread-1): 14:10:33 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:10:33.922200 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:10:33.922501 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:10:34.008060 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:10:34.009260 (Thread-1): finished collecting timing info
2021-01-25 13:10:34.137444 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:10:34.140400 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:10:34.143381 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace("Date mutation", '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,"Valeur fonciere" as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 13:10:34.144657 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:10:34.145802 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:10:34.337263 (Thread-1): Connected to db: None
2021-01-25 13:10:34.603860 (Thread-1): SQL status: OK in 0.46 seconds
2021-01-25 13:10:34.615700 (Thread-1): finished collecting timing info
2021-01-25 13:10:34.616494 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:10:34.616881 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:10:34.622388 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54851382-9446-44aa-9949-28dd0a9fbc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40b16ffc18>]}
2021-01-25 13:10:34.633064 (Thread-1): 14:10:34 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.70s]
2021-01-25 13:10:34.639535 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:10:34.723889 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:10:34.724365 (MainThread): On master: ROLLBACK
2021-01-25 13:10:34.724710 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:10:34.725033 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:10:35.036058 (MainThread): Connected to db: None
2021-01-25 13:10:35.036597 (MainThread): On master: ROLLBACK
2021-01-25 13:10:35.036956 (MainThread): On master: Close
2021-01-25 13:10:35.038613 (MainThread): 14:10:35 | 
2021-01-25 13:10:35.041509 (MainThread): 14:10:35 | Finished running 1 view model in 2.47s.
2021-01-25 13:10:35.041834 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:10:35.042014 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:10:35.042158 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:10:35.057306 (MainThread): 
2021-01-25 13:10:35.058025 (MainThread): Completed successfully
2021-01-25 13:10:35.058699 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 13:10:35.064689 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40b13f67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40b1578cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40b14bb0b8>]}
2021-01-25 13:10:35.065522 (MainThread): Flushing usage events
2021-01-25 13:11:04.011235 (MainThread): Running with dbt=0.18.1
2021-01-25 13:11:04.135800 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:11:04.137266 (MainThread): Tracking: tracking
2021-01-25 13:11:04.147393 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4286979080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4286980da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4286980e10>]}
2021-01-25 13:11:04.207284 (MainThread): Partial parsing not enabled
2021-01-25 13:11:04.209664 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:11:04.216538 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:11:04.220526 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:11:04.225926 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:11:04.255013 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:11:04.259799 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:11:04.310175 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:11:04.312857 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:11:04.318876 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:11:04.319447 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:11:04.325606 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:11:04.344885 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:11:04.362866 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:11:04.372269 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:11:04.387705 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:11:04.398888 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:11:04.428883 (MainThread): Parsing macros/core.sql
2021-01-25 13:11:04.436471 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:11:04.518835 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:11:04.537023 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:11:04.540678 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:11:04.543295 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:11:04.545536 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:11:04.549837 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:11:04.553609 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:11:04.572112 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:11:04.576597 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:11:04.588669 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:11:04.641629 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:11:04.675642 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:11:04.679483 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:11:04.689427 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:11:04.701949 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:11:04.729583 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:11:04.743402 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:11:04.785112 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:11:04.789236 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:11:04.792969 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:11:04.797760 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:11:04.813493 (MainThread): Partial parsing not enabled
2021-01-25 13:11:04.931882 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:11:05.398577 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:11:05.400041 (MainThread): 
2021-01-25 13:11:05.400793 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:11:05.404716 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:11:05.446433 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:11:05.446751 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:11:05.446991 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:11:05.447203 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:11:05.599522 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:11:05.872567 (ThreadPoolExecutor-0_0): SQL status: OK in 0.43 seconds
2021-01-25 13:11:05.916652 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:11:05.941158 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:11:05.984979 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:11:05.985298 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:11:05.985483 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:11:05.985626 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:11:06.136544 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:11:06.655426 (ThreadPoolExecutor-1_0): SQL status: OK in 0.67 seconds
2021-01-25 13:11:06.703088 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:11:06.703469 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:11:06.705502 (MainThread): 14:11:06 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:11:06.706790 (MainThread): 14:11:06 | 
2021-01-25 13:11:06.742778 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:11:06.745480 (Thread-1): 14:11:06 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:11:06.746261 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:11:06.746618 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:11:06.797443 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:11:06.798095 (Thread-1): finished collecting timing info
2021-01-25 13:11:06.845713 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:11:06.846479 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:11:06.846895 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace("Date mutation", '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace("Valeur fonciere", ',', '.') as decimal) as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 13:11:06.847113 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:11:06.847244 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:11:07.024762 (Thread-1): Connected to db: None
2021-01-25 13:11:07.194776 (Thread-1): SQL status: OK in 0.35 seconds
2021-01-25 13:11:07.217842 (Thread-1): finished collecting timing info
2021-01-25 13:11:07.218686 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:11:07.218958 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:11:07.221773 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3efbb5b-5854-4b15-8c61-922a693ecfa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4286673ac8>]}
2021-01-25 13:11:07.225365 (Thread-1): 14:11:07 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.48s]
2021-01-25 13:11:07.225829 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:11:07.327406 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:11:07.327812 (MainThread): On master: ROLLBACK
2021-01-25 13:11:07.328075 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:11:07.328297 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:11:07.644998 (MainThread): Connected to db: None
2021-01-25 13:11:07.645377 (MainThread): On master: ROLLBACK
2021-01-25 13:11:07.645563 (MainThread): On master: Close
2021-01-25 13:11:07.648046 (MainThread): 14:11:07 | 
2021-01-25 13:11:07.648398 (MainThread): 14:11:07 | Finished running 1 view model in 2.25s.
2021-01-25 13:11:07.648605 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:11:07.648776 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:11:07.648925 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:11:07.664473 (MainThread): 
2021-01-25 13:11:07.664877 (MainThread): Completed successfully
2021-01-25 13:11:07.665157 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 13:11:07.665566 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42865eb780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42867a9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42866966d8>]}
2021-01-25 13:11:07.666039 (MainThread): Flushing usage events
2021-01-25 13:11:54.647635 (MainThread): Running with dbt=0.18.1
2021-01-25 13:11:54.770225 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:11:54.771837 (MainThread): Tracking: tracking
2021-01-25 13:11:54.781303 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4722dc0ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4722dc0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4722dc0ef0>]}
2021-01-25 13:11:54.840185 (MainThread): Partial parsing not enabled
2021-01-25 13:11:54.841915 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:11:54.848050 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:11:54.852398 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:11:54.857081 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:11:54.883095 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:11:54.887845 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:11:54.934841 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:11:54.937440 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:11:54.943818 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:11:54.944338 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:11:54.949950 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:11:54.969177 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:11:54.987253 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:11:54.995934 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:11:55.011215 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:11:55.022407 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:11:55.051850 (MainThread): Parsing macros/core.sql
2021-01-25 13:11:55.059438 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:11:55.141680 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:11:55.158799 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:11:55.163037 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:11:55.165598 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:11:55.168178 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:11:55.172553 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:11:55.176253 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:11:55.198796 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:11:55.202797 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:11:55.215130 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:11:55.268029 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:11:55.301700 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:11:55.306179 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:11:55.316276 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:11:55.328992 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:11:55.355578 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:11:55.369882 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:11:55.410517 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:11:55.414854 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:11:55.418295 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:11:55.422096 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:11:55.437780 (MainThread): Partial parsing not enabled
2021-01-25 13:11:55.556983 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:11:56.070428 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:11:56.075223 (MainThread): 
2021-01-25 13:11:56.076133 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:11:56.087260 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:11:56.138664 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:11:56.139278 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:11:56.139572 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:11:56.139793 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:11:56.301049 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:11:56.593497 (ThreadPoolExecutor-0_0): SQL status: OK in 0.45 seconds
2021-01-25 13:11:56.635664 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:11:56.648339 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:11:56.684294 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:11:56.684583 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:11:56.684741 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:11:56.684879 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:11:56.899464 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:11:57.422031 (ThreadPoolExecutor-1_0): SQL status: OK in 0.74 seconds
2021-01-25 13:11:57.466331 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:11:57.470085 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:11:57.477103 (MainThread): 14:11:57 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:11:57.477424 (MainThread): 14:11:57 | 
2021-01-25 13:11:57.499487 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:11:57.501808 (Thread-1): 14:11:57 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:11:57.502490 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:11:57.502797 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:11:57.592277 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:11:57.606163 (Thread-1): finished collecting timing info
2021-01-25 13:11:57.736428 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:11:57.738247 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:11:57.738646 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,"Nature mutation" as transaction_type
  ,"type de voie" as lane_type
  ,"Voie" as lane
  ,"Code postal" as zip_code
  ,"Commune" as municipality
  ,"Code departement" as department_code
  ,"Code commune" as municipality_code
  ,"Code commune" as code_commune
  ,"Nombre de lots" as lots_count
  ,"Type local" as premises_type
  ,"Surface reelle bati" as built_surface
  ,"Surface terrain" as land_surface
  ,"Nombre pieces principales" as main_rooms_count
  ,"Nature culture" as crop_code
  ,"Nature culture speciale" as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 13:11:57.738964 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:11:57.739241 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:11:58.063510 (Thread-1): Connected to db: None
2021-01-25 13:11:58.252981 (Thread-1): SQL status: OK in 0.51 seconds
2021-01-25 13:11:58.271968 (Thread-1): finished collecting timing info
2021-01-25 13:11:58.279232 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:11:58.279717 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:11:58.291014 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98281b1c-8a45-4884-adc3-f147e9c6823d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4722be6ba8>]}
2021-01-25 13:11:58.294632 (Thread-1): 14:11:58 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.79s]
2021-01-25 13:11:58.299248 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:11:58.320466 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:11:58.320937 (MainThread): On master: ROLLBACK
2021-01-25 13:11:58.321270 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:11:58.321589 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:11:58.587983 (MainThread): Connected to db: None
2021-01-25 13:11:58.588512 (MainThread): On master: ROLLBACK
2021-01-25 13:11:58.588815 (MainThread): On master: Close
2021-01-25 13:11:58.590257 (MainThread): 14:11:58 | 
2021-01-25 13:11:58.593844 (MainThread): 14:11:58 | Finished running 1 view model in 2.51s.
2021-01-25 13:11:58.594225 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:11:58.594478 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:11:58.594654 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:11:58.624160 (MainThread): 
2021-01-25 13:11:58.624773 (MainThread): Completed successfully
2021-01-25 13:11:58.627166 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 13:11:58.627915 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4722a2b898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4722b35e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4722be6ba8>]}
2021-01-25 13:11:58.628613 (MainThread): Flushing usage events
2021-01-25 13:13:51.867416 (MainThread): Running with dbt=0.18.1
2021-01-25 13:13:51.992834 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:13:51.996247 (MainThread): Tracking: tracking
2021-01-25 13:13:52.006625 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed15edd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed1100e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed1100eb8>]}
2021-01-25 13:13:52.065964 (MainThread): Partial parsing not enabled
2021-01-25 13:13:52.068313 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:13:52.075134 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:13:52.078713 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:13:52.083100 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:13:52.111131 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:13:52.116307 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:13:52.163771 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:13:52.166356 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:13:52.172382 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:13:52.172888 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:13:52.178984 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:13:52.197810 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:13:52.215467 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:13:52.224429 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:13:52.239376 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:13:52.250634 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:13:52.279600 (MainThread): Parsing macros/core.sql
2021-01-25 13:13:52.287876 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:13:52.371638 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:13:52.390898 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:13:52.395488 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:13:52.397985 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:13:52.400272 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:13:52.404747 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:13:52.408739 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:13:52.426812 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:13:52.431192 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:13:52.443706 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:13:52.500335 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:13:52.534045 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:13:52.538361 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:13:52.548317 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:13:52.560709 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:13:52.589467 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:13:52.603663 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:13:52.646328 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:13:52.650803 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:13:52.655142 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:13:52.659001 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:13:52.674674 (MainThread): Partial parsing not enabled
2021-01-25 13:13:52.793805 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:13:53.336439 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:13:53.337688 (MainThread): 
2021-01-25 13:13:53.338344 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:13:53.341337 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:13:53.367016 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:13:53.367319 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:13:53.367463 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:13:53.367585 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:13:53.533930 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:13:53.713698 (ThreadPoolExecutor-0_0): SQL status: OK in 0.35 seconds
2021-01-25 13:13:53.750012 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:13:53.765810 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:13:53.787678 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:13:53.787972 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:13:53.788145 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:13:53.788278 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:13:53.955506 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:13:54.451659 (ThreadPoolExecutor-1_0): SQL status: OK in 0.66 seconds
2021-01-25 13:13:54.470085 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:13:54.470420 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:13:54.472453 (MainThread): 14:13:54 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:13:54.472799 (MainThread): 14:13:54 | 
2021-01-25 13:13:54.503696 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:13:54.506035 (Thread-1): 14:13:54 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:13:54.506742 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:13:54.507793 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:13:54.622300 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:13:54.633486 (Thread-1): finished collecting timing info
2021-01-25 13:13:54.697627 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:13:54.698461 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:13:54.698787 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transaction_type
  ,nullif("type de voie", '') as lane_type
  ,nullif("Voie", '') as lane
  ,nullif("Code postal", '') as zip_code
  ,nullif("Commune", '') as municipality
  ,nullif("Code departement", '') as department_code
  ,nullif("Code commune", '') as municipality_code
  ,nullif("Code commune", '') as code_commune
  ,nullif("Nombre de lots", '') as lots_count
  ,nullif("Type local", '') as premises_type
  ,nullif("Surface reelle bati", '') as built_surface
  ,nullif("Surface terrain", '') as land_surface
  ,nullif("Nombre pieces principales", '') as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
  ,nullif("Nature culture speciale", '') as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 13:13:54.698982 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:13:54.699161 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:13:54.879560 (Thread-1): Connected to db: None
2021-01-25 13:13:55.255460 (Thread-1): SQL status: OK in 0.56 seconds
2021-01-25 13:13:55.289000 (Thread-1): finished collecting timing info
2021-01-25 13:13:55.292185 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:13:55.293097 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:13:55.302520 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd12b7d-81df-4ea6-9353-6275909b0aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed0d822b0>]}
2021-01-25 13:13:55.307423 (Thread-1): 14:13:55 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.79s]
2021-01-25 13:13:55.307912 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:13:55.410006 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:13:55.410517 (MainThread): On master: ROLLBACK
2021-01-25 13:13:55.410870 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:13:55.411275 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:13:55.644257 (MainThread): Connected to db: None
2021-01-25 13:13:55.644792 (MainThread): On master: ROLLBACK
2021-01-25 13:13:55.645149 (MainThread): On master: Close
2021-01-25 13:13:55.648474 (MainThread): 14:13:55 | 
2021-01-25 13:13:55.648925 (MainThread): 14:13:55 | Finished running 1 view model in 2.31s.
2021-01-25 13:13:55.649294 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:13:55.649604 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:13:55.649891 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:13:55.673072 (MainThread): 
2021-01-25 13:13:55.673580 (MainThread): Completed successfully
2021-01-25 13:13:55.673975 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 13:13:55.674518 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed0f4a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed1a38780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed0d822b0>]}
2021-01-25 13:13:55.675131 (MainThread): Flushing usage events
2021-01-25 13:18:21.829045 (MainThread): Running with dbt=0.18.1
2021-01-25 13:18:21.956118 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:18:21.957676 (MainThread): Tracking: tracking
2021-01-25 13:18:21.966853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8995899080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89958a0dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89958a0e48>]}
2021-01-25 13:18:22.026365 (MainThread): Partial parsing not enabled
2021-01-25 13:18:22.028060 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:18:22.034180 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:18:22.038728 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:18:22.043997 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:18:22.069792 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:18:22.075028 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:18:22.121624 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:18:22.124275 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:18:22.130453 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:18:22.130991 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:18:22.136614 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:18:22.155514 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:18:22.173245 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:18:22.181880 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:18:22.196948 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:18:22.208674 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:18:22.239126 (MainThread): Parsing macros/core.sql
2021-01-25 13:18:22.248101 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:18:22.335613 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:18:22.353387 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:18:22.357212 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:18:22.359791 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:18:22.362001 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:18:22.366223 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:18:22.370919 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:18:22.389404 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:18:22.393477 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:18:22.406148 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:18:22.459686 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:18:22.493889 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:18:22.497596 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:18:22.508241 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:18:22.520416 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:18:22.547963 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:18:22.563409 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:18:22.604484 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:18:22.608726 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:18:22.612173 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:18:22.616173 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:18:22.631825 (MainThread): Partial parsing not enabled
2021-01-25 13:18:22.753906 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:18:23.208298 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:18:23.209508 (MainThread): 
2021-01-25 13:18:23.210187 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:18:23.213880 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:18:23.241280 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:18:23.241601 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:18:23.241769 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:18:23.241908 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:18:23.451844 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:18:23.629634 (ThreadPoolExecutor-0_0): SQL status: OK in 0.39 seconds
2021-01-25 13:18:23.687679 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:18:23.703377 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:18:23.749245 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:18:23.749578 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:18:23.749782 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:18:23.749928 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:18:24.071314 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:18:24.595427 (ThreadPoolExecutor-1_0): SQL status: OK in 0.85 seconds
2021-01-25 13:18:24.616682 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:18:24.623215 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:18:24.625407 (MainThread): 14:18:24 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:18:24.625838 (MainThread): 14:18:24 | 
2021-01-25 13:18:24.664464 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:18:24.667498 (Thread-1): 14:18:24 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:18:24.668488 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:18:24.671542 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:18:24.720935 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:18:24.721632 (Thread-1): finished collecting timing info
2021-01-25 13:18:24.769711 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:18:24.770643 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:18:24.771047 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transaction_type
  ,nullif("type de voie", '') as lane_type
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 6, '0') as zip_code
  ,nullif("Commune", '') as municipality
  ,lpad(nullif("Code departement", ''), 2, '0') as department_code
  ,lpad(nullif("Code commune", ''), 5, '0') as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("Type local", '') as premises_type
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
  ,nullif("Nature culture speciale", '') as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 13:18:24.771339 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:18:24.771561 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:18:24.910187 (Thread-1): Connected to db: None
2021-01-25 13:18:25.217910 (Thread-1): SQL status: OK in 0.45 seconds
2021-01-25 13:18:25.244312 (Thread-1): finished collecting timing info
2021-01-25 13:18:25.255241 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:18:25.255701 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:18:25.257735 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b764627b-e40f-4760-8941-cc2f0dc79ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f899572fa58>]}
2021-01-25 13:18:25.269358 (Thread-1): 14:18:25 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.59s]
2021-01-25 13:18:25.269885 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:18:25.368812 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:18:25.369244 (MainThread): On master: ROLLBACK
2021-01-25 13:18:25.369549 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:18:25.369824 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:18:25.545895 (MainThread): Connected to db: None
2021-01-25 13:18:25.546399 (MainThread): On master: ROLLBACK
2021-01-25 13:18:25.546746 (MainThread): On master: Close
2021-01-25 13:18:25.548547 (MainThread): 14:18:25 | 
2021-01-25 13:18:25.548992 (MainThread): 14:18:25 | Finished running 1 view model in 2.34s.
2021-01-25 13:18:25.549371 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:18:25.549601 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:18:25.549788 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:18:25.557837 (MainThread): 
2021-01-25 13:18:25.558388 (MainThread): Completed successfully
2021-01-25 13:18:25.558778 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 13:18:25.559512 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f899550bb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f899575d7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f899554e630>]}
2021-01-25 13:18:25.560109 (MainThread): Flushing usage events
2021-01-25 13:22:03.431008 (MainThread): Running with dbt=0.18.1
2021-01-25 13:22:03.556843 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:22:03.558386 (MainThread): Tracking: tracking
2021-01-25 13:22:03.567855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edb685d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edb198e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edb198ef0>]}
2021-01-25 13:22:03.629116 (MainThread): Partial parsing not enabled
2021-01-25 13:22:03.631648 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:22:03.639777 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:22:03.646619 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:22:03.652520 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:22:03.684489 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:22:03.689224 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:22:03.737622 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:22:03.740219 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:22:03.746348 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:22:03.747211 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:22:03.753076 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:22:03.772848 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:22:03.791019 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:22:03.799913 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:22:03.815476 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:22:03.826810 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:22:03.855833 (MainThread): Parsing macros/core.sql
2021-01-25 13:22:03.863951 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:22:03.947543 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:22:03.966089 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:22:03.970332 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:22:03.972856 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:22:03.975116 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:22:03.979877 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:22:03.983583 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:22:04.002240 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:22:04.006545 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:22:04.019686 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:22:04.073780 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:22:04.107286 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:22:04.111103 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:22:04.121833 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:22:04.134622 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:22:04.162059 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:22:04.175658 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:22:04.217928 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:22:04.222025 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:22:04.225432 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:22:04.229571 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:22:04.244971 (MainThread): Partial parsing not enabled
2021-01-25 13:22:04.364703 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:22:04.811187 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:22:04.812417 (MainThread): 
2021-01-25 13:22:04.813073 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:22:04.816636 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:22:04.842974 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:22:04.843270 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:22:04.843428 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:22:04.843550 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:22:05.066648 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:22:05.298482 (ThreadPoolExecutor-0_0): SQL status: OK in 0.45 seconds
2021-01-25 13:22:05.332873 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:22:05.343226 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:22:05.388083 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:22:05.388609 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:22:05.388903 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:22:05.389085 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:22:05.617028 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:22:06.181586 (ThreadPoolExecutor-1_0): SQL status: OK in 0.79 seconds
2021-01-25 13:22:06.208456 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:22:06.209729 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:22:06.215304 (MainThread): 14:22:06 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:22:06.216165 (MainThread): 14:22:06 | 
2021-01-25 13:22:06.259497 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:22:06.265777 (Thread-1): 14:22:06 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:22:06.267637 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:22:06.268793 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:22:06.383308 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:22:06.392138 (Thread-1): finished collecting timing info
2021-01-25 13:22:06.508546 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:22:06.509272 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:22:06.509551 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transaction_type
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 5, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,nullif("Commune", '') as municipality
  ,lpad(nullif("Code departement", ''), 2, '0') as department_code
  ,lpad(nullif("Code commune", ''), 5, '0') as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("Type local", '') as premises_type
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
  ,nullif("Nature culture speciale", '') as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 13:22:06.509707 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:22:06.509825 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:22:06.668756 (Thread-1): Connected to db: None
2021-01-25 13:22:06.996269 (Thread-1): SQL status: OK in 0.49 seconds
2021-01-25 13:22:07.010473 (Thread-1): finished collecting timing info
2021-01-25 13:22:07.016704 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:22:07.017024 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:22:07.027114 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfd1321c-7e12-4f54-85b6-49d52a4129b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edae8bb00>]}
2021-01-25 13:22:07.030647 (Thread-1): 14:22:07 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.75s]
2021-01-25 13:22:07.031175 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:22:07.072974 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:22:07.073399 (MainThread): On master: ROLLBACK
2021-01-25 13:22:07.073725 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:22:07.073949 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:22:07.323474 (MainThread): Connected to db: None
2021-01-25 13:22:07.323856 (MainThread): On master: ROLLBACK
2021-01-25 13:22:07.324048 (MainThread): On master: Close
2021-01-25 13:22:07.325426 (MainThread): 14:22:07 | 
2021-01-25 13:22:07.326769 (MainThread): 14:22:07 | Finished running 1 view model in 2.51s.
2021-01-25 13:22:07.327123 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:22:07.327292 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:22:07.327409 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:22:07.338557 (MainThread): 
2021-01-25 13:22:07.343150 (MainThread): Completed successfully
2021-01-25 13:22:07.343675 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 13:22:07.344427 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edaea2eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edae887f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edae467f0>]}
2021-01-25 13:22:07.345121 (MainThread): Flushing usage events
2021-01-25 13:23:30.822069 (MainThread): Running with dbt=0.18.1
2021-01-25 13:23:30.988233 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:23:30.991294 (MainThread): Tracking: tracking
2021-01-25 13:23:31.018833 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbec7ddcf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbec2f0dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbec2f0e48>]}
2021-01-25 13:23:31.125093 (MainThread): Partial parsing not enabled
2021-01-25 13:23:31.127378 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:23:31.134489 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:23:31.138413 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:23:31.143427 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:23:31.173882 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:23:31.179081 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:23:31.226283 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:23:31.228993 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:23:31.235243 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:23:31.235753 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:23:31.241331 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:23:31.260076 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:23:31.277970 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:23:31.286776 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:23:31.302043 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:23:31.313341 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:23:31.342060 (MainThread): Parsing macros/core.sql
2021-01-25 13:23:31.350158 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:23:31.432887 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:23:31.450420 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:23:31.454137 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:23:31.456663 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:23:31.458958 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:23:31.463768 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:23:31.467289 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:23:31.485715 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:23:31.489709 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:23:31.505980 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:23:31.559936 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:23:31.593500 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:23:31.597424 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:23:31.607587 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:23:31.619616 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:23:31.647518 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:23:31.660511 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:23:31.702736 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:23:31.707325 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:23:31.710714 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:23:31.715030 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:23:31.730649 (MainThread): Partial parsing not enabled
2021-01-25 13:23:31.849888 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:23:32.371776 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:23:32.373242 (MainThread): 
2021-01-25 13:23:32.374057 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:23:32.395690 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:23:32.437548 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:23:32.438014 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:23:32.438316 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:23:32.438485 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:23:32.596936 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:23:32.927099 (ThreadPoolExecutor-0_0): SQL status: OK in 0.49 seconds
2021-01-25 13:23:32.958133 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:23:32.971930 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:23:33.011035 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:23:33.011364 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:23:33.011852 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:23:33.012009 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:23:33.211660 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:23:33.690376 (ThreadPoolExecutor-1_0): SQL status: OK in 0.68 seconds
2021-01-25 13:23:33.712380 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:23:33.713751 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:23:33.716674 (MainThread): 14:23:33 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:23:33.717100 (MainThread): 14:23:33 | 
2021-01-25 13:23:33.736858 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:23:33.740084 (Thread-1): 14:23:33 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:23:33.740980 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:23:33.741396 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:23:33.793973 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:23:33.794630 (Thread-1): finished collecting timing info
2021-01-25 13:23:33.845147 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:23:33.845893 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:23:33.846297 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transaction_type
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 5, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,nullif("Commune", '') as municipality
  ,lpad(nullif("Code departement", ''), 2, '0') as department_code
  ,lpad(nullif("Code commune", ''), 3, '0') as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("Type local", '') as premises_type
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
  ,nullif("Nature culture speciale", '') as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 13:23:33.846469 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:23:33.846584 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:23:34.027251 (Thread-1): Connected to db: None
2021-01-25 13:23:34.231963 (Thread-1): SQL status: OK in 0.39 seconds
2021-01-25 13:23:34.252591 (Thread-1): finished collecting timing info
2021-01-25 13:23:34.258793 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:23:34.259554 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:23:34.262829 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ead438e-6347-4c24-bc3d-70adeec23ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbec1a1da0>]}
2021-01-25 13:23:34.265781 (Thread-1): 14:23:34 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.52s]
2021-01-25 13:23:34.271254 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:23:34.356157 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:23:34.356603 (MainThread): On master: ROLLBACK
2021-01-25 13:23:34.356922 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:23:34.357229 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:23:34.571801 (MainThread): Connected to db: None
2021-01-25 13:23:34.572298 (MainThread): On master: ROLLBACK
2021-01-25 13:23:34.572626 (MainThread): On master: Close
2021-01-25 13:23:34.574342 (MainThread): 14:23:34 | 
2021-01-25 13:23:34.574763 (MainThread): 14:23:34 | Finished running 1 view model in 2.20s.
2021-01-25 13:23:34.575286 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:23:34.575593 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:23:34.575908 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:23:34.605044 (MainThread): 
2021-01-25 13:23:34.605505 (MainThread): Completed successfully
2021-01-25 13:23:34.605900 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 13:23:34.606476 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbebf5b7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbebf9def0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbec1a1da0>]}
2021-01-25 13:23:34.611400 (MainThread): Flushing usage events
2021-01-25 13:26:49.024054 (MainThread): Running with dbt=0.18.1
2021-01-25 13:26:49.149481 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 13:26:49.151116 (MainThread): Tracking: tracking
2021-01-25 13:26:49.160643 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b65634cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b65148e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b65148eb8>]}
2021-01-25 13:26:49.219986 (MainThread): Partial parsing not enabled
2021-01-25 13:26:49.221873 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:26:49.228144 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:26:49.232824 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:26:49.238436 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:26:49.264308 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:26:49.269460 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:26:49.317078 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:26:49.319692 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:26:49.325730 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:26:49.326245 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:26:49.332363 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:26:49.351007 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:26:49.368402 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:26:49.377607 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:26:49.392915 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:26:49.404788 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:26:49.434915 (MainThread): Parsing macros/core.sql
2021-01-25 13:26:49.442475 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:26:49.530892 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:26:49.548607 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:26:49.552914 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:26:49.555489 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:26:49.558081 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:26:49.562346 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:26:49.565899 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:26:49.584646 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:26:49.588908 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:26:49.602300 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:26:49.656152 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:26:49.690168 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:26:49.694380 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:26:49.704788 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:26:49.717268 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:26:49.745432 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:26:49.758976 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:26:49.799638 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:26:49.804338 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:26:49.808194 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:26:49.811961 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:26:49.827662 (MainThread): Partial parsing not enabled
2021-01-25 13:26:49.946409 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:26:50.439413 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source
2021-01-25 13:26:50.440910 (MainThread): 
2021-01-25 13:26:50.441739 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:26:50.446498 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:26:50.489332 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:26:50.489659 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:26:50.489819 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:26:50.490011 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:26:50.718453 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:26:50.873256 (ThreadPoolExecutor-0_0): SQL status: OK in 0.38 seconds
2021-01-25 13:26:50.931534 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:26:50.940165 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:26:50.984980 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:26:50.985274 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:26:50.985497 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:26:50.985696 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:26:51.184727 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:26:51.712761 (ThreadPoolExecutor-1_0): SQL status: OK in 0.73 seconds
2021-01-25 13:26:51.744160 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:26:51.744482 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:26:51.746227 (MainThread): 14:26:51 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:26:51.746567 (MainThread): 14:26:51 | 
2021-01-25 13:26:51.790534 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 13:26:51.792689 (Thread-1): 14:26:51 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 13:26:51.793328 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:26:51.793582 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 13:26:51.854131 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:26:51.854842 (Thread-1): finished collecting timing info
2021-01-25 13:26:51.904722 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 13:26:51.905518 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:26:51.905804 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transaction_type
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,nullif("Commune", '') as municipality
  ,lpad(nullif("Code departement", ''), 2, '0') as department_code
  ,lpad(nullif("Code commune", ''), 3, '0') as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("Type local", '') as premises_type
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
  ,nullif("Nature culture speciale", '') as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 13:26:51.906005 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:26:51.906264 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:26:52.042597 (Thread-1): Connected to db: None
2021-01-25 13:26:52.339867 (Thread-1): SQL status: OK in 0.43 seconds
2021-01-25 13:26:52.360016 (Thread-1): finished collecting timing info
2021-01-25 13:26:52.371083 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 13:26:52.371497 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 13:26:52.373692 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '591f2311-314f-4f81-833c-553f60a220f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b64ffaa20>]}
2021-01-25 13:26:52.385678 (Thread-1): 14:26:52 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.58s]
2021-01-25 13:26:52.391106 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 13:26:52.492099 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:26:52.492563 (MainThread): On master: ROLLBACK
2021-01-25 13:26:52.492907 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:26:52.493264 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:26:52.762027 (MainThread): Connected to db: None
2021-01-25 13:26:52.762496 (MainThread): On master: ROLLBACK
2021-01-25 13:26:52.766604 (MainThread): On master: Close
2021-01-25 13:26:52.768253 (MainThread): 14:26:52 | 
2021-01-25 13:26:52.768651 (MainThread): 14:26:52 | Finished running 1 view model in 2.33s.
2021-01-25 13:26:52.768893 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:26:52.769054 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 13:26:52.769185 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 13:26:52.788736 (MainThread): 
2021-01-25 13:26:52.789306 (MainThread): Completed successfully
2021-01-25 13:26:52.789665 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 13:26:52.790162 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b64db3cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b65a7cac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b64e52a20>]}
2021-01-25 13:26:52.790695 (MainThread): Flushing usage events
2021-01-25 13:54:49.277247 (MainThread): Running with dbt=0.18.1
2021-01-25 13:54:49.631585 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 13:54:49.654965 (MainThread): Tracking: tracking
2021-01-25 13:54:49.697849 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51ffb5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51fad9e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51fad9eb8>]}
2021-01-25 13:54:49.759317 (MainThread): Partial parsing not enabled
2021-01-25 13:54:49.775464 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:54:49.806973 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:54:49.830186 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 13:54:49.838239 (MainThread): Parsing macros/helpers.sql
2021-01-25 13:54:49.867464 (MainThread): Parsing macros/catalog.sql
2021-01-25 13:54:49.872418 (MainThread): Parsing macros/adapters.sql
2021-01-25 13:54:49.921308 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 13:54:49.924458 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 13:54:49.930409 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 13:54:49.931308 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 13:54:49.937907 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 13:54:49.957379 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:54:49.975804 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:54:49.984904 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 13:54:50.000486 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:54:50.012265 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:54:50.052471 (MainThread): Parsing macros/core.sql
2021-01-25 13:54:50.063579 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 13:54:50.150286 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 13:54:50.169368 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 13:54:50.173233 (MainThread): Parsing macros/etc/query.sql
2021-01-25 13:54:50.176004 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 13:54:50.178395 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 13:54:50.182868 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 13:54:50.187323 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 13:54:50.208619 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 13:54:50.213298 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 13:54:50.226672 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 13:54:50.280349 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 13:54:50.315968 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 13:54:50.320109 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 13:54:50.330366 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 13:54:50.342817 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 13:54:50.370526 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 13:54:50.385416 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 13:54:50.429212 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 13:54:50.433568 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 13:54:50.437092 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 13:54:50.440950 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 13:54:50.456617 (MainThread): Partial parsing not enabled
2021-01-25 13:54:50.612505 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 13:54:51.129429 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 13:54:51.130716 (MainThread): 
2021-01-25 13:54:51.131586 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:54:51.136137 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 13:54:51.175568 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 13:54:51.175919 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 13:54:51.176091 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 13:54:51.176220 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:54:51.929141 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 13:54:52.105975 (ThreadPoolExecutor-0_0): SQL status: OK in 0.93 seconds
2021-01-25 13:54:52.168205 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 13:54:52.203606 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 13:54:52.242001 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 13:54:52.243164 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 13:54:52.244369 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 13:54:52.246061 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:54:52.440425 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 13:54:52.862635 (ThreadPoolExecutor-1_0): SQL status: OK in 0.62 seconds
2021-01-25 13:54:52.908517 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 13:54:52.908930 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 13:54:52.911214 (MainThread): 14:54:52 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 13:54:52.911777 (MainThread): 14:54:52 | 
2021-01-25 13:54:52.975551 (Thread-1): Began running node seed.subsurface.crop_codes
2021-01-25 13:54:52.978265 (Thread-1): 14:54:52 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 13:54:52.979201 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 13:54:52.979627 (Thread-1): finished collecting timing info
2021-01-25 13:54:53.194922 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 13:54:53.207580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f481a94-8161-4f37-b1d1-189f19c55b80', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51f7dbf60>]}
2021-01-25 13:54:53.283063 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 13:54:53.291687 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 13:54:53.298681 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 13:54:53.299081 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 13:54:53.299425 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:54:53.543154 (Thread-1): Connected to db: None
2021-01-25 13:54:54.132222 (Thread-1): SQL status: OK in 0.83 seconds
2021-01-25 13:54:54.132987 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 13:54:54.133701 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 13:54:54.146161 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 13:54:54.146481 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 13:54:54.817782 (Thread-1): SQL status: OK in 0.67 seconds
2021-01-25 13:54:54.818745 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 13:54:54.902486 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 13:54:54.902994 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 13:54:54.934451 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-25 13:54:54.973371 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 13:54:54.992710 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 13:54:54.993158 (Thread-1): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 13:54:55.405660 (Thread-1): Error running SQL: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 13:54:55.406292 (Thread-1): Rolling back transaction.
2021-01-25 13:54:55.407405 (Thread-1): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 13:54:55.407823 (Thread-1): On seed.subsurface.crop_codes: Close
2021-01-25 13:54:55.411688 (Thread-1): finished collecting timing info
2021-01-25 13:54:55.418440 (Thread-1): Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 87, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 13:54:55.724301 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f481a94-8161-4f37-b1d1-189f19c55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51f795b70>]}
2021-01-25 13:54:55.725180 (Thread-1): 14:54:55 | 1 of 1 ERROR loading seed file no_schema.crop_codes.................. [ERROR in 2.75s]
2021-01-25 13:54:55.726095 (Thread-1): Finished running node seed.subsurface.crop_codes
2021-01-25 13:54:55.796507 (MainThread): Acquiring new dremio connection "master".
2021-01-25 13:54:55.797062 (MainThread): On master: ROLLBACK
2021-01-25 13:54:55.797458 (MainThread): Opening a new connection, currently in state init
2021-01-25 13:54:55.797858 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 13:54:55.998743 (MainThread): Connected to db: None
2021-01-25 13:54:55.999130 (MainThread): On master: ROLLBACK
2021-01-25 13:54:55.999303 (MainThread): On master: Close
2021-01-25 13:54:56.000843 (MainThread): 14:54:55 | 
2021-01-25 13:54:56.002324 (MainThread): 14:54:55 | Finished running 1 seed in 4.87s.
2021-01-25 13:54:56.002668 (MainThread): Connection 'master' was properly closed.
2021-01-25 13:54:56.002866 (MainThread): Connection 'list_@fab4' was properly closed.
2021-01-25 13:54:56.003056 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 13:54:56.017499 (MainThread): 
2021-01-25 13:54:56.018072 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 13:54:56.018479 (MainThread): 
2021-01-25 13:54:56.018803 (MainThread): Runtime Error in seed crop_codes (data/crop_codes.csv)
2021-01-25 13:54:56.019215 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 13:54:56.019706 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 13:54:56.020400 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51f811358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51f811828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51f811e80>]}
2021-01-25 13:54:56.021062 (MainThread): Flushing usage events
2021-01-25 14:12:34.555866 (MainThread): Running with dbt=0.18.1
2021-01-25 14:12:36.019985 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 14:12:36.046476 (MainThread): Tracking: tracking
2021-01-25 14:12:36.145909 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea32869748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea32870d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea32870da0>]}
2021-01-25 14:12:36.677986 (MainThread): Partial parsing not enabled
2021-01-25 14:12:36.693607 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 14:12:36.754913 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 14:12:36.820291 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 14:12:36.855472 (MainThread): Parsing macros/helpers.sql
2021-01-25 14:12:37.158055 (MainThread): Parsing macros/catalog.sql
2021-01-25 14:12:37.242938 (MainThread): Parsing macros/adapters.sql
2021-01-25 14:12:37.742434 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 14:12:37.785064 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 14:12:37.890399 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 14:12:37.943196 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 14:12:38.088250 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 14:12:38.386547 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 14:12:38.687117 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 14:12:38.784786 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 14:12:38.961722 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 14:12:39.137579 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 14:12:39.501240 (MainThread): Parsing macros/core.sql
2021-01-25 14:12:39.556120 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 14:12:40.569376 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 14:12:40.719003 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 14:12:40.793145 (MainThread): Parsing macros/etc/query.sql
2021-01-25 14:12:40.845974 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 14:12:40.855509 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 14:12:40.906530 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 14:12:40.951626 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 14:12:41.176479 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 14:12:41.213692 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 14:12:41.432347 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 14:12:41.735178 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 14:12:42.073474 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 14:12:42.083184 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 14:12:42.263146 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 14:12:42.403226 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 14:12:42.735136 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 14:12:42.904171 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 14:12:43.436093 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 14:12:43.471678 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 14:12:43.503877 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 14:12:43.556385 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 14:12:43.800720 (MainThread): Partial parsing not enabled
2021-01-25 14:12:44.742595 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 14:12:51.030283 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 14:12:51.032596 (MainThread): 
2021-01-25 14:12:51.033785 (MainThread): Acquiring new dremio connection "master".
2021-01-25 14:12:51.038078 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 14:12:51.150901 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 14:12:51.153546 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 14:12:51.159923 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 14:12:51.162681 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 14:12:52.279135 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 14:12:52.599535 (ThreadPoolExecutor-0_0): SQL status: OK in 1.45 seconds
2021-01-25 14:12:52.693467 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 14:12:52.773848 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 14:12:52.997813 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 14:12:52.998274 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 14:12:52.998627 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 14:12:53.009937 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 14:12:53.288112 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 14:12:53.882395 (ThreadPoolExecutor-1_0): SQL status: OK in 0.88 seconds
2021-01-25 14:12:53.931923 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 14:12:53.932664 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 14:12:53.951602 (MainThread): 15:12:53 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 14:12:53.953560 (MainThread): 15:12:53 | 
2021-01-25 14:12:54.112327 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 14:12:54.121039 (Thread-1): 15:12:54 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 14:12:54.122151 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 14:12:54.122561 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 14:12:54.600818 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 14:12:54.940413 (Thread-1): finished collecting timing info
2021-01-25 14:12:55.442562 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 14:12:55.470353 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 14:12:55.470761 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transaction_type
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,nullif("Commune", '') as municipality
  ,lpad(nullif("Code departement", ''), 2, '0') as department_code
  ,lpad(nullif("Code commune", ''), 3, '0') as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("Type local", '') as premises_type
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
  ,nullif("Nature culture speciale", '') as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 14:12:55.471170 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 14:12:55.471485 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 14:12:55.728522 (Thread-1): Connected to db: None
2021-01-25 14:12:56.057045 (Thread-1): SQL status: OK in 0.59 seconds
2021-01-25 14:12:56.158810 (Thread-1): finished collecting timing info
2021-01-25 14:12:56.217991 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 14:12:56.218494 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 14:12:56.276020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90324285-c62d-4f6b-bf0e-18d629a5030d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea324d02e8>]}
2021-01-25 14:12:56.337644 (Thread-1): 15:12:56 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 2.15s]
2021-01-25 14:12:56.349845 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 14:12:56.424651 (MainThread): Acquiring new dremio connection "master".
2021-01-25 14:12:56.425205 (MainThread): On master: ROLLBACK
2021-01-25 14:12:56.425513 (MainThread): Opening a new connection, currently in state init
2021-01-25 14:12:56.425793 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 14:12:56.726377 (MainThread): Connected to db: None
2021-01-25 14:12:56.727191 (MainThread): On master: ROLLBACK
2021-01-25 14:12:56.727574 (MainThread): On master: Close
2021-01-25 14:12:56.730166 (MainThread): 15:12:56 | 
2021-01-25 14:12:56.730678 (MainThread): 15:12:56 | Finished running 1 view model in 5.70s.
2021-01-25 14:12:56.731312 (MainThread): Connection 'master' was properly closed.
2021-01-25 14:12:56.731782 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 14:12:56.756802 (MainThread): 
2021-01-25 14:12:56.757703 (MainThread): Completed successfully
2021-01-25 14:12:56.758192 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 14:12:56.765066 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea331a86d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea331a41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea325776a0>]}
2021-01-25 14:12:56.765819 (MainThread): Flushing usage events
2021-01-25 14:24:21.680441 (MainThread): Running with dbt=0.18.1
2021-01-25 14:24:22.165154 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-01-25 14:24:22.185376 (MainThread): Tracking: tracking
2021-01-25 14:24:22.284754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5891b8b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5891b8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5891b8e80>]}
2021-01-25 14:24:22.632541 (MainThread): Partial parsing not enabled
2021-01-25 14:24:22.654127 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 14:24:22.722618 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 14:24:22.780958 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 14:24:22.809411 (MainThread): Parsing macros/helpers.sql
2021-01-25 14:24:22.868046 (MainThread): Parsing macros/catalog.sql
2021-01-25 14:24:22.877019 (MainThread): Parsing macros/adapters.sql
2021-01-25 14:24:22.958704 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 14:24:22.992517 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 14:24:23.018533 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 14:24:23.026138 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 14:24:23.045196 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 14:24:23.165721 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 14:24:23.223428 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 14:24:23.267383 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 14:24:23.324001 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 14:24:23.358595 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 14:24:23.523162 (MainThread): Parsing macros/core.sql
2021-01-25 14:24:23.552332 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 14:24:23.999521 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 14:24:24.119366 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 14:24:24.142899 (MainThread): Parsing macros/etc/query.sql
2021-01-25 14:24:24.150149 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 14:24:24.174364 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 14:24:24.211445 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 14:24:24.234062 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 14:24:24.362276 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 14:24:24.377317 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 14:24:24.477600 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 14:24:24.647125 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 14:24:24.799638 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 14:24:24.834046 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 14:24:24.895332 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 14:24:24.968531 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 14:24:25.045837 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 14:24:25.101432 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 14:24:25.386417 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 14:24:25.395349 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 14:24:25.418845 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 14:24:25.428463 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 14:24:25.490066 (MainThread): Partial parsing not enabled
2021-01-25 14:24:26.157799 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 14:24:28.377916 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 14:24:28.380578 (MainThread): 
2021-01-25 14:24:28.383880 (MainThread): Acquiring new dremio connection "master".
2021-01-25 14:24:28.405314 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 14:24:28.604250 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 14:24:28.604610 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 14:24:28.607556 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 14:24:28.622966 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 14:24:29.609584 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 14:24:30.462569 (ThreadPoolExecutor-0_0): SQL status: OK in 1.86 seconds
2021-01-25 14:24:30.575432 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 14:24:30.578755 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-25 14:24:30.584317 (MainThread): 15:24:30 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 14:24:30.595745 (MainThread): 15:24:30 | 
2021-01-25 14:24:30.732947 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 14:24:30.737998 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 14:24:30.738579 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 14:24:30.750516 (Thread-2): Began running node seed.subsurface.crop_codes
2021-01-25 14:24:30.751470 (Thread-2): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 14:24:30.751905 (Thread-2): Compiling seed.subsurface.crop_codes
2021-01-25 14:24:31.168335 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 14:24:31.185235 (Thread-2): finished collecting timing info
2021-01-25 14:24:31.185881 (Thread-2): finished collecting timing info
2021-01-25 14:24:31.192987 (Thread-2): Finished running node seed.subsurface.crop_codes
2021-01-25 14:24:31.202716 (Thread-1): finished collecting timing info
2021-01-25 14:24:31.207956 (Thread-1): finished collecting timing info
2021-01-25 14:24:31.209696 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 14:24:31.272579 (MainThread): Connection 'master' was properly closed.
2021-01-25 14:24:31.273337 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 14:24:31.273874 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 14:24:31.328695 (MainThread): 15:24:31 | Done.
2021-01-25 14:24:31.365142 (MainThread): Acquiring new dremio connection "generate_catalog".
2021-01-25 14:24:31.365592 (MainThread): 15:24:31 | Building catalog
2021-01-25 14:24:31.461356 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "@fab4.information_schema".
2021-01-25 14:24:31.473929 (ThreadPoolExecutor-1_1): Acquiring new dremio connection "fs.information_schema".
2021-01-25 14:24:31.557972 (ThreadPoolExecutor-1_0): Using dremio connection "@fab4.information_schema".
2021-01-25 14:24:31.582310 (ThreadPoolExecutor-1_0): On @fab4.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('@fab4')
    and (table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-25 14:24:31.582767 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 14:24:31.583061 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 14:24:31.594421 (ThreadPoolExecutor-1_1): Using dremio connection "fs.information_schema".
2021-01-25 14:24:31.595372 (ThreadPoolExecutor-1_1): On fs.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('fs')
    and (table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-25 14:24:31.612204 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-01-25 14:24:31.612632 (ThreadPoolExecutor-1_1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 14:24:31.962790 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 14:24:31.979844 (ThreadPoolExecutor-1_1): Connected to db: None
2021-01-25 14:24:46.866107 (ThreadPoolExecutor-1_0): SQL status: OK in 15.28 seconds
2021-01-25 14:24:46.869275 (ThreadPoolExecutor-1_1): SQL status: OK in 15.26 seconds
2021-01-25 14:24:47.078004 (ThreadPoolExecutor-1_0): On @fab4.information_schema: ROLLBACK
2021-01-25 14:24:47.078425 (ThreadPoolExecutor-1_0): On @fab4.information_schema: Close
2021-01-25 14:24:47.116402 (ThreadPoolExecutor-1_1): On fs.information_schema: ROLLBACK
2021-01-25 14:24:47.121025 (ThreadPoolExecutor-1_1): On fs.information_schema: Close
2021-01-25 14:24:47.628795 (MainThread): 15:24:47 | Catalog written to /home/fabrice/subsurface/target/catalog.json
2021-01-25 14:24:47.631612 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe589aecb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe588ea3128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe588eaaa58>]}
2021-01-25 14:24:47.632259 (MainThread): Flushing usage events
2021-01-25 14:24:48.332273 (MainThread): Connection 'generate_catalog' was properly closed.
2021-01-25 14:24:48.333600 (MainThread): Connection '@fab4.information_schema' was properly closed.
2021-01-25 14:24:48.333950 (MainThread): Connection 'fs.information_schema' was properly closed.
2021-01-25 14:25:23.204916 (MainThread): Running with dbt=0.18.1
2021-01-25 14:25:23.616829 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-01-25 14:25:23.619562 (MainThread): Tracking: tracking
2021-01-25 14:25:23.690775 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64faa5978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64f5c6da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64f5c6e10>]}
2021-01-25 14:25:23.725630 (MainThread): Serving docs at 0.0.0.0:8080
2021-01-25 14:25:23.726173 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-01-25 14:25:23.726596 (MainThread): Press Ctrl+C to exit.


2021-01-25 14:28:02.982201 (MainThread): Flushing usage events
2021-01-25 14:28:03.502226 (MainThread): ctrl-c
2021-01-25 16:01:12.549330 (MainThread): Running with dbt=0.18.1
2021-01-25 16:01:12.903561 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 16:01:12.927054 (MainThread): Tracking: tracking
2021-01-25 16:01:12.968258 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedfa305cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9e28dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9e28e48>]}
2021-01-25 16:01:13.062741 (MainThread): Partial parsing not enabled
2021-01-25 16:01:13.070818 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:01:13.103279 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:01:13.125254 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:01:13.132011 (MainThread): Parsing macros/helpers.sql
2021-01-25 16:01:13.164524 (MainThread): Parsing macros/catalog.sql
2021-01-25 16:01:13.192166 (MainThread): Parsing macros/adapters.sql
2021-01-25 16:01:13.254596 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:01:13.267606 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 16:01:13.278349 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 16:01:13.279266 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 16:01:13.286984 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 16:01:13.308586 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:01:13.336495 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:01:13.347319 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 16:01:13.365353 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:01:13.378785 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:01:13.430914 (MainThread): Parsing macros/core.sql
2021-01-25 16:01:13.446963 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 16:01:13.569950 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 16:01:13.591330 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 16:01:13.596218 (MainThread): Parsing macros/etc/query.sql
2021-01-25 16:01:13.598966 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 16:01:13.601442 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 16:01:13.608123 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 16:01:13.612118 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 16:01:13.634155 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 16:01:13.640551 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:01:13.725998 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 16:01:13.808571 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 16:01:13.860661 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 16:01:13.864808 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 16:01:13.878061 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:01:13.893512 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 16:01:13.925821 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:01:13.941503 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:01:14.003609 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 16:01:14.014794 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 16:01:14.021273 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 16:01:14.026725 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 16:01:14.045257 (MainThread): Partial parsing not enabled
2021-01-25 16:01:14.263879 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 16:01:15.512351 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 16:01:15.513760 (MainThread): 
2021-01-25 16:01:15.514756 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:01:15.522518 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 16:01:15.571738 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 16:01:15.572129 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 16:01:15.572344 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 16:01:15.573209 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:01:16.587311 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 16:01:16.871830 (ThreadPoolExecutor-0_0): SQL status: OK in 1.30 seconds
2021-01-25 16:01:16.927371 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 16:01:17.005619 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 16:01:17.094009 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 16:01:17.094513 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 16:01:17.094872 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 16:01:17.095155 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:01:17.240766 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 16:01:17.929435 (ThreadPoolExecutor-1_0): SQL status: OK in 0.83 seconds
2021-01-25 16:01:17.966429 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 16:01:17.966808 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 16:01:17.972261 (MainThread): 17:01:17 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 16:01:17.972638 (MainThread): 17:01:17 | 
2021-01-25 16:01:18.081457 (Thread-1): Began running node seed.subsurface.crop_codes
2021-01-25 16:01:18.084290 (Thread-1): 17:01:18 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 16:01:18.086285 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:01:18.086742 (Thread-1): finished collecting timing info
2021-01-25 16:01:18.756157 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 16:01:18.759441 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c25965d2-e199-494f-b38b-c5ce040e78e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9b2bbe0>]}
2021-01-25 16:01:18.875693 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:01:18.883803 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:01:18.884146 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:01:18.884452 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 16:01:18.884632 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:01:19.117130 (Thread-1): Connected to db: None
2021-01-25 16:01:19.676821 (Thread-1): SQL status: OK in 0.79 seconds
2021-01-25 16:01:19.677515 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:01:19.678130 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:01:19.730629 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:01:19.731486 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:01:20.283605 (Thread-1): SQL status: OK in 0.55 seconds
2021-01-25 16:01:20.284280 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:01:20.356003 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:01:20.356319 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 16:01:20.413763 (Thread-1): SQL status: OK in 0.06 seconds
2021-01-25 16:01:20.471692 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 16:01:20.498336 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:01:20.498673 (Thread-1): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:01:20.609850 (Thread-1): Error running SQL: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:01:20.610171 (Thread-1): Rolling back transaction.
2021-01-25 16:01:20.610412 (Thread-1): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 16:01:20.610580 (Thread-1): On seed.subsurface.crop_codes: Close
2021-01-25 16:01:20.611676 (Thread-1): finished collecting timing info
2021-01-25 16:01:20.612785 (Thread-1): Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 87, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:01:20.670437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25965d2-e199-494f-b38b-c5ce040e78e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9ae5c18>]}
2021-01-25 16:01:20.671323 (Thread-1): 17:01:20 | 1 of 1 ERROR loading seed file no_schema.crop_codes.................. [ERROR in 2.58s]
2021-01-25 16:01:20.673172 (Thread-1): Finished running node seed.subsurface.crop_codes
2021-01-25 16:01:20.683888 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:01:20.684296 (MainThread): On master: ROLLBACK
2021-01-25 16:01:20.684553 (MainThread): Opening a new connection, currently in state init
2021-01-25 16:01:20.684748 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:01:20.933225 (MainThread): Connected to db: None
2021-01-25 16:01:20.933626 (MainThread): On master: ROLLBACK
2021-01-25 16:01:20.933869 (MainThread): On master: Close
2021-01-25 16:01:20.936354 (MainThread): 17:01:20 | 
2021-01-25 16:01:20.937266 (MainThread): 17:01:20 | Finished running 1 seed in 5.42s.
2021-01-25 16:01:20.938947 (MainThread): Connection 'master' was properly closed.
2021-01-25 16:01:20.940658 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 16:01:20.956836 (MainThread): 
2021-01-25 16:01:20.958050 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 16:01:20.959143 (MainThread): 
2021-01-25 16:01:20.959438 (MainThread): Runtime Error in seed crop_codes (data/crop_codes.csv)
2021-01-25 16:01:20.960765 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:01:20.961119 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 16:01:20.961521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9b614a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9b618d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9b61be0>]}
2021-01-25 16:01:20.963128 (MainThread): Flushing usage events
2021-01-25 16:05:26.408315 (MainThread): Running with dbt=0.18.1
2021-01-25 16:05:26.603491 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 16:05:26.606240 (MainThread): Tracking: tracking
2021-01-25 16:05:26.645585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1aa0dd68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1a521e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1a521ef0>]}
2021-01-25 16:05:26.699198 (MainThread): Partial parsing not enabled
2021-01-25 16:05:26.714725 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:05:26.754552 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:05:26.769335 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:05:26.777647 (MainThread): Parsing macros/helpers.sql
2021-01-25 16:05:26.803724 (MainThread): Parsing macros/catalog.sql
2021-01-25 16:05:26.809273 (MainThread): Parsing macros/adapters.sql
2021-01-25 16:05:26.860716 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:05:26.863311 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 16:05:26.869466 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 16:05:26.870172 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 16:05:26.876058 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 16:05:26.895345 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:05:26.913124 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:05:26.921869 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 16:05:26.937175 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:05:26.948603 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:05:26.983293 (MainThread): Parsing macros/core.sql
2021-01-25 16:05:26.993573 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 16:05:27.079588 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 16:05:27.097082 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 16:05:27.101274 (MainThread): Parsing macros/etc/query.sql
2021-01-25 16:05:27.103892 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 16:05:27.106345 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 16:05:27.110758 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 16:05:27.114436 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 16:05:27.133341 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 16:05:27.137413 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:05:27.150660 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 16:05:27.204906 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 16:05:27.238577 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 16:05:27.242788 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 16:05:27.253407 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:05:27.265506 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 16:05:27.293119 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:05:27.306509 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:05:27.347440 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 16:05:27.352334 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 16:05:27.356081 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 16:05:27.359929 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 16:05:27.375761 (MainThread): Partial parsing not enabled
2021-01-25 16:05:27.515777 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 16:05:28.197466 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 16:05:28.198649 (MainThread): 
2021-01-25 16:05:28.199483 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:05:28.202529 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 16:05:28.229155 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 16:05:28.229555 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 16:05:28.229862 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 16:05:28.230133 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:05:28.872054 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 16:05:29.030822 (ThreadPoolExecutor-0_0): SQL status: OK in 0.80 seconds
2021-01-25 16:05:29.068263 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 16:05:29.080491 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 16:05:29.102002 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 16:05:29.102430 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 16:05:29.102707 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 16:05:29.102989 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:05:29.315291 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 16:05:29.944156 (ThreadPoolExecutor-1_0): SQL status: OK in 0.84 seconds
2021-01-25 16:05:29.978318 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 16:05:29.979176 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 16:05:29.982369 (MainThread): 17:05:29 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 16:05:29.982784 (MainThread): 17:05:29 | 
2021-01-25 16:05:30.041570 (Thread-1): Began running node seed.subsurface.crop_codes
2021-01-25 16:05:30.044059 (Thread-1): 17:05:30 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 16:05:30.048986 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:05:30.049792 (Thread-1): finished collecting timing info
2021-01-25 16:05:30.369729 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 16:05:30.375312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '605b96df-81c9-45ac-8dd7-10f58d9d06dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1a22b748>]}
2021-01-25 16:05:30.518447 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:05:30.529451 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:05:30.535394 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:05:30.535811 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 16:05:30.536114 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:05:30.833077 (Thread-1): Connected to db: None
2021-01-25 16:05:31.304294 (Thread-1): SQL status: OK in 0.77 seconds
2021-01-25 16:05:31.304904 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:05:31.305413 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:05:31.318978 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:05:31.319550 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:05:31.750942 (Thread-1): SQL status: OK in 0.43 seconds
2021-01-25 16:05:31.751620 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:05:31.799009 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:05:31.799396 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 16:05:31.810285 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-25 16:05:31.826161 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 16:05:31.840217 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:05:31.840620 (Thread-1): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:05:31.920975 (Thread-1): Error running SQL: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:05:31.921429 (Thread-1): Rolling back transaction.
2021-01-25 16:05:31.921815 (Thread-1): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 16:05:31.922197 (Thread-1): On seed.subsurface.crop_codes: Close
2021-01-25 16:05:31.926549 (Thread-1): finished collecting timing info
2021-01-25 16:05:31.927960 (Thread-1): Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 87, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:05:31.997084 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '605b96df-81c9-45ac-8dd7-10f58d9d06dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1a22b630>]}
2021-01-25 16:05:31.997797 (Thread-1): 17:05:31 | 1 of 1 ERROR loading seed file no_schema.crop_codes.................. [ERROR in 1.95s]
2021-01-25 16:05:31.998288 (Thread-1): Finished running node seed.subsurface.crop_codes
2021-01-25 16:05:32.097589 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:05:32.098020 (MainThread): On master: ROLLBACK
2021-01-25 16:05:32.098329 (MainThread): Opening a new connection, currently in state init
2021-01-25 16:05:32.098594 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:05:32.252310 (MainThread): Connected to db: None
2021-01-25 16:05:32.252870 (MainThread): On master: ROLLBACK
2021-01-25 16:05:32.253245 (MainThread): On master: Close
2021-01-25 16:05:32.259362 (MainThread): 17:05:32 | 
2021-01-25 16:05:32.259876 (MainThread): 17:05:32 | Finished running 1 seed in 4.06s.
2021-01-25 16:05:32.260304 (MainThread): Connection 'master' was properly closed.
2021-01-25 16:05:32.260661 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 16:05:32.287696 (MainThread): 
2021-01-25 16:05:32.289661 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 16:05:32.290177 (MainThread): 
2021-01-25 16:05:32.290646 (MainThread): Runtime Error in seed crop_codes (data/crop_codes.csv)
2021-01-25 16:05:32.292023 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:05:32.292496 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 16:05:32.293123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a19723d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a19723898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a19718518>]}
2021-01-25 16:05:32.293740 (MainThread): Flushing usage events
2021-01-25 16:06:03.968024 (MainThread): Running with dbt=0.18.1
2021-01-25 16:06:04.118133 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 16:06:04.119760 (MainThread): Tracking: tracking
2021-01-25 16:06:04.142083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd13c9dda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd137c0e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd137c0eb8>]}
2021-01-25 16:06:04.210393 (MainThread): Partial parsing not enabled
2021-01-25 16:06:04.212000 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:06:04.217847 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:06:04.222301 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:06:04.227270 (MainThread): Parsing macros/helpers.sql
2021-01-25 16:06:04.260316 (MainThread): Parsing macros/catalog.sql
2021-01-25 16:06:04.265401 (MainThread): Parsing macros/adapters.sql
2021-01-25 16:06:04.315247 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:06:04.317773 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 16:06:04.324284 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 16:06:04.324840 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 16:06:04.330756 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 16:06:04.349965 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:06:04.368123 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:06:04.377352 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 16:06:04.392949 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:06:04.405720 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:06:04.439138 (MainThread): Parsing macros/core.sql
2021-01-25 16:06:04.447847 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 16:06:04.535200 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 16:06:04.553097 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 16:06:04.557005 (MainThread): Parsing macros/etc/query.sql
2021-01-25 16:06:04.559471 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 16:06:04.561659 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 16:06:04.565867 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 16:06:04.569422 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 16:06:04.588305 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 16:06:04.592656 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:06:04.605275 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 16:06:04.661349 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 16:06:04.697782 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 16:06:04.701622 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 16:06:04.712799 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:06:04.726121 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 16:06:04.758304 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:06:04.772624 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:06:04.814676 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 16:06:04.818827 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 16:06:04.822288 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 16:06:04.826517 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 16:06:04.842345 (MainThread): Partial parsing not enabled
2021-01-25 16:06:04.966495 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 16:06:05.579449 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 16:06:05.581025 (MainThread): 
2021-01-25 16:06:05.581816 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:06:05.584951 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 16:06:05.620413 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 16:06:05.620746 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 16:06:05.620944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 16:06:05.621087 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:06:05.812419 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 16:06:05.994566 (ThreadPoolExecutor-0_0): SQL status: OK in 0.37 seconds
2021-01-25 16:06:06.025472 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 16:06:06.035666 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 16:06:06.055575 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 16:06:06.056470 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 16:06:06.056938 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 16:06:06.057118 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:06:06.225658 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 16:06:06.623371 (ThreadPoolExecutor-1_0): SQL status: OK in 0.57 seconds
2021-01-25 16:06:06.669835 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 16:06:06.670173 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 16:06:06.677010 (MainThread): 17:06:06 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 16:06:06.677367 (MainThread): 17:06:06 | 
2021-01-25 16:06:06.727179 (Thread-1): Began running node seed.subsurface.crop_codes
2021-01-25 16:06:06.729355 (Thread-1): 17:06:06 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 16:06:06.731175 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:06:06.731516 (Thread-1): finished collecting timing info
2021-01-25 16:06:06.867230 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 16:06:06.872386 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8d6ab0a0-8712-4076-a4e7-340ae595fbad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd13539470>]}
2021-01-25 16:06:06.940765 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:06:06.947865 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:06:06.948195 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:06:06.948364 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 16:06:06.948502 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:06:07.107232 (Thread-1): Connected to db: None
2021-01-25 16:06:07.610982 (Thread-1): SQL status: OK in 0.66 seconds
2021-01-25 16:06:07.611891 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:06:07.612699 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:06:07.635952 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:06:07.636433 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:06:08.286586 (Thread-1): SQL status: OK in 0.65 seconds
2021-01-25 16:06:08.287339 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:06:08.325969 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:06:08.335148 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 16:06:08.362571 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-25 16:06:08.387587 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 16:06:08.388762 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:06:08.395181 (Thread-1): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:06:08.456302 (Thread-1): Error running SQL: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:06:08.456654 (Thread-1): Rolling back transaction.
2021-01-25 16:06:08.456897 (Thread-1): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 16:06:08.457124 (Thread-1): On seed.subsurface.crop_codes: Close
2021-01-25 16:06:08.459475 (Thread-1): finished collecting timing info
2021-01-25 16:06:08.461256 (Thread-1): Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 87, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:06:08.475545 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d6ab0a0-8712-4076-a4e7-340ae595fbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd13536f28>]}
2021-01-25 16:06:08.476350 (Thread-1): 17:06:08 | 1 of 1 ERROR loading seed file no_schema.crop_codes.................. [ERROR in 1.74s]
2021-01-25 16:06:08.476915 (Thread-1): Finished running node seed.subsurface.crop_codes
2021-01-25 16:06:08.541776 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:06:08.542203 (MainThread): On master: ROLLBACK
2021-01-25 16:06:08.542472 (MainThread): Opening a new connection, currently in state init
2021-01-25 16:06:08.542781 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:06:08.753201 (MainThread): Connected to db: None
2021-01-25 16:06:08.753629 (MainThread): On master: ROLLBACK
2021-01-25 16:06:08.753846 (MainThread): On master: Close
2021-01-25 16:06:08.755437 (MainThread): 17:06:08 | 
2021-01-25 16:06:08.755760 (MainThread): 17:06:08 | Finished running 1 seed in 3.17s.
2021-01-25 16:06:08.755953 (MainThread): Connection 'master' was properly closed.
2021-01-25 16:06:08.756665 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 16:06:08.756845 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 16:06:08.771025 (MainThread): 
2021-01-25 16:06:08.771450 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 16:06:08.771679 (MainThread): 
2021-01-25 16:06:08.771876 (MainThread): Runtime Error in seed crop_codes (data/crop_codes.csv)
2021-01-25 16:06:08.772079 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:06:08.772845 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 16:06:08.773467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd129b9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd13612cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd13536390>]}
2021-01-25 16:06:08.773935 (MainThread): Flushing usage events
2021-01-25 16:20:54.824076 (MainThread): Running with dbt=0.18.1
2021-01-25 16:20:55.255221 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 16:20:55.269360 (MainThread): Tracking: tracking
2021-01-25 16:20:55.321406 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f2295a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f1da8dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f1da8e48>]}
2021-01-25 16:20:55.449318 (MainThread): Partial parsing not enabled
2021-01-25 16:20:55.464193 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:20:55.495584 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:20:55.527361 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:20:55.535937 (MainThread): Parsing macros/helpers.sql
2021-01-25 16:20:55.570519 (MainThread): Parsing macros/catalog.sql
2021-01-25 16:20:55.576232 (MainThread): Parsing macros/adapters.sql
2021-01-25 16:20:55.630793 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:20:55.634525 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 16:20:55.640975 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 16:20:55.641747 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 16:20:55.648204 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 16:20:55.670375 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:20:55.692308 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:20:55.702326 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 16:20:55.718728 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:20:55.732953 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:20:55.791081 (MainThread): Parsing macros/core.sql
2021-01-25 16:20:55.806743 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 16:20:55.904021 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 16:20:55.924746 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 16:20:55.944472 (MainThread): Parsing macros/etc/query.sql
2021-01-25 16:20:55.969209 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 16:20:55.973785 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 16:20:55.979701 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 16:20:55.984720 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 16:20:56.015054 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 16:20:56.020027 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:20:56.034272 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 16:20:56.098283 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 16:20:56.141225 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 16:20:56.146758 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 16:20:56.159136 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:20:56.173338 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 16:20:56.207904 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:20:56.223248 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:20:56.273891 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 16:20:56.279035 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 16:20:56.283163 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 16:20:56.287547 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 16:20:56.305367 (MainThread): Partial parsing not enabled
2021-01-25 16:20:56.479635 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 16:20:57.296647 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 16:20:57.298068 (MainThread): 
2021-01-25 16:20:57.298892 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:20:57.303560 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 16:20:57.359352 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 16:20:57.359618 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 16:20:57.359809 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 16:20:57.359940 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:20:58.074508 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 16:20:58.313172 (ThreadPoolExecutor-0_0): SQL status: OK in 0.95 seconds
2021-01-25 16:20:58.367765 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 16:20:58.381759 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 16:20:58.418420 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 16:20:58.421509 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 16:20:58.423117 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 16:20:58.423400 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:20:58.600224 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 16:20:59.058074 (ThreadPoolExecutor-1_0): SQL status: OK in 0.63 seconds
2021-01-25 16:20:59.080301 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 16:20:59.081003 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 16:20:59.087232 (MainThread): 17:20:59 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 16:20:59.087610 (MainThread): 17:20:59 | 
2021-01-25 16:20:59.124978 (Thread-1): Began running node seed.subsurface.crop_codes
2021-01-25 16:20:59.128725 (Thread-1): 17:20:59 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 16:20:59.129574 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:20:59.130186 (Thread-1): finished collecting timing info
2021-01-25 16:20:59.265258 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 16:20:59.265669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f21ac3b1-426c-4153-9f01-b4f0393a1bc9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f1ab3cc0>]}
2021-01-25 16:20:59.307037 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:20:59.312870 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:20:59.313178 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:20:59.313337 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 16:20:59.313470 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:20:59.509383 (Thread-1): Connected to db: None
2021-01-25 16:21:00.002360 (Thread-1): SQL status: OK in 0.69 seconds
2021-01-25 16:21:00.003157 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:21:00.003897 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:21:00.034363 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:21:00.036738 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:21:00.632148 (Thread-1): SQL status: OK in 0.60 seconds
2021-01-25 16:21:00.632996 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:21:00.680728 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:21:00.682675 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 16:21:00.726363 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-25 16:21:00.761391 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 16:21:00.775490 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:21:00.776529 (Thread-1): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:21:00.854211 (Thread-1): Error running SQL: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:21:00.854533 (Thread-1): Rolling back transaction.
2021-01-25 16:21:00.854764 (Thread-1): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 16:21:00.854984 (Thread-1): On seed.subsurface.crop_codes: Close
2021-01-25 16:21:00.855905 (Thread-1): finished collecting timing info
2021-01-25 16:21:00.857563 (Thread-1): Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 87, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:21:00.950608 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f21ac3b1-426c-4153-9f01-b4f0393a1bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f1b1ddd8>]}
2021-01-25 16:21:00.951353 (Thread-1): 17:21:00 | 1 of 1 ERROR loading seed file no_schema.crop_codes.................. [ERROR in 1.82s]
2021-01-25 16:21:00.958020 (Thread-1): Finished running node seed.subsurface.crop_codes
2021-01-25 16:21:00.966545 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:21:00.967153 (MainThread): On master: ROLLBACK
2021-01-25 16:21:00.967457 (MainThread): Opening a new connection, currently in state init
2021-01-25 16:21:00.967636 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:21:01.245181 (MainThread): Connected to db: None
2021-01-25 16:21:01.245602 (MainThread): On master: ROLLBACK
2021-01-25 16:21:01.245818 (MainThread): On master: Close
2021-01-25 16:21:01.256992 (MainThread): 17:21:01 | 
2021-01-25 16:21:01.257574 (MainThread): 17:21:01 | Finished running 1 seed in 3.96s.
2021-01-25 16:21:01.257815 (MainThread): Connection 'master' was properly closed.
2021-01-25 16:21:01.257949 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 16:21:01.293626 (MainThread): 
2021-01-25 16:21:01.297576 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 16:21:01.298034 (MainThread): 
2021-01-25 16:21:01.298457 (MainThread): Runtime Error in seed crop_codes (data/crop_codes.csv)
2021-01-25 16:21:01.298876 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:21:01.299319 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 16:21:01.308554 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f1b1ddd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f1b15f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f1b15f98>]}
2021-01-25 16:21:01.309000 (MainThread): Flushing usage events
2021-01-25 16:22:31.598596 (MainThread): Running with dbt=0.18.1
2021-01-25 16:22:31.748022 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 16:22:31.754793 (MainThread): Tracking: tracking
2021-01-25 16:22:31.767572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9658deb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a965945f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a960a0eb8>]}
2021-01-25 16:22:31.857691 (MainThread): Partial parsing not enabled
2021-01-25 16:22:31.859053 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:22:31.865105 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:22:31.868806 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:22:31.874208 (MainThread): Parsing macros/helpers.sql
2021-01-25 16:22:31.906749 (MainThread): Parsing macros/catalog.sql
2021-01-25 16:22:31.912057 (MainThread): Parsing macros/adapters.sql
2021-01-25 16:22:31.970181 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:22:31.972754 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 16:22:31.979914 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 16:22:31.980400 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 16:22:31.986624 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 16:22:32.007922 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:22:32.029931 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:22:32.041162 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 16:22:32.057878 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:22:32.069966 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:22:32.105676 (MainThread): Parsing macros/core.sql
2021-01-25 16:22:32.113730 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 16:22:32.211729 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 16:22:32.233894 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 16:22:32.238261 (MainThread): Parsing macros/etc/query.sql
2021-01-25 16:22:32.241500 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 16:22:32.243741 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 16:22:32.248439 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 16:22:32.252222 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 16:22:32.274136 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 16:22:32.279568 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:22:32.298295 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 16:22:32.361233 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 16:22:32.398436 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 16:22:32.402785 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 16:22:32.417925 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:22:32.435518 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 16:22:32.466027 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:22:32.481476 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:22:32.528270 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 16:22:32.533172 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 16:22:32.537077 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 16:22:32.541307 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 16:22:32.559789 (MainThread): Partial parsing not enabled
2021-01-25 16:22:32.703371 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 16:22:33.303812 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 16:22:33.305446 (MainThread): 
2021-01-25 16:22:33.306262 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:22:33.310066 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 16:22:33.352116 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 16:22:33.352409 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 16:22:33.363243 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 16:22:33.363452 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:22:33.612583 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 16:22:33.844249 (ThreadPoolExecutor-0_0): SQL status: OK in 0.48 seconds
2021-01-25 16:22:33.875867 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 16:22:33.895929 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 16:22:33.926367 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 16:22:33.926650 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 16:22:33.926817 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 16:22:33.926956 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:22:34.089860 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 16:22:34.627202 (ThreadPoolExecutor-1_0): SQL status: OK in 0.70 seconds
2021-01-25 16:22:34.698687 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 16:22:34.699037 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 16:22:34.704152 (MainThread): 17:22:34 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 16:22:34.704582 (MainThread): 17:22:34 | 
2021-01-25 16:22:34.733038 (Thread-1): Began running node seed.subsurface.crop_codes
2021-01-25 16:22:34.749454 (Thread-1): 17:22:34 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 16:22:34.751184 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:22:34.755238 (Thread-1): finished collecting timing info
2021-01-25 16:22:35.026150 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 16:22:35.026568 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4bf912d5-8014-4024-bb2d-4cdd6e7cc40c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a95da42e8>]}
2021-01-25 16:22:35.079701 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:22:35.089090 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:22:35.089396 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:22:35.094112 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 16:22:35.094627 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:22:35.245219 (Thread-1): Connected to db: None
2021-01-25 16:22:35.661465 (Thread-1): SQL status: OK in 0.57 seconds
2021-01-25 16:22:35.662126 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:22:35.662675 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:22:35.670108 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:22:35.670494 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:22:36.372210 (Thread-1): SQL status: OK in 0.70 seconds
2021-01-25 16:22:36.372939 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:22:36.506510 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:22:36.521487 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 16:22:36.553729 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-25 16:22:36.622553 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 16:22:36.629167 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:22:36.631126 (Thread-1): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:22:36.696471 (Thread-1): Error running SQL: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrément'
          ),
      
        (
            'BB'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:22:36.697020 (Thread-1): Rolling back transaction.
2021-01-25 16:22:36.697400 (Thread-1): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 16:22:36.697811 (Thread-1): On seed.subsurface.crop_codes: Close
2021-01-25 16:22:36.707617 (Thread-1): finished collecting timing info
2021-01-25 16:22:36.708687 (Thread-1): Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 87, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:22:36.741412 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf912d5-8014-4024-bb2d-4cdd6e7cc40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a95d5ee48>]}
2021-01-25 16:22:36.743669 (Thread-1): 17:22:36 | 1 of 1 ERROR loading seed file no_schema.crop_codes.................. [ERROR in 1.99s]
2021-01-25 16:22:36.748953 (Thread-1): Finished running node seed.subsurface.crop_codes
2021-01-25 16:22:36.771701 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:22:36.772095 (MainThread): On master: ROLLBACK
2021-01-25 16:22:36.772350 (MainThread): Opening a new connection, currently in state init
2021-01-25 16:22:36.772540 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:22:37.040991 (MainThread): Connected to db: None
2021-01-25 16:22:37.041411 (MainThread): On master: ROLLBACK
2021-01-25 16:22:37.041645 (MainThread): On master: Close
2021-01-25 16:22:37.044051 (MainThread): 17:22:37 | 
2021-01-25 16:22:37.044387 (MainThread): 17:22:37 | Finished running 1 seed in 3.74s.
2021-01-25 16:22:37.044612 (MainThread): Connection 'master' was properly closed.
2021-01-25 16:22:37.044758 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 16:22:37.044869 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 16:22:37.078588 (MainThread): 
2021-01-25 16:22:37.082510 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 16:22:37.083118 (MainThread): 
2021-01-25 16:22:37.086294 (MainThread): Runtime Error in seed crop_codes (data/crop_codes.csv)
2021-01-25 16:22:37.087929 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains à bâtir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrain...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:22:37.088983 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 16:22:37.092097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a95dda2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a95dda748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a95dda7f0>]}
2021-01-25 16:22:37.097266 (MainThread): Flushing usage events
2021-01-25 16:31:23.091719 (MainThread): Running with dbt=0.18.1
2021-01-25 16:31:23.218044 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 16:31:23.219774 (MainThread): Tracking: tracking
2021-01-25 16:31:23.247743 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc6391b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc6391d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc6391cf8>]}
2021-01-25 16:31:23.308025 (MainThread): Partial parsing not enabled
2021-01-25 16:31:23.309336 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:31:23.314223 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:31:23.318057 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:31:23.322296 (MainThread): Parsing macros/helpers.sql
2021-01-25 16:31:23.347883 (MainThread): Parsing macros/catalog.sql
2021-01-25 16:31:23.352669 (MainThread): Parsing macros/adapters.sql
2021-01-25 16:31:23.399984 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:31:23.402530 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 16:31:23.408972 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 16:31:23.409488 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 16:31:23.414888 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 16:31:23.433936 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:31:23.451318 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:31:23.460939 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 16:31:23.475814 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:31:23.486903 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:31:23.516412 (MainThread): Parsing macros/core.sql
2021-01-25 16:31:23.524221 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 16:31:23.607568 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 16:31:23.625537 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 16:31:23.629374 (MainThread): Parsing macros/etc/query.sql
2021-01-25 16:31:23.631726 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 16:31:23.633807 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 16:31:23.637997 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 16:31:23.641999 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 16:31:23.660787 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 16:31:23.664626 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:31:23.677742 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 16:31:23.731346 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 16:31:23.769532 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 16:31:23.773645 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 16:31:23.784218 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:31:23.796882 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 16:31:23.825308 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:31:23.838517 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:31:23.880110 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 16:31:23.884659 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 16:31:23.888055 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 16:31:23.892149 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 16:31:23.907971 (MainThread): Partial parsing not enabled
2021-01-25 16:31:24.028511 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 16:31:24.521223 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 16:31:24.523047 (MainThread): 
2021-01-25 16:31:24.523889 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:31:24.528079 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 16:31:24.553190 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 16:31:24.553490 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 16:31:24.553628 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 16:31:24.553755 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:31:24.717530 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 16:31:24.991123 (ThreadPoolExecutor-0_0): SQL status: OK in 0.44 seconds
2021-01-25 16:31:25.041703 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 16:31:25.060256 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 16:31:25.074802 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 16:31:25.075150 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 16:31:25.075382 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 16:31:25.075552 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:31:25.251264 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 16:31:25.635762 (ThreadPoolExecutor-1_0): SQL status: OK in 0.56 seconds
2021-01-25 16:31:25.658224 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 16:31:25.658512 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 16:31:25.661574 (MainThread): 17:31:25 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 16:31:25.661979 (MainThread): 17:31:25 | 
2021-01-25 16:31:25.665301 (Thread-1): Began running node seed.subsurface.crop_codes
2021-01-25 16:31:25.668644 (Thread-1): 17:31:25 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 16:31:25.669752 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:31:25.670110 (Thread-1): finished collecting timing info
2021-01-25 16:31:25.800842 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 16:31:25.804969 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'daee2ad7-89f5-4414-b5da-aa5ad7796bb9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc60a5a20>]}
2021-01-25 16:31:25.895052 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:31:25.905443 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:31:25.905786 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:31:25.906014 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 16:31:25.906231 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:31:26.204075 (Thread-1): Connected to db: None
2021-01-25 16:31:26.613478 (Thread-1): SQL status: OK in 0.71 seconds
2021-01-25 16:31:26.614118 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:31:26.614651 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:31:26.632835 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:31:26.633130 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:31:27.270356 (Thread-1): SQL status: OK in 0.64 seconds
2021-01-25 16:31:27.271162 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:31:27.332172 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:31:27.332463 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 16:31:27.364746 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-25 16:31:27.397453 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 16:31:27.399609 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:31:27.400687 (Thread-1): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains a batir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrement'
          ),
      
        (
            'BB'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies resineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrieres'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisees'
          ),
      
        (
            'P'
          ,
            'Pres'
          ),
      
        (
            'PA'
          ,
            'Patures ou Paturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Pres d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Pres Patures ou Herbages plantes'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantees'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:31:27.447820 (Thread-1): Error running SQL: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains a batir'
          ),
      
        (
            'AG'
          ,
            'Terrains d’agrement'
          ),
      
        (
            'BB'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies resineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrieres'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer ou Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisees'
          ),
      
        (
            'P'
          ,
            'Pres'
          ),
      
        (
            'PA'
          ,
            'Patures ou Paturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Pres d’embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Pres Patures ou Herbages plantes'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantees'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:31:27.448168 (Thread-1): Rolling back transaction.
2021-01-25 16:31:27.448390 (Thread-1): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 16:31:27.448577 (Thread-1): On seed.subsurface.crop_codes: Close
2021-01-25 16:31:27.449594 (Thread-1): finished collecting timing info
2021-01-25 16:31:27.450616 (Thread-1): Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains a batir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrains ...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains a batir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrains ...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 87, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in seed crop_codes (data/crop_codes.csv)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains a batir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrains ...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:31:27.455300 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daee2ad7-89f5-4414-b5da-aa5ad7796bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc633e5c0>]}
2021-01-25 16:31:27.455921 (Thread-1): 17:31:27 | 1 of 1 ERROR loading seed file no_schema.crop_codes.................. [ERROR in 1.79s]
2021-01-25 16:31:27.459217 (Thread-1): Finished running node seed.subsurface.crop_codes
2021-01-25 16:31:27.532828 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:31:27.533169 (MainThread): On master: ROLLBACK
2021-01-25 16:31:27.533324 (MainThread): Opening a new connection, currently in state init
2021-01-25 16:31:27.533444 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:31:27.746514 (MainThread): Connected to db: None
2021-01-25 16:31:27.746861 (MainThread): On master: ROLLBACK
2021-01-25 16:31:27.747038 (MainThread): On master: Close
2021-01-25 16:31:27.748636 (MainThread): 17:31:27 | 
2021-01-25 16:31:27.749020 (MainThread): 17:31:27 | Finished running 1 seed in 3.23s.
2021-01-25 16:31:27.749240 (MainThread): Connection 'master' was properly closed.
2021-01-25 16:31:27.749367 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 16:31:27.780929 (MainThread): 
2021-01-25 16:31:27.781303 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 16:31:27.781514 (MainThread): 
2021-01-25 16:31:27.781691 (MainThread): Runtime Error in seed crop_codes (data/crop_codes.csv)
2021-01-25 16:31:27.781863 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n\n  create table\n    "$scratch"."subsurface"."@fab4"."crop_codes_green"\n  as (\n    select\n    cast(crop_code as varchar)\n        as crop_code,cast(crop_name as varchar)\n        as crop_name\n  from\n    (values\n      \n        (\n            \'AB\'\n          ,\n            \'Terrains a batir\'\n          ),\n      \n        (\n            \'AG\'\n          ,\n            \'Terrains ...[see log] (1040) (SQLExecDirectW)')
2021-01-25 16:31:27.782030 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 16:31:27.782370 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc5589f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc6112e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc61128d0>]}
2021-01-25 16:31:27.782727 (MainThread): Flushing usage events
2021-01-25 16:36:46.600453 (MainThread): Running with dbt=0.18.1
2021-01-25 16:36:46.722902 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 16:36:46.724382 (MainThread): Tracking: tracking
2021-01-25 16:36:46.734516 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f337a2bdcf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3379dd0dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3379dd0e48>]}
2021-01-25 16:36:46.802663 (MainThread): Partial parsing not enabled
2021-01-25 16:36:46.804335 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:36:46.810604 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:36:46.814661 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 16:36:46.818962 (MainThread): Parsing macros/helpers.sql
2021-01-25 16:36:46.845607 (MainThread): Parsing macros/catalog.sql
2021-01-25 16:36:46.850323 (MainThread): Parsing macros/adapters.sql
2021-01-25 16:36:46.899091 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 16:36:46.901529 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 16:36:46.907966 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 16:36:46.908466 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 16:36:46.914653 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 16:36:46.935338 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:36:46.956384 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:36:46.965178 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 16:36:46.981476 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:36:46.993482 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:36:47.023950 (MainThread): Parsing macros/core.sql
2021-01-25 16:36:47.031899 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 16:36:47.117484 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 16:36:47.135749 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 16:36:47.139487 (MainThread): Parsing macros/etc/query.sql
2021-01-25 16:36:47.141816 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 16:36:47.143937 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 16:36:47.148246 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 16:36:47.152414 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 16:36:47.170607 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 16:36:47.175178 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 16:36:47.187564 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 16:36:47.240868 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 16:36:47.276151 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 16:36:47.280088 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 16:36:47.291446 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 16:36:47.303350 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 16:36:47.330908 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 16:36:47.344210 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 16:36:47.384628 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 16:36:47.389332 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 16:36:47.393216 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 16:36:47.396956 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 16:36:47.413261 (MainThread): Partial parsing not enabled
2021-01-25 16:36:47.533705 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 16:36:48.145915 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 16:36:48.147389 (MainThread): 
2021-01-25 16:36:48.148074 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:36:48.151185 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 16:36:48.183023 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 16:36:48.183420 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 16:36:48.183797 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 16:36:48.184102 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:36:48.355782 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 16:36:48.517110 (ThreadPoolExecutor-0_0): SQL status: OK in 0.33 seconds
2021-01-25 16:36:48.541690 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 16:36:48.551608 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 16:36:48.568116 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 16:36:48.568548 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 16:36:48.568810 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 16:36:48.569029 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:36:48.732908 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 16:36:49.106886 (ThreadPoolExecutor-1_0): SQL status: OK in 0.54 seconds
2021-01-25 16:36:49.134782 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 16:36:49.135265 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 16:36:49.138169 (MainThread): 17:36:49 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 16:36:49.138565 (MainThread): 17:36:49 | 
2021-01-25 16:36:49.156633 (Thread-1): Began running node seed.subsurface.crop_codes
2021-01-25 16:36:49.159032 (Thread-1): 17:36:49 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 16:36:49.163503 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:36:49.163845 (Thread-1): finished collecting timing info
2021-01-25 16:36:49.790339 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 16:36:49.792069 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4c6dfd8c-8268-4b8c-a82e-7ebd895566f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3379b52dd8>]}
2021-01-25 16:36:49.917830 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:36:49.968772 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:36:49.983295 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:36:49.983583 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 16:36:49.983753 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:36:50.215069 (Thread-1): Connected to db: None
2021-01-25 16:36:50.803208 (Thread-1): SQL status: OK in 0.82 seconds
2021-01-25 16:36:50.803860 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:36:50.804393 (Thread-1): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 16:36:50.817505 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:36:50.817815 (Thread-1): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 16:36:51.271533 (Thread-1): SQL status: OK in 0.45 seconds
2021-01-25 16:36:51.272298 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[]
2021-01-25 16:36:51.332553 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:36:51.334990 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 16:36:51.372834 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-25 16:36:51.385545 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 16:36:51.395338 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:36:51.395700 (Thread-1): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 16:36:53.095575 (Thread-1): SQL status: OK in 1.70 seconds
2021-01-25 16:36:53.140619 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:36:53.141236 (Thread-1): On seed.subsurface.crop_codes: 
    
  create or replace view "@fab4"."crop_codes" as (
    select * from "$scratch"."subsurface"."@fab4"."crop_codes_green"
  )

  
2021-01-25 16:36:53.479867 (Thread-1): SQL status: OK in 0.33 seconds
2021-01-25 16:36:53.499778 (Thread-1): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 16:36:53.500211 (Thread-1): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_blue"
2021-01-25 16:36:53.532949 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-25 16:36:53.579325 (Thread-1): finished collecting timing info
2021-01-25 16:36:53.584882 (Thread-1): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 16:36:53.586702 (Thread-1): On seed.subsurface.crop_codes: Close
2021-01-25 16:36:53.593338 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6dfd8c-8268-4b8c-a82e-7ebd895566f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3379b49278>]}
2021-01-25 16:36:53.594021 (Thread-1): 17:36:53 | 1 of 1 OK loaded seed file no_schema.crop_codes...................... [OK in 4.43s]
2021-01-25 16:36:53.596814 (Thread-1): Finished running node seed.subsurface.crop_codes
2021-01-25 16:36:53.657743 (MainThread): Acquiring new dremio connection "master".
2021-01-25 16:36:53.658167 (MainThread): On master: ROLLBACK
2021-01-25 16:36:53.658411 (MainThread): Opening a new connection, currently in state init
2021-01-25 16:36:53.658573 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 16:36:53.911557 (MainThread): Connected to db: None
2021-01-25 16:36:53.912068 (MainThread): On master: ROLLBACK
2021-01-25 16:36:53.912413 (MainThread): On master: Close
2021-01-25 16:36:53.914043 (MainThread): 17:36:53 | 
2021-01-25 16:36:53.914474 (MainThread): 17:36:53 | Finished running 1 seed in 5.77s.
2021-01-25 16:36:53.914830 (MainThread): Connection 'master' was properly closed.
2021-01-25 16:36:53.915142 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 16:36:53.915464 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 16:36:53.939703 (MainThread): 
2021-01-25 16:36:53.940249 (MainThread): Completed successfully
2021-01-25 16:36:53.940686 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 16:36:53.941303 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3379ad6c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3379b52908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3379b52080>]}
2021-01-25 16:36:53.941897 (MainThread): Flushing usage events
2021-01-25 18:01:49.783247 (MainThread): Running with dbt=0.18.1
2021-01-25 18:01:50.260663 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 18:01:50.307113 (MainThread): Tracking: tracking
2021-01-25 18:01:50.353197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d1d90748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d1d90da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d1d90e10>]}
2021-01-25 18:01:50.448176 (MainThread): Partial parsing not enabled
2021-01-25 18:01:50.463848 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 18:01:50.495459 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 18:01:50.560319 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 18:01:50.567557 (MainThread): Parsing macros/helpers.sql
2021-01-25 18:01:50.596652 (MainThread): Parsing macros/catalog.sql
2021-01-25 18:01:50.601564 (MainThread): Parsing macros/adapters.sql
2021-01-25 18:01:50.647942 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 18:01:50.650522 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 18:01:50.656479 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 18:01:50.657189 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 18:01:50.663470 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 18:01:50.682156 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 18:01:50.700453 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 18:01:50.709193 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 18:01:50.724219 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 18:01:50.736749 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 18:01:50.782544 (MainThread): Parsing macros/core.sql
2021-01-25 18:01:50.793975 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 18:01:50.877856 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 18:01:50.895825 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 18:01:50.899578 (MainThread): Parsing macros/etc/query.sql
2021-01-25 18:01:50.902201 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 18:01:50.904558 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 18:01:50.909528 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 18:01:50.913206 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 18:01:50.932236 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 18:01:50.936352 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 18:01:50.949347 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 18:01:51.002736 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 18:01:51.036473 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 18:01:51.040387 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 18:01:51.050647 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 18:01:51.063318 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 18:01:51.091111 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 18:01:51.105083 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 18:01:51.145966 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 18:01:51.150261 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 18:01:51.153840 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 18:01:51.158474 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 18:01:51.173599 (MainThread): Partial parsing not enabled
2021-01-25 18:01:51.316999 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 18:01:51.952539 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 1 source
2021-01-25 18:01:51.953919 (MainThread): 
2021-01-25 18:01:51.954612 (MainThread): Acquiring new dremio connection "master".
2021-01-25 18:01:51.958853 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 18:01:51.986225 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 18:01:51.986498 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 18:01:51.986632 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 18:01:51.986745 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 18:01:53.230549 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 18:01:53.704148 (ThreadPoolExecutor-0_0): SQL status: OK in 1.72 seconds
2021-01-25 18:01:53.737275 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 18:01:53.748957 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 18:01:53.767627 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 18:01:53.767918 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 18:01:53.768088 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 18:01:53.768219 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 18:01:53.909101 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 18:01:54.386022 (ThreadPoolExecutor-1_0): SQL status: OK in 0.62 seconds
2021-01-25 18:01:54.410189 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 18:01:54.415172 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 18:01:54.417111 (MainThread): 19:01:54 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 18:01:54.421325 (MainThread): 19:01:54 | 
2021-01-25 18:01:54.468839 (Thread-2): Began running node seed.subsurface.crop_codes
2021-01-25 18:01:54.480561 (Thread-2): 19:01:54 | 1 of 1 START seed file @fab4.crop_codes.............................. [RUN]
2021-01-25 18:01:54.481200 (Thread-2): Acquiring new dremio connection "seed.subsurface.crop_codes".
2021-01-25 18:01:54.481451 (Thread-2): finished collecting timing info
2021-01-25 18:01:54.786726 (Thread-2): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 18:01:54.787214 (Thread-2): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a96a56cc-3a4c-43ed-9e3d-5958da96221f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d1a9b9b0>]}
2021-01-25 18:01:54.885965 (Thread-2): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 18:01:54.912834 (Thread-2): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 18:01:54.913222 (Thread-2): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 18:01:54.913595 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 18:01:54.918340 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 18:01:55.152325 (Thread-2): Connected to db: None
2021-01-25 18:01:55.482770 (Thread-2): SQL status: OK in 0.57 seconds
2021-01-25 18:01:55.503785 (Thread-2): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_codes_green">]
2021-01-25 18:01:55.504546 (Thread-2): On "seed.subsurface.crop_codes": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 18:01:55.515284 (Thread-2): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 18:01:55.515857 (Thread-2): On seed.subsurface.crop_codes: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 18:01:55.831514 (Thread-2): SQL status: OK in 0.32 seconds
2021-01-25 18:01:55.878478 (Thread-2): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_codes_green">]
2021-01-25 18:01:55.955562 (Thread-2): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 18:01:55.956066 (Thread-2): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_blue"
2021-01-25 18:01:55.998976 (Thread-2): SQL status: OK in 0.04 seconds
2021-01-25 18:01:56.029352 (Thread-2): Writing runtime SQL for node "seed.subsurface.crop_codes"
2021-01-25 18:01:56.059980 (Thread-2): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 18:01:56.060304 (Thread-2): On seed.subsurface.crop_codes: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_codes_blue"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_name as varchar)
        as crop_name
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'BB'
          ,
            'oisBFFutaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_name )

  )

  
2021-01-25 18:01:56.468774 (Thread-2): SQL status: OK in 0.41 seconds
2021-01-25 18:01:56.497515 (Thread-2): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 18:01:56.497915 (Thread-2): On seed.subsurface.crop_codes: 
    
  create or replace view "@fab4"."crop_codes" as (
    select * from "$scratch"."subsurface"."@fab4"."crop_codes_blue"
  )

  
2021-01-25 18:01:56.620341 (Thread-2): SQL status: OK in 0.12 seconds
2021-01-25 18:01:56.626791 (Thread-2): Using dremio connection "seed.subsurface.crop_codes".
2021-01-25 18:01:56.631294 (Thread-2): On seed.subsurface.crop_codes: drop table if exists "$scratch"."subsurface"."@fab4"."crop_codes_green"
2021-01-25 18:01:56.688943 (Thread-2): SQL status: OK in 0.06 seconds
2021-01-25 18:01:56.720518 (Thread-2): finished collecting timing info
2021-01-25 18:01:56.721569 (Thread-2): On seed.subsurface.crop_codes: ROLLBACK
2021-01-25 18:01:56.722244 (Thread-2): On seed.subsurface.crop_codes: Close
2021-01-25 18:01:56.725333 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a96a56cc-3a4c-43ed-9e3d-5958da96221f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d1a25fd0>]}
2021-01-25 18:01:56.731668 (Thread-2): 19:01:56 | 1 of 1 OK loaded seed file no_schema.crop_codes...................... [OK in 2.24s]
2021-01-25 18:01:56.733345 (Thread-2): Finished running node seed.subsurface.crop_codes
2021-01-25 18:01:56.744103 (MainThread): Acquiring new dremio connection "master".
2021-01-25 18:01:56.744532 (MainThread): On master: ROLLBACK
2021-01-25 18:01:56.744775 (MainThread): Opening a new connection, currently in state init
2021-01-25 18:01:56.744962 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 18:01:56.967468 (MainThread): Connected to db: None
2021-01-25 18:01:56.967879 (MainThread): On master: ROLLBACK
2021-01-25 18:01:56.968068 (MainThread): On master: Close
2021-01-25 18:01:56.976253 (MainThread): 19:01:56 | 
2021-01-25 18:01:56.977706 (MainThread): 19:01:56 | Finished running 1 seed in 5.02s.
2021-01-25 18:01:56.978464 (MainThread): Connection 'master' was properly closed.
2021-01-25 18:01:56.978733 (MainThread): Connection 'seed.subsurface.crop_codes' was properly closed.
2021-01-25 18:01:56.979011 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 18:01:56.986889 (MainThread): 
2021-01-25 18:01:56.987668 (MainThread): Completed successfully
2021-01-25 18:01:56.987997 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 18:01:56.988440 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d1c3b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d1b129b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d1b12ba8>]}
2021-01-25 18:01:56.988864 (MainThread): Flushing usage events
2021-01-25 20:42:06.860056 (MainThread): Running with dbt=0.18.1
2021-01-25 20:42:07.114589 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 20:42:07.137845 (MainThread): Tracking: tracking
2021-01-25 20:42:07.155297 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec8348b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec8348da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec8348e10>]}
2021-01-25 20:42:07.216690 (MainThread): Partial parsing not enabled
2021-01-25 20:42:07.233088 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:42:07.264539 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:42:07.279097 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:42:07.286746 (MainThread): Parsing macros/helpers.sql
2021-01-25 20:42:07.313106 (MainThread): Parsing macros/catalog.sql
2021-01-25 20:42:07.318131 (MainThread): Parsing macros/adapters.sql
2021-01-25 20:42:07.365413 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:42:07.370828 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 20:42:07.377558 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 20:42:07.378511 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 20:42:07.386087 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 20:42:07.404891 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:42:07.422433 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:42:07.431006 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 20:42:07.445789 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:42:07.456943 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:42:07.501578 (MainThread): Parsing macros/core.sql
2021-01-25 20:42:07.513108 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 20:42:07.595158 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 20:42:07.612270 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 20:42:07.616045 (MainThread): Parsing macros/etc/query.sql
2021-01-25 20:42:07.618742 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 20:42:07.621074 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 20:42:07.625400 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 20:42:07.629062 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 20:42:07.646832 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 20:42:07.650873 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:42:07.663623 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 20:42:07.715558 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 20:42:07.747812 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 20:42:07.751653 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 20:42:07.761717 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:42:07.773763 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 20:42:07.800192 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:42:07.813265 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:42:07.852888 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 20:42:07.857088 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 20:42:07.860593 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 20:42:07.864672 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 20:42:07.879571 (MainThread): Partial parsing not enabled
2021-01-25 20:42:08.019221 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 20:42:08.566228 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 1 source
2021-01-25 20:42:08.567754 (MainThread): 
2021-01-25 20:42:08.568463 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:42:08.577309 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 20:42:08.604295 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 20:42:08.604626 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 20:42:08.604813 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 20:42:08.604966 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:42:09.195531 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 20:42:09.447662 (ThreadPoolExecutor-0_0): SQL status: OK in 0.84 seconds
2021-01-25 20:42:09.494754 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 20:42:09.521219 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 20:42:09.551094 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 20:42:09.551374 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 20:42:09.551536 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 20:42:09.551656 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:42:09.672890 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 20:42:09.996515 (ThreadPoolExecutor-1_0): SQL status: OK in 0.44 seconds
2021-01-25 20:42:10.029589 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 20:42:10.029891 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 20:42:10.036081 (MainThread): 21:42:10 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 20:42:10.036411 (MainThread): 21:42:10 | 
2021-01-25 20:42:10.082235 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-25 20:42:10.082587 (Thread-2): Began running node seed.subsurface.premises_types
2021-01-25 20:42:10.090948 (Thread-2): 21:42:10 | 2 of 3 START seed file @fab4.premises_types.......................... [RUN]
2021-01-25 20:42:10.091767 (Thread-2): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-25 20:42:10.092189 (Thread-2): finished collecting timing info
2021-01-25 20:42:10.088375 (Thread-1): 21:42:10 | 1 of 3 START seed file @fab4.crop_types.............................. [RUN]
2021-01-25 20:42:10.140093 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-25 20:42:10.140389 (Thread-1): finished collecting timing info
2021-01-25 20:42:10.279392 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 20:42:10.281507 (Thread-2): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-01-25 20:42:10.282561 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7abdf80-df30-489d-9b68-72b8c66768a9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec8055fd0>]}
2021-01-25 20:42:10.282799 (Thread-2): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7abdf80-df30-489d-9b68-72b8c66768a9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec80550f0>]}
2021-01-25 20:42:10.333728 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:42:10.337544 (Thread-2): On "seed.subsurface.premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:42:10.348228 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:42:10.348506 (Thread-2): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:42:10.348642 (Thread-2): Opening a new connection, currently in state init
2021-01-25 20:42:10.348763 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:42:10.342668 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:42:10.350573 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:42:10.350794 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:42:10.350916 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:42:10.654727 (Thread-1): Connected to db: None
2021-01-25 20:42:10.664951 (Thread-2): Connected to db: None
2021-01-25 20:42:11.045192 (Thread-1): SQL status: OK in 0.69 seconds
2021-01-25 20:42:11.089047 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_codes_blue">]
2021-01-25 20:42:11.089807 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:42:11.111233 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:42:11.111579 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:42:11.185704 (Thread-2): SQL status: OK in 0.84 seconds
2021-01-25 20:42:11.223650 (Thread-2): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_codes_blue">]
2021-01-25 20:42:11.224337 (Thread-2): On "seed.subsurface.premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:42:11.230263 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:42:11.234687 (Thread-2): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:42:11.763379 (Thread-1): SQL status: OK in 0.65 seconds
2021-01-25 20:42:11.810176 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_codes_blue">]
2021-01-25 20:42:11.875169 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:42:11.875499 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."subsurface"."@fab4"."crop_types_green"
2021-01-25 20:42:11.875713 (Thread-2): SQL status: OK in 0.64 seconds
2021-01-25 20:42:11.895151 (Thread-2): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_codes_blue">]
2021-01-25 20:42:11.899618 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:42:11.899939 (Thread-2): On seed.subsurface.premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."premises_types_green"
2021-01-25 20:42:11.944543 (Thread-1): SQL status: OK in 0.07 seconds
2021-01-25 20:42:11.987991 (Thread-2): SQL status: OK in 0.09 seconds
2021-01-25 20:42:12.011046 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_types"
2021-01-25 20:42:12.011809 (Thread-2): Writing runtime SQL for node "seed.subsurface.premises_types"
2021-01-25 20:42:12.034658 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:42:12.034931 (Thread-1): On seed.subsurface.crop_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_types_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_desc as varchar)
        as crop_desc
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'B'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_desc )

  )

  
2021-01-25 20:42:12.036943 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:42:12.037237 (Thread-2): On seed.subsurface.premises_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."premises_types_green"
  as (
    select
    cast(premises_code as bigint)
        as premises_code,cast(premises_label_fr as varchar)
        as premises_label_fr,cast(premises_label_en as varchar)
        as premises_label_en
  from
    (values
      
        (
            '1'
          ,
            'Maison'
          ,
            'House'
          ),
      
        (
            '2'
          ,
            'Appartement'
          ,
            'Flat'
          ),
      
        (
            '3'
          ,
            'Dépendance'
          ,
            'Outbuilding'
          ),
      
        (
            '4'
          ,
            'Local industriel. commercial ou assimilé'
          ,
            'Industrial premises. commercial or similar'
          )
      ) temp_table ( premises_code, premises_label_fr, premises_label_en )

  )

  
2021-01-25 20:42:12.854392 (Thread-1): SQL status: OK in 0.82 seconds
2021-01-25 20:42:12.882245 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:42:12.886747 (Thread-1): On seed.subsurface.crop_types: 
    
  create or replace view "@fab4"."crop_types" as (
    select * from "$scratch"."subsurface"."@fab4"."crop_types_green"
  )

  
2021-01-25 20:42:13.058589 (Thread-2): SQL status: OK in 1.02 seconds
2021-01-25 20:42:13.060874 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:42:13.066595 (Thread-2): On seed.subsurface.premises_types: 
    
  create or replace view "@fab4"."premises_types" as (
    select * from "$scratch"."subsurface"."@fab4"."premises_types_green"
  )

  
2021-01-25 20:42:13.167377 (Thread-1): SQL status: OK in 0.28 seconds
2021-01-25 20:42:13.176470 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:42:13.176762 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."subsurface"."@fab4"."crop_types_blue"
2021-01-25 20:42:13.479750 (Thread-2): SQL status: OK in 0.41 seconds
2021-01-25 20:42:13.489291 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:42:13.497041 (Thread-2): On seed.subsurface.premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."premises_types_blue"
2021-01-25 20:42:13.502976 (Thread-1): SQL status: OK in 0.33 seconds
2021-01-25 20:42:13.566581 (Thread-2): SQL status: OK in 0.07 seconds
2021-01-25 20:42:13.582608 (Thread-2): finished collecting timing info
2021-01-25 20:42:13.558196 (Thread-1): finished collecting timing info
2021-01-25 20:42:13.584986 (Thread-1): On seed.subsurface.crop_types: ROLLBACK
2021-01-25 20:42:13.585427 (Thread-1): On seed.subsurface.crop_types: Close
2021-01-25 20:42:13.587518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7abdf80-df30-489d-9b68-72b8c66768a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec7fc1f98>]}
2021-01-25 20:42:13.597618 (Thread-1): 21:42:13 | 1 of 3 OK loaded seed file no_schema.crop_types...................... [OK in 3.45s]
2021-01-25 20:42:13.598147 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-25 20:42:13.584465 (Thread-2): On seed.subsurface.premises_types: ROLLBACK
2021-01-25 20:42:13.599421 (Thread-2): On seed.subsurface.premises_types: Close
2021-01-25 20:42:13.601576 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7abdf80-df30-489d-9b68-72b8c66768a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec81212e8>]}
2021-01-25 20:42:13.602361 (Thread-2): 21:42:13 | 2 of 3 OK loaded seed file no_schema.premises_types.................. [OK in 3.51s]
2021-01-25 20:42:13.602867 (Thread-2): Finished running node seed.subsurface.premises_types
2021-01-25 20:42:13.598746 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-25 20:42:13.611333 (Thread-1): 21:42:13 | 3 of 3 START seed file @fab4.transfer_types.......................... [RUN]
2021-01-25 20:42:13.612297 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:42:13.618628 (Thread-1): finished collecting timing info
2021-01-25 20:42:13.668628 (Thread-1): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:42:13.708303 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:42:13.708629 (Thread-1): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:42:13.708835 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:42:13.708996 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:42:13.896563 (Thread-1): Connected to db: None
2021-01-25 20:42:14.414596 (Thread-1): SQL status: OK in 0.71 seconds
2021-01-25 20:42:14.470963 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_codes_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">]
2021-01-25 20:42:14.471921 (Thread-1): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:42:14.491836 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:42:14.498861 (Thread-1): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:42:14.987175 (Thread-1): SQL status: OK in 0.49 seconds
2021-01-25 20:42:15.031953 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_codes_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">]
2021-01-25 20:42:15.036620 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:42:15.036995 (Thread-1): On seed.subsurface.transfer_types: drop table if exists "$scratch"."subsurface"."@fab4"."transfer_types_green"
2021-01-25 20:42:15.112393 (Thread-1): SQL status: OK in 0.08 seconds
2021-01-25 20:42:15.115272 (Thread-1): Writing runtime SQL for node "seed.subsurface.transfer_types"
2021-01-25 20:42:15.115955 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:42:15.116211 (Thread-1): On seed.subsurface.transfer_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."transfer_types_green"
  as (
    select
    cast(transfer_desc_fr as varchar)
        as transfer_desc_fr,cast(transfer_desc_en as varchar)
        as transfer_desc_en
  from
    (values
      
        (
            'Expropriation'
          ,
            'Expropriation'
          ),
      
        (
            'Vente'
          ,
            'Sale'
          ),
      
        (
            'Echange'
          ,
            'Exchange'
          ),
      
        (
            'Adjudication'
          ,
            'Sale by tender'
          ),
      
        (
            'Vente en l''état futur d''achèvement'
          ,
            'Sale before completion'
          ),
      
        (
            'Vente terrain à bâtir'
          ,
            'Building plot sale'
          )
      ) temp_table ( transfer_desc_fr, transfer_desc_en )

  )

  
2021-01-25 20:42:15.630793 (Thread-1): SQL status: OK in 0.51 seconds
2021-01-25 20:42:15.633512 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:42:15.633940 (Thread-1): On seed.subsurface.transfer_types: 
    
  create or replace view "@fab4"."transfer_types" as (
    select * from "$scratch"."subsurface"."@fab4"."transfer_types_green"
  )

  
2021-01-25 20:42:15.970698 (Thread-1): SQL status: OK in 0.34 seconds
2021-01-25 20:42:15.978153 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:42:15.982622 (Thread-1): On seed.subsurface.transfer_types: drop table if exists "$scratch"."subsurface"."@fab4"."transfer_types_blue"
2021-01-25 20:42:16.003624 (Thread-1): SQL status: OK in 0.02 seconds
2021-01-25 20:42:16.015668 (Thread-1): finished collecting timing info
2021-01-25 20:42:16.016459 (Thread-1): On seed.subsurface.transfer_types: ROLLBACK
2021-01-25 20:42:16.016802 (Thread-1): On seed.subsurface.transfer_types: Close
2021-01-25 20:42:16.027019 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7abdf80-df30-489d-9b68-72b8c66768a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec44c0518>]}
2021-01-25 20:42:16.027654 (Thread-1): 21:42:16 | 3 of 3 OK loaded seed file no_schema.transfer_types.................. [OK in 2.41s]
2021-01-25 20:42:16.028062 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-25 20:42:16.120868 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:42:16.121351 (MainThread): On master: ROLLBACK
2021-01-25 20:42:16.121693 (MainThread): Opening a new connection, currently in state init
2021-01-25 20:42:16.122015 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:42:16.258037 (MainThread): Connected to db: None
2021-01-25 20:42:16.258594 (MainThread): On master: ROLLBACK
2021-01-25 20:42:16.258996 (MainThread): On master: Close
2021-01-25 20:42:16.260855 (MainThread): 21:42:16 | 
2021-01-25 20:42:16.261361 (MainThread): 21:42:16 | Finished running 3 seeds in 7.69s.
2021-01-25 20:42:16.261837 (MainThread): Connection 'master' was properly closed.
2021-01-25 20:42:16.264683 (MainThread): Connection 'seed.subsurface.transfer_types' was properly closed.
2021-01-25 20:42:16.265091 (MainThread): Connection 'seed.subsurface.premises_types' was properly closed.
2021-01-25 20:42:16.287856 (MainThread): 
2021-01-25 20:42:16.288398 (MainThread): Completed successfully
2021-01-25 20:42:16.288875 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-25 20:42:16.289523 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec44c01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec7f7d048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec7f7d518>]}
2021-01-25 20:42:16.290167 (MainThread): Flushing usage events
2021-01-25 20:47:05.729571 (MainThread): Running with dbt=0.18.1
2021-01-25 20:47:05.887787 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 20:47:05.889219 (MainThread): Tracking: tracking
2021-01-25 20:47:05.897790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d778edc88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d77400dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d77400e48>]}
2021-01-25 20:47:05.977971 (MainThread): Partial parsing not enabled
2021-01-25 20:47:05.982909 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:47:05.994829 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:47:06.000584 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:47:06.009719 (MainThread): Parsing macros/helpers.sql
2021-01-25 20:47:06.060395 (MainThread): Parsing macros/catalog.sql
2021-01-25 20:47:06.065620 (MainThread): Parsing macros/adapters.sql
2021-01-25 20:47:06.115736 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:47:06.118471 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 20:47:06.124232 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 20:47:06.124736 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 20:47:06.130668 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 20:47:06.151223 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:47:06.168658 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:47:06.177203 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 20:47:06.193532 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:47:06.204488 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:47:06.232362 (MainThread): Parsing macros/core.sql
2021-01-25 20:47:06.240260 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 20:47:06.320684 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 20:47:06.337815 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 20:47:06.341368 (MainThread): Parsing macros/etc/query.sql
2021-01-25 20:47:06.343693 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 20:47:06.345813 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 20:47:06.350019 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 20:47:06.353459 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 20:47:06.371182 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 20:47:06.375092 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:47:06.387307 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 20:47:06.440136 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 20:47:06.474676 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 20:47:06.478391 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 20:47:06.488182 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:47:06.500511 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 20:47:06.528918 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:47:06.543094 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:47:06.582163 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 20:47:06.586141 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 20:47:06.589656 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 20:47:06.593410 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 20:47:06.608524 (MainThread): Partial parsing not enabled
2021-01-25 20:47:06.723913 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 20:47:07.318309 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 1 source
2021-01-25 20:47:07.320416 (MainThread): 
2021-01-25 20:47:07.321234 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:47:07.331326 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 20:47:07.357672 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 20:47:07.358063 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 20:47:07.358336 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 20:47:07.358549 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:47:07.525409 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 20:47:07.787777 (ThreadPoolExecutor-0_0): SQL status: OK in 0.43 seconds
2021-01-25 20:47:07.830211 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 20:47:07.852908 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 20:47:07.875582 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 20:47:07.876015 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 20:47:07.876376 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 20:47:07.876658 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:47:08.028029 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 20:47:08.306203 (ThreadPoolExecutor-1_0): SQL status: OK in 0.43 seconds
2021-01-25 20:47:08.329409 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 20:47:08.330000 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 20:47:08.332480 (MainThread): 21:47:08 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 20:47:08.335008 (MainThread): 21:47:08 | 
2021-01-25 20:47:08.383929 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-25 20:47:08.388447 (Thread-1): 21:47:08 | 1 of 3 START seed file @fab4.crop_types.............................. [RUN]
2021-01-25 20:47:08.388956 (Thread-2): Began running node seed.subsurface.premises_types
2021-01-25 20:47:08.393221 (Thread-2): 21:47:08 | 2 of 3 START seed file @fab4.premises_types.......................... [RUN]
2021-01-25 20:47:08.394175 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-25 20:47:08.394942 (Thread-2): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-25 20:47:08.397267 (Thread-2): finished collecting timing info
2021-01-25 20:47:08.395422 (Thread-1): finished collecting timing info
2021-01-25 20:47:08.781555 (Thread-2): On "seed.subsurface.premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:47:08.787247 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:47:08.800454 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:47:08.801121 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:47:08.801940 (Thread-2): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:47:08.802170 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:47:08.802341 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:47:08.801604 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:47:08.806410 (Thread-1): Opening a new connection, currently in state init
2021-01-25 20:47:08.806712 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:47:09.115872 (Thread-2): Connected to db: None
2021-01-25 20:47:09.132891 (Thread-1): Connected to db: None
2021-01-25 20:47:09.651890 (Thread-2): SQL status: OK in 0.85 seconds
2021-01-25 20:47:09.711928 (Thread-2): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 20:47:09.712616 (Thread-2): On "seed.subsurface.premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:47:09.722177 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:47:09.729379 (Thread-2): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:47:09.774772 (Thread-1): SQL status: OK in 0.97 seconds
2021-01-25 20:47:09.817823 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 20:47:09.818628 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:47:09.839992 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:47:09.840335 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:47:10.446390 (Thread-2): SQL status: OK in 0.72 seconds
2021-01-25 20:47:10.450594 (Thread-1): SQL status: OK in 0.61 seconds
2021-01-25 20:47:10.496485 (Thread-2): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 20:47:10.515281 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 20:47:10.532575 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:47:10.531337 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:47:10.533214 (Thread-2): On seed.subsurface.premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."premises_types_blue"
2021-01-25 20:47:10.532958 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."subsurface"."@fab4"."crop_types_blue"
2021-01-25 20:47:10.602718 (Thread-2): SQL status: OK in 0.07 seconds
2021-01-25 20:47:10.622386 (Thread-2): Writing runtime SQL for node "seed.subsurface.premises_types"
2021-01-25 20:47:10.623291 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:47:10.623666 (Thread-2): On seed.subsurface.premises_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."premises_types_blue"
  as (
    select
    cast(premises_code as bigint)
        as premises_code,cast(premises_label_fr as varchar)
        as premises_label_fr,cast(premises_label_en as varchar)
        as premises_label_en
  from
    (values
      
        (
            '1'
          ,
            'Maison'
          ,
            'House'
          ),
      
        (
            '2'
          ,
            'Appartement'
          ,
            'Flat'
          ),
      
        (
            '3'
          ,
            'Dépendance'
          ,
            'Outbuilding'
          ),
      
        (
            '4'
          ,
            'Local industriel. commercial ou assimilé'
          ,
            'Industrial premises. commercial or similar'
          )
      ) temp_table ( premises_code, premises_label_fr, premises_label_en )

  )

  
2021-01-25 20:47:10.623913 (Thread-1): SQL status: OK in 0.09 seconds
2021-01-25 20:47:10.628815 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_types"
2021-01-25 20:47:10.629564 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:47:10.629887 (Thread-1): On seed.subsurface.crop_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_types_blue"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_label as varchar)
        as crop_label
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'B'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_label )

  )

  
2021-01-25 20:47:10.868888 (Thread-2): SQL status: OK in 0.24 seconds
2021-01-25 20:47:10.884485 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:47:10.890585 (Thread-2): On seed.subsurface.premises_types: 
    
  create or replace view "@fab4"."premises_types" as (
    select * from "$scratch"."subsurface"."@fab4"."premises_types_blue"
  )

  
2021-01-25 20:47:11.027969 (Thread-2): SQL status: OK in 0.14 seconds
2021-01-25 20:47:11.044691 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 20:47:11.045105 (Thread-2): On seed.subsurface.premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."premises_types_green"
2021-01-25 20:47:11.096507 (Thread-2): SQL status: OK in 0.05 seconds
2021-01-25 20:47:11.154052 (Thread-2): finished collecting timing info
2021-01-25 20:47:11.174066 (Thread-2): On seed.subsurface.premises_types: ROLLBACK
2021-01-25 20:47:11.174395 (Thread-2): On seed.subsurface.premises_types: Close
2021-01-25 20:47:11.176271 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577fcdc6-e44f-47ee-a81a-78c6352f4bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d77171518>]}
2021-01-25 20:47:11.176912 (Thread-2): 21:47:11 | 2 of 3 OK loaded seed file no_schema.premises_types.................. [OK in 2.78s]
2021-01-25 20:47:11.177320 (Thread-2): Finished running node seed.subsurface.premises_types
2021-01-25 20:47:11.177751 (Thread-2): Began running node seed.subsurface.transfer_types
2021-01-25 20:47:11.180644 (Thread-2): 21:47:11 | 3 of 3 START seed file @fab4.transfer_types.......................... [RUN]
2021-01-25 20:47:11.186984 (Thread-2): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:47:11.190571 (Thread-2): finished collecting timing info
2021-01-25 20:47:11.226747 (Thread-2): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:47:11.240212 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:47:11.240584 (Thread-2): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:47:11.242517 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:47:11.242819 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:47:11.569163 (Thread-2): Connected to db: None
2021-01-25 20:47:11.859688 (Thread-1): SQL status: OK in 1.23 seconds
2021-01-25 20:47:11.863252 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:47:11.863671 (Thread-1): On seed.subsurface.crop_types: 
    
  create or replace view "@fab4"."crop_types" as (
    select * from "$scratch"."subsurface"."@fab4"."crop_types_blue"
  )

  
2021-01-25 20:47:12.068836 (Thread-1): SQL status: OK in 0.20 seconds
2021-01-25 20:47:12.085186 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 20:47:12.085567 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."subsurface"."@fab4"."crop_types_green"
2021-01-25 20:47:12.151308 (Thread-1): SQL status: OK in 0.07 seconds
2021-01-25 20:47:12.171512 (Thread-1): finished collecting timing info
2021-01-25 20:47:12.178787 (Thread-1): On seed.subsurface.crop_types: ROLLBACK
2021-01-25 20:47:12.179234 (Thread-1): On seed.subsurface.crop_types: Close
2021-01-25 20:47:12.181566 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577fcdc6-e44f-47ee-a81a-78c6352f4bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d770abcc0>]}
2021-01-25 20:47:12.186599 (Thread-1): 21:47:12 | 1 of 3 OK loaded seed file no_schema.crop_types...................... [OK in 3.79s]
2021-01-25 20:47:12.190604 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-25 20:47:12.288329 (Thread-2): SQL status: OK in 1.05 seconds
2021-01-25 20:47:12.337739 (Thread-2): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 20:47:12.342989 (Thread-2): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 20:47:12.364818 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:47:12.370526 (Thread-2): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 20:47:13.900639 (Thread-2): SQL status: OK in 1.53 seconds
2021-01-25 20:47:13.935610 (Thread-2): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 20:47:13.939955 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:47:13.950512 (Thread-2): On seed.subsurface.transfer_types: drop table if exists "$scratch"."subsurface"."@fab4"."transfer_types_blue"
2021-01-25 20:47:13.969150 (Thread-2): SQL status: OK in 0.02 seconds
2021-01-25 20:47:13.972678 (Thread-2): Writing runtime SQL for node "seed.subsurface.transfer_types"
2021-01-25 20:47:13.973650 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:47:13.974048 (Thread-2): On seed.subsurface.transfer_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."transfer_types_blue"
  as (
    select
    cast(transfer_label_fr as varchar)
        as transfer_label_fr,cast(transfer_label_en as varchar)
        as transfer_label_en
  from
    (values
      
        (
            'Expropriation'
          ,
            'Expropriation'
          ),
      
        (
            'Vente'
          ,
            'Sale'
          ),
      
        (
            'Echange'
          ,
            'Exchange'
          ),
      
        (
            'Adjudication'
          ,
            'Sale by tender'
          ),
      
        (
            'Vente en l''état futur d''achèvement'
          ,
            'Sale before completion'
          ),
      
        (
            'Vente terrain à bâtir'
          ,
            'Building plot sale'
          )
      ) temp_table ( transfer_label_fr, transfer_label_en )

  )

  
2021-01-25 20:47:14.604501 (Thread-2): SQL status: OK in 0.63 seconds
2021-01-25 20:47:14.607804 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:47:14.608275 (Thread-2): On seed.subsurface.transfer_types: 
    
  create or replace view "@fab4"."transfer_types" as (
    select * from "$scratch"."subsurface"."@fab4"."transfer_types_blue"
  )

  
2021-01-25 20:47:14.766598 (Thread-2): SQL status: OK in 0.16 seconds
2021-01-25 20:47:14.773261 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 20:47:14.782859 (Thread-2): On seed.subsurface.transfer_types: drop table if exists "$scratch"."subsurface"."@fab4"."transfer_types_green"
2021-01-25 20:47:14.871626 (Thread-2): SQL status: OK in 0.09 seconds
2021-01-25 20:47:14.887169 (Thread-2): finished collecting timing info
2021-01-25 20:47:14.887874 (Thread-2): On seed.subsurface.transfer_types: ROLLBACK
2021-01-25 20:47:14.888149 (Thread-2): On seed.subsurface.transfer_types: Close
2021-01-25 20:47:14.890188 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577fcdc6-e44f-47ee-a81a-78c6352f4bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d765f5198>]}
2021-01-25 20:47:14.890878 (Thread-2): 21:47:14 | 3 of 3 OK loaded seed file no_schema.transfer_types.................. [OK in 3.70s]
2021-01-25 20:47:14.891288 (Thread-2): Finished running node seed.subsurface.transfer_types
2021-01-25 20:47:14.989335 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:47:14.989810 (MainThread): On master: ROLLBACK
2021-01-25 20:47:14.990147 (MainThread): Opening a new connection, currently in state init
2021-01-25 20:47:14.990508 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:47:15.140938 (MainThread): Connected to db: None
2021-01-25 20:47:15.141455 (MainThread): On master: ROLLBACK
2021-01-25 20:47:15.141814 (MainThread): On master: Close
2021-01-25 20:47:15.143649 (MainThread): 21:47:15 | 
2021-01-25 20:47:15.145195 (MainThread): 21:47:15 | Finished running 3 seeds in 7.82s.
2021-01-25 20:47:15.150549 (MainThread): Connection 'master' was properly closed.
2021-01-25 20:47:15.150900 (MainThread): Connection 'seed.subsurface.transfer_types' was properly closed.
2021-01-25 20:47:15.151228 (MainThread): Connection 'seed.subsurface.crop_types' was properly closed.
2021-01-25 20:47:15.194924 (MainThread): 
2021-01-25 20:47:15.195494 (MainThread): Completed successfully
2021-01-25 20:47:15.195802 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-25 20:47:15.196219 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d765f5198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d77182b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d772a3ef0>]}
2021-01-25 20:47:15.196653 (MainThread): Flushing usage events
2021-01-25 20:50:51.420162 (MainThread): Running with dbt=0.18.1
2021-01-25 20:50:51.568765 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 20:50:51.570366 (MainThread): Tracking: tracking
2021-01-25 20:50:51.579494 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd70fddca58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd70fdf8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd70fdf8e80>]}
2021-01-25 20:50:51.644108 (MainThread): Partial parsing not enabled
2021-01-25 20:50:51.645875 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:50:51.653730 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:50:51.658723 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:50:51.665025 (MainThread): Parsing macros/helpers.sql
2021-01-25 20:50:51.705542 (MainThread): Parsing macros/catalog.sql
2021-01-25 20:50:51.714494 (MainThread): Parsing macros/adapters.sql
2021-01-25 20:50:51.767127 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:50:51.769550 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 20:50:51.775334 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 20:50:51.775824 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 20:50:51.781265 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 20:50:51.799756 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:50:51.818092 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:50:51.826493 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 20:50:51.841244 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:50:51.852104 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:50:51.888033 (MainThread): Parsing macros/core.sql
2021-01-25 20:50:51.898102 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 20:50:51.982522 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 20:50:51.999834 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 20:50:52.003466 (MainThread): Parsing macros/etc/query.sql
2021-01-25 20:50:52.005774 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 20:50:52.007870 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 20:50:52.012028 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 20:50:52.015451 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 20:50:52.042253 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 20:50:52.048006 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:50:52.061910 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 20:50:52.133082 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 20:50:52.173586 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 20:50:52.178430 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 20:50:52.191311 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:50:52.203359 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 20:50:52.230838 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:50:52.248327 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:50:52.289343 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 20:50:52.293451 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 20:50:52.296660 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 20:50:52.300257 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 20:50:52.315348 (MainThread): Partial parsing not enabled
2021-01-25 20:50:52.430117 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 20:50:53.230818 (MainThread): Found 1 model, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 1 source
2021-01-25 20:50:53.232784 (MainThread): 
2021-01-25 20:50:53.233468 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:50:53.257218 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 20:50:53.279479 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 20:50:53.279775 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 20:50:53.279921 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 20:50:53.280045 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:50:53.421937 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 20:50:53.766605 (ThreadPoolExecutor-1_0): SQL status: OK in 0.49 seconds
2021-01-25 20:50:53.826185 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 20:50:53.827049 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 20:50:53.829664 (MainThread): 21:50:53 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 20:50:53.838789 (MainThread): 21:50:53 | 
2021-01-25 20:50:53.871219 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:50:53.871645 (Thread-1): 21:50:53 | 1 of 4 START test not_null_crop_types_crop_code...................... [RUN]
2021-01-25 20:50:53.872337 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 20:50:53.872677 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:50:53.879602 (Thread-2): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:50:53.880077 (Thread-2): 21:50:53 | 2 of 4 START test not_null_crop_types_crop_label..................... [RUN]
2021-01-25 20:50:53.880714 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 20:50:53.881018 (Thread-2): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:50:53.953649 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 20:50:53.958578 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 20:50:53.968309 (Thread-1): finished collecting timing info
2021-01-25 20:50:53.969039 (Thread-1): Using dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 20:50:53.969209 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_code is null



2021-01-25 20:50:53.969325 (Thread-1): Opening a new connection, currently in state init
2021-01-25 20:50:53.969431 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:50:53.970754 (Thread-2): finished collecting timing info
2021-01-25 20:50:53.971335 (Thread-2): Using dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 20:50:53.971497 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_label is null



2021-01-25 20:50:53.971608 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:50:53.971749 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:50:54.233485 (Thread-1): Connected to db: None
2021-01-25 20:50:54.257914 (Thread-2): Connected to db: None
2021-01-25 20:50:54.900028 (Thread-1): SQL status: OK in 0.93 seconds
2021-01-25 20:50:54.924100 (Thread-1): finished collecting timing info
2021-01-25 20:50:54.924713 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: ROLLBACK
2021-01-25 20:50:54.924932 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: Close
2021-01-25 20:50:54.925871 (Thread-1): 21:50:54 | 1 of 4 PASS not_null_crop_types_crop_code............................ [PASS in 1.05s]
2021-01-25 20:50:54.926201 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:50:54.926465 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 20:50:54.926895 (Thread-1): 21:50:54 | 3 of 4 START test unique_crop_types_crop_code........................ [RUN]
2021-01-25 20:50:54.927697 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 20:50:54.928100 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 20:50:54.975633 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 20:50:54.976039 (Thread-2): SQL status: OK in 1.00 seconds
2021-01-25 20:50:54.976930 (Thread-1): finished collecting timing info
2021-01-25 20:50:54.977643 (Thread-1): Using dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 20:50:54.978731 (Thread-1): On test.subsurface.unique_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from (

    select
        crop_code

    from "@fab4"."crop_types"
    where crop_code is not null
    group by crop_code
    having count(*) > 1

) validation_errors



2021-01-25 20:50:54.982528 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:50:54.982906 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:50:54.987242 (Thread-2): finished collecting timing info
2021-01-25 20:50:54.987819 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: ROLLBACK
2021-01-25 20:50:54.987964 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: Close
2021-01-25 20:50:54.988874 (Thread-2): 21:50:54 | 2 of 4 PASS not_null_crop_types_crop_label........................... [PASS in 1.11s]
2021-01-25 20:50:54.989193 (Thread-2): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:50:54.989417 (Thread-2): Began running node test.subsurface.unique_crop_types_crop_label
2021-01-25 20:50:54.989718 (Thread-2): 21:50:54 | 4 of 4 START test unique_crop_types_crop_label....................... [RUN]
2021-01-25 20:50:54.990183 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_label".
2021-01-25 20:50:54.990444 (Thread-2): Compiling test.subsurface.unique_crop_types_crop_label
2021-01-25 20:50:55.030766 (Thread-2): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_label"
2021-01-25 20:50:55.032672 (Thread-2): finished collecting timing info
2021-01-25 20:50:55.034606 (Thread-2): Using dremio connection "test.subsurface.unique_crop_types_crop_label".
2021-01-25 20:50:55.034949 (Thread-2): On test.subsurface.unique_crop_types_crop_label: 
    
    



select count(*) as validation_errors
from (

    select
        crop_label

    from "@fab4"."crop_types"
    where crop_label is not null
    group by crop_label
    having count(*) > 1

) validation_errors



2021-01-25 20:50:55.042007 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:50:55.042483 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:50:55.346077 (Thread-1): Connected to db: None
2021-01-25 20:50:55.368129 (Thread-2): Connected to db: None
2021-01-25 20:50:56.587049 (Thread-2): SQL status: OK in 1.55 seconds
2021-01-25 20:50:56.594733 (Thread-1): SQL status: OK in 1.61 seconds
2021-01-25 20:50:56.642722 (Thread-2): finished collecting timing info
2021-01-25 20:50:56.643354 (Thread-2): On test.subsurface.unique_crop_types_crop_label: ROLLBACK
2021-01-25 20:50:56.643848 (Thread-2): On test.subsurface.unique_crop_types_crop_label: Close
2021-01-25 20:50:56.644236 (Thread-1): finished collecting timing info
2021-01-25 20:50:56.645113 (Thread-1): On test.subsurface.unique_crop_types_crop_code: ROLLBACK
2021-01-25 20:50:56.645347 (Thread-1): On test.subsurface.unique_crop_types_crop_code: Close
2021-01-25 20:50:56.646256 (Thread-2): 21:50:56 | 4 of 4 PASS unique_crop_types_crop_label............................. [PASS in 1.66s]
2021-01-25 20:50:56.647477 (Thread-1): 21:50:56 | 3 of 4 PASS unique_crop_types_crop_code.............................. [PASS in 1.72s]
2021-01-25 20:50:56.654565 (Thread-2): Finished running node test.subsurface.unique_crop_types_crop_label
2021-01-25 20:50:56.655004 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 20:50:56.688388 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:50:56.689000 (MainThread): 21:50:56 | 
2021-01-25 20:50:56.689245 (MainThread): 21:50:56 | Finished running 4 tests in 3.46s.
2021-01-25 20:50:56.689395 (MainThread): Connection 'master' was properly closed.
2021-01-25 20:50:56.689502 (MainThread): Connection 'test.subsurface.unique_crop_types_crop_label' was properly closed.
2021-01-25 20:50:56.689599 (MainThread): Connection 'test.subsurface.unique_crop_types_crop_code' was properly closed.
2021-01-25 20:50:56.731021 (MainThread): 
2021-01-25 20:50:56.731463 (MainThread): Completed successfully
2021-01-25 20:50:56.731665 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-01-25 20:50:56.732086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd70faefd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd70fbf8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd70fbc86d8>]}
2021-01-25 20:50:56.732512 (MainThread): Flushing usage events
2021-01-25 20:54:23.325479 (MainThread): Running with dbt=0.18.1
2021-01-25 20:54:23.449521 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 20:54:23.451137 (MainThread): Tracking: tracking
2021-01-25 20:54:23.460218 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9896acd908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98965f1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98965f1ef0>]}
2021-01-25 20:54:23.518606 (MainThread): Partial parsing not enabled
2021-01-25 20:54:23.520217 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:54:23.525892 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:54:23.529370 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:54:23.533562 (MainThread): Parsing macros/helpers.sql
2021-01-25 20:54:23.558995 (MainThread): Parsing macros/catalog.sql
2021-01-25 20:54:23.563735 (MainThread): Parsing macros/adapters.sql
2021-01-25 20:54:23.609812 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:54:23.612267 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 20:54:23.618500 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 20:54:23.619121 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 20:54:23.624876 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 20:54:23.643755 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:54:23.661396 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:54:23.669906 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 20:54:23.684812 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:54:23.695938 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:54:23.724075 (MainThread): Parsing macros/core.sql
2021-01-25 20:54:23.731563 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 20:54:23.812992 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 20:54:23.829924 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 20:54:23.833449 (MainThread): Parsing macros/etc/query.sql
2021-01-25 20:54:23.835815 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 20:54:23.837928 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 20:54:23.842109 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 20:54:23.845651 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 20:54:23.863719 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 20:54:23.867571 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:54:23.880270 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 20:54:23.932412 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 20:54:23.965083 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 20:54:23.968759 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 20:54:23.978631 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:54:23.990531 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 20:54:24.017025 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:54:24.030392 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:54:24.069840 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 20:54:24.073849 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 20:54:24.077095 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 20:54:24.080795 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 20:54:24.095926 (MainThread): Partial parsing not enabled
2021-01-25 20:54:24.211637 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 20:54:25.292256 (MainThread): Found 1 model, 11 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 1 source
2021-01-25 20:54:25.294653 (MainThread): 
2021-01-25 20:54:25.295452 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:54:25.345206 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 20:54:25.371910 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 20:54:25.373246 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 20:54:25.373636 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 20:54:25.373909 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:25.540054 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 20:54:26.018786 (ThreadPoolExecutor-1_0): SQL status: OK in 0.65 seconds
2021-01-25 20:54:26.082065 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 20:54:26.082463 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 20:54:26.084742 (MainThread): 21:54:26 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 20:54:26.085149 (MainThread): 21:54:26 | 
2021-01-25 20:54:26.151233 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:54:26.151638 (Thread-1): 21:54:26 | 1 of 11 START test not_null_crop_types_crop_code..................... [RUN]
2021-01-25 20:54:26.151925 (Thread-2): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:54:26.152288 (Thread-2): 21:54:26 | 2 of 11 START test not_null_crop_types_crop_label.................... [RUN]
2021-01-25 20:54:26.153000 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 20:54:26.153353 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:54:26.161242 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 20:54:26.161587 (Thread-2): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:54:26.229659 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 20:54:26.236194 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 20:54:26.236862 (Thread-2): finished collecting timing info
2021-01-25 20:54:26.237446 (Thread-1): finished collecting timing info
2021-01-25 20:54:26.238245 (Thread-1): Using dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 20:54:26.238519 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_code is null



2021-01-25 20:54:26.238638 (Thread-1): Opening a new connection, currently in state init
2021-01-25 20:54:26.238736 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:26.237956 (Thread-2): Using dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 20:54:26.254670 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_label is null



2021-01-25 20:54:26.254941 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:54:26.255148 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:26.506059 (Thread-1): Connected to db: None
2021-01-25 20:54:26.583235 (Thread-2): Connected to db: None
2021-01-25 20:54:26.705970 (Thread-1): SQL status: OK in 0.47 seconds
2021-01-25 20:54:26.729009 (Thread-1): finished collecting timing info
2021-01-25 20:54:26.729612 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: ROLLBACK
2021-01-25 20:54:26.729791 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: Close
2021-01-25 20:54:26.730972 (Thread-1): 21:54:26 | 1 of 11 PASS not_null_crop_types_crop_code........................... [PASS in 0.58s]
2021-01-25 20:54:26.731948 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:54:26.732499 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:54:26.754723 (Thread-1): 21:54:26 | 3 of 11 START test not_null_premises_types_premises_code............. [RUN]
2021-01-25 20:54:26.755423 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 20:54:26.755729 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:54:26.835781 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-25 20:54:26.836959 (Thread-1): finished collecting timing info
2021-01-25 20:54:26.837631 (Thread-1): Using dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 20:54:26.837846 (Thread-1): On test.subsurface.not_null_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_code is null



2021-01-25 20:54:26.838032 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:54:26.838281 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:27.022583 (Thread-2): SQL status: OK in 0.77 seconds
2021-01-25 20:54:27.053126 (Thread-2): finished collecting timing info
2021-01-25 20:54:27.053725 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: ROLLBACK
2021-01-25 20:54:27.053902 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: Close
2021-01-25 20:54:27.055027 (Thread-2): 21:54:27 | 2 of 11 PASS not_null_crop_types_crop_label.......................... [PASS in 0.89s]
2021-01-25 20:54:27.058949 (Thread-2): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:54:27.059590 (Thread-2): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:54:27.074875 (Thread-2): 21:54:27 | 4 of 11 START test not_null_premises_types_premises_label_en......... [RUN]
2021-01-25 20:54:27.075611 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 20:54:27.075965 (Thread-2): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:54:27.122540 (Thread-1): Connected to db: None
2021-01-25 20:54:27.182859 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-25 20:54:27.183526 (Thread-2): finished collecting timing info
2021-01-25 20:54:27.184172 (Thread-2): Using dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 20:54:27.184429 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_en: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_label_en is null



2021-01-25 20:54:27.190552 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:54:27.190868 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:27.406888 (Thread-2): Connected to db: None
2021-01-25 20:54:27.544959 (Thread-1): SQL status: OK in 0.71 seconds
2021-01-25 20:54:27.579957 (Thread-1): finished collecting timing info
2021-01-25 20:54:27.580530 (Thread-1): On test.subsurface.not_null_premises_types_premises_code: ROLLBACK
2021-01-25 20:54:27.580685 (Thread-1): On test.subsurface.not_null_premises_types_premises_code: Close
2021-01-25 20:54:27.582652 (Thread-1): 21:54:27 | 3 of 11 PASS not_null_premises_types_premises_code................... [PASS in 0.83s]
2021-01-25 20:54:27.583118 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:54:27.583558 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:54:27.587691 (Thread-1): 21:54:27 | 5 of 11 START test not_null_premises_types_premises_label_fr......... [RUN]
2021-01-25 20:54:27.588506 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 20:54:27.588930 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:54:27.632367 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-25 20:54:27.633024 (Thread-1): finished collecting timing info
2021-01-25 20:54:27.633728 (Thread-1): Using dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 20:54:27.633975 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_label_fr is null



2021-01-25 20:54:27.634133 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:54:27.634331 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:27.918126 (Thread-2): SQL status: OK in 0.73 seconds
2021-01-25 20:54:27.947245 (Thread-2): finished collecting timing info
2021-01-25 20:54:27.947933 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_en: ROLLBACK
2021-01-25 20:54:27.948180 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_en: Close
2021-01-25 20:54:27.949245 (Thread-2): 21:54:27 | 4 of 11 PASS not_null_premises_types_premises_label_en............... [PASS in 0.87s]
2021-01-25 20:54:27.958587 (Thread-2): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:54:27.958978 (Thread-2): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:54:27.959341 (Thread-2): 21:54:27 | 6 of 11 START test not_null_transfer_types_transfer_label_en......... [RUN]
2021-01-25 20:54:27.960013 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 20:54:27.960376 (Thread-2): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:54:27.968636 (Thread-1): Connected to db: None
2021-01-25 20:54:28.037673 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-25 20:54:28.038306 (Thread-2): finished collecting timing info
2021-01-25 20:54:28.039035 (Thread-2): Using dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 20:54:28.039311 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: 
    
    



select count(*) as validation_errors
from "@fab4"."transfer_types"
where transfer_label_en is null



2021-01-25 20:54:28.039534 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:54:28.039792 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:28.402748 (Thread-2): Connected to db: None
2021-01-25 20:54:28.516034 (Thread-1): SQL status: OK in 0.88 seconds
2021-01-25 20:54:28.559444 (Thread-1): finished collecting timing info
2021-01-25 20:54:28.560086 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_fr: ROLLBACK
2021-01-25 20:54:28.560343 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_fr: Close
2021-01-25 20:54:28.561583 (Thread-1): 21:54:28 | 5 of 11 PASS not_null_premises_types_premises_label_fr............... [PASS in 0.97s]
2021-01-25 20:54:28.562009 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:54:28.563468 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:54:28.564102 (Thread-1): 21:54:28 | 7 of 11 START test not_null_transfer_types_transfer_label_fr......... [RUN]
2021-01-25 20:54:28.564926 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 20:54:28.565285 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:54:28.620643 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-25 20:54:28.621515 (Thread-1): finished collecting timing info
2021-01-25 20:54:28.628449 (Thread-1): Using dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 20:54:28.628869 (Thread-1): On test.subsurface.not_null_transfer_types_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."transfer_types"
where transfer_label_fr is null



2021-01-25 20:54:28.629153 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:54:28.629405 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:28.986483 (Thread-1): Connected to db: None
2021-01-25 20:54:29.061437 (Thread-2): SQL status: OK in 1.02 seconds
2021-01-25 20:54:29.098396 (Thread-2): finished collecting timing info
2021-01-25 20:54:29.099178 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: ROLLBACK
2021-01-25 20:54:29.099525 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: Close
2021-01-25 20:54:29.100774 (Thread-2): 21:54:29 | 6 of 11 PASS not_null_transfer_types_transfer_label_en............... [PASS in 1.14s]
2021-01-25 20:54:29.101164 (Thread-2): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:54:29.101542 (Thread-2): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 20:54:29.102139 (Thread-2): 21:54:29 | 8 of 11 START test unique_crop_types_crop_code....................... [RUN]
2021-01-25 20:54:29.102923 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 20:54:29.103311 (Thread-2): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 20:54:29.149410 (Thread-2): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 20:54:29.150161 (Thread-2): finished collecting timing info
2021-01-25 20:54:29.155889 (Thread-2): Using dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 20:54:29.156177 (Thread-2): On test.subsurface.unique_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from (

    select
        crop_code

    from "@fab4"."crop_types"
    where crop_code is not null
    group by crop_code
    having count(*) > 1

) validation_errors



2021-01-25 20:54:29.156430 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:54:29.156714 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:29.546036 (Thread-2): Connected to db: None
2021-01-25 20:54:29.697358 (Thread-1): SQL status: OK in 1.07 seconds
2021-01-25 20:54:29.723719 (Thread-1): finished collecting timing info
2021-01-25 20:54:29.724446 (Thread-1): On test.subsurface.not_null_transfer_types_transfer_label_fr: ROLLBACK
2021-01-25 20:54:29.724772 (Thread-1): On test.subsurface.not_null_transfer_types_transfer_label_fr: Close
2021-01-25 20:54:29.726036 (Thread-1): 21:54:29 | 7 of 11 PASS not_null_transfer_types_transfer_label_fr............... [PASS in 1.16s]
2021-01-25 20:54:29.726611 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:54:29.727150 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-25 20:54:29.727844 (Thread-1): 21:54:29 | 9 of 11 START test unique_premises_types_premises_code............... [RUN]
2021-01-25 20:54:29.733708 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 20:54:29.734191 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-25 20:54:29.805851 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-25 20:54:29.819047 (Thread-1): finished collecting timing info
2021-01-25 20:54:29.819912 (Thread-1): Using dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 20:54:29.820325 (Thread-1): On test.subsurface.unique_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from (

    select
        premises_code

    from "@fab4"."premises_types"
    where premises_code is not null
    group by premises_code
    having count(*) > 1

) validation_errors



2021-01-25 20:54:29.820792 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:54:29.821162 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:30.005783 (Thread-2): SQL status: OK in 0.85 seconds
2021-01-25 20:54:30.050228 (Thread-2): finished collecting timing info
2021-01-25 20:54:30.051061 (Thread-2): On test.subsurface.unique_crop_types_crop_code: ROLLBACK
2021-01-25 20:54:30.051429 (Thread-2): On test.subsurface.unique_crop_types_crop_code: Close
2021-01-25 20:54:30.052829 (Thread-2): 21:54:30 | 8 of 11 PASS unique_crop_types_crop_code............................. [PASS in 0.95s]
2021-01-25 20:54:30.053811 (Thread-1): Connected to db: None
2021-01-25 20:54:30.058009 (Thread-2): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 20:54:30.058588 (Thread-2): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:54:30.059292 (Thread-2): 21:54:30 | 10 of 11 START test unique_transfer_types_transfer_label_en.......... [RUN]
2021-01-25 20:54:30.060201 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 20:54:30.060661 (Thread-2): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:54:30.145490 (Thread-2): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-25 20:54:30.150688 (Thread-2): finished collecting timing info
2021-01-25 20:54:30.151592 (Thread-2): Using dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 20:54:30.151998 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_en: 
    
    



select count(*) as validation_errors
from (

    select
        transfer_label_en

    from "@fab4"."transfer_types"
    where transfer_label_en is not null
    group by transfer_label_en
    having count(*) > 1

) validation_errors



2021-01-25 20:54:30.152370 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:54:30.158559 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:30.447039 (Thread-2): Connected to db: None
2021-01-25 20:54:30.919226 (Thread-1): SQL status: OK in 1.10 seconds
2021-01-25 20:54:30.951456 (Thread-1): finished collecting timing info
2021-01-25 20:54:30.952682 (Thread-1): On test.subsurface.unique_premises_types_premises_code: ROLLBACK
2021-01-25 20:54:30.953081 (Thread-1): On test.subsurface.unique_premises_types_premises_code: Close
2021-01-25 20:54:30.958692 (Thread-1): 21:54:30 | 9 of 11 PASS unique_premises_types_premises_code..................... [PASS in 1.23s]
2021-01-25 20:54:30.959268 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-25 20:54:30.959841 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:54:30.960594 (Thread-1): 21:54:30 | 11 of 11 START test unique_transfer_types_transfer_label_fr.......... [RUN]
2021-01-25 20:54:30.967058 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 20:54:30.967575 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:54:31.015977 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-25 20:54:31.016713 (Thread-1): finished collecting timing info
2021-01-25 20:54:31.017479 (Thread-1): Using dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 20:54:31.017740 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_fr: 
    
    



select count(*) as validation_errors
from (

    select
        transfer_label_fr

    from "@fab4"."transfer_types"
    where transfer_label_fr is not null
    group by transfer_label_fr
    having count(*) > 1

) validation_errors



2021-01-25 20:54:31.017977 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:54:31.018172 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:54:31.309651 (Thread-2): SQL status: OK in 1.16 seconds
2021-01-25 20:54:31.348195 (Thread-2): finished collecting timing info
2021-01-25 20:54:31.348914 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_en: ROLLBACK
2021-01-25 20:54:31.349225 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_en: Close
2021-01-25 20:54:31.350362 (Thread-2): 21:54:31 | 10 of 11 PASS unique_transfer_types_transfer_label_en................ [PASS in 1.29s]
2021-01-25 20:54:31.350741 (Thread-2): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:54:31.371098 (Thread-1): Connected to db: None
2021-01-25 20:54:31.816123 (Thread-1): SQL status: OK in 0.80 seconds
2021-01-25 20:54:31.837996 (Thread-1): finished collecting timing info
2021-01-25 20:54:31.838650 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_fr: ROLLBACK
2021-01-25 20:54:31.838888 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_fr: Close
2021-01-25 20:54:31.840488 (Thread-1): 21:54:31 | 11 of 11 PASS unique_transfer_types_transfer_label_fr................ [PASS in 0.87s]
2021-01-25 20:54:31.842041 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:54:31.894623 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:54:31.895617 (MainThread): 21:54:31 | 
2021-01-25 20:54:31.896094 (MainThread): 21:54:31 | Finished running 11 tests in 6.60s.
2021-01-25 20:54:31.896535 (MainThread): Connection 'master' was properly closed.
2021-01-25 20:54:31.896884 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_en' was properly closed.
2021-01-25 20:54:31.897227 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_fr' was properly closed.
2021-01-25 20:54:31.978407 (MainThread): 
2021-01-25 20:54:31.978961 (MainThread): Completed successfully
2021-01-25 20:54:31.979436 (MainThread): 
Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
2021-01-25 20:54:31.980108 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98962b9438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98963f2048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f989578b518>]}
2021-01-25 20:54:31.980761 (MainThread): Flushing usage events
2021-01-25 20:56:52.181522 (MainThread): Running with dbt=0.18.1
2021-01-25 20:56:52.303882 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 20:56:52.305428 (MainThread): Tracking: tracking
2021-01-25 20:56:52.314492 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e0cfdcf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e0810dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e0810e48>]}
2021-01-25 20:56:52.388296 (MainThread): Partial parsing not enabled
2021-01-25 20:56:52.390356 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:56:52.400734 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:56:52.404994 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:56:52.410111 (MainThread): Parsing macros/helpers.sql
2021-01-25 20:56:52.437196 (MainThread): Parsing macros/catalog.sql
2021-01-25 20:56:52.442868 (MainThread): Parsing macros/adapters.sql
2021-01-25 20:56:52.501769 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:56:52.504964 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 20:56:52.513291 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 20:56:52.513999 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 20:56:52.522087 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 20:56:52.551099 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:56:52.574941 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:56:52.583477 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 20:56:52.599771 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:56:52.610937 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:56:52.639337 (MainThread): Parsing macros/core.sql
2021-01-25 20:56:52.647904 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 20:56:52.728100 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 20:56:52.745088 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 20:56:52.748880 (MainThread): Parsing macros/etc/query.sql
2021-01-25 20:56:52.751273 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 20:56:52.753384 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 20:56:52.757837 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 20:56:52.761316 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 20:56:52.779303 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 20:56:52.783146 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:56:52.795597 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 20:56:52.848452 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 20:56:52.881394 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 20:56:52.885008 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 20:56:52.895091 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:56:52.907278 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 20:56:52.934000 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:56:52.947029 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:56:52.986510 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 20:56:52.990517 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 20:56:52.994113 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 20:56:52.997728 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 20:56:53.012748 (MainThread): Partial parsing not enabled
2021-01-25 20:56:53.128583 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 20:56:54.449384 (MainThread): Found 1 model, 16 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 1 source
2021-01-25 20:56:54.452575 (MainThread): 
2021-01-25 20:56:54.453455 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:56:54.514930 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 20:56:54.540056 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 20:56:54.540342 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 20:56:54.540506 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 20:56:54.540628 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:54.697902 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 20:56:55.040161 (ThreadPoolExecutor-1_0): SQL status: OK in 0.50 seconds
2021-01-25 20:56:55.099313 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 20:56:55.099680 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 20:56:55.101748 (MainThread): 21:56:55 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 20:56:55.102083 (MainThread): 21:56:55 | 
2021-01-25 20:56:55.150576 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:56:55.150929 (Thread-2): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:56:55.155017 (Thread-2): 21:56:55 | 2 of 16 START test not_null_crop_types_crop_label.................... [RUN]
2021-01-25 20:56:55.157214 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 20:56:55.157589 (Thread-2): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:56:55.154640 (Thread-1): 21:56:55 | 1 of 16 START test not_null_crop_types_crop_code..................... [RUN]
2021-01-25 20:56:55.187421 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 20:56:55.187773 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:56:55.319932 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 20:56:55.320884 (Thread-1): finished collecting timing info
2021-01-25 20:56:55.321872 (Thread-1): Using dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 20:56:55.322303 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_code is null



2021-01-25 20:56:55.323631 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 20:56:55.323832 (Thread-1): Opening a new connection, currently in state init
2021-01-25 20:56:55.324413 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:55.324711 (Thread-2): finished collecting timing info
2021-01-25 20:56:55.325396 (Thread-2): Using dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 20:56:55.325634 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_label is null



2021-01-25 20:56:55.325805 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:56:55.325965 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:55.558148 (Thread-2): Connected to db: None
2021-01-25 20:56:55.672128 (Thread-1): Connected to db: None
2021-01-25 20:56:55.798776 (Thread-2): SQL status: OK in 0.47 seconds
2021-01-25 20:56:55.828467 (Thread-2): finished collecting timing info
2021-01-25 20:56:55.829189 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: ROLLBACK
2021-01-25 20:56:55.829450 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: Close
2021-01-25 20:56:55.833022 (Thread-2): 21:56:55 | 2 of 16 PASS not_null_crop_types_crop_label.......................... [PASS in 0.68s]
2021-01-25 20:56:55.833422 (Thread-2): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:56:55.833677 (Thread-2): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:56:55.834030 (Thread-2): 21:56:55 | 3 of 16 START test not_null_premises_types_premises_code............. [RUN]
2021-01-25 20:56:55.834565 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 20:56:55.834818 (Thread-2): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:56:55.897533 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-25 20:56:55.906552 (Thread-1): SQL status: OK in 0.58 seconds
2021-01-25 20:56:55.907329 (Thread-1): finished collecting timing info
2021-01-25 20:56:55.907869 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: ROLLBACK
2021-01-25 20:56:55.908019 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: Close
2021-01-25 20:56:55.909572 (Thread-1): 21:56:55 | 1 of 16 PASS not_null_crop_types_crop_code........................... [PASS in 0.72s]
2021-01-25 20:56:55.909921 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:56:55.910160 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:56:55.910622 (Thread-1): 21:56:55 | 4 of 16 START test not_null_premises_types_premises_label_en......... [RUN]
2021-01-25 20:56:55.915033 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 20:56:55.915313 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:56:55.929738 (Thread-2): finished collecting timing info
2021-01-25 20:56:55.930398 (Thread-2): Using dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 20:56:55.930584 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_code is null



2021-01-25 20:56:55.930697 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:56:55.930806 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:55.954045 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-25 20:56:55.962928 (Thread-1): finished collecting timing info
2021-01-25 20:56:55.963525 (Thread-1): Using dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 20:56:55.963679 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_en: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_label_en is null



2021-01-25 20:56:55.963800 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:56:55.963915 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:56.240042 (Thread-1): Connected to db: None
2021-01-25 20:56:56.240301 (Thread-2): Connected to db: None
2021-01-25 20:56:56.500058 (Thread-1): SQL status: OK in 0.54 seconds
2021-01-25 20:56:56.528756 (Thread-1): finished collecting timing info
2021-01-25 20:56:56.529436 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_en: ROLLBACK
2021-01-25 20:56:56.529832 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_en: Close
2021-01-25 20:56:56.531815 (Thread-1): 21:56:56 | 4 of 16 PASS not_null_premises_types_premises_label_en............... [PASS in 0.62s]
2021-01-25 20:56:56.532185 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:56:56.532461 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:56:56.532855 (Thread-1): 21:56:56 | 5 of 16 START test not_null_premises_types_premises_label_fr......... [RUN]
2021-01-25 20:56:56.533412 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 20:56:56.533683 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:56:56.558628 (Thread-2): SQL status: OK in 0.63 seconds
2021-01-25 20:56:56.616256 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-25 20:56:56.616593 (Thread-2): finished collecting timing info
2021-01-25 20:56:56.630078 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: ROLLBACK
2021-01-25 20:56:56.634590 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: Close
2021-01-25 20:56:56.635980 (Thread-2): 21:56:56 | 3 of 16 PASS not_null_premises_types_premises_code................... [PASS in 0.80s]
2021-01-25 20:56:56.630577 (Thread-1): finished collecting timing info
2021-01-25 20:56:56.636368 (Thread-2): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:56:56.636749 (Thread-1): Using dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 20:56:56.637034 (Thread-2): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:56:56.637315 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_label_fr is null



2021-01-25 20:56:56.637867 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:56:56.637991 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:56.637687 (Thread-2): 21:56:56 | 6 of 16 START test not_null_transfer_types_transfer_label_en......... [RUN]
2021-01-25 20:56:56.647011 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 20:56:56.647272 (Thread-2): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:56:56.695137 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-25 20:56:56.695850 (Thread-2): finished collecting timing info
2021-01-25 20:56:56.696509 (Thread-2): Using dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 20:56:56.698541 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: 
    
    



select count(*) as validation_errors
from "@fab4"."transfer_types"
where transfer_label_en is null



2021-01-25 20:56:56.698790 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:56:56.698915 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:56.962721 (Thread-2): Connected to db: None
2021-01-25 20:56:56.994604 (Thread-1): Connected to db: None
2021-01-25 20:56:57.212948 (Thread-2): SQL status: OK in 0.51 seconds
2021-01-25 20:56:57.238982 (Thread-2): finished collecting timing info
2021-01-25 20:56:57.239596 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: ROLLBACK
2021-01-25 20:56:57.239792 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: Close
2021-01-25 20:56:57.240711 (Thread-2): 21:56:57 | 6 of 16 PASS not_null_transfer_types_transfer_label_en............... [PASS in 0.59s]
2021-01-25 20:56:57.241191 (Thread-2): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:56:57.241667 (Thread-2): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:56:57.242093 (Thread-2): 21:56:57 | 7 of 16 START test not_null_transfer_types_transfer_label_fr......... [RUN]
2021-01-25 20:56:57.242666 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 20:56:57.242937 (Thread-2): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:56:57.293163 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-25 20:56:57.294508 (Thread-1): SQL status: OK in 0.66 seconds
2021-01-25 20:56:57.295477 (Thread-2): finished collecting timing info
2021-01-25 20:56:57.296134 (Thread-2): Using dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 20:56:57.296409 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."transfer_types"
where transfer_label_fr is null



2021-01-25 20:56:57.296675 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:56:57.296945 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:57.419347 (Thread-1): finished collecting timing info
2021-01-25 20:56:57.419934 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_fr: ROLLBACK
2021-01-25 20:56:57.420096 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_fr: Close
2021-01-25 20:56:57.421049 (Thread-1): 21:56:57 | 5 of 16 PASS not_null_premises_types_premises_label_fr............... [PASS in 0.89s]
2021-01-25 20:56:57.421395 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:56:57.421650 (Thread-1): Began running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune
2021-01-25 20:56:57.421996 (Thread-1): 21:56:57 | 8 of 16 START test source_not_null_land_values_valeurs_foncieres_Code_commune [RUN]
2021-01-25 20:56:57.423231 (Thread-1): Acquiring new dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune".
2021-01-25 20:56:57.423543 (Thread-1): Compiling test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune
2021-01-25 20:56:57.459995 (Thread-2): Connected to db: None
2021-01-25 20:56:57.503260 (Thread-1): Writing injected SQL for node "test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune"
2021-01-25 20:56:57.526983 (Thread-1): finished collecting timing info
2021-01-25 20:56:57.527705 (Thread-1): Using dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune".
2021-01-25 20:56:57.527990 (Thread-1): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Code commune is null



2021-01-25 20:56:57.528219 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:56:57.528473 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:57.744564 (Thread-2): SQL status: OK in 0.45 seconds
2021-01-25 20:56:57.770087 (Thread-2): finished collecting timing info
2021-01-25 20:56:57.770926 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_fr: ROLLBACK
2021-01-25 20:56:57.771301 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_fr: Close
2021-01-25 20:56:57.772793 (Thread-2): 21:56:57 | 7 of 16 PASS not_null_transfer_types_transfer_label_fr............... [PASS in 0.53s]
2021-01-25 20:56:57.774722 (Thread-2): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:56:57.775292 (Thread-2): Began running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement
2021-01-25 20:56:57.775990 (Thread-2): 21:56:57 | 9 of 16 START test source_not_null_land_values_valeurs_foncieres_Code_departement [RUN]
2021-01-25 20:56:57.776883 (Thread-2): Acquiring new dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement".
2021-01-25 20:56:57.777362 (Thread-2): Compiling test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement
2021-01-25 20:56:57.846258 (Thread-2): Writing injected SQL for node "test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement"
2021-01-25 20:56:57.847156 (Thread-1): Connected to db: None
2021-01-25 20:56:57.849162 (Thread-2): finished collecting timing info
2021-01-25 20:56:57.849917 (Thread-2): Using dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement".
2021-01-25 20:56:57.850223 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Code departement is null



2021-01-25 20:56:57.850478 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:56:57.850696 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:58.005895 (Thread-2): Connected to db: None
2021-01-25 20:56:58.031037 (Thread-1): Error running SQL: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Code commune is null



2021-01-25 20:56:58.031420 (Thread-1): Rolling back transaction.
2021-01-25 20:56:58.031766 (Thread-1): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune: ROLLBACK
2021-01-25 20:56:58.032121 (Thread-1): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune: Close
2021-01-25 20:56:58.033244 (Thread-1): finished collecting timing info
2021-01-25 20:56:58.035463 (Thread-2): Error running SQL: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Code departement is null



2021-01-25 20:56:58.042698 (Thread-2): Rolling back transaction.
2021-01-25 20:56:58.043781 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement: ROLLBACK
2021-01-25 20:56:58.044613 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement: Close
2021-01-25 20:56:58.045826 (Thread-2): finished collecting timing info
2021-01-25 20:56:58.046907 (Thread-2): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Code_departement (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code departement is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code departement is null\n\n\n\nstartLine 9\nstartColumn 12\nendLine 9\nendColumn 22\n...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code departement is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code departement is null\n\n\n\nstartLine 9\nstartColumn 12\nendLine 9\nendColumn 22\n...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 84, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 64, in execute_schema_test
    fetch=True,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in test source_not_null_land_values_valeurs_foncieres_Code_departement (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code departement is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code departement is null\n\n\n\nstartLine 9\nstartColumn 12\nendLine 9\nendColumn 22\n...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:56:58.065761 (Thread-2): 21:56:58 | 9 of 16 ERROR source_not_null_land_values_valeurs_foncieres_Code_departement [ERROR in 0.29s]
2021-01-25 20:56:58.034636 (Thread-1): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Code_commune (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code commune is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code commune is null\n\n\n\nstartLine 9\nstartColumn 12\nendLine 9\nendColumn 18\nSQL Quer...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code commune is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code commune is null\n\n\n\nstartLine 9\nstartColumn 12\nendLine 9\nendColumn 18\nSQL Quer...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 84, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 64, in execute_schema_test
    fetch=True,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in test source_not_null_land_values_valeurs_foncieres_Code_commune (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code commune is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code commune is null\n\n\n\nstartLine 9\nstartColumn 12\nendLine 9\nendColumn 18\nSQL Quer...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:56:58.066627 (Thread-2): Finished running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_departement
2021-01-25 20:56:58.067273 (Thread-1): 21:56:58 | 8 of 16 ERROR source_not_null_land_values_valeurs_foncieres_Code_commune [ERROR in 0.64s]
2021-01-25 20:56:58.067715 (Thread-2): Began running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation
2021-01-25 20:56:58.068541 (Thread-2): 21:56:58 | 10 of 16 START test source_not_null_land_values_valeurs_foncieres_Date_mutation [RUN]
2021-01-25 20:56:58.070607 (Thread-1): Finished running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Code_commune
2021-01-25 20:56:58.071358 (Thread-2): Acquiring new dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation".
2021-01-25 20:56:58.071939 (Thread-1): Began running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation
2021-01-25 20:56:58.072417 (Thread-2): Compiling test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation
2021-01-25 20:56:58.077960 (Thread-1): 21:56:58 | 11 of 16 START test source_not_null_land_values_valeurs_foncieres_Nature_mutation [RUN]
2021-01-25 20:56:58.084944 (Thread-1): Acquiring new dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation".
2021-01-25 20:56:58.085435 (Thread-1): Compiling test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation
2021-01-25 20:56:58.151384 (Thread-2): Writing injected SQL for node "test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation"
2021-01-25 20:56:58.157179 (Thread-2): finished collecting timing info
2021-01-25 20:56:58.158378 (Thread-2): Using dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation".
2021-01-25 20:56:58.158687 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Date mutation is null



2021-01-25 20:56:58.158898 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:56:58.159070 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:58.182024 (Thread-1): Writing injected SQL for node "test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation"
2021-01-25 20:56:58.186869 (Thread-1): finished collecting timing info
2021-01-25 20:56:58.187455 (Thread-1): Using dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation".
2021-01-25 20:56:58.187613 (Thread-1): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Nature mutation is null



2021-01-25 20:56:58.187736 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:56:58.187901 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:58.447568 (Thread-2): Connected to db: None
2021-01-25 20:56:58.482614 (Thread-1): Connected to db: None
2021-01-25 20:56:58.543243 (Thread-2): Error running SQL: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Date mutation is null



2021-01-25 20:56:58.543610 (Thread-2): Rolling back transaction.
2021-01-25 20:56:58.543964 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation: ROLLBACK
2021-01-25 20:56:58.544332 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation: Close
2021-01-25 20:56:58.545270 (Thread-2): finished collecting timing info
2021-01-25 20:56:58.550781 (Thread-2): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Date_mutation (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Date mutation is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Date mutation is null\n\n\n\nstartLine 9\nstartColumn 7\nendLine 9\nendColumn 10\nSQL Que...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Date mutation is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Date mutation is null\n\n\n\nstartLine 9\nstartColumn 7\nendLine 9\nendColumn 10\nSQL Que...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 84, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 64, in execute_schema_test
    fetch=True,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in test source_not_null_land_values_valeurs_foncieres_Date_mutation (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Date mutation is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Date mutation is null\n\n\n\nstartLine 9\nstartColumn 7\nendLine 9\nendColumn 10\nSQL Que...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:56:58.551900 (Thread-2): 21:56:58 | 10 of 16 ERROR source_not_null_land_values_valeurs_foncieres_Date_mutation [ERROR in 0.48s]
2021-01-25 20:56:58.552339 (Thread-2): Finished running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Date_mutation
2021-01-25 20:56:58.552807 (Thread-2): Began running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere
2021-01-25 20:56:58.555719 (Thread-2): 21:56:58 | 12 of 16 START test source_not_null_land_values_valeurs_foncieres_Valeur_fonciere [RUN]
2021-01-25 20:56:58.556564 (Thread-2): Acquiring new dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere".
2021-01-25 20:56:58.556976 (Thread-2): Compiling test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere
2021-01-25 20:56:58.586601 (Thread-1): Error running SQL: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Nature mutation is null



2021-01-25 20:56:58.586966 (Thread-1): Rolling back transaction.
2021-01-25 20:56:58.587320 (Thread-1): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation: ROLLBACK
2021-01-25 20:56:58.587715 (Thread-1): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation: Close
2021-01-25 20:56:58.588968 (Thread-1): finished collecting timing info
2021-01-25 20:56:58.590216 (Thread-1): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Nature_mutation (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Nature mutation is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Nature mutation is null\n\n\n\nstartLine 9\nstartColumn 14\nendLine 9\nendColumn 21\nSQ...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Nature mutation is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Nature mutation is null\n\n\n\nstartLine 9\nstartColumn 14\nendLine 9\nendColumn 21\nSQ...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 84, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 64, in execute_schema_test
    fetch=True,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in test source_not_null_land_values_valeurs_foncieres_Nature_mutation (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Nature mutation is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Nature mutation is null\n\n\n\nstartLine 9\nstartColumn 14\nendLine 9\nendColumn 21\nSQ...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:56:58.591341 (Thread-1): 21:56:58 | 11 of 16 ERROR source_not_null_land_values_valeurs_foncieres_Nature_mutation [ERROR in 0.51s]
2021-01-25 20:56:58.591807 (Thread-1): Finished running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Nature_mutation
2021-01-25 20:56:58.599299 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 20:56:58.600045 (Thread-1): 21:56:58 | 13 of 16 START test unique_crop_types_crop_code...................... [RUN]
2021-01-25 20:56:58.615915 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 20:56:58.616292 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 20:56:58.639026 (Thread-2): Writing injected SQL for node "test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere"
2021-01-25 20:56:58.648094 (Thread-2): finished collecting timing info
2021-01-25 20:56:58.648927 (Thread-2): Using dremio connection "test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere".
2021-01-25 20:56:58.649292 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Valeur fonciere is null



2021-01-25 20:56:58.649622 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:56:58.649941 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:58.659104 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 20:56:58.659803 (Thread-1): finished collecting timing info
2021-01-25 20:56:58.660532 (Thread-1): Using dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 20:56:58.660705 (Thread-1): On test.subsurface.unique_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from (

    select
        crop_code

    from "@fab4"."crop_types"
    where crop_code is not null
    group by crop_code
    having count(*) > 1

) validation_errors



2021-01-25 20:56:58.660842 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:56:58.660970 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:58.908569 (Thread-2): Connected to db: None
2021-01-25 20:56:58.931520 (Thread-1): Connected to db: None
2021-01-25 20:56:58.938907 (Thread-2): Error running SQL: 
    
    



select count(*) as validation_errors
from "fs"."valeurs_foncieres"
where Valeur fonciere is null



2021-01-25 20:56:58.939197 (Thread-2): Rolling back transaction.
2021-01-25 20:56:58.939382 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere: ROLLBACK
2021-01-25 20:56:58.939520 (Thread-2): On test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere: Close
2021-01-25 20:56:58.940137 (Thread-2): finished collecting timing info
2021-01-25 20:56:58.941026 (Thread-2): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Valeur_fonciere (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Valeur fonciere is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Valeur fonciere is null\n\n\n\nstartLine 9\nstartColumn 14\nendLine 9\nendColumn 21\nSQ...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Valeur fonciere is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Valeur fonciere is null\n\n\n\nstartLine 9\nstartColumn 14\nendLine 9\nendColumn 21\nSQ...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 84, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 64, in execute_schema_test
    fetch=True,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in test source_not_null_land_values_valeurs_foncieres_Valeur_fonciere (models/sources/sources.yml)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Valeur fonciere is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Valeur fonciere is null\n\n\n\nstartLine 9\nstartColumn 14\nendLine 9\nendColumn 21\nSQ...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:56:58.941731 (Thread-2): 21:56:58 | 12 of 16 ERROR source_not_null_land_values_valeurs_foncieres_Valeur_fonciere [ERROR in 0.39s]
2021-01-25 20:56:58.941977 (Thread-2): Finished running node test.subsurface.source_not_null_land_values_valeurs_foncieres_Valeur_fonciere
2021-01-25 20:56:58.942519 (Thread-2): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-25 20:56:58.946887 (Thread-2): 21:56:58 | 14 of 16 START test unique_premises_types_premises_code.............. [RUN]
2021-01-25 20:56:58.947699 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 20:56:58.948057 (Thread-2): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-25 20:56:58.996557 (Thread-2): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-25 20:56:58.997618 (Thread-2): finished collecting timing info
2021-01-25 20:56:58.998561 (Thread-2): Using dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 20:56:58.998996 (Thread-2): On test.subsurface.unique_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from (

    select
        premises_code

    from "@fab4"."premises_types"
    where premises_code is not null
    group by premises_code
    having count(*) > 1

) validation_errors



2021-01-25 20:56:58.999390 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:56:59.007975 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:59.314091 (Thread-1): SQL status: OK in 0.65 seconds
2021-01-25 20:56:59.352528 (Thread-1): finished collecting timing info
2021-01-25 20:56:59.353339 (Thread-1): On test.subsurface.unique_crop_types_crop_code: ROLLBACK
2021-01-25 20:56:59.353732 (Thread-1): On test.subsurface.unique_crop_types_crop_code: Close
2021-01-25 20:56:59.355214 (Thread-1): 21:56:59 | 13 of 16 PASS unique_crop_types_crop_code............................ [PASS in 0.74s]
2021-01-25 20:56:59.358568 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 20:56:59.359004 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:56:59.359505 (Thread-1): 21:56:59 | 15 of 16 START test unique_transfer_types_transfer_label_en.......... [RUN]
2021-01-25 20:56:59.363020 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 20:56:59.363462 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:56:59.388766 (Thread-2): Connected to db: None
2021-01-25 20:56:59.428395 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-25 20:56:59.435053 (Thread-1): finished collecting timing info
2021-01-25 20:56:59.435916 (Thread-1): Using dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 20:56:59.436275 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_en: 
    
    



select count(*) as validation_errors
from (

    select
        transfer_label_en

    from "@fab4"."transfer_types"
    where transfer_label_en is not null
    group by transfer_label_en
    having count(*) > 1

) validation_errors



2021-01-25 20:56:59.442602 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:56:59.442942 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:56:59.637364 (Thread-1): Connected to db: None
2021-01-25 20:56:59.841868 (Thread-2): SQL status: OK in 0.84 seconds
2021-01-25 20:56:59.911239 (Thread-2): finished collecting timing info
2021-01-25 20:56:59.912108 (Thread-2): On test.subsurface.unique_premises_types_premises_code: ROLLBACK
2021-01-25 20:56:59.912532 (Thread-2): On test.subsurface.unique_premises_types_premises_code: Close
2021-01-25 20:56:59.914888 (Thread-2): 21:56:59 | 14 of 16 PASS unique_premises_types_premises_code.................... [PASS in 0.97s]
2021-01-25 20:56:59.916189 (Thread-1): SQL status: OK in 0.47 seconds
2021-01-25 20:56:59.919788 (Thread-2): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-25 20:56:59.920289 (Thread-2): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:56:59.920921 (Thread-2): 21:56:59 | 16 of 16 START test unique_transfer_types_transfer_label_fr.......... [RUN]
2021-01-25 20:56:59.921669 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 20:56:59.922065 (Thread-2): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:56:59.998935 (Thread-1): finished collecting timing info
2021-01-25 20:56:59.999841 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_en: ROLLBACK
2021-01-25 20:57:00.000345 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_en: Close
2021-01-25 20:57:00.002195 (Thread-1): 21:56:59 | 15 of 16 PASS unique_transfer_types_transfer_label_en................ [PASS in 0.64s]
2021-01-25 20:57:00.009416 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:57:00.014124 (Thread-2): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-25 20:57:00.015112 (Thread-2): finished collecting timing info
2021-01-25 20:57:00.027260 (Thread-2): Using dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 20:57:00.027663 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_fr: 
    
    



select count(*) as validation_errors
from (

    select
        transfer_label_fr

    from "@fab4"."transfer_types"
    where transfer_label_fr is not null
    group by transfer_label_fr
    having count(*) > 1

) validation_errors



2021-01-25 20:57:00.028021 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:57:00.028371 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:57:00.287839 (Thread-2): Connected to db: None
2021-01-25 20:57:00.577750 (Thread-2): SQL status: OK in 0.55 seconds
2021-01-25 20:57:00.593442 (Thread-2): finished collecting timing info
2021-01-25 20:57:00.594288 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_fr: ROLLBACK
2021-01-25 20:57:00.594712 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_fr: Close
2021-01-25 20:57:00.596378 (Thread-2): 21:57:00 | 16 of 16 PASS unique_transfer_types_transfer_label_fr................ [PASS in 0.67s]
2021-01-25 20:57:00.599205 (Thread-2): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:57:00.664987 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:57:00.665715 (MainThread): 21:57:00 | 
2021-01-25 20:57:00.666027 (MainThread): 21:57:00 | Finished running 16 tests in 6.21s.
2021-01-25 20:57:00.666225 (MainThread): Connection 'master' was properly closed.
2021-01-25 20:57:00.666383 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_fr' was properly closed.
2021-01-25 20:57:00.666501 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_en' was properly closed.
2021-01-25 20:57:00.848043 (MainThread): 
2021-01-25 20:57:00.848609 (MainThread): Completed with 5 errors and 0 warnings:
2021-01-25 20:57:00.848866 (MainThread): 
2021-01-25 20:57:00.849063 (MainThread): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Code_departement (models/sources/sources.yml)
2021-01-25 20:57:00.849238 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code departement is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code departement is null\n\n\n\nstartLine 9\nstartColumn 12\nendLine 9\nendColumn 22\n...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:57:00.849410 (MainThread): 
2021-01-25 20:57:00.849595 (MainThread): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Code_commune (models/sources/sources.yml)
2021-01-25 20:57:00.849774 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code commune is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Code commune is null\n\n\n\nstartLine 9\nstartColumn 12\nendLine 9\nendColumn 18\nSQL Quer...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:57:00.849989 (MainThread): 
2021-01-25 20:57:00.854528 (MainThread): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Date_mutation (models/sources/sources.yml)
2021-01-25 20:57:00.854946 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Date mutation is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Date mutation is null\n\n\n\nstartLine 9\nstartColumn 7\nendLine 9\nendColumn 10\nSQL Que...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:57:00.855307 (MainThread): 
2021-01-25 20:57:00.855756 (MainThread): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Nature_mutation (models/sources/sources.yml)
2021-01-25 20:57:00.856069 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Nature mutation is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Nature mutation is null\n\n\n\nstartLine 9\nstartColumn 14\nendLine 9\nendColumn 21\nSQ...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:57:00.856356 (MainThread): 
2021-01-25 20:57:00.856824 (MainThread): Runtime Error in test source_not_null_land_values_valeurs_foncieres_Valeur_fonciere (models/sources/sources.yml)
2021-01-25 20:57:00.857195 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Valeur fonciere is null\n\n\n\n[30038]Query execution error. Details:[ \nPARSE ERROR: Failure parsing the query.\n\nSQL Query \n    \n    \n\n\n\nselect count(*) as validation_errors\nfrom "fs"."valeurs_foncieres"\nwhere Valeur fonciere is null\n\n\n\nstartLine 9\nstartColumn 14\nendLine 9\nendColumn 21\nSQ...[see log] (1040) (SQLExecDirectW)')
2021-01-25 20:57:00.857556 (MainThread): 
Done. PASS=11 WARN=0 ERROR=5 SKIP=0 TOTAL=16
2021-01-25 20:57:00.858091 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e0594240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e06ad208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7dc919588>]}
2021-01-25 20:57:00.858629 (MainThread): Flushing usage events
2021-01-25 20:58:48.303652 (MainThread): Running with dbt=0.18.1
2021-01-25 20:58:48.432195 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 20:58:48.433844 (MainThread): Tracking: tracking
2021-01-25 20:58:48.443196 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa831d6cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa831880dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa831880e48>]}
2021-01-25 20:58:48.501136 (MainThread): Partial parsing not enabled
2021-01-25 20:58:48.502687 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:58:48.509181 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:58:48.513380 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 20:58:48.518627 (MainThread): Parsing macros/helpers.sql
2021-01-25 20:58:48.544291 (MainThread): Parsing macros/catalog.sql
2021-01-25 20:58:48.548892 (MainThread): Parsing macros/adapters.sql
2021-01-25 20:58:48.594899 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 20:58:48.597307 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 20:58:48.603183 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 20:58:48.603672 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 20:58:48.609232 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 20:58:48.627654 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:58:48.644910 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:58:48.653450 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 20:58:48.668229 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:58:48.679250 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:58:48.707480 (MainThread): Parsing macros/core.sql
2021-01-25 20:58:48.714865 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 20:58:48.794630 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 20:58:48.812431 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 20:58:48.815976 (MainThread): Parsing macros/etc/query.sql
2021-01-25 20:58:48.818590 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 20:58:48.820680 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 20:58:48.825186 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 20:58:48.828919 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 20:58:48.847686 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 20:58:48.851792 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 20:58:48.865120 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 20:58:48.918444 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 20:58:48.951215 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 20:58:48.954964 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 20:58:48.964836 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 20:58:48.977116 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 20:58:49.003393 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 20:58:49.016512 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 20:58:49.055302 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 20:58:49.059355 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 20:58:49.062654 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 20:58:49.066710 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 20:58:49.081757 (MainThread): Partial parsing not enabled
2021-01-25 20:58:49.201573 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 20:58:50.272507 (MainThread): Found 1 model, 11 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 1 source
2021-01-25 20:58:50.274968 (MainThread): 
2021-01-25 20:58:50.275773 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:58:50.321579 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 20:58:50.352039 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 20:58:50.352722 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 20:58:50.353232 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 20:58:50.353463 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:50.506135 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 20:58:50.829892 (ThreadPoolExecutor-1_0): SQL status: OK in 0.48 seconds
2021-01-25 20:58:50.907187 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 20:58:50.907492 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 20:58:50.911582 (MainThread): 21:58:50 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 20:58:50.912041 (MainThread): 21:58:50 | 
2021-01-25 20:58:50.940798 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:58:50.941232 (Thread-1): 21:58:50 | 1 of 11 START test not_null_crop_types_crop_code..................... [RUN]
2021-01-25 20:58:50.941859 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 20:58:50.942149 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:58:50.955366 (Thread-2): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:58:50.955747 (Thread-2): 21:58:50 | 2 of 11 START test not_null_crop_types_crop_label.................... [RUN]
2021-01-25 20:58:50.956431 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 20:58:50.956712 (Thread-2): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:58:51.040859 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 20:58:51.050689 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 20:58:51.051330 (Thread-2): finished collecting timing info
2021-01-25 20:58:51.052027 (Thread-1): finished collecting timing info
2021-01-25 20:58:51.052584 (Thread-2): Using dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 20:58:51.052846 (Thread-1): Using dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 20:58:51.053030 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_label is null



2021-01-25 20:58:51.053177 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_code is null



2021-01-25 20:58:51.053322 (Thread-2): Opening a new connection, currently in state init
2021-01-25 20:58:51.053483 (Thread-1): Opening a new connection, currently in state init
2021-01-25 20:58:51.053634 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:51.053773 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:51.364411 (Thread-2): Connected to db: None
2021-01-25 20:58:51.371780 (Thread-1): Connected to db: None
2021-01-25 20:58:51.706880 (Thread-2): SQL status: OK in 0.65 seconds
2021-01-25 20:58:51.727756 (Thread-2): finished collecting timing info
2021-01-25 20:58:51.728347 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: ROLLBACK
2021-01-25 20:58:51.728528 (Thread-2): On test.subsurface.not_null_crop_types_crop_label: Close
2021-01-25 20:58:51.732507 (Thread-2): 21:58:51 | 2 of 11 PASS not_null_crop_types_crop_label.......................... [PASS in 0.78s]
2021-01-25 20:58:51.737790 (Thread-2): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 20:58:51.738158 (Thread-2): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:58:51.738564 (Thread-2): 21:58:51 | 3 of 11 START test not_null_premises_types_premises_code............. [RUN]
2021-01-25 20:58:51.739350 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 20:58:51.739700 (Thread-2): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:58:51.769861 (Thread-1): SQL status: OK in 0.72 seconds
2021-01-25 20:58:51.790470 (Thread-1): finished collecting timing info
2021-01-25 20:58:51.806565 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: ROLLBACK
2021-01-25 20:58:51.807228 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-25 20:58:51.807474 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: Close
2021-01-25 20:58:51.810665 (Thread-1): 21:58:51 | 1 of 11 PASS not_null_crop_types_crop_code........................... [PASS in 0.87s]
2021-01-25 20:58:51.807993 (Thread-2): finished collecting timing info
2021-01-25 20:58:51.811156 (Thread-2): Using dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 20:58:51.811405 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_code is null



2021-01-25 20:58:51.811559 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:58:51.811692 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:51.814609 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 20:58:51.815020 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:58:51.815340 (Thread-1): 21:58:51 | 4 of 11 START test not_null_premises_types_premises_label_en......... [RUN]
2021-01-25 20:58:51.815961 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 20:58:51.816242 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:58:51.875961 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-25 20:58:51.886616 (Thread-1): finished collecting timing info
2021-01-25 20:58:51.887282 (Thread-1): Using dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 20:58:51.887463 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_en: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_label_en is null



2021-01-25 20:58:51.887586 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:58:51.887705 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:52.163733 (Thread-2): Connected to db: None
2021-01-25 20:58:52.176279 (Thread-1): Connected to db: None
2021-01-25 20:58:52.470948 (Thread-2): SQL status: OK in 0.66 seconds
2021-01-25 20:58:52.494192 (Thread-1): SQL status: OK in 0.61 seconds
2021-01-25 20:58:52.503509 (Thread-2): finished collecting timing info
2021-01-25 20:58:52.504133 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: ROLLBACK
2021-01-25 20:58:52.504323 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: Close
2021-01-25 20:58:52.509495 (Thread-2): 21:58:52 | 3 of 11 PASS not_null_premises_types_premises_code................... [PASS in 0.77s]
2021-01-25 20:58:52.509890 (Thread-2): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 20:58:52.510212 (Thread-2): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:58:52.510706 (Thread-2): 21:58:52 | 5 of 11 START test not_null_premises_types_premises_label_fr......... [RUN]
2021-01-25 20:58:52.511192 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 20:58:52.511373 (Thread-2): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:58:52.552612 (Thread-1): finished collecting timing info
2021-01-25 20:58:52.553211 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_en: ROLLBACK
2021-01-25 20:58:52.553395 (Thread-1): On test.subsurface.not_null_premises_types_premises_label_en: Close
2021-01-25 20:58:52.559378 (Thread-1): 21:58:52 | 4 of 11 PASS not_null_premises_types_premises_label_en............... [PASS in 0.74s]
2021-01-25 20:58:52.559738 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 20:58:52.560041 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:58:52.560400 (Thread-1): 21:58:52 | 6 of 11 START test not_null_transfer_types_transfer_label_en......... [RUN]
2021-01-25 20:58:52.560980 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 20:58:52.561229 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:58:52.593931 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-25 20:58:52.616006 (Thread-2): finished collecting timing info
2021-01-25 20:58:52.618989 (Thread-2): Using dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 20:58:52.619173 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_label_fr is null



2021-01-25 20:58:52.619299 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:58:52.619419 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:52.627639 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-25 20:58:52.628260 (Thread-1): finished collecting timing info
2021-01-25 20:58:52.634974 (Thread-1): Using dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 20:58:52.635155 (Thread-1): On test.subsurface.not_null_transfer_types_transfer_label_en: 
    
    



select count(*) as validation_errors
from "@fab4"."transfer_types"
where transfer_label_en is null



2021-01-25 20:58:52.635303 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:58:52.635430 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:52.964121 (Thread-2): Connected to db: None
2021-01-25 20:58:52.976492 (Thread-1): Connected to db: None
2021-01-25 20:58:53.135387 (Thread-2): SQL status: OK in 0.52 seconds
2021-01-25 20:58:53.158828 (Thread-2): finished collecting timing info
2021-01-25 20:58:53.160857 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_fr: ROLLBACK
2021-01-25 20:58:53.161206 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_fr: Close
2021-01-25 20:58:53.163302 (Thread-2): 21:58:53 | 5 of 11 PASS not_null_premises_types_premises_label_fr............... [PASS in 0.65s]
2021-01-25 20:58:53.163742 (Thread-2): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 20:58:53.164178 (Thread-2): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:58:53.164776 (Thread-2): 21:58:53 | 7 of 11 START test not_null_transfer_types_transfer_label_fr......... [RUN]
2021-01-25 20:58:53.169987 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 20:58:53.170487 (Thread-2): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:58:53.198184 (Thread-1): SQL status: OK in 0.56 seconds
2021-01-25 20:58:53.201641 (Thread-1): finished collecting timing info
2021-01-25 20:58:53.202305 (Thread-1): On test.subsurface.not_null_transfer_types_transfer_label_en: ROLLBACK
2021-01-25 20:58:53.202579 (Thread-1): On test.subsurface.not_null_transfer_types_transfer_label_en: Close
2021-01-25 20:58:53.203905 (Thread-1): 21:58:53 | 6 of 11 PASS not_null_transfer_types_transfer_label_en............... [PASS in 0.64s]
2021-01-25 20:58:53.217242 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 20:58:53.217768 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 20:58:53.218302 (Thread-1): 21:58:53 | 8 of 11 START test unique_crop_types_crop_code....................... [RUN]
2021-01-25 20:58:53.219040 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 20:58:53.219382 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 20:58:53.232144 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-25 20:58:53.232830 (Thread-2): finished collecting timing info
2021-01-25 20:58:53.233509 (Thread-2): Using dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 20:58:53.233704 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."transfer_types"
where transfer_label_fr is null



2021-01-25 20:58:53.233838 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:58:53.233996 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:53.297090 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 20:58:53.297919 (Thread-1): finished collecting timing info
2021-01-25 20:58:53.298692 (Thread-1): Using dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 20:58:53.298865 (Thread-1): On test.subsurface.unique_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from (

    select
        crop_code

    from "@fab4"."crop_types"
    where crop_code is not null
    group by crop_code
    having count(*) > 1

) validation_errors



2021-01-25 20:58:53.298986 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:58:53.299139 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:53.514541 (Thread-2): Connected to db: None
2021-01-25 20:58:53.532178 (Thread-1): Connected to db: None
2021-01-25 20:58:53.859165 (Thread-2): SQL status: OK in 0.63 seconds
2021-01-25 20:58:53.915080 (Thread-2): finished collecting timing info
2021-01-25 20:58:53.915792 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_fr: ROLLBACK
2021-01-25 20:58:53.915992 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_fr: Close
2021-01-25 20:58:53.917285 (Thread-2): 21:58:53 | 7 of 11 PASS not_null_transfer_types_transfer_label_fr............... [PASS in 0.75s]
2021-01-25 20:58:53.917910 (Thread-2): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 20:58:53.918564 (Thread-2): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-25 20:58:53.919360 (Thread-2): 21:58:53 | 9 of 11 START test unique_premises_types_premises_code............... [RUN]
2021-01-25 20:58:53.927108 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 20:58:53.927620 (Thread-2): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-25 20:58:53.954811 (Thread-1): SQL status: OK in 0.66 seconds
2021-01-25 20:58:53.972396 (Thread-1): finished collecting timing info
2021-01-25 20:58:53.973109 (Thread-1): On test.subsurface.unique_crop_types_crop_code: ROLLBACK
2021-01-25 20:58:54.019709 (Thread-1): On test.subsurface.unique_crop_types_crop_code: Close
2021-01-25 20:58:54.021253 (Thread-1): 21:58:54 | 8 of 11 PASS unique_crop_types_crop_code............................. [PASS in 0.80s]
2021-01-25 20:58:54.022553 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 20:58:54.022997 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:58:54.023490 (Thread-1): 21:58:54 | 10 of 11 START test unique_transfer_types_transfer_label_en.......... [RUN]
2021-01-25 20:58:54.024193 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 20:58:54.024930 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:58:54.031820 (Thread-2): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-25 20:58:54.044342 (Thread-2): finished collecting timing info
2021-01-25 20:58:54.045386 (Thread-2): Using dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 20:58:54.045826 (Thread-2): On test.subsurface.unique_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from (

    select
        premises_code

    from "@fab4"."premises_types"
    where premises_code is not null
    group by premises_code
    having count(*) > 1

) validation_errors



2021-01-25 20:58:54.046237 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:58:54.051838 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:54.090554 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-25 20:58:54.097901 (Thread-1): finished collecting timing info
2021-01-25 20:58:54.103044 (Thread-1): Using dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 20:58:54.103330 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_en: 
    
    



select count(*) as validation_errors
from (

    select
        transfer_label_en

    from "@fab4"."transfer_types"
    where transfer_label_en is not null
    group by transfer_label_en
    having count(*) > 1

) validation_errors



2021-01-25 20:58:54.103596 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 20:58:54.103838 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:54.328909 (Thread-2): Connected to db: None
2021-01-25 20:58:54.514458 (Thread-1): Connected to db: None
2021-01-25 20:58:54.710299 (Thread-2): SQL status: OK in 0.66 seconds
2021-01-25 20:58:54.776985 (Thread-2): finished collecting timing info
2021-01-25 20:58:54.777928 (Thread-2): On test.subsurface.unique_premises_types_premises_code: ROLLBACK
2021-01-25 20:58:54.778438 (Thread-2): On test.subsurface.unique_premises_types_premises_code: Close
2021-01-25 20:58:54.779962 (Thread-2): 21:58:54 | 9 of 11 PASS unique_premises_types_premises_code..................... [PASS in 0.85s]
2021-01-25 20:58:54.786738 (Thread-2): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-25 20:58:54.787352 (Thread-2): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:58:54.788116 (Thread-2): 21:58:54 | 11 of 11 START test unique_transfer_types_transfer_label_fr.......... [RUN]
2021-01-25 20:58:54.791011 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 20:58:54.791426 (Thread-2): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:58:54.848676 (Thread-1): SQL status: OK in 0.75 seconds
2021-01-25 20:58:54.855234 (Thread-2): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-25 20:58:54.865062 (Thread-1): finished collecting timing info
2021-01-25 20:58:54.865951 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_en: ROLLBACK
2021-01-25 20:58:54.866463 (Thread-1): On test.subsurface.unique_transfer_types_transfer_label_en: Close
2021-01-25 20:58:54.868265 (Thread-1): 21:58:54 | 10 of 11 PASS unique_transfer_types_transfer_label_en................ [PASS in 0.84s]
2021-01-25 20:58:54.870669 (Thread-2): finished collecting timing info
2021-01-25 20:58:54.878854 (Thread-2): Using dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 20:58:54.879630 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_fr: 
    
    



select count(*) as validation_errors
from (

    select
        transfer_label_fr

    from "@fab4"."transfer_types"
    where transfer_label_fr is not null
    group by transfer_label_fr
    having count(*) > 1

) validation_errors



2021-01-25 20:58:54.879282 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 20:58:54.879895 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 20:58:54.884760 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 20:58:55.131234 (Thread-2): Connected to db: None
2021-01-25 20:58:55.431023 (Thread-2): SQL status: OK in 0.55 seconds
2021-01-25 20:58:55.449396 (Thread-2): finished collecting timing info
2021-01-25 20:58:55.450194 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_fr: ROLLBACK
2021-01-25 20:58:55.450571 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_fr: Close
2021-01-25 20:58:55.452066 (Thread-2): 21:58:55 | 11 of 11 PASS unique_transfer_types_transfer_label_fr................ [PASS in 0.66s]
2021-01-25 20:58:55.452645 (Thread-2): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 20:58:55.551872 (MainThread): Acquiring new dremio connection "master".
2021-01-25 20:58:55.552859 (MainThread): 21:58:55 | 
2021-01-25 20:58:55.553383 (MainThread): 21:58:55 | Finished running 11 tests in 5.28s.
2021-01-25 20:58:55.553877 (MainThread): Connection 'master' was properly closed.
2021-01-25 20:58:55.554274 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 20:58:55.554745 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_en' was properly closed.
2021-01-25 20:58:55.555148 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_fr' was properly closed.
2021-01-25 20:58:55.644345 (MainThread): 
2021-01-25 20:58:55.644978 (MainThread): Completed successfully
2021-01-25 20:58:55.645557 (MainThread): 
Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
2021-01-25 20:58:55.646283 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa83173c780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa83160c5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa83160c9e8>]}
2021-01-25 20:58:55.647026 (MainThread): Flushing usage events
2021-01-25 21:27:27.192029 (MainThread): Running with dbt=0.18.1
2021-01-25 21:27:27.311388 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__municipalities'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 21:27:27.312680 (MainThread): Tracking: tracking
2021-01-25 21:27:27.328070 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df817908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e2bd18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df817f60>]}
2021-01-25 21:27:27.385247 (MainThread): Partial parsing not enabled
2021-01-25 21:27:27.386632 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:27:27.391570 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:27:27.402725 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:27:27.409856 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:27:27.436552 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:27:27.441132 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:27:27.486222 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:27:27.488654 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:27:27.494541 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:27:27.495046 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:27:27.500396 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:27:27.518485 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:27:27.535748 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:27:27.544289 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:27:27.558790 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:27:27.569604 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:27:27.597567 (MainThread): Parsing macros/core.sql
2021-01-25 21:27:27.604814 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:27:27.684457 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:27:27.701533 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:27:27.705004 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:27:27.707318 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:27:27.709392 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:27:27.713492 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:27:27.716974 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:27:27.734558 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:27:27.738595 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:27:27.750543 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:27:27.802451 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:27:27.834420 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:27:27.838023 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:27:27.847688 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:27:27.859362 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:27:27.885665 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:27:27.898702 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:27:27.937016 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:27:27.941156 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:27:27.944460 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:27:27.948138 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:27:27.963104 (MainThread): Partial parsing not enabled
2021-01-25 21:27:28.077143 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:27:28.121298 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:27:29.054793 (MainThread): Found 2 models, 11 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:27:29.056692 (MainThread): 
2021-01-25 21:27:29.057537 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:27:29.060499 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 21:27:29.084503 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 21:27:29.084776 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 21:27:29.084908 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 21:27:29.085027 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:27:29.229726 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 21:27:29.361137 (ThreadPoolExecutor-0_0): SQL status: OK in 0.28 seconds
2021-01-25 21:27:29.388616 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 21:27:29.443904 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:27:29.455487 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:27:29.455777 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:27:29.455994 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 21:27:29.456158 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:27:29.599658 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:27:29.991689 (ThreadPoolExecutor-1_0): SQL status: OK in 0.54 seconds
2021-01-25 21:27:30.021456 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:27:30.023089 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:27:30.029253 (MainThread): 22:27:30 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 21:27:30.029702 (MainThread): 22:27:30 | 
2021-01-25 21:27:30.062068 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 21:27:30.064766 (Thread-1): 22:27:30 | 1 of 1 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-25 21:27:30.066004 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:27:30.066462 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 21:27:30.143261 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 21:27:30.156197 (Thread-1): finished collecting timing info
2021-01-25 21:27:30.208531 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-25 21:27:30.216980 (Thread-1): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:27:30.217436 (Thread-1): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    

select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as departement_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes"
  )

2021-01-25 21:27:30.217747 (Thread-1): Opening a new connection, currently in state init
2021-01-25 21:27:30.218026 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:27:30.335158 (Thread-1): Connected to db: None
2021-01-25 21:27:30.373514 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."stg__municipalities" as (
    

select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as departement_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes"
  )

2021-01-25 21:27:30.373842 (Thread-1): Rolling back transaction.
2021-01-25 21:27:30.374086 (Thread-1): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-25 21:27:30.374288 (Thread-1): On model.subsurface.stg__municipalities: Close
2021-01-25 21:27:30.376610 (Thread-1): finished collecting timing info
2021-01-25 21:27:30.378077 (Thread-1): Runtime Error in model stg__municipalities (models/staging/stg__municipalities.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__municipalities" as (\n    \n\nselect\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as departement_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n   "fs"."geo"."communes"\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidat...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__municipalities" as (\n    \n\nselect\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as departement_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n   "fs"."geo"."communes"\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidat...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__municipalities (models/staging/stg__municipalities.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__municipalities" as (\n    \n\nselect\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as departement_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n   "fs"."geo"."communes"\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidat...[see log] (1040) (SQLExecDirectW)')
2021-01-25 21:27:30.405523 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd03c7eb1-7770-4485-9ac6-23eda8946b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df475a90>]}
2021-01-25 21:27:30.408147 (Thread-1): 22:27:30 | 1 of 1 ERROR creating view model @fab4.stg__municipalities........... [ERROR in 0.34s]
2021-01-25 21:27:30.408555 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 21:27:30.446060 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:27:30.447221 (MainThread): On master: ROLLBACK
2021-01-25 21:27:30.447504 (MainThread): Opening a new connection, currently in state init
2021-01-25 21:27:30.447686 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:27:30.574159 (MainThread): Connected to db: None
2021-01-25 21:27:30.574536 (MainThread): On master: ROLLBACK
2021-01-25 21:27:30.574695 (MainThread): On master: Close
2021-01-25 21:27:30.576029 (MainThread): 22:27:30 | 
2021-01-25 21:27:30.579171 (MainThread): 22:27:30 | Finished running 1 view model in 1.52s.
2021-01-25 21:27:30.582652 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:27:30.590471 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 21:27:30.591086 (MainThread): Connection 'model.subsurface.stg__municipalities' was properly closed.
2021-01-25 21:27:30.599314 (MainThread): 
2021-01-25 21:27:30.600381 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 21:27:30.601171 (MainThread): 
2021-01-25 21:27:30.602058 (MainThread): Runtime Error in model stg__municipalities (models/staging/stg__municipalities.sql)
2021-01-25 21:27:30.603420 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__municipalities" as (\n    \n\nselect\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as departement_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n   "fs"."geo"."communes"\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidat...[see log] (1040) (SQLExecDirectW)')
2021-01-25 21:27:30.604506 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 21:27:30.604965 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df46a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df46aba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df46a7b8>]}
2021-01-25 21:27:30.605345 (MainThread): Flushing usage events
2021-01-25 21:29:54.267796 (MainThread): Running with dbt=0.18.1
2021-01-25 21:29:54.403071 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__municipalities'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 21:29:54.404543 (MainThread): Tracking: tracking
2021-01-25 21:29:54.415839 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9406d5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9401e9e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9401e9eb8>]}
2021-01-25 21:29:54.475155 (MainThread): Partial parsing not enabled
2021-01-25 21:29:54.476950 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:29:54.481942 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:29:54.485480 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:29:54.489823 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:29:54.514562 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:29:54.519099 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:29:54.564396 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:29:54.566828 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:29:54.572567 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:29:54.573054 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:29:54.578561 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:29:54.597082 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:29:54.614963 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:29:54.623287 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:29:54.638210 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:29:54.649215 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:29:54.677059 (MainThread): Parsing macros/core.sql
2021-01-25 21:29:54.684488 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:29:54.764890 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:29:54.781703 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:29:54.785228 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:29:54.787699 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:29:54.789790 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:29:54.794371 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:29:54.797812 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:29:54.815621 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:29:54.819521 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:29:54.831807 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:29:54.882831 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:29:54.915619 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:29:54.919283 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:29:54.929324 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:29:54.941214 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:29:54.967229 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:29:54.980374 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:29:55.019821 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:29:55.023853 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:29:55.027169 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:29:55.031058 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:29:55.045920 (MainThread): Partial parsing not enabled
2021-01-25 21:29:55.168576 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:29:55.213691 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:29:55.903776 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94006bdd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9400333c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff940033390>]}
2021-01-25 21:29:55.904354 (MainThread): Flushing usage events
2021-01-25 21:29:56.470490 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 21:29:56.471514 (MainThread): Encountered an error:
2021-01-25 21:29:56.471800 (MainThread): Compilation Error in model stg__municipalities (models/staging/stg__municipalities.sql)
  Model 'model.subsurface.stg__municipalities' (models/staging/stg__municipalities.sql) depends on a source named 'geo.communes' which was not found
2021-01-25 21:29:56.494168 (MainThread): Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 351, in load_all
    manifest = loader.create_manifest()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 327, in create_manifest
    self.process_manifest(manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 297, in process_manifest
    process_sources(manifest, project_name)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 706, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 693, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 410, in invalid_source_fail_unless_test
    disabled=disabled
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 569, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg__municipalities (models/staging/stg__municipalities.sql)
  Model 'model.subsurface.stg__municipalities' (models/staging/stg__municipalities.sql) depends on a source named 'geo.communes' which was not found

2021-01-25 21:30:24.354190 (MainThread): Running with dbt=0.18.1
2021-01-25 21:30:24.476557 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__municipalities'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 21:30:24.477988 (MainThread): Tracking: tracking
2021-01-25 21:30:24.486804 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff17494cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff16fa7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff16fa7f60>]}
2021-01-25 21:30:24.544433 (MainThread): Partial parsing not enabled
2021-01-25 21:30:24.545961 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:30:24.552131 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:30:24.555738 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:30:24.559861 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:30:24.584270 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:30:24.589025 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:30:24.634669 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:30:24.637053 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:30:24.642838 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:30:24.643345 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:30:24.648686 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:30:24.666788 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:30:24.683743 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:30:24.692329 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:30:24.706812 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:30:24.717879 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:30:24.745514 (MainThread): Parsing macros/core.sql
2021-01-25 21:30:24.752737 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:30:24.831765 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:30:24.849286 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:30:24.852759 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:30:24.855085 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:30:24.857138 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:30:24.861217 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:30:24.864650 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:30:24.882307 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:30:24.886145 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:30:24.898473 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:30:24.950742 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:30:24.982539 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:30:24.986203 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:30:24.996174 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:30:25.007995 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:30:25.034149 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:30:25.047693 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:30:25.086408 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:30:25.090796 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:30:25.094230 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:30:25.097829 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:30:25.112682 (MainThread): Partial parsing not enabled
2021-01-25 21:30:25.227357 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:30:25.272158 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:30:26.125038 (MainThread): Found 2 models, 11 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:30:26.126958 (MainThread): 
2021-01-25 21:30:26.127733 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:30:26.131178 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 21:30:26.159653 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 21:30:26.159912 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 21:30:26.160063 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 21:30:26.160216 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:30:26.297602 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 21:30:26.516851 (ThreadPoolExecutor-0_0): SQL status: OK in 0.36 seconds
2021-01-25 21:30:26.574657 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 21:30:26.768169 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:30:26.782996 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:30:26.783422 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:30:26.783781 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 21:30:26.784121 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:30:26.905809 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:30:27.211290 (ThreadPoolExecutor-1_0): SQL status: OK in 0.43 seconds
2021-01-25 21:30:27.239349 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:30:27.246672 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:30:27.249155 (MainThread): 22:30:27 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 21:30:27.249535 (MainThread): 22:30:27 | 
2021-01-25 21:30:27.278557 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 21:30:27.280884 (Thread-1): 22:30:27 | 1 of 1 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-25 21:30:27.286910 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:30:27.287265 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 21:30:27.421598 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 21:30:27.422508 (Thread-1): finished collecting timing info
2021-01-25 21:30:27.475034 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-25 21:30:27.476123 (Thread-1): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:30:27.476642 (Thread-1): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    

select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as departement_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-25 21:30:27.477013 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:30:27.477320 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:30:27.602331 (Thread-1): Connected to db: None
2021-01-25 21:30:27.754768 (Thread-1): SQL status: OK in 0.28 seconds
2021-01-25 21:30:27.772956 (Thread-1): finished collecting timing info
2021-01-25 21:30:27.773701 (Thread-1): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-25 21:30:27.774024 (Thread-1): On model.subsurface.stg__municipalities: Close
2021-01-25 21:30:27.776126 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e7e07b-8b58-4003-8347-c08fd86b7c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff16f27748>]}
2021-01-25 21:30:27.778664 (Thread-1): 22:30:27 | 1 of 1 OK created view model @fab4.stg__municipalities............... [OK in 0.49s]
2021-01-25 21:30:27.782666 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 21:30:27.807171 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:30:27.807504 (MainThread): On master: ROLLBACK
2021-01-25 21:30:27.807657 (MainThread): Opening a new connection, currently in state init
2021-01-25 21:30:27.807781 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:30:27.938181 (MainThread): Connected to db: None
2021-01-25 21:30:27.938771 (MainThread): On master: ROLLBACK
2021-01-25 21:30:27.939146 (MainThread): On master: Close
2021-01-25 21:30:27.941111 (MainThread): 22:30:27 | 
2021-01-25 21:30:27.942068 (MainThread): 22:30:27 | Finished running 1 view model in 1.81s.
2021-01-25 21:30:27.950501 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:30:27.950776 (MainThread): Connection 'model.subsurface.stg__municipalities' was properly closed.
2021-01-25 21:30:27.961109 (MainThread): 
2021-01-25 21:30:27.962498 (MainThread): Completed successfully
2021-01-25 21:30:27.963205 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 21:30:27.963908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff16d21ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff16bf5ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff16d0af28>]}
2021-01-25 21:30:27.964913 (MainThread): Flushing usage events
2021-01-25 21:32:18.370906 (MainThread): Running with dbt=0.18.1
2021-01-25 21:32:18.550219 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 21:32:18.553493 (MainThread): Tracking: tracking
2021-01-25 21:32:18.562853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0c1dd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0bd00e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0bd00e80>]}
2021-01-25 21:32:18.624028 (MainThread): Partial parsing not enabled
2021-01-25 21:32:18.626376 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:32:18.633455 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:32:18.638071 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:32:18.644640 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:32:18.679396 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:32:18.684487 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:32:18.747611 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:32:18.750221 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:32:18.756344 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:32:18.756967 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:32:18.762406 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:32:18.780955 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:32:18.803707 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:32:18.813223 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:32:18.828054 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:32:18.841541 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:32:18.875790 (MainThread): Parsing macros/core.sql
2021-01-25 21:32:18.885780 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:32:18.966582 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:32:18.983936 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:32:18.987741 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:32:18.990529 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:32:18.992928 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:32:18.997447 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:32:19.000890 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:32:19.019114 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:32:19.023177 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:32:19.035399 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:32:19.104826 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:32:19.139403 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:32:19.143201 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:32:19.152955 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:32:19.165313 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:32:19.192149 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:32:19.205190 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:32:19.255350 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:32:19.261113 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:32:19.266209 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:32:19.271810 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:32:19.293666 (MainThread): Partial parsing not enabled
2021-01-25 21:32:19.428578 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:32:19.477426 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:32:20.561483 (MainThread): Found 2 models, 11 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:32:20.563650 (MainThread): 
2021-01-25 21:32:20.564330 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:32:20.587066 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 21:32:20.637401 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 21:32:20.637702 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 21:32:20.637914 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 21:32:20.638113 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:32:20.818509 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 21:32:20.957320 (ThreadPoolExecutor-0_0): SQL status: OK in 0.32 seconds
2021-01-25 21:32:20.979718 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 21:32:21.038294 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:32:21.052634 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:32:21.052974 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:32:21.053137 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 21:32:21.053272 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:32:21.189682 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:32:21.686807 (ThreadPoolExecutor-1_0): SQL status: OK in 0.63 seconds
2021-01-25 21:32:21.737557 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:32:21.738919 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:32:21.740943 (MainThread): 22:32:21 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 21:32:21.741314 (MainThread): 22:32:21 | 
2021-01-25 21:32:21.744344 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 21:32:21.747603 (Thread-1): 22:32:21 | 1 of 2 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 21:32:21.747886 (Thread-2): Began running node model.subsurface.stg__municipalities
2021-01-25 21:32:21.750066 (Thread-2): 22:32:21 | 2 of 2 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-25 21:32:21.750847 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:32:21.751878 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 21:32:21.751581 (Thread-2): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:32:21.759718 (Thread-2): Compiling model.subsurface.stg__municipalities
2021-01-25 21:32:21.882391 (Thread-2): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 21:32:21.883199 (Thread-2): finished collecting timing info
2021-01-25 21:32:21.895383 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 21:32:21.896038 (Thread-1): finished collecting timing info
2021-01-25 21:32:22.025350 (Thread-2): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-25 21:32:22.026152 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 21:32:22.027095 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:32:22.027437 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transaction_type
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,nullif("Commune", '') as municipality
  ,lpad(nullif("Code departement", ''), 2, '0') as department_code
  ,lpad(nullif("Code commune", ''), 3, '0') as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("Type local", '') as premises_type
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
  ,nullif("Nature culture speciale", '') as special_crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 21:32:22.027609 (Thread-1): Opening a new connection, currently in state init
2021-01-25 21:32:22.027791 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:32:22.030510 (Thread-2): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:32:22.030776 (Thread-2): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    

select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as departement_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-25 21:32:22.030916 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 21:32:22.031048 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:32:22.304457 (Thread-1): Connected to db: None
2021-01-25 21:32:22.517214 (Thread-1): SQL status: OK in 0.49 seconds
2021-01-25 21:32:22.533628 (Thread-2): Connected to db: None
2021-01-25 21:32:22.544078 (Thread-1): finished collecting timing info
2021-01-25 21:32:22.553720 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 21:32:22.554044 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 21:32:22.555617 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eb19c13-8949-416d-ac25-f7b2b4115643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0b952dd8>]}
2021-01-25 21:32:22.564792 (Thread-1): 22:32:22 | 1 of 2 OK created view model @fab4.stg__land_values.................. [OK in 0.80s]
2021-01-25 21:32:22.565178 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 21:32:22.650866 (Thread-2): SQL status: OK in 0.62 seconds
2021-01-25 21:32:22.656834 (Thread-2): finished collecting timing info
2021-01-25 21:32:22.666578 (Thread-2): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-25 21:32:22.666887 (Thread-2): On model.subsurface.stg__municipalities: Close
2021-01-25 21:32:22.669130 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eb19c13-8949-416d-ac25-f7b2b4115643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0bafac88>]}
2021-01-25 21:32:22.683738 (Thread-2): 22:32:22 | 2 of 2 OK created view model @fab4.stg__municipalities............... [OK in 0.92s]
2021-01-25 21:32:22.684128 (Thread-2): Finished running node model.subsurface.stg__municipalities
2021-01-25 21:32:22.711536 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:32:22.711861 (MainThread): On master: ROLLBACK
2021-01-25 21:32:22.711988 (MainThread): Opening a new connection, currently in state init
2021-01-25 21:32:22.712099 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:32:22.882382 (MainThread): Connected to db: None
2021-01-25 21:32:22.882736 (MainThread): On master: ROLLBACK
2021-01-25 21:32:22.882878 (MainThread): On master: Close
2021-01-25 21:32:22.884772 (MainThread): 22:32:22 | 
2021-01-25 21:32:22.885115 (MainThread): 22:32:22 | Finished running 2 view models in 2.32s.
2021-01-25 21:32:22.885293 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:32:22.885425 (MainThread): Connection 'model.subsurface.stg__municipalities' was properly closed.
2021-01-25 21:32:22.885541 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 21:32:22.906703 (MainThread): 
2021-01-25 21:32:22.907140 (MainThread): Completed successfully
2021-01-25 21:32:22.907347 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-25 21:32:22.907663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0ba8d9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0baaaa58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0bb2f6a0>]}
2021-01-25 21:32:22.910669 (MainThread): Flushing usage events
2021-01-25 21:38:26.155966 (MainThread): Running with dbt=0.18.1
2021-01-25 21:38:26.311547 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__municipalities'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 21:38:26.313027 (MainThread): Tracking: tracking
2021-01-25 21:38:26.321920 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55afacd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55af5f0f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55af5f0f98>]}
2021-01-25 21:38:26.380394 (MainThread): Partial parsing not enabled
2021-01-25 21:38:26.381980 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:38:26.388354 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:38:26.391831 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:38:26.396155 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:38:26.420591 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:38:26.425029 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:38:26.470913 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:38:26.473318 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:38:26.479209 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:38:26.479711 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:38:26.485089 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:38:26.503632 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:38:26.520751 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:38:26.529250 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:38:26.544064 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:38:26.554972 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:38:26.582826 (MainThread): Parsing macros/core.sql
2021-01-25 21:38:26.590239 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:38:26.670865 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:38:26.688576 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:38:26.692206 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:38:26.694618 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:38:26.696728 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:38:26.700894 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:38:26.704499 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:38:26.722023 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:38:26.725814 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:38:26.737941 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:38:26.789732 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:38:26.823289 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:38:26.829282 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:38:26.839932 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:38:26.852082 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:38:26.878717 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:38:26.891650 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:38:26.931028 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:38:26.935166 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:38:26.938447 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:38:26.942025 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:38:26.957091 (MainThread): Partial parsing not enabled
2021-01-25 21:38:27.073105 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:38:27.119153 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:38:28.225145 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.subsurface.marts

2021-01-25 21:38:28.399807 (MainThread): Found 2 models, 18 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:38:28.402490 (MainThread): 
2021-01-25 21:38:28.403280 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:38:28.481473 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:38:28.506918 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:38:28.507205 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:38:28.507370 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 21:38:28.507531 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:38:28.756077 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:38:29.186243 (ThreadPoolExecutor-1_0): SQL status: OK in 0.68 seconds
2021-01-25 21:38:29.268039 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:38:29.276689 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:38:29.286835 (MainThread): 22:38:29 | Concurrency: 2 threads (target='unmanaged')
2021-01-25 21:38:29.287253 (MainThread): 22:38:29 | 
2021-01-25 21:38:29.371627 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 21:38:29.372033 (Thread-1): 22:38:29 | 1 of 7 START test not_null_stg__municipalities_departement_label..... [RUN]
2021-01-25 21:38:29.372317 (Thread-2): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 21:38:29.372634 (Thread-2): 22:38:29 | 2 of 7 START test not_null_stg__municipalities_department_code....... [RUN]
2021-01-25 21:38:29.373305 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 21:38:29.373641 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 21:38:29.379942 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 21:38:29.380256 (Thread-2): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 21:38:29.466722 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-25 21:38:29.472867 (Thread-2): finished collecting timing info
2021-01-25 21:38:29.473510 (Thread-2): Using dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 21:38:29.473708 (Thread-2): On test.subsurface.not_null_stg__municipalities_department_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where department_code is null



2021-01-25 21:38:29.473906 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 21:38:29.474075 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:38:29.472136 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-25 21:38:29.478157 (Thread-1): finished collecting timing info
2021-01-25 21:38:29.478914 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 21:38:29.479227 (Thread-1): On test.subsurface.not_null_stg__municipalities_departement_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where departement_label is null



2021-01-25 21:38:29.479486 (Thread-1): Opening a new connection, currently in state init
2021-01-25 21:38:29.479717 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:38:29.830872 (Thread-2): Connected to db: None
2021-01-25 21:38:29.831159 (Thread-1): Connected to db: None
2021-01-25 21:38:30.555651 (Thread-2): SQL status: OK in 1.08 seconds
2021-01-25 21:38:30.582366 (Thread-2): finished collecting timing info
2021-01-25 21:38:30.582980 (Thread-2): On test.subsurface.not_null_stg__municipalities_department_code: ROLLBACK
2021-01-25 21:38:30.583179 (Thread-2): On test.subsurface.not_null_stg__municipalities_department_code: Close
2021-01-25 21:38:30.584392 (Thread-2): 22:38:30 | 2 of 7 PASS not_null_stg__municipalities_department_code............. [PASS in 1.20s]
2021-01-25 21:38:30.586811 (Thread-2): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 21:38:30.587462 (Thread-2): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 21:38:30.588171 (Thread-2): 22:38:30 | 3 of 7 START test not_null_stg__municipalities_municipality_code..... [RUN]
2021-01-25 21:38:30.595502 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 21:38:30.596354 (Thread-2): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 21:38:30.663002 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-25 21:38:30.667218 (Thread-2): finished collecting timing info
2021-01-25 21:38:30.670926 (Thread-2): Using dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 21:38:30.671467 (Thread-2): On test.subsurface.not_null_stg__municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where municipality_code is null



2021-01-25 21:38:30.671948 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 21:38:30.672396 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:38:30.918821 (Thread-1): SQL status: OK in 1.44 seconds
2021-01-25 21:38:30.955216 (Thread-1): finished collecting timing info
2021-01-25 21:38:30.955952 (Thread-1): On test.subsurface.not_null_stg__municipalities_departement_label: ROLLBACK
2021-01-25 21:38:30.956349 (Thread-1): On test.subsurface.not_null_stg__municipalities_departement_label: Close
2021-01-25 21:38:30.957763 (Thread-1): 22:38:30 | 1 of 7 PASS not_null_stg__municipalities_departement_label........... [PASS in 1.58s]
2021-01-25 21:38:30.958105 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 21:38:30.958394 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 21:38:30.958982 (Thread-1): 22:38:30 | 4 of 7 START test not_null_stg__municipalities_municipality_label.... [RUN]
2021-01-25 21:38:30.961266 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 21:38:30.961573 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 21:38:30.998632 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-25 21:38:30.999208 (Thread-1): finished collecting timing info
2021-01-25 21:38:30.999828 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 21:38:31.000024 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where municipality_label is null



2021-01-25 21:38:31.000181 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:38:31.004721 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:38:31.187941 (Thread-2): Connected to db: None
2021-01-25 21:38:31.370210 (Thread-1): Connected to db: None
2021-01-25 21:38:31.959054 (Thread-2): SQL status: OK in 1.29 seconds
2021-01-25 21:38:31.994894 (Thread-2): finished collecting timing info
2021-01-25 21:38:31.995986 (Thread-2): On test.subsurface.not_null_stg__municipalities_municipality_code: ROLLBACK
2021-01-25 21:38:31.996281 (Thread-2): On test.subsurface.not_null_stg__municipalities_municipality_code: Close
2021-01-25 21:38:31.995599 (Thread-1): SQL status: OK in 1.00 seconds
2021-01-25 21:38:31.997581 (Thread-2): 22:38:31 | 3 of 7 PASS not_null_stg__municipalities_municipality_code........... [PASS in 1.40s]
2021-01-25 21:38:31.997986 (Thread-2): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 21:38:31.998382 (Thread-2): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 21:38:31.999081 (Thread-2): 22:38:31 | 5 of 7 START test not_null_stg__municipalities_region_code........... [RUN]
2021-01-25 21:38:32.000636 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 21:38:32.001076 (Thread-2): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 21:38:32.044269 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-25 21:38:32.055880 (Thread-2): finished collecting timing info
2021-01-25 21:38:32.056553 (Thread-2): Using dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 21:38:32.056807 (Thread-2): On test.subsurface.not_null_stg__municipalities_region_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where region_code is null



2021-01-25 21:38:32.056970 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 21:38:32.057114 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:38:32.059023 (Thread-1): finished collecting timing info
2021-01-25 21:38:32.059671 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_label: ROLLBACK
2021-01-25 21:38:32.059901 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_label: Close
2021-01-25 21:38:32.060992 (Thread-1): 22:38:32 | 4 of 7 PASS not_null_stg__municipalities_municipality_label.......... [PASS in 1.10s]
2021-01-25 21:38:32.061396 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 21:38:32.061743 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 21:38:32.062231 (Thread-1): 22:38:32 | 6 of 7 START test not_null_stg__municipalities_region_label.......... [RUN]
2021-01-25 21:38:32.062937 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 21:38:32.063312 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 21:38:32.116343 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-25 21:38:32.126941 (Thread-1): finished collecting timing info
2021-01-25 21:38:32.127656 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 21:38:32.127914 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where region_label is null



2021-01-25 21:38:32.138566 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:38:32.139016 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:38:32.527687 (Thread-2): Connected to db: None
2021-01-25 21:38:32.554918 (Thread-1): Connected to db: None
2021-01-25 21:38:33.431424 (Thread-2): SQL status: OK in 1.37 seconds
2021-01-25 21:38:33.455950 (Thread-1): SQL status: OK in 1.32 seconds
2021-01-25 21:38:33.464880 (Thread-2): finished collecting timing info
2021-01-25 21:38:33.465717 (Thread-2): On test.subsurface.not_null_stg__municipalities_region_code: ROLLBACK
2021-01-25 21:38:33.466118 (Thread-2): On test.subsurface.not_null_stg__municipalities_region_code: Close
2021-01-25 21:38:33.467600 (Thread-2): 22:38:33 | 5 of 7 PASS not_null_stg__municipalities_region_code................. [PASS in 1.47s]
2021-01-25 21:38:33.468069 (Thread-2): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 21:38:33.468532 (Thread-2): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 21:38:33.469204 (Thread-2): 22:38:33 | 7 of 7 START test unique_stg__municipalities_municipality_code....... [RUN]
2021-01-25 21:38:33.470103 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 21:38:33.471901 (Thread-2): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 21:38:33.494955 (Thread-1): finished collecting timing info
2021-01-25 21:38:33.495794 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_label: ROLLBACK
2021-01-25 21:38:33.496193 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_label: Close
2021-01-25 21:38:33.497906 (Thread-1): 22:38:33 | 6 of 7 PASS not_null_stg__municipalities_region_label................ [PASS in 1.44s]
2021-01-25 21:38:33.498717 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 21:38:33.523691 (Thread-2): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-25 21:38:33.534554 (Thread-2): finished collecting timing info
2021-01-25 21:38:33.535328 (Thread-2): Using dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 21:38:33.535746 (Thread-2): On test.subsurface.unique_stg__municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from (

    select
        municipality_code

    from "@fab4"."stg__municipalities"
    where municipality_code is not null
    group by municipality_code
    having count(*) > 1

) validation_errors



2021-01-25 21:38:33.536019 (Thread-2): Opening a new connection, currently in state closed
2021-01-25 21:38:33.536243 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:38:33.685476 (Thread-2): Connected to db: None
2021-01-25 21:38:34.623370 (Thread-2): SQL status: OK in 1.09 seconds
2021-01-25 21:38:34.667767 (Thread-2): finished collecting timing info
2021-01-25 21:38:34.668501 (Thread-2): On test.subsurface.unique_stg__municipalities_municipality_code: ROLLBACK
2021-01-25 21:38:34.668792 (Thread-2): On test.subsurface.unique_stg__municipalities_municipality_code: Close
2021-01-25 21:38:34.670218 (Thread-2): 22:38:34 | 7 of 7 PASS unique_stg__municipalities_municipality_code............. [PASS in 1.20s]
2021-01-25 21:38:34.670748 (Thread-2): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 21:38:34.725522 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:38:34.726579 (MainThread): 22:38:34 | 
2021-01-25 21:38:34.727036 (MainThread): 22:38:34 | Finished running 7 tests in 6.32s.
2021-01-25 21:38:34.730568 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:38:34.730944 (MainThread): Connection 'test.subsurface.unique_stg__municipalities_municipality_code' was properly closed.
2021-01-25 21:38:34.731306 (MainThread): Connection 'test.subsurface.not_null_stg__municipalities_region_label' was properly closed.
2021-01-25 21:38:34.858607 (MainThread): 
2021-01-25 21:38:34.860506 (MainThread): Completed successfully
2021-01-25 21:38:34.860905 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-01-25 21:38:34.866752 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55af370ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55af370588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55af370a58>]}
2021-01-25 21:38:34.867298 (MainThread): Flushing usage events
2021-01-25 21:39:24.167640 (MainThread): Running with dbt=0.18.1
2021-01-25 21:39:24.290848 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__municipalities'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 21:39:24.292405 (MainThread): Tracking: tracking
2021-01-25 21:39:24.305276 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50eb105f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50eac18ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50eac18f60>]}
2021-01-25 21:39:24.373881 (MainThread): Partial parsing not enabled
2021-01-25 21:39:24.375498 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:39:24.381122 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:39:24.384675 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:39:24.388907 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:39:24.413746 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:39:24.418374 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:39:24.464027 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:39:24.466476 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:39:24.472270 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:39:24.472760 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:39:24.478190 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:39:24.497201 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:39:24.514633 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:39:24.523282 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:39:24.538158 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:39:24.549374 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:39:24.577421 (MainThread): Parsing macros/core.sql
2021-01-25 21:39:24.584903 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:39:24.666205 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:39:24.683307 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:39:24.687004 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:39:24.689349 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:39:24.691490 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:39:24.695864 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:39:24.699370 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:39:24.717118 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:39:24.721175 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:39:24.733212 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:39:24.785712 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:39:24.818293 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:39:24.822162 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:39:24.831986 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:39:24.844054 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:39:24.870699 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:39:24.883880 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:39:24.923667 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:39:24.927762 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:39:24.931153 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:39:24.934776 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:39:24.949834 (MainThread): Partial parsing not enabled
2021-01-25 21:39:25.064795 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:39:25.110522 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:39:26.209347 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.subsurface.marts

2021-01-25 21:39:26.425366 (MainThread): Found 2 models, 18 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:39:26.428062 (MainThread): 
2021-01-25 21:39:26.428781 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:39:26.495088 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:39:26.519854 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:39:26.520259 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:39:26.520574 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 21:39:26.520856 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:39:26.669062 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:39:27.002910 (ThreadPoolExecutor-1_0): SQL status: OK in 0.48 seconds
2021-01-25 21:39:27.110508 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:39:27.110955 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:39:27.127538 (MainThread): 22:39:27 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 21:39:27.127934 (MainThread): 22:39:27 | 
2021-01-25 21:39:27.195831 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 21:39:27.196342 (Thread-1): 22:39:27 | 1 of 7 START test not_null_stg__municipalities_departement_label..... [RUN]
2021-01-25 21:39:27.197186 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 21:39:27.197552 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 21:39:27.361278 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-25 21:39:27.366961 (Thread-1): finished collecting timing info
2021-01-25 21:39:27.367742 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 21:39:27.368003 (Thread-1): On test.subsurface.not_null_stg__municipalities_departement_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where departement_label is null



2021-01-25 21:39:27.368186 (Thread-1): Opening a new connection, currently in state init
2021-01-25 21:39:27.368357 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:39:27.508845 (Thread-1): Connected to db: None
2021-01-25 21:39:27.747138 (Thread-1): SQL status: OK in 0.38 seconds
2021-01-25 21:39:27.765591 (Thread-1): finished collecting timing info
2021-01-25 21:39:27.766181 (Thread-1): On test.subsurface.not_null_stg__municipalities_departement_label: ROLLBACK
2021-01-25 21:39:27.766398 (Thread-1): On test.subsurface.not_null_stg__municipalities_departement_label: Close
2021-01-25 21:39:27.767792 (Thread-1): 22:39:27 | 1 of 7 PASS not_null_stg__municipalities_departement_label........... [PASS in 0.57s]
2021-01-25 21:39:27.774450 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 21:39:27.774868 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 21:39:27.775363 (Thread-1): 22:39:27 | 2 of 7 START test not_null_stg__municipalities_department_code....... [RUN]
2021-01-25 21:39:27.775927 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 21:39:27.776198 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 21:39:27.857821 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-25 21:39:27.865895 (Thread-1): finished collecting timing info
2021-01-25 21:39:27.866664 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 21:39:27.866871 (Thread-1): On test.subsurface.not_null_stg__municipalities_department_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where department_code is null



2021-01-25 21:39:27.867010 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:39:27.867144 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:39:28.120332 (Thread-1): Connected to db: None
2021-01-25 21:39:28.412864 (Thread-1): SQL status: OK in 0.55 seconds
2021-01-25 21:39:28.426630 (Thread-1): finished collecting timing info
2021-01-25 21:39:28.427238 (Thread-1): On test.subsurface.not_null_stg__municipalities_department_code: ROLLBACK
2021-01-25 21:39:28.427429 (Thread-1): On test.subsurface.not_null_stg__municipalities_department_code: Close
2021-01-25 21:39:28.428616 (Thread-1): 22:39:28 | 2 of 7 PASS not_null_stg__municipalities_department_code............. [PASS in 0.65s]
2021-01-25 21:39:28.434613 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 21:39:28.435073 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 21:39:28.435540 (Thread-1): 22:39:28 | 3 of 7 START test not_null_stg__municipalities_municipality_code..... [RUN]
2021-01-25 21:39:28.436243 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 21:39:28.436631 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 21:39:28.490600 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-25 21:39:28.495304 (Thread-1): finished collecting timing info
2021-01-25 21:39:28.496268 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 21:39:28.496712 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where municipality_code is null



2021-01-25 21:39:28.497010 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:39:28.497294 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:39:28.632199 (Thread-1): Connected to db: None
2021-01-25 21:39:28.845611 (Thread-1): SQL status: OK in 0.35 seconds
2021-01-25 21:39:28.866516 (Thread-1): finished collecting timing info
2021-01-25 21:39:28.867176 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_code: ROLLBACK
2021-01-25 21:39:28.867419 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_code: Close
2021-01-25 21:39:28.868657 (Thread-1): 22:39:28 | 3 of 7 PASS not_null_stg__municipalities_municipality_code........... [PASS in 0.43s]
2021-01-25 21:39:28.869045 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 21:39:28.869366 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 21:39:28.869817 (Thread-1): 22:39:28 | 4 of 7 START test not_null_stg__municipalities_municipality_label.... [RUN]
2021-01-25 21:39:28.872019 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 21:39:28.872353 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 21:39:28.898403 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-25 21:39:28.899179 (Thread-1): finished collecting timing info
2021-01-25 21:39:28.899977 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 21:39:28.900250 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where municipality_label is null



2021-01-25 21:39:28.900415 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:39:28.900549 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:39:29.026725 (Thread-1): Connected to db: None
2021-01-25 21:39:29.313654 (Thread-1): SQL status: OK in 0.41 seconds
2021-01-25 21:39:29.334782 (Thread-1): finished collecting timing info
2021-01-25 21:39:29.335602 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_label: ROLLBACK
2021-01-25 21:39:29.335993 (Thread-1): On test.subsurface.not_null_stg__municipalities_municipality_label: Close
2021-01-25 21:39:29.337651 (Thread-1): 22:39:29 | 4 of 7 PASS not_null_stg__municipalities_municipality_label.......... [PASS in 0.47s]
2021-01-25 21:39:29.342606 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 21:39:29.343121 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 21:39:29.343805 (Thread-1): 22:39:29 | 5 of 7 START test not_null_stg__municipalities_region_code........... [RUN]
2021-01-25 21:39:29.346962 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 21:39:29.347406 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 21:39:29.403060 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-25 21:39:29.403983 (Thread-1): finished collecting timing info
2021-01-25 21:39:29.404898 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 21:39:29.405256 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where region_code is null



2021-01-25 21:39:29.405577 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:39:29.405928 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:39:29.566719 (Thread-1): Connected to db: None
2021-01-25 21:39:30.983151 (Thread-1): SQL status: OK in 1.58 seconds
2021-01-25 21:39:30.995671 (Thread-1): finished collecting timing info
2021-01-25 21:39:30.996390 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_code: ROLLBACK
2021-01-25 21:39:30.996697 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_code: Close
2021-01-25 21:39:30.998080 (Thread-1): 22:39:30 | 5 of 7 PASS not_null_stg__municipalities_region_code................. [PASS in 1.65s]
2021-01-25 21:39:30.998480 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 21:39:30.998883 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 21:39:30.999432 (Thread-1): 22:39:30 | 6 of 7 START test not_null_stg__municipalities_region_label.......... [RUN]
2021-01-25 21:39:31.000211 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 21:39:31.000627 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 21:39:31.060852 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-25 21:39:31.061885 (Thread-1): finished collecting timing info
2021-01-25 21:39:31.066921 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 21:39:31.067307 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where region_label is null



2021-01-25 21:39:31.067651 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:39:31.068011 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:39:31.382930 (Thread-1): Connected to db: None
2021-01-25 21:39:31.703147 (Thread-1): SQL status: OK in 0.64 seconds
2021-01-25 21:39:31.730803 (Thread-1): finished collecting timing info
2021-01-25 21:39:31.731625 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_label: ROLLBACK
2021-01-25 21:39:31.732015 (Thread-1): On test.subsurface.not_null_stg__municipalities_region_label: Close
2021-01-25 21:39:31.733648 (Thread-1): 22:39:31 | 6 of 7 PASS not_null_stg__municipalities_region_label................ [PASS in 0.73s]
2021-01-25 21:39:31.742615 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 21:39:31.743156 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 21:39:31.743833 (Thread-1): 22:39:31 | 7 of 7 START test unique_stg__municipalities_municipality_code....... [RUN]
2021-01-25 21:39:31.744683 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 21:39:31.745123 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 21:39:31.798083 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-25 21:39:31.807229 (Thread-1): finished collecting timing info
2021-01-25 21:39:31.808081 (Thread-1): Using dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 21:39:31.808468 (Thread-1): On test.subsurface.unique_stg__municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from (

    select
        municipality_code

    from "@fab4"."stg__municipalities"
    where municipality_code is not null
    group by municipality_code
    having count(*) > 1

) validation_errors



2021-01-25 21:39:31.808792 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:39:31.809108 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:39:31.969461 (Thread-1): Connected to db: None
2021-01-25 21:39:32.538764 (Thread-1): SQL status: OK in 0.73 seconds
2021-01-25 21:39:32.550581 (Thread-1): finished collecting timing info
2021-01-25 21:39:32.551259 (Thread-1): On test.subsurface.unique_stg__municipalities_municipality_code: ROLLBACK
2021-01-25 21:39:32.551484 (Thread-1): On test.subsurface.unique_stg__municipalities_municipality_code: Close
2021-01-25 21:39:32.552777 (Thread-1): 22:39:32 | 7 of 7 PASS unique_stg__municipalities_municipality_code............. [PASS in 0.81s]
2021-01-25 21:39:32.553216 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 21:39:32.608892 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:39:32.609830 (MainThread): 22:39:32 | 
2021-01-25 21:39:32.610215 (MainThread): 22:39:32 | Finished running 7 tests in 6.18s.
2021-01-25 21:39:32.610780 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:39:32.611076 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 21:39:32.611330 (MainThread): Connection 'test.subsurface.unique_stg__municipalities_municipality_code' was properly closed.
2021-01-25 21:39:32.679530 (MainThread): 
2021-01-25 21:39:32.680108 (MainThread): Completed successfully
2021-01-25 21:39:32.680584 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-01-25 21:39:32.681248 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50eaac9cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ea7e6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ea95da20>]}
2021-01-25 21:39:32.681905 (MainThread): Flushing usage events
2021-01-25 21:42:52.353823 (MainThread): Running with dbt=0.18.1
2021-01-25 21:42:52.478557 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values--target', 'unmanaged'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 21:42:52.480127 (MainThread): Tracking: tracking
2021-01-25 21:42:52.489468 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50129ceb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff500daae48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff500daaeb8>]}
2021-01-25 21:42:52.548557 (MainThread): Partial parsing not enabled
2021-01-25 21:42:52.550310 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:42:52.555630 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:42:52.559050 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:42:52.563221 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:42:52.587591 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:42:52.592284 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:42:52.638736 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:42:52.641118 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:42:52.646884 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:42:52.647374 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:42:52.652781 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:42:52.671108 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:42:52.688372 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:42:52.696795 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:42:52.711605 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:42:52.722526 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:42:52.750572 (MainThread): Parsing macros/core.sql
2021-01-25 21:42:52.757951 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:42:52.836634 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:42:52.853892 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:42:52.857443 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:42:52.859853 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:42:52.862064 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:42:52.866252 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:42:52.869800 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:42:52.887643 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:42:52.891503 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:42:52.903558 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:42:52.955623 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:42:52.988107 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:42:52.991870 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:42:53.001660 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:42:53.013914 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:42:53.040186 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:42:53.052908 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:42:53.092383 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:42:53.096339 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:42:53.099652 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:42:53.103311 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:42:53.118191 (MainThread): Partial parsing not enabled
2021-01-25 21:42:53.233972 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:42:53.280354 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:42:54.403764 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.subsurface.marts

2021-01-25 21:42:54.573497 (MainThread): Found 2 models, 18 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:42:54.574555 (MainThread): The selector 'stg__land_values--target' does not match any nodes and will be ignored
2021-01-25 21:42:54.575057 (MainThread): The selector 'unmanaged' does not match any nodes and will be ignored
2021-01-25 21:42:54.576868 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-01-25 21:42:54.577385 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50097b4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50097be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50097bc18>]}
2021-01-25 21:42:54.577765 (MainThread): Flushing usage events
2021-01-25 21:42:55.149080 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 21:43:28.209475 (MainThread): Running with dbt=0.18.1
2021-01-25 21:43:28.344059 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 21:43:28.345746 (MainThread): Tracking: tracking
2021-01-25 21:43:28.354882 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ffadef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44fac0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44fac0f60>]}
2021-01-25 21:43:28.412864 (MainThread): Partial parsing not enabled
2021-01-25 21:43:28.414498 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:43:28.420402 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:43:28.430641 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:43:28.434858 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:43:28.459846 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:43:28.464370 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:43:28.510160 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:43:28.512800 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:43:28.518508 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:43:28.519010 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:43:28.524379 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:43:28.542740 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:43:28.559880 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:43:28.568274 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:43:28.583149 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:43:28.594088 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:43:28.621885 (MainThread): Parsing macros/core.sql
2021-01-25 21:43:28.629183 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:43:28.708894 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:43:28.725763 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:43:28.729243 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:43:28.731571 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:43:28.733648 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:43:28.737789 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:43:28.741231 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:43:28.759766 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:43:28.763637 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:43:28.776227 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:43:28.827852 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:43:28.860899 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:43:28.864534 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:43:28.874509 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:43:28.886202 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:43:28.912762 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:43:28.925622 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:43:28.965064 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:43:28.969062 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:43:28.972339 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:43:28.975985 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:43:28.991183 (MainThread): Partial parsing not enabled
2021-01-25 21:43:29.106076 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:43:29.151840 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:43:30.243089 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.subsurface.marts

2021-01-25 21:43:30.507508 (MainThread): Found 2 models, 18 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:43:30.509959 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-01-25 21:43:30.510464 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f6943c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f6947b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44f694cc0>]}
2021-01-25 21:43:30.510854 (MainThread): Flushing usage events
2021-01-25 21:43:31.008204 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 21:43:59.575259 (MainThread): Running with dbt=0.18.1
2021-01-25 21:43:59.699844 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 21:43:59.701396 (MainThread): Tracking: tracking
2021-01-25 21:43:59.726392 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891c33d5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891be60f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891be60fd0>]}
2021-01-25 21:43:59.781334 (MainThread): Partial parsing not enabled
2021-01-25 21:43:59.782736 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:43:59.787824 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:43:59.791224 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:43:59.795480 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:43:59.820806 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:43:59.825357 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:43:59.871855 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:43:59.874381 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:43:59.880333 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:43:59.880870 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:43:59.886234 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:43:59.904993 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:43:59.922731 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:43:59.931335 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:43:59.946217 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:43:59.957238 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:43:59.985061 (MainThread): Parsing macros/core.sql
2021-01-25 21:43:59.992532 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:44:00.075241 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:44:00.092286 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:44:00.096078 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:44:00.098460 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:44:00.100547 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:44:00.104880 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:44:00.108368 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:44:00.126113 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:44:00.129919 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:44:00.141551 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:44:00.192931 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:44:00.225343 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:44:00.228962 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:44:00.238693 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:44:00.250699 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:44:00.276884 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:44:00.289881 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:44:00.329500 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:44:00.333535 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:44:00.336868 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:44:00.340604 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:44:00.355546 (MainThread): Partial parsing not enabled
2021-01-25 21:44:00.471039 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:44:00.517295 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:44:01.584155 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.subsurface.marts

2021-01-25 21:44:01.823582 (MainThread): Found 2 models, 18 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:44:01.826033 (MainThread): 
2021-01-25 21:44:01.826778 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:44:01.829896 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 21:44:01.856564 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 21:44:01.856862 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 21:44:01.857000 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 21:44:01.857124 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:44:02.032316 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 21:44:02.250156 (ThreadPoolExecutor-0_0): SQL status: OK in 0.39 seconds
2021-01-25 21:44:02.289863 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 21:44:02.521791 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:44:02.555115 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:44:02.561068 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:44:02.565444 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 21:44:02.567118 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:44:02.717688 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:44:02.970765 (ThreadPoolExecutor-1_0): SQL status: OK in 0.41 seconds
2021-01-25 21:44:03.001289 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:44:03.001639 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:44:03.004405 (MainThread): 22:44:03 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 21:44:03.004737 (MainThread): 22:44:03 | 
2021-01-25 21:44:03.007427 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 21:44:03.010647 (Thread-1): 22:44:03 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 21:44:03.011335 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:44:03.011628 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 21:44:03.100665 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 21:44:03.107152 (Thread-1): finished collecting timing info
2021-01-25 21:44:03.219811 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 21:44:03.220547 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:44:03.220858 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0') as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("Type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 21:44:03.221020 (Thread-1): Opening a new connection, currently in state init
2021-01-25 21:44:03.221136 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:44:03.401803 (Thread-1): Connected to db: None
2021-01-25 21:44:03.578748 (Thread-1): SQL status: OK in 0.36 seconds
2021-01-25 21:44:03.600540 (Thread-1): finished collecting timing info
2021-01-25 21:44:03.601217 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 21:44:03.601470 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 21:44:03.611590 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbacaf25-47e6-4530-a795-2662e14f401e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891bbcb9e8>]}
2021-01-25 21:44:03.613948 (Thread-1): 22:44:03 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.60s]
2021-01-25 21:44:03.626302 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 21:44:03.724058 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:44:03.724626 (MainThread): On master: ROLLBACK
2021-01-25 21:44:03.724960 (MainThread): Opening a new connection, currently in state init
2021-01-25 21:44:03.725449 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:44:03.851840 (MainThread): Connected to db: None
2021-01-25 21:44:03.852209 (MainThread): On master: ROLLBACK
2021-01-25 21:44:03.852424 (MainThread): On master: Close
2021-01-25 21:44:03.853672 (MainThread): 22:44:03 | 
2021-01-25 21:44:03.854024 (MainThread): 22:44:03 | Finished running 1 view model in 2.03s.
2021-01-25 21:44:03.854337 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:44:03.854805 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 21:44:03.854967 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 21:44:03.862419 (MainThread): 
2021-01-25 21:44:03.862925 (MainThread): Completed successfully
2021-01-25 21:44:03.863201 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 21:44:03.863563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891bcb80b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891bbac5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891bb68940>]}
2021-01-25 21:44:03.863985 (MainThread): Flushing usage events
2021-01-25 21:45:44.425944 (MainThread): Running with dbt=0.18.1
2021-01-25 21:45:44.598753 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 21:45:44.600599 (MainThread): Tracking: tracking
2021-01-25 21:45:44.609850 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe713a05f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe713519e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe713519eb8>]}
2021-01-25 21:45:44.668868 (MainThread): Partial parsing not enabled
2021-01-25 21:45:44.671196 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:45:44.676534 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:45:44.679962 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:45:44.684116 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:45:44.708805 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:45:44.713305 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:45:44.759275 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:45:44.761718 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:45:44.767455 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:45:44.767948 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:45:44.773339 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:45:44.791348 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:45:44.808496 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:45:44.817154 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:45:44.831505 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:45:44.842421 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:45:44.870172 (MainThread): Parsing macros/core.sql
2021-01-25 21:45:44.877658 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:45:44.957867 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:45:44.974834 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:45:44.978361 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:45:44.980689 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:45:44.982834 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:45:44.987019 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:45:44.990532 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:45:45.008437 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:45:45.012239 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:45:45.024334 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:45:45.077868 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:45:45.119923 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:45:45.123577 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:45:45.133166 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:45:45.144941 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:45:45.171057 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:45:45.184156 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:45:45.223825 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:45:45.227806 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:45:45.231131 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:45:45.234799 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:45:45.249795 (MainThread): Partial parsing not enabled
2021-01-25 21:45:45.366207 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:45:45.412871 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:45:46.754225 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.subsurface.marts

2021-01-25 21:45:47.009869 (MainThread): Found 2 models, 18 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:45:47.012480 (MainThread): 
2021-01-25 21:45:47.013244 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:45:47.016702 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 21:45:47.072702 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 21:45:47.073893 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 21:45:47.074243 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 21:45:47.074534 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:45:47.221328 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 21:45:47.374614 (ThreadPoolExecutor-0_0): SQL status: OK in 0.30 seconds
2021-01-25 21:45:47.400897 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 21:45:47.578117 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:45:47.593125 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:45:47.593447 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:45:47.593642 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 21:45:47.593793 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:45:47.761378 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:45:48.161298 (ThreadPoolExecutor-1_0): SQL status: OK in 0.57 seconds
2021-01-25 21:45:48.210012 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:45:48.227805 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:45:48.239046 (MainThread): 22:45:48 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 21:45:48.239434 (MainThread): 22:45:48 | 
2021-01-25 21:45:48.275088 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 21:45:48.277989 (Thread-1): 22:45:48 | 1 of 1 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 21:45:48.278787 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:45:48.279170 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 21:45:48.355274 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 21:45:48.361216 (Thread-1): finished collecting timing info
2021-01-25 21:45:48.454206 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 21:45:48.463110 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:45:48.463373 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    

select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0') as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 21:45:48.463519 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:45:48.463649 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:45:48.631751 (Thread-1): Connected to db: None
2021-01-25 21:45:48.793700 (Thread-1): SQL status: OK in 0.33 seconds
2021-01-25 21:45:48.802581 (Thread-1): finished collecting timing info
2021-01-25 21:45:48.818589 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 21:45:48.818914 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 21:45:48.820496 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'befd9ee7-6043-48b8-b9a6-0ba79e3df20f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7133c8e10>]}
2021-01-25 21:45:48.822912 (Thread-1): 22:45:48 | 1 of 1 OK created view model @fab4.stg__land_values.................. [OK in 0.54s]
2021-01-25 21:45:48.838599 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 21:45:48.885093 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:45:48.885477 (MainThread): On master: ROLLBACK
2021-01-25 21:45:48.885724 (MainThread): Opening a new connection, currently in state init
2021-01-25 21:45:48.885850 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:45:49.027000 (MainThread): Connected to db: None
2021-01-25 21:45:49.027432 (MainThread): On master: ROLLBACK
2021-01-25 21:45:49.027616 (MainThread): On master: Close
2021-01-25 21:45:49.028798 (MainThread): 22:45:49 | 
2021-01-25 21:45:49.029150 (MainThread): 22:45:49 | Finished running 1 view model in 2.02s.
2021-01-25 21:45:49.029348 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:45:49.029485 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-25 21:45:49.043308 (MainThread): 
2021-01-25 21:45:49.046820 (MainThread): Completed successfully
2021-01-25 21:45:49.047082 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 21:45:49.047421 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe713294f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7132338d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe713221908>]}
2021-01-25 21:45:49.047789 (MainThread): Flushing usage events
2021-01-25 21:51:32.764062 (MainThread): Running with dbt=0.18.1
2021-01-25 21:51:32.895036 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 21:51:32.896482 (MainThread): Tracking: tracking
2021-01-25 21:51:32.905086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad43df0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad43df0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad43df0f60>]}
2021-01-25 21:51:32.962360 (MainThread): Partial parsing not enabled
2021-01-25 21:51:32.963930 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:51:32.970173 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:51:32.974475 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:51:32.979544 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:51:33.004363 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:51:33.009026 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:51:33.054754 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:51:33.057168 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:51:33.063101 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:51:33.063605 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:51:33.069099 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:51:33.087908 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:51:33.105434 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:51:33.113884 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:51:33.129431 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:51:33.140467 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:51:33.168943 (MainThread): Parsing macros/core.sql
2021-01-25 21:51:33.176599 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:51:33.256740 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:51:33.274160 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:51:33.277769 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:51:33.280168 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:51:33.282285 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:51:33.286503 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:51:33.290018 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:51:33.307829 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:51:33.311682 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:51:33.323759 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:51:33.375199 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:51:33.407931 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:51:33.411621 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:51:33.421563 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:51:33.434044 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:51:33.460467 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:51:33.473269 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:51:33.512841 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:51:33.516982 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:51:33.520490 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:51:33.524100 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:51:33.539455 (MainThread): Partial parsing not enabled
2021-01-25 21:51:33.655401 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 21:51:33.700874 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:51:33.722985 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:51:35.238232 (MainThread): Found 3 models, 23 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:51:35.241435 (MainThread): 
2021-01-25 21:51:35.242209 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:51:35.330291 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:51:35.356387 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:51:35.356817 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:51:35.357216 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 21:51:35.357574 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:51:35.556040 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:51:35.926481 (ThreadPoolExecutor-1_0): SQL status: OK in 0.57 seconds
2021-01-25 21:51:36.047550 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:51:36.050565 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:51:36.061234 (MainThread): 22:51:36 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 21:51:36.061576 (MainThread): 22:51:36 | 
2021-01-25 21:51:36.130650 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 21:51:36.131083 (Thread-1): 22:51:36 | 1 of 5 START test not_null_stg__land_values_lots_count............... [RUN]
2021-01-25 21:51:36.131733 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 21:51:36.132066 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 21:51:36.277192 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 21:51:36.277861 (Thread-1): finished collecting timing info
2021-01-25 21:51:36.278516 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 21:51:36.278729 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where lots_count is null



2021-01-25 21:51:36.278864 (Thread-1): Opening a new connection, currently in state init
2021-01-25 21:51:36.278994 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:51:36.421406 (Thread-1): Connected to db: None
2021-01-25 21:51:40.236184 (Thread-1): SQL status: OK in 3.96 seconds
2021-01-25 21:51:40.266034 (Thread-1): finished collecting timing info
2021-01-25 21:51:40.266836 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: ROLLBACK
2021-01-25 21:51:40.267395 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: Close
2021-01-25 21:51:40.269181 (Thread-1): 22:51:40 | 1 of 5 PASS not_null_stg__land_values_lots_count..................... [PASS in 4.14s]
2021-01-25 21:51:40.274638 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 21:51:40.275269 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 21:51:40.276087 (Thread-1): 22:51:40 | 2 of 5 START test not_null_stg__land_values_municipality_code........ [RUN]
2021-01-25 21:51:40.279023 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 21:51:40.279539 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 21:51:40.327584 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 21:51:40.328590 (Thread-1): finished collecting timing info
2021-01-25 21:51:40.329511 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 21:51:40.329963 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where municipality_code is null



2021-01-25 21:51:40.330419 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:51:40.330845 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:51:40.465513 (Thread-1): Connected to db: None
2021-01-25 21:51:57.966653 (Thread-1): SQL status: OK in 17.64 seconds
2021-01-25 21:51:58.003685 (Thread-1): finished collecting timing info
2021-01-25 21:51:58.004401 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: ROLLBACK
2021-01-25 21:51:58.004681 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: Close
2021-01-25 21:51:58.006712 (Thread-1): 22:51:58 | 2 of 5 PASS not_null_stg__land_values_municipality_code.............. [PASS in 17.73s]
2021-01-25 21:51:58.007253 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 21:51:58.007686 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_amount
2021-01-25 21:51:58.008204 (Thread-1): 22:51:58 | 3 of 5 START test not_null_stg__land_values_transaction_amount....... [RUN]
2021-01-25 21:51:58.008895 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_amount".
2021-01-25 21:51:58.009262 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_amount
2021-01-25 21:51:58.064980 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_amount"
2021-01-25 21:51:58.065659 (Thread-1): finished collecting timing info
2021-01-25 21:51:58.066354 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transaction_amount".
2021-01-25 21:51:58.066607 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_amount: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transaction_amount is null



2021-01-25 21:51:58.066788 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:51:58.066960 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:51:58.235647 (Thread-1): Connected to db: None
2021-01-25 21:52:04.244475 (Thread-1): SQL status: OK in 6.18 seconds
2021-01-25 21:52:04.253875 (Thread-1): finished collecting timing info
2021-01-25 21:52:04.254639 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_amount: ROLLBACK
2021-01-25 21:52:04.255091 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_amount: Close
2021-01-25 21:52:04.256754 (Thread-1): 22:52:04 | 3 of 5 FAIL 195699 not_null_stg__land_values_transaction_amount...... [FAIL 195699 in 6.25s]
2021-01-25 21:52:04.257228 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_amount
2021-01-25 21:52:04.259604 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 21:52:04.260331 (Thread-1): 22:52:04 | 4 of 5 START test not_null_stg__land_values_transaction_date......... [RUN]
2021-01-25 21:52:04.261292 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 21:52:04.261759 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 21:52:04.290063 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 21:52:04.290999 (Thread-1): finished collecting timing info
2021-01-25 21:52:04.291851 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 21:52:04.292139 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transaction_date is null



2021-01-25 21:52:04.292262 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:52:04.292382 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:52:04.416112 (Thread-1): Connected to db: None
2021-01-25 21:52:22.783580 (Thread-1): SQL status: OK in 18.49 seconds
2021-01-25 21:52:22.804590 (Thread-1): finished collecting timing info
2021-01-25 21:52:22.805301 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: ROLLBACK
2021-01-25 21:52:22.805548 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: Close
2021-01-25 21:52:22.806796 (Thread-1): 22:52:22 | 4 of 5 PASS not_null_stg__land_values_transaction_date............... [PASS in 18.55s]
2021-01-25 21:52:22.810579 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 21:52:22.811007 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 21:52:22.811471 (Thread-1): 22:52:22 | 5 of 5 START test not_null_stg__land_values_transfer_label_fr........ [RUN]
2021-01-25 21:52:22.815556 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 21:52:22.815919 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 21:52:22.840904 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 21:52:22.841648 (Thread-1): finished collecting timing info
2021-01-25 21:52:22.842355 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 21:52:22.842610 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transfer_label_fr is null



2021-01-25 21:52:22.842812 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 21:52:22.842977 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:52:22.967622 (Thread-1): Connected to db: None
2021-01-25 21:52:24.460671 (Thread-1): SQL status: OK in 1.62 seconds
2021-01-25 21:52:24.474670 (Thread-1): finished collecting timing info
2021-01-25 21:52:24.475300 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: ROLLBACK
2021-01-25 21:52:24.475555 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: Close
2021-01-25 21:52:24.476848 (Thread-1): 22:52:24 | 5 of 5 PASS not_null_stg__land_values_transfer_label_fr.............. [PASS in 1.66s]
2021-01-25 21:52:24.477296 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 21:52:24.517570 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:52:24.518673 (MainThread): 22:52:24 | 
2021-01-25 21:52:24.519092 (MainThread): 22:52:24 | Finished running 5 tests in 49.28s.
2021-01-25 21:52:24.519534 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:52:24.519907 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 21:52:24.520205 (MainThread): Connection 'test.subsurface.not_null_stg__land_values_transfer_label_fr' was properly closed.
2021-01-25 21:52:24.552969 (MainThread): 
2021-01-25 21:52:24.553409 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 21:52:24.553796 (MainThread): 
2021-01-25 21:52:24.554148 (MainThread): Failure in test not_null_stg__land_values_transaction_amount (models/staging/schema.yml)
2021-01-25 21:52:24.565078 (MainThread):   Got 195699 results, expected 0.
2021-01-25 21:52:24.565608 (MainThread): 
2021-01-25 21:52:24.565945 (MainThread):   compiled SQL at target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_transaction_amount.sql
2021-01-25 21:52:24.566231 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-01-25 21:52:24.566750 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad4398de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad43a41390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad43a41be0>]}
2021-01-25 21:52:24.567286 (MainThread): Flushing usage events
2021-01-25 21:59:44.495132 (MainThread): Running with dbt=0.18.1
2021-01-25 21:59:44.669492 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=True, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 21:59:44.681004 (MainThread): Tracking: tracking
2021-01-25 21:59:44.690228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd32cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fce3fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fce3ff60>]}
2021-01-25 21:59:44.748371 (MainThread): Partial parsing not enabled
2021-01-25 21:59:44.749723 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:59:44.754823 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:59:44.758416 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 21:59:44.762505 (MainThread): Parsing macros/helpers.sql
2021-01-25 21:59:44.787174 (MainThread): Parsing macros/catalog.sql
2021-01-25 21:59:44.791676 (MainThread): Parsing macros/adapters.sql
2021-01-25 21:59:44.838055 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 21:59:44.840486 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 21:59:44.846232 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 21:59:44.846777 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 21:59:44.852200 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 21:59:44.870879 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:59:44.888349 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:59:44.897020 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 21:59:44.912034 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:59:44.922947 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:59:44.951168 (MainThread): Parsing macros/core.sql
2021-01-25 21:59:44.958717 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 21:59:45.038783 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 21:59:45.055502 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 21:59:45.059194 (MainThread): Parsing macros/etc/query.sql
2021-01-25 21:59:45.061546 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 21:59:45.063694 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 21:59:45.067914 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 21:59:45.071585 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 21:59:45.089029 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 21:59:45.093083 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 21:59:45.105250 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 21:59:45.157136 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 21:59:45.189210 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 21:59:45.193089 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 21:59:45.202945 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 21:59:45.215042 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 21:59:45.241099 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 21:59:45.253665 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 21:59:45.293926 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 21:59:45.297913 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 21:59:45.301285 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 21:59:45.304937 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 21:59:45.320060 (MainThread): Partial parsing not enabled
2021-01-25 21:59:45.434553 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 21:59:45.479310 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 21:59:45.501115 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 21:59:45.537242 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 21:59:46.974624 (MainThread): Found 3 models, 23 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 21:59:46.977665 (MainThread): 
2021-01-25 21:59:46.978407 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:59:47.064462 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 21:59:47.089426 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 21:59:47.089749 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 21:59:47.089913 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 21:59:47.090044 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:59:47.336972 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 21:59:47.732498 (ThreadPoolExecutor-1_0): SQL status: OK in 0.64 seconds
2021-01-25 21:59:47.820348 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 21:59:47.826876 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 21:59:47.832548 (MainThread): 22:59:47 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 21:59:47.832890 (MainThread): 22:59:47 | 
2021-01-25 21:59:47.862965 (Thread-1): Began running node test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 21:59:47.863377 (Thread-1): 22:59:47 | 1 of 1 START test stg__land_values_premises_or_crop_codes............ [RUN]
2021-01-25 21:59:47.864012 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 21:59:47.864316 (Thread-1): Compiling test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 21:59:47.994479 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_premises_or_crop_codes"
2021-01-25 21:59:48.005938 (Thread-1): finished collecting timing info
2021-01-25 21:59:48.006622 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 21:59:48.006802 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  premises_code is null
  and crop_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 21:59:48.006932 (Thread-1): Opening a new connection, currently in state init
2021-01-25 21:59:48.007048 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 21:59:48.164935 (Thread-1): Connected to db: None
2021-01-25 21:59:53.279670 (Thread-1): SQL status: OK in 5.27 seconds
2021-01-25 21:59:53.310261 (Thread-1): finished collecting timing info
2021-01-25 21:59:53.310902 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: ROLLBACK
2021-01-25 21:59:53.311101 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: Close
2021-01-25 21:59:53.312313 (Thread-1): 22:59:53 | 1 of 1 FAIL 712146 stg__land_values_premises_or_crop_codes........... [FAIL 712146 in 5.45s]
2021-01-25 21:59:53.312669 (Thread-1): Finished running node test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 21:59:53.399589 (MainThread): Acquiring new dremio connection "master".
2021-01-25 21:59:53.400484 (MainThread): 22:59:53 | 
2021-01-25 21:59:53.400801 (MainThread): 22:59:53 | Finished running 1 test in 6.42s.
2021-01-25 21:59:53.401047 (MainThread): Connection 'master' was properly closed.
2021-01-25 21:59:53.401306 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 21:59:53.401437 (MainThread): Connection 'test.subsurface.stg__land_values_premises_or_crop_codes' was properly closed.
2021-01-25 21:59:53.409450 (MainThread): 
2021-01-25 21:59:53.410040 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 21:59:53.410547 (MainThread): 
2021-01-25 21:59:53.411028 (MainThread): Failure in test stg__land_values_premises_or_crop_codes (tests/stg__land_values_premises_or_crop_codes.sql)
2021-01-25 21:59:53.411547 (MainThread):   Got 712146 results, expected 0.
2021-01-25 21:59:53.411981 (MainThread): 
2021-01-25 21:59:53.412281 (MainThread):   compiled SQL at target/compiled/subsurface/tests/stg__land_values_premises_or_crop_codes.sql
2021-01-25 21:59:53.412505 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 21:59:53.413054 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fca29f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fc9d65f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fc9d6358>]}
2021-01-25 21:59:53.413529 (MainThread): Flushing usage events
2021-01-25 22:00:45.469765 (MainThread): Running with dbt=0.18.1
2021-01-25 22:00:45.603550 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=True, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 22:00:45.611216 (MainThread): Tracking: tracking
2021-01-25 22:00:45.622734 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee7d30400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee5607f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee5607fd0>]}
2021-01-25 22:00:45.680759 (MainThread): Partial parsing not enabled
2021-01-25 22:00:45.682460 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:00:45.687806 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:00:45.691271 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:00:45.695580 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:00:45.720605 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:00:45.725068 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:00:45.771490 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:00:45.773917 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:00:45.779803 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:00:45.780311 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:00:45.785670 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:00:45.803937 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:00:45.821379 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:00:45.829852 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:00:45.844619 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:00:45.856125 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:00:45.884665 (MainThread): Parsing macros/core.sql
2021-01-25 22:00:45.892164 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:00:45.972229 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:00:45.989436 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:00:45.993181 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:00:45.995601 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:00:45.997765 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:00:46.001963 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:00:46.005534 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:00:46.023948 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:00:46.027774 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:00:46.039960 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:00:46.092384 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:00:46.124414 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:00:46.128099 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:00:46.137901 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:00:46.149828 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:00:46.176201 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:00:46.189480 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:00:46.229085 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:00:46.233183 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:00:46.236488 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:00:46.240146 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:00:46.255142 (MainThread): Partial parsing not enabled
2021-01-25 22:00:46.371129 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:00:46.417174 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:00:46.439184 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:00:46.474801 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:00:47.834782 (MainThread): Found 3 models, 23 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:00:47.837845 (MainThread): 
2021-01-25 22:00:47.838602 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:00:47.955438 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:00:47.978737 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:00:47.979121 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:00:47.979326 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 22:00:47.979474 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:00:48.174076 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:00:48.497068 (ThreadPoolExecutor-1_0): SQL status: OK in 0.52 seconds
2021-01-25 22:00:48.558228 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:00:48.562218 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:00:48.568506 (MainThread): 23:00:48 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:00:48.568843 (MainThread): 23:00:48 | 
2021-01-25 22:00:48.586072 (Thread-1): Began running node test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:00:48.586548 (Thread-1): 23:00:48 | 1 of 1 START test stg__land_values_premises_or_crop_codes............ [RUN]
2021-01-25 22:00:48.587293 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:00:48.587639 (Thread-1): Compiling test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:00:48.642397 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_premises_or_crop_codes"
2021-01-25 22:00:48.643187 (Thread-1): finished collecting timing info
2021-01-25 22:00:48.643974 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:00:48.644184 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  built_surface is null
  and land_surface is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 22:00:48.644341 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:00:48.644470 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:00:48.765759 (Thread-1): Connected to db: None
2021-01-25 22:00:54.659327 (Thread-1): SQL status: OK in 6.01 seconds
2021-01-25 22:00:54.671032 (Thread-1): finished collecting timing info
2021-01-25 22:00:54.671831 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: ROLLBACK
2021-01-25 22:00:54.672209 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: Close
2021-01-25 22:00:54.673890 (Thread-1): 23:00:54 | 1 of 1 FAIL 712907 stg__land_values_premises_or_crop_codes........... [FAIL 712907 in 6.09s]
2021-01-25 22:00:54.674418 (Thread-1): Finished running node test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:00:54.703365 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:00:54.704333 (MainThread): 23:00:54 | 
2021-01-25 22:00:54.704747 (MainThread): 23:00:54 | Finished running 1 test in 6.87s.
2021-01-25 22:00:54.705142 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:00:54.705441 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:00:54.705712 (MainThread): Connection 'test.subsurface.stg__land_values_premises_or_crop_codes' was properly closed.
2021-01-25 22:00:54.714761 (MainThread): 
2021-01-25 22:00:54.715349 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 22:00:54.715822 (MainThread): 
2021-01-25 22:00:54.716303 (MainThread): Failure in test stg__land_values_premises_or_crop_codes (tests/stg__land_values_premises_or_crop_codes.sql)
2021-01-25 22:00:54.716865 (MainThread):   Got 712907 results, expected 0.
2021-01-25 22:00:54.717381 (MainThread): 
2021-01-25 22:00:54.717832 (MainThread):   compiled SQL at target/compiled/subsurface/tests/stg__land_values_premises_or_crop_codes.sql
2021-01-25 22:00:54.718283 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 22:00:54.718959 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee5393a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee53932e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee5393a58>]}
2021-01-25 22:00:54.719596 (MainThread): Flushing usage events
2021-01-25 22:06:59.427387 (MainThread): Running with dbt=0.18.1
2021-01-25 22:06:59.552530 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=True, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 22:06:59.553953 (MainThread): Tracking: tracking
2021-01-25 22:06:59.572486 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c663655f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c65e87f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c65e87f60>]}
2021-01-25 22:06:59.629632 (MainThread): Partial parsing not enabled
2021-01-25 22:06:59.631008 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:06:59.636053 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:06:59.639471 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:06:59.643567 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:06:59.668285 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:06:59.672955 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:06:59.718467 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:06:59.720900 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:06:59.726686 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:06:59.727177 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:06:59.732608 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:06:59.750923 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:06:59.768103 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:06:59.776608 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:06:59.791481 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:06:59.802837 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:06:59.830505 (MainThread): Parsing macros/core.sql
2021-01-25 22:06:59.837814 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:06:59.916581 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:06:59.933401 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:06:59.936957 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:06:59.939416 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:06:59.941508 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:06:59.945567 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:06:59.949056 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:06:59.966909 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:06:59.970846 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:06:59.983034 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:07:00.034289 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:07:00.066601 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:07:00.070247 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:07:00.080006 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:07:00.094142 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:07:00.121979 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:07:00.134739 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:07:00.173852 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:07:00.177813 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:07:00.181079 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:07:00.184719 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:07:00.199911 (MainThread): Partial parsing not enabled
2021-01-25 22:07:00.315968 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:07:00.360518 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:07:00.382392 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:07:00.418193 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:07:01.875032 (MainThread): Found 3 models, 23 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:07:01.878100 (MainThread): 
2021-01-25 22:07:01.878827 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:07:01.962941 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:07:01.987880 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:07:01.988173 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:07:01.988348 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 22:07:01.988487 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:07:02.238598 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:07:02.526628 (ThreadPoolExecutor-1_0): SQL status: OK in 0.54 seconds
2021-01-25 22:07:02.668447 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:07:02.668814 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:07:02.671375 (MainThread): 23:07:02 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:07:02.671716 (MainThread): 23:07:02 | 
2021-01-25 22:07:02.718607 (Thread-1): Began running node test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:07:02.719045 (Thread-1): 23:07:02 | 1 of 1 START test stg__land_values_premises_or_crop_codes............ [RUN]
2021-01-25 22:07:02.719767 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:07:02.720265 (Thread-1): Compiling test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:07:02.895383 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_premises_or_crop_codes"
2021-01-25 22:07:02.903078 (Thread-1): finished collecting timing info
2021-01-25 22:07:02.903935 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:07:02.904245 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  land_surface is not null
  and corp_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 22:07:02.904490 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:07:02.904684 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:07:03.039872 (Thread-1): Connected to db: None
2021-01-25 22:07:03.107488 (Thread-1): Error running SQL: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  land_surface is not null
  and corp_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 22:07:03.107758 (Thread-1): Rolling back transaction.
2021-01-25 22:07:03.107907 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: ROLLBACK
2021-01-25 22:07:03.108052 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: Close
2021-01-25 22:07:03.110000 (Thread-1): finished collecting timing info
2021-01-25 22:07:03.111392 (Thread-1): Runtime Error in test stg__land_values_premises_or_crop_codes (tests/stg__land_values_premises_or_crop_codes.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  "@fab4"."stg__land_values"\nwhere\n  land_surface is not null\n  and corp_code is null\n)select count(*) from dbt__CTE__INTERNAL_test\n[30038]Query execution error. Details:[ \nVALIDATION ERROR: Column \'corp_code\' not found in any table\n\nSQL Query \nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  "@fab4"."stg__land_value...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  "@fab4"."stg__land_values"\nwhere\n  land_surface is not null\n  and corp_code is null\n)select count(*) from dbt__CTE__INTERNAL_test\n[30038]Query execution error. Details:[ \nVALIDATION ERROR: Column \'corp_code\' not found in any table\n\nSQL Query \nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  "@fab4"."stg__land_value...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 82, in execute
    failed_rows = self.execute_data_test(test)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/test.py", line 45, in execute_data_test
    test.injected_sql, auto_begin=True, fetch=True
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in test stg__land_values_premises_or_crop_codes (tests/stg__land_values_premises_or_crop_codes.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  "@fab4"."stg__land_values"\nwhere\n  land_surface is not null\n  and corp_code is null\n)select count(*) from dbt__CTE__INTERNAL_test\n[30038]Query execution error. Details:[ \nVALIDATION ERROR: Column \'corp_code\' not found in any table\n\nSQL Query \nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  "@fab4"."stg__land_value...[see log] (1040) (SQLExecDirectW)')
2021-01-25 22:07:03.142013 (Thread-1): 23:07:03 | 1 of 1 ERROR stg__land_values_premises_or_crop_codes................. [ERROR in 0.42s]
2021-01-25 22:07:03.142990 (Thread-1): Finished running node test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:07:03.212647 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:07:03.213296 (MainThread): 23:07:03 | 
2021-01-25 22:07:03.214165 (MainThread): 23:07:03 | Finished running 1 test in 1.33s.
2021-01-25 22:07:03.215628 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:07:03.216098 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:07:03.216408 (MainThread): Connection 'test.subsurface.stg__land_values_premises_or_crop_codes' was properly closed.
2021-01-25 22:07:03.229032 (MainThread): 
2021-01-25 22:07:03.232078 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 22:07:03.234542 (MainThread): 
2021-01-25 22:07:03.234885 (MainThread): Runtime Error in test stg__land_values_premises_or_crop_codes (tests/stg__land_values_premises_or_crop_codes.sql)
2021-01-25 22:07:03.235086 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  "@fab4"."stg__land_values"\nwhere\n  land_surface is not null\n  and corp_code is null\n)select count(*) from dbt__CTE__INTERNAL_test\n[30038]Query execution error. Details:[ \nVALIDATION ERROR: Column \'corp_code\' not found in any table\n\nSQL Query \nwith dbt__CTE__INTERNAL_test as (\nselect\n  *\nfrom\n  "@fab4"."stg__land_value...[see log] (1040) (SQLExecDirectW)')
2021-01-25 22:07:03.235279 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 22:07:03.235601 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c65c1ada0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c65c1a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c65c1a048>]}
2021-01-25 22:07:03.235980 (MainThread): Flushing usage events
2021-01-25 22:07:44.137677 (MainThread): Running with dbt=0.18.1
2021-01-25 22:07:44.295200 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=True, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 22:07:44.296721 (MainThread): Tracking: tracking
2021-01-25 22:07:44.306377 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d57a24fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d57537f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d57537fd0>]}
2021-01-25 22:07:44.363359 (MainThread): Partial parsing not enabled
2021-01-25 22:07:44.364932 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:07:44.370997 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:07:44.374386 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:07:44.378512 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:07:44.403685 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:07:44.408273 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:07:44.453271 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:07:44.455691 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:07:44.461513 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:07:44.462016 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:07:44.467417 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:07:44.485787 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:07:44.503506 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:07:44.511989 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:07:44.526947 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:07:44.537562 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:07:44.565409 (MainThread): Parsing macros/core.sql
2021-01-25 22:07:44.572647 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:07:44.651406 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:07:44.667998 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:07:44.671493 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:07:44.673786 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:07:44.675884 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:07:44.680081 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:07:44.683678 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:07:44.701858 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:07:44.705784 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:07:44.717827 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:07:44.769047 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:07:44.801020 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:07:44.804835 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:07:44.814589 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:07:44.826911 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:07:44.852412 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:07:44.865292 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:07:44.904973 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:07:44.908991 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:07:44.912314 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:07:44.915946 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:07:44.930981 (MainThread): Partial parsing not enabled
2021-01-25 22:07:45.046308 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:07:45.090865 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:07:45.113505 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:07:45.149138 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:07:46.435387 (MainThread): Found 3 models, 23 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:07:46.438383 (MainThread): 
2021-01-25 22:07:46.439260 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:07:46.521855 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:07:46.545587 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:07:46.545874 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:07:46.546045 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 22:07:46.546181 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:07:46.783435 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:07:47.167808 (ThreadPoolExecutor-1_0): SQL status: OK in 0.62 seconds
2021-01-25 22:07:47.218975 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:07:47.219576 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:07:47.222730 (MainThread): 23:07:47 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:07:47.223103 (MainThread): 23:07:47 | 
2021-01-25 22:07:47.254586 (Thread-1): Began running node test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:07:47.255031 (Thread-1): 23:07:47 | 1 of 1 START test stg__land_values_premises_or_crop_codes............ [RUN]
2021-01-25 22:07:47.255659 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:07:47.255958 (Thread-1): Compiling test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:07:47.383870 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_premises_or_crop_codes"
2021-01-25 22:07:47.384762 (Thread-1): finished collecting timing info
2021-01-25 22:07:47.385679 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_premises_or_crop_codes".
2021-01-25 22:07:47.386054 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  land_surface is not null
  and crop_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 22:07:47.386386 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:07:47.386680 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:07:47.505799 (Thread-1): Connected to db: None
2021-01-25 22:07:50.367750 (Thread-1): SQL status: OK in 2.98 seconds
2021-01-25 22:07:50.402998 (Thread-1): finished collecting timing info
2021-01-25 22:07:50.403775 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: ROLLBACK
2021-01-25 22:07:50.404153 (Thread-1): On test.subsurface.stg__land_values_premises_or_crop_codes: Close
2021-01-25 22:07:50.405780 (Thread-1): 23:07:50 | 1 of 1 PASS stg__land_values_premises_or_crop_codes.................. [PASS in 3.15s]
2021-01-25 22:07:50.406221 (Thread-1): Finished running node test.subsurface.stg__land_values_premises_or_crop_codes
2021-01-25 22:07:50.455259 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:07:50.456199 (MainThread): 23:07:50 | 
2021-01-25 22:07:50.456669 (MainThread): 23:07:50 | Finished running 1 test in 4.02s.
2021-01-25 22:07:50.457085 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:07:50.457399 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:07:50.457703 (MainThread): Connection 'test.subsurface.stg__land_values_premises_or_crop_codes' was properly closed.
2021-01-25 22:07:50.483869 (MainThread): 
2021-01-25 22:07:50.484348 (MainThread): Completed successfully
2021-01-25 22:07:50.484789 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 22:07:50.485404 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d572f46d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d571225c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5717dfd0>]}
2021-01-25 22:07:50.486035 (MainThread): Flushing usage events
2021-01-25 22:09:52.902186 (MainThread): Running with dbt=0.18.1
2021-01-25 22:09:53.023970 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=True, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 22:09:53.025518 (MainThread): Tracking: tracking
2021-01-25 22:09:53.034654 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7871d5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7823ff28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7823ff98>]}
2021-01-25 22:09:53.093356 (MainThread): Partial parsing not enabled
2021-01-25 22:09:53.095032 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:09:53.100317 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:09:53.103893 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:09:53.107947 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:09:53.132758 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:09:53.137274 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:09:53.184308 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:09:53.186786 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:09:53.192955 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:09:53.193477 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:09:53.198816 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:09:53.217539 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:09:53.234765 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:09:53.243135 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:09:53.258025 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:09:53.268823 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:09:53.297318 (MainThread): Parsing macros/core.sql
2021-01-25 22:09:53.304780 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:09:53.384140 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:09:53.401495 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:09:53.405208 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:09:53.407591 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:09:53.409674 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:09:53.414057 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:09:53.417538 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:09:53.435240 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:09:53.439084 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:09:53.451097 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:09:53.502547 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:09:53.534469 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:09:53.538047 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:09:53.547837 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:09:53.559718 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:09:53.586237 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:09:53.599424 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:09:53.638433 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:09:53.642282 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:09:53.645517 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:09:53.649091 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:09:53.663910 (MainThread): Partial parsing not enabled
2021-01-25 22:09:53.779312 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:09:53.824489 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:09:53.846501 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:09:53.882423 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:09:53.903710 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:09:54.067119 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a780284e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a78034ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a78034fd0>]}
2021-01-25 22:09:54.067600 (MainThread): Flushing usage events
2021-01-25 22:09:54.619334 (MainThread): Connection 'test.subsurface.stg__land_values_built_surface_implies_premises_code' was properly closed.
2021-01-25 22:09:54.620341 (MainThread): Encountered an error:
2021-01-25 22:09:54.620634 (MainThread): Compilation Error
  Invalid models config given in models/staging/schema.yml @ models: {'name': 'stg__land_values', 'description': 'land value at transaction time', 'tests': [None], 'columns': [{'name': 'transaction_date', 'tests': ['not_null']}, {'name': 'transaction_amount'}, {'name': 'transfer_label_fr', 'tests': ['not_null']}, {'name': 'lane_type'}, {'name': 'lane_code'}, {'name': 'lane'}, {'name': 'zip_code'}, {'name': 'municipality_code', 'tests': ['not_null']}, {'name': 'lots_count', 'tests': ['not_null']}, {'name': 'premises_code'}, {'name': 'built_surface'}, {'name': 'land_surface'}, {'name': 'main_rooms_count'}, {'name': 'crop_code'}], 'original_file_path': 'models/staging/schema.yml', 'yaml_key': 'models', 'package_name': 'subsurface'} - at path []: None is not of type 'object'
2021-01-25 22:09:54.647928 (MainThread): jsonschema.exceptions.ValidationError: None is not of type 'object'

Failed validating 'type' in schema[0]:
    {'type': 'object'}

On instance:
    None

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 719, in get_unparsed_target
    model = self._target_type().from_dict(data)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/contracts/util.py", line 64, in from_dict
    self = super().from_dict(data=data, validate=validate)
  File "/home/fabrice/.local/lib/python3.7/site-packages/hologram/__init__.py", line 618, in from_dict
    cls.validate(data)
  File "/home/fabrice/.local/lib/python3.7/site-packages/hologram/__init__.py", line 961, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: None is not of type 'object'

Failed validating 'type' in schema[0]:
    {'type': 'object'}

On instance:
    None

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 557, in parse_file
    for test_block in parser.parse():
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 698, in parse
    for node in self.get_unparsed_target():
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 722, in get_unparsed_target
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid models config given in models/staging/schema.yml @ models: {'name': 'stg__land_values', 'description': 'land value at transaction time', 'tests': [None], 'columns': [{'name': 'transaction_date', 'tests': ['not_null']}, {'name': 'transaction_amount'}, {'name': 'transfer_label_fr', 'tests': ['not_null']}, {'name': 'lane_type'}, {'name': 'lane_code'}, {'name': 'lane'}, {'name': 'zip_code'}, {'name': 'municipality_code', 'tests': ['not_null']}, {'name': 'lots_count', 'tests': ['not_null']}, {'name': 'premises_code'}, {'name': 'built_surface'}, {'name': 'land_surface'}, {'name': 'main_rooms_count'}, {'name': 'crop_code'}], 'original_file_path': 'models/staging/schema.yml', 'yaml_key': 'models', 'package_name': 'subsurface'} - at path []: None is not of type 'object'

2021-01-25 22:10:51.081892 (MainThread): Running with dbt=0.18.1
2021-01-25 22:10:51.207380 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=True, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 22:10:51.208929 (MainThread): Tracking: tracking
2021-01-25 22:10:51.217983 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cde091be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cde091e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cde091ef0>]}
2021-01-25 22:10:51.276628 (MainThread): Partial parsing not enabled
2021-01-25 22:10:51.278241 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:10:51.283619 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:10:51.287149 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:10:51.291443 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:10:51.316327 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:10:51.320911 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:10:51.367482 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:10:51.369918 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:10:51.375911 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:10:51.376445 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:10:51.381872 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:10:51.401187 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:10:51.418618 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:10:51.427226 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:10:51.442118 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:10:51.453245 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:10:51.481577 (MainThread): Parsing macros/core.sql
2021-01-25 22:10:51.489295 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:10:51.570183 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:10:51.587555 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:10:51.591170 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:10:51.593636 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:10:51.595847 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:10:51.600081 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:10:51.603618 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:10:51.621588 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:10:51.625411 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:10:51.637538 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:10:51.690557 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:10:51.722901 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:10:51.726627 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:10:51.736526 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:10:51.748677 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:10:51.775190 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:10:51.788260 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:10:51.827872 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:10:51.831951 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:10:51.835285 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:10:51.838982 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:10:51.854214 (MainThread): Partial parsing not enabled
2021-01-25 22:10:51.972648 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:10:52.018908 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:10:52.041115 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:10:52.077294 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:10:52.098772 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:10:53.553283 (MainThread): Found 3 models, 24 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:10:53.556820 (MainThread): 
2021-01-25 22:10:53.557777 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:10:53.644680 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:10:53.668913 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:10:53.669206 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:10:53.669362 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 22:10:53.669493 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:10:53.841897 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:10:54.251464 (ThreadPoolExecutor-1_0): SQL status: OK in 0.58 seconds
2021-01-25 22:10:54.313418 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:10:54.338465 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:10:54.356318 (MainThread): 23:10:54 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:10:54.356742 (MainThread): 23:10:54 | 
2021-01-25 22:10:54.384328 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 22:10:54.384671 (Thread-1): 23:10:54 | 1 of 2 START test stg__land_values_built_surface_implies_premises_code [RUN]
2021-01-25 22:10:54.385252 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:10:54.385541 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 22:10:54.480414 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 22:10:54.483648 (Thread-1): finished collecting timing info
2021-01-25 22:10:54.487679 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:10:54.487995 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  built_surface is not null
  and premises_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 22:10:54.488169 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 22:10:54.488327 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:10:54.653407 (Thread-1): Connected to db: None
2021-01-25 22:10:57.236328 (Thread-1): SQL status: OK in 2.75 seconds
2021-01-25 22:10:57.262272 (Thread-1): finished collecting timing info
2021-01-25 22:10:57.263109 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: ROLLBACK
2021-01-25 22:10:57.263515 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: Close
2021-01-25 22:10:57.265169 (Thread-1): 23:10:57 | 1 of 2 PASS stg__land_values_built_surface_implies_premises_code..... [PASS in 2.88s]
2021-01-25 22:10:57.266801 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 22:10:57.267395 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 22:10:57.268102 (Thread-1): 23:10:57 | 2 of 2 START test stg__land_values_land_surface_implies_crop_code.... [RUN]
2021-01-25 22:10:57.269015 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:10:57.269503 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 22:10:57.299063 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 22:10:57.300003 (Thread-1): finished collecting timing info
2021-01-25 22:10:57.300880 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:10:57.301278 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  land_surface is not null
  and crop_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 22:10:57.301700 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 22:10:57.302081 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:10:57.430690 (Thread-1): Connected to db: None
2021-01-25 22:11:00.738457 (Thread-1): SQL status: OK in 3.44 seconds
2021-01-25 22:11:00.755583 (Thread-1): finished collecting timing info
2021-01-25 22:11:00.756457 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: ROLLBACK
2021-01-25 22:11:00.756845 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: Close
2021-01-25 22:11:00.758821 (Thread-1): 23:11:00 | 2 of 2 PASS stg__land_values_land_surface_implies_crop_code.......... [PASS in 3.49s]
2021-01-25 22:11:00.760794 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 22:11:00.800018 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:11:00.800979 (MainThread): 23:11:00 | 
2021-01-25 22:11:00.801509 (MainThread): 23:11:00 | Finished running 2 tests in 7.24s.
2021-01-25 22:11:00.802003 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:11:00.802448 (MainThread): Connection 'test.subsurface.stg__land_values_land_surface_implies_crop_code' was properly closed.
2021-01-25 22:11:00.821483 (MainThread): 
2021-01-25 22:11:00.822176 (MainThread): Completed successfully
2021-01-25 22:11:00.822737 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-25 22:11:00.823442 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cde0010f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cdde2c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cdde2cb00>]}
2021-01-25 22:11:00.824135 (MainThread): Flushing usage events
2021-01-25 22:22:32.289244 (MainThread): Running with dbt=0.18.1
2021-01-25 22:22:32.408700 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-01-25 22:22:32.410293 (MainThread): Tracking: tracking
2021-01-25 22:22:32.419498 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af8e2ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af8e2da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af8e2e10>]}
2021-01-25 22:22:32.477740 (MainThread): Partial parsing not enabled
2021-01-25 22:22:32.479336 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:22:32.484926 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:22:32.488361 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:22:32.492640 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:22:32.517824 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:22:32.522495 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:22:32.568893 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:22:32.571332 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:22:32.577039 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:22:32.577525 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:22:32.582997 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:22:32.601672 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:22:32.619380 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:22:32.627969 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:22:32.642810 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:22:32.654090 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:22:32.682226 (MainThread): Parsing macros/core.sql
2021-01-25 22:22:32.689669 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:22:32.769721 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:22:32.786359 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:22:32.789863 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:22:32.792237 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:22:32.794444 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:22:32.798602 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:22:32.802031 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:22:32.819728 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:22:32.823673 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:22:32.836485 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:22:32.888381 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:22:32.920756 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:22:32.924429 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:22:32.934258 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:22:32.946269 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:22:32.972644 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:22:32.985446 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:22:33.025473 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:22:33.029408 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:22:33.032684 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:22:33.036353 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:22:33.051533 (MainThread): Partial parsing not enabled
2021-01-25 22:22:33.167521 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:22:33.212802 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:22:33.234828 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:22:33.270219 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:22:33.291369 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:22:34.770433 (MainThread): Found 3 models, 24 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:22:34.774182 (MainThread): 
2021-01-25 22:22:34.774929 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:22:34.864697 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:22:34.888923 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:22:34.889242 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:22:34.889425 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:22:34.889565 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:22:35.053984 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:22:35.401444 (ThreadPoolExecutor-0_0): SQL status: OK in 0.51 seconds
2021-01-25 22:22:35.471521 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:22:35.478602 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-25 22:22:35.480959 (MainThread): 23:22:35 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:22:35.481491 (MainThread): 23:22:35 | 
2021-01-25 22:22:35.566712 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 22:22:35.567499 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:22:35.568098 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 22:22:35.772843 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 22:22:35.800596 (Thread-1): finished collecting timing info
2021-01-25 22:22:35.801371 (Thread-1): finished collecting timing info
2021-01-25 22:22:35.802545 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 22:22:35.806608 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 22:22:35.811318 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:22:35.811712 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 22:22:35.953940 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 22:22:35.955165 (Thread-1): finished collecting timing info
2021-01-25 22:22:35.955802 (Thread-1): finished collecting timing info
2021-01-25 22:22:35.956660 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 22:22:35.956983 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 22:22:35.958879 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:22:35.959207 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 22:22:36.025350 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 22:22:36.028121 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.029216 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.030587 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 22:22:36.032552 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-25 22:22:36.034797 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-25 22:22:36.035318 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-25 22:22:36.063058 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.063942 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.065229 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-25 22:22:36.065838 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-25 22:22:36.067140 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-25 22:22:36.067643 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-25 22:22:36.083569 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.084489 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.085636 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-25 22:22:36.086197 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-25 22:22:36.087472 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-25 22:22:36.087985 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-25 22:22:36.104031 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.104881 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.106013 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-25 22:22:36.106592 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 22:22:36.107824 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 22:22:36.108335 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 22:22:36.142737 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 22:22:36.152439 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.153301 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.154454 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 22:22:36.155019 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 22:22:36.155961 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 22:22:36.156456 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 22:22:36.176315 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 22:22:36.177247 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.178184 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.179334 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 22:22:36.179901 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 22:22:36.180842 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 22:22:36.181337 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 22:22:36.203055 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 22:22:36.203969 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.204836 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.205968 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 22:22:36.206581 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 22:22:36.207576 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 22:22:36.208094 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 22:22:36.228306 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 22:22:36.229244 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.230127 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.231330 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 22:22:36.231932 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 22:22:36.232884 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:22:36.233385 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 22:22:36.263981 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 22:22:36.264906 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.265941 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.267101 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 22:22:36.267664 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 22:22:36.268630 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:22:36.269136 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 22:22:36.288656 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 22:22:36.289622 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.290572 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.291681 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 22:22:36.292237 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 22:22:36.293117 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 22:22:36.293625 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 22:22:36.313990 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-25 22:22:36.314969 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.315873 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.317019 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 22:22:36.317582 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 22:22:36.318568 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 22:22:36.319142 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 22:22:36.338880 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-25 22:22:36.339815 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.340702 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.341884 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 22:22:36.342488 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 22:22:36.343549 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 22:22:36.344059 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 22:22:36.363988 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-25 22:22:36.364918 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.365801 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.366952 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 22:22:36.367520 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 22:22:36.368450 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 22:22:36.368947 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 22:22:36.388786 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-25 22:22:36.389764 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.390655 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.391778 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 22:22:36.392314 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 22:22:36.393203 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 22:22:36.393717 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 22:22:36.413845 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-25 22:22:36.414832 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.415800 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.416926 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 22:22:36.417466 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 22:22:36.418410 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 22:22:36.418907 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 22:22:36.438957 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-25 22:22:36.439894 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.440774 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.441912 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 22:22:36.442504 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 22:22:36.443552 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 22:22:36.444084 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 22:22:36.463723 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-25 22:22:36.464682 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.465708 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.466916 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 22:22:36.467495 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 22:22:36.468421 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 22:22:36.468921 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 22:22:36.488927 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 22:22:36.490550 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.491430 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.492545 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 22:22:36.493096 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 22:22:36.494212 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 22:22:36.494765 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 22:22:36.515252 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 22:22:36.516183 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.517121 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.518238 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 22:22:36.518822 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 22:22:36.519751 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 22:22:36.520257 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 22:22:36.540448 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 22:22:36.541379 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.542260 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.543496 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 22:22:36.544107 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 22:22:36.545071 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 22:22:36.545572 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-25 22:22:36.567593 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-25 22:22:36.568528 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.569399 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.570572 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 22:22:36.571127 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 22:22:36.572119 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 22:22:36.572650 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 22:22:36.592956 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-25 22:22:36.605517 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.606165 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.607059 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 22:22:36.607608 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 22:22:36.608545 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 22:22:36.609039 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 22:22:36.629382 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-25 22:22:36.630338 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.631282 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.632425 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 22:22:36.633015 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-25 22:22:36.633933 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 22:22:36.634457 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-25 22:22:36.654456 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-25 22:22:36.655395 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.656261 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.657390 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-25 22:22:36.657952 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 22:22:36.658921 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 22:22:36.659429 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 22:22:36.679187 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-25 22:22:36.680126 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.681006 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.682180 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 22:22:36.682763 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 22:22:36.683695 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 22:22:36.684196 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 22:22:36.705069 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-25 22:22:36.706004 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.706952 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.708092 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 22:22:36.708662 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 22:22:36.709615 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 22:22:36.710117 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 22:22:36.730239 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-25 22:22:36.731219 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.732134 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.733280 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 22:22:36.733847 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 22:22:36.734813 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 22:22:36.735341 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 22:22:36.755130 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-25 22:22:36.756080 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.757013 (Thread-1): finished collecting timing info
2021-01-25 22:22:36.758140 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 22:22:36.799059 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:22:36.799330 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:22:36.799442 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_fr' was properly closed.
2021-01-25 22:22:36.972726 (MainThread): 23:22:36 | Done.
2021-01-25 22:22:37.033820 (MainThread): Acquiring new dremio connection "generate_catalog".
2021-01-25 22:22:37.034401 (MainThread): 23:22:37 | Building catalog
2021-01-25 22:22:37.346430 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "@fab4.information_schema".
2021-01-25 22:22:37.364112 (ThreadPoolExecutor-1_0): Using dremio connection "@fab4.information_schema".
2021-01-25 22:22:37.364499 (ThreadPoolExecutor-1_0): On @fab4.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('@fab4')
    and (table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-25 22:22:37.364822 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 22:22:37.365119 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:22:37.495525 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:22:38.666124 (ThreadPoolExecutor-1_0): SQL status: OK in 1.30 seconds
2021-01-25 22:22:38.691711 (ThreadPoolExecutor-1_0): On @fab4.information_schema: ROLLBACK
2021-01-25 22:22:38.694543 (ThreadPoolExecutor-1_0): On @fab4.information_schema: Close
2021-01-25 22:22:38.696319 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "fs.information_schema".
2021-01-25 22:22:38.710236 (ThreadPoolExecutor-1_0): Using dremio connection "fs.information_schema".
2021-01-25 22:22:38.710636 (ThreadPoolExecutor-1_0): On fs.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('fs')
    and (table_schema = lower('geo') or table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-25 22:22:38.710972 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:22:38.711233 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:22:38.958840 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:22:43.100417 (ThreadPoolExecutor-1_0): SQL status: OK in 4.39 seconds
2021-01-25 22:22:43.162242 (ThreadPoolExecutor-1_0): On fs.information_schema: ROLLBACK
2021-01-25 22:22:43.170828 (ThreadPoolExecutor-1_0): On fs.information_schema: Close
2021-01-25 22:22:43.735140 (MainThread): 23:22:43 | Catalog written to /home/fabrice/subsurface/target/catalog.json
2021-01-25 22:22:43.736124 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af50a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af50abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af50aeb8>]}
2021-01-25 22:22:43.736825 (MainThread): Flushing usage events
2021-01-25 22:22:44.225650 (MainThread): Connection 'generate_catalog' was properly closed.
2021-01-25 22:22:44.227123 (MainThread): Connection 'fs.information_schema' was properly closed.
2021-01-25 22:23:23.839428 (MainThread): Running with dbt=0.18.1
2021-01-25 22:23:23.955764 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-01-25 22:23:23.957455 (MainThread): Tracking: tracking
2021-01-25 22:23:23.966552 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2bb25cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2b648e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2b648eb8>]}
2021-01-25 22:23:23.971959 (MainThread): Serving docs at 0.0.0.0:8080
2021-01-25 22:23:23.972375 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-01-25 22:23:23.972697 (MainThread): Press Ctrl+C to exit.


2021-01-25 22:23:29.717308 (MainThread): subprocess 15270 is still running
2021-01-25 22:25:39.501813 (MainThread): Flushing usage events
2021-01-25 22:25:40.035099 (MainThread): ctrl-c
2021-01-25 22:39:42.721076 (MainThread): Running with dbt=0.18.1
2021-01-25 22:39:42.918305 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['f_land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:39:42.919836 (MainThread): Tracking: tracking
2021-01-25 22:39:42.938251 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18148b4dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18143e1ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18143e1f60>]}
2021-01-25 22:39:42.996472 (MainThread): Partial parsing not enabled
2021-01-25 22:39:42.997712 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:39:43.002698 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:39:43.015041 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:39:43.020626 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:39:43.048955 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:39:43.053442 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:39:43.100583 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:39:43.103034 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:39:43.108750 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:39:43.109174 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:39:43.114559 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:39:43.133088 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:39:43.150754 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:39:43.159109 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:39:43.173799 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:39:43.184779 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:39:43.213384 (MainThread): Parsing macros/core.sql
2021-01-25 22:39:43.220659 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:39:43.301034 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:39:43.318208 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:39:43.321728 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:39:43.324064 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:39:43.326130 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:39:43.330856 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:39:43.334265 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:39:43.352009 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:39:43.355902 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:39:43.368208 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:39:43.421591 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:39:43.453585 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:39:43.457180 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:39:43.466938 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:39:43.479073 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:39:43.505359 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:39:43.518220 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:39:43.557993 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:39:43.562162 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:39:43.565392 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:39:43.568999 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:39:43.583939 (MainThread): Partial parsing not enabled
2021-01-25 22:39:43.700332 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:39:43.747411 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:39:43.769482 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:39:43.806530 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:39:43.826764 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:39:44.812320 (MainThread): [WARNING]: Test 'test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_municipalities_' (models/staging/schema.yml) depends on a node named 'municipalities' which was not found
2021-01-25 22:39:45.096779 (MainThread): Found 3 models, 26 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:39:45.100082 (MainThread): 
2021-01-25 22:39:45.100854 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:39:45.104175 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:39:45.135597 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:39:45.136082 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:39:45.136220 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:39:45.136339 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:39:45.338527 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:39:45.505443 (ThreadPoolExecutor-0_0): SQL status: OK in 0.37 seconds
2021-01-25 22:39:45.527262 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:39:45.617757 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:39:45.631078 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:39:45.631335 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:39:45.631474 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:39:45.631579 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:39:45.744464 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:39:46.042795 (ThreadPoolExecutor-1_0): SQL status: OK in 0.41 seconds
2021-01-25 22:39:46.075559 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:39:46.075833 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:39:46.077827 (MainThread): 23:39:46 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:39:46.078174 (MainThread): 23:39:46 | 
2021-01-25 22:39:46.080474 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 22:39:46.083213 (Thread-1): 23:39:46 | 1 of 1 START view model @fab4.f_land_values.......................... [RUN]
2021-01-25 22:39:46.089822 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:39:46.090225 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 22:39:46.158395 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 22:39:46.174865 (Thread-1): finished collecting timing info
2021-01-25 22:39:46.220810 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-25 22:39:46.244725 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 22:39:46.245117 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,cast(land_surface, 0) as land_surface
  ,cast(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 22:39:46.245345 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 22:39:46.245559 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:39:46.365590 (Thread-1): Connected to db: None
2021-01-25 22:39:46.448753 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,cast(land_surface, 0) as land_surface
  ,cast(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 22:39:46.449247 (Thread-1): Rolling back transaction.
2021-01-25 22:39:46.449545 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-25 22:39:46.449789 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-25 22:39:46.451413 (Thread-1): finished collecting timing info
2021-01-25 22:39:46.453030 (Thread-1): Runtime Error in model f_land_values (models/marts/f_land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."f_land_values" as (\n    select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, \'N/A\') as lane_type\n  ,coalesce(lane_code, \'N/A\') as lane_code\n  ,coalesce(lane, \'N/A\') as lane\n  ,coalesce(zip_code, \'N/A\') as zip_code\n  ,municipality_...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."f_land_values" as (\n    select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, \'N/A\') as lane_type\n  ,coalesce(lane_code, \'N/A\') as lane_code\n  ,coalesce(lane, \'N/A\') as lane\n  ,coalesce(zip_code, \'N/A\') as zip_code\n  ,municipality_...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model f_land_values (models/marts/f_land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."f_land_values" as (\n    select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, \'N/A\') as lane_type\n  ,coalesce(lane_code, \'N/A\') as lane_code\n  ,coalesce(lane, \'N/A\') as lane\n  ,coalesce(zip_code, \'N/A\') as zip_code\n  ,municipality_...[see log] (1040) (SQLExecDirectW)')
2021-01-25 22:39:46.508896 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc1f5a9-fd26-4605-8b29-359db9c86631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1813fb4dd8>]}
2021-01-25 22:39:46.512862 (Thread-1): 23:39:46 | 1 of 1 ERROR creating view model @fab4.f_land_values................. [ERROR in 0.42s]
2021-01-25 22:39:46.513419 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 22:39:46.587093 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:39:46.587616 (MainThread): On master: ROLLBACK
2021-01-25 22:39:46.587842 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:39:46.588056 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:39:46.706360 (MainThread): Connected to db: None
2021-01-25 22:39:46.706817 (MainThread): On master: ROLLBACK
2021-01-25 22:39:46.706976 (MainThread): On master: Close
2021-01-25 22:39:46.708370 (MainThread): 23:39:46 | 
2021-01-25 22:39:46.708701 (MainThread): 23:39:46 | Finished running 1 view model in 1.61s.
2021-01-25 22:39:46.708966 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:39:46.709200 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-25 22:39:46.724052 (MainThread): 
2021-01-25 22:39:46.725759 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 22:39:46.726767 (MainThread): 
2021-01-25 22:39:46.728015 (MainThread): Runtime Error in model f_land_values (models/marts/f_land_values.sql)
2021-01-25 22:39:46.728794 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."f_land_values" as (\n    select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, \'N/A\') as lane_type\n  ,coalesce(lane_code, \'N/A\') as lane_code\n  ,coalesce(lane, \'N/A\') as lane\n  ,coalesce(zip_code, \'N/A\') as zip_code\n  ,municipality_...[see log] (1040) (SQLExecDirectW)')
2021-01-25 22:39:46.729689 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 22:39:46.731328 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1813fb4240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1813fbad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1814016f60>]}
2021-01-25 22:39:46.731913 (MainThread): Flushing usage events
2021-01-25 22:42:18.346443 (MainThread): Running with dbt=0.18.1
2021-01-25 22:42:18.468545 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['f_land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:42:18.470062 (MainThread): Tracking: tracking
2021-01-25 22:42:18.479169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc585710c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc585710f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc585710f98>]}
2021-01-25 22:42:18.537069 (MainThread): Partial parsing not enabled
2021-01-25 22:42:18.538758 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:42:18.544911 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:42:18.548481 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:42:18.552722 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:42:18.578746 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:42:18.583360 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:42:18.631102 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:42:18.633622 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:42:18.639591 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:42:18.640114 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:42:18.645770 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:42:18.664446 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:42:18.682082 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:42:18.690545 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:42:18.705460 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:42:18.716784 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:42:18.745551 (MainThread): Parsing macros/core.sql
2021-01-25 22:42:18.753127 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:42:18.833197 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:42:18.850613 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:42:18.854239 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:42:18.856737 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:42:18.858995 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:42:18.863336 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:42:18.866949 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:42:18.884862 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:42:18.888796 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:42:18.901045 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:42:18.953040 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:42:18.985615 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:42:18.989335 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:42:18.999449 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:42:19.011576 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:42:19.038293 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:42:19.051607 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:42:19.091181 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:42:19.095389 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:42:19.098792 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:42:19.102523 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:42:19.117736 (MainThread): Partial parsing not enabled
2021-01-25 22:42:19.233188 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:42:19.280288 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:42:19.302121 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:42:19.339181 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:42:19.359839 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:42:20.329390 (MainThread): [WARNING]: Test 'test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_municipalities_' (models/staging/schema.yml) depends on a node named 'municipalities' which was not found
2021-01-25 22:42:20.609666 (MainThread): Found 3 models, 26 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:42:20.612928 (MainThread): 
2021-01-25 22:42:20.613718 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:42:20.617038 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:42:20.647207 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:42:20.647515 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:42:20.647758 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:42:20.647970 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:42:20.783606 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:42:20.925169 (ThreadPoolExecutor-0_0): SQL status: OK in 0.28 seconds
2021-01-25 22:42:20.944744 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:42:21.060629 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:42:21.075589 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:42:21.076012 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:42:21.076245 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:42:21.076479 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:42:21.200565 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:42:21.413198 (ThreadPoolExecutor-1_0): SQL status: OK in 0.34 seconds
2021-01-25 22:42:21.443588 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:42:21.443909 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:42:21.448249 (MainThread): 23:42:21 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:42:21.448581 (MainThread): 23:42:21 | 
2021-01-25 22:42:21.466566 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 22:42:21.469118 (Thread-1): 23:42:21 | 1 of 1 START view model @fab4.f_land_values.......................... [RUN]
2021-01-25 22:42:21.469894 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:42:21.471328 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 22:42:21.512330 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 22:42:21.516626 (Thread-1): finished collecting timing info
2021-01-25 22:42:21.558170 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-25 22:42:21.558972 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 22:42:21.559392 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,cast(land_surface, 0) as land_surface
  ,cast(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 22:42:21.559602 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 22:42:21.559790 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:42:21.681928 (Thread-1): Connected to db: None
2021-01-25 22:42:21.700221 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,cast(land_surface, 0) as land_surface
  ,cast(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 22:42:21.701428 (Thread-1): Rolling back transaction.
2021-01-25 22:42:21.702599 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-25 22:42:21.703896 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-25 22:42:21.706232 (Thread-1): finished collecting timing info
2021-01-25 22:42:21.708188 (Thread-1): Runtime Error in model f_land_values (models/marts/f_land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."f_land_values" as (\n    select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, \'N/A\') as lane_type\n  ,coalesce(lane_code, \'N/A\') as lane_code\n  ,coalesce(lane, \'N/A\') as lane\n  ,coalesce(zip_code, \'N/A\') as zip_code\n  ,municipality_...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."f_land_values" as (\n    select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, \'N/A\') as lane_type\n  ,coalesce(lane_code, \'N/A\') as lane_code\n  ,coalesce(lane, \'N/A\') as lane\n  ,coalesce(zip_code, \'N/A\') as zip_code\n  ,municipality_...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model f_land_values (models/marts/f_land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."f_land_values" as (\n    select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, \'N/A\') as lane_type\n  ,coalesce(lane_code, \'N/A\') as lane_code\n  ,coalesce(lane, \'N/A\') as lane\n  ,coalesce(zip_code, \'N/A\') as zip_code\n  ,municipality_...[see log] (1040) (SQLExecDirectW)')
2021-01-25 22:42:21.713384 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d7d85b6-9840-45f9-b294-251249ea50fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc585355a58>]}
2021-01-25 22:42:21.724614 (Thread-1): 23:42:21 | 1 of 1 ERROR creating view model @fab4.f_land_values................. [ERROR in 0.24s]
2021-01-25 22:42:21.730573 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 22:42:21.758038 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:42:21.758667 (MainThread): On master: ROLLBACK
2021-01-25 22:42:21.759107 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:42:21.759294 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:42:21.932005 (MainThread): Connected to db: None
2021-01-25 22:42:21.932398 (MainThread): On master: ROLLBACK
2021-01-25 22:42:21.932579 (MainThread): On master: Close
2021-01-25 22:42:21.934575 (MainThread): 23:42:21 | 
2021-01-25 22:42:21.946607 (MainThread): 23:42:21 | Finished running 1 view model in 1.32s.
2021-01-25 22:42:21.946999 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:42:21.947166 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-25 22:42:21.963054 (MainThread): 
2021-01-25 22:42:21.970526 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 22:42:21.974173 (MainThread): 
2021-01-25 22:42:21.974615 (MainThread): Runtime Error in model f_land_values (models/marts/f_land_values.sql)
2021-01-25 22:42:21.974965 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."f_land_values" as (\n    select\n  transaction_date\n  ,coalesce(transaction_amount, 0) as transaction_amount\n  ,transfer_types.transfer_label_en as transfer_label\n  ,coalesce(lane_type, \'N/A\') as lane_type\n  ,coalesce(lane_code, \'N/A\') as lane_code\n  ,coalesce(lane, \'N/A\') as lane\n  ,coalesce(zip_code, \'N/A\') as zip_code\n  ,municipality_...[see log] (1040) (SQLExecDirectW)')
2021-01-25 22:42:21.975314 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 22:42:21.976486 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc585378240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5854b4a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58533de80>]}
2021-01-25 22:42:21.976994 (MainThread): Flushing usage events
2021-01-25 22:42:38.135026 (MainThread): Running with dbt=0.18.1
2021-01-25 22:42:38.256442 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['f_land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:42:38.258018 (MainThread): Tracking: tracking
2021-01-25 22:42:38.267013 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1dff8cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1ef924e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1dff8ef0>]}
2021-01-25 22:42:38.324225 (MainThread): Partial parsing not enabled
2021-01-25 22:42:38.325876 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:42:38.332121 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:42:38.336455 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:42:38.340706 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:42:38.365682 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:42:38.370373 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:42:38.415881 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:42:38.418413 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:42:38.424244 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:42:38.424756 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:42:38.430748 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:42:38.449191 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:42:38.466242 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:42:38.474747 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:42:38.489598 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:42:38.500754 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:42:38.528902 (MainThread): Parsing macros/core.sql
2021-01-25 22:42:38.537425 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:42:38.618097 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:42:38.635301 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:42:38.638957 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:42:38.641422 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:42:38.643676 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:42:38.648040 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:42:38.651706 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:42:38.668962 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:42:38.672896 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:42:38.685268 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:42:38.738221 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:42:38.770594 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:42:38.774271 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:42:38.784374 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:42:38.797354 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:42:38.825887 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:42:38.839776 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:42:38.881089 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:42:38.885167 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:42:38.888527 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:42:38.892244 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:42:38.907393 (MainThread): Partial parsing not enabled
2021-01-25 22:42:39.023256 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:42:39.070138 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:42:39.117541 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:42:39.161938 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:42:39.196036 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:42:40.170187 (MainThread): [WARNING]: Test 'test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_municipalities_' (models/staging/schema.yml) depends on a node named 'municipalities' which was not found
2021-01-25 22:42:40.448448 (MainThread): Found 3 models, 26 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:42:40.451647 (MainThread): 
2021-01-25 22:42:40.452435 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:42:40.455866 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:42:40.483718 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:42:40.484025 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:42:40.484190 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:42:40.484326 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:42:40.620097 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:42:40.762112 (ThreadPoolExecutor-0_0): SQL status: OK in 0.28 seconds
2021-01-25 22:42:40.780380 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:42:40.867930 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:42:40.882251 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:42:40.882690 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:42:40.882995 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:42:40.883237 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:42:41.002780 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:42:41.206384 (ThreadPoolExecutor-1_0): SQL status: OK in 0.32 seconds
2021-01-25 22:42:41.229388 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:42:41.230527 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:42:41.233720 (MainThread): 23:42:41 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:42:41.236944 (MainThread): 23:42:41 | 
2021-01-25 22:42:41.264209 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 22:42:41.272802 (Thread-1): 23:42:41 | 1 of 1 START view model @fab4.f_land_values.......................... [RUN]
2021-01-25 22:42:41.277833 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:42:41.278174 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 22:42:41.354393 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 22:42:41.357800 (Thread-1): finished collecting timing info
2021-01-25 22:42:41.408231 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-25 22:42:41.409899 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 22:42:41.411142 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 22:42:41.412137 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:42:41.413182 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:42:41.532494 (Thread-1): Connected to db: None
2021-01-25 22:42:41.779263 (Thread-1): SQL status: OK in 0.37 seconds
2021-01-25 22:42:41.790802 (Thread-1): finished collecting timing info
2021-01-25 22:42:41.791612 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-25 22:42:41.793004 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-25 22:42:41.795041 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9eada5-9b06-4095-a10d-1b321a5fa19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1dc5d400>]}
2021-01-25 22:42:41.797939 (Thread-1): 23:42:41 | 1 of 1 OK created view model @fab4.f_land_values..................... [OK in 0.52s]
2021-01-25 22:42:41.799850 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 22:42:41.856494 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:42:41.856857 (MainThread): On master: ROLLBACK
2021-01-25 22:42:41.857029 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:42:41.857154 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:42:41.974385 (MainThread): Connected to db: None
2021-01-25 22:42:41.974736 (MainThread): On master: ROLLBACK
2021-01-25 22:42:41.974874 (MainThread): On master: Close
2021-01-25 22:42:41.976380 (MainThread): 23:42:41 | 
2021-01-25 22:42:41.976763 (MainThread): 23:42:41 | Finished running 1 view model in 1.52s.
2021-01-25 22:42:41.977056 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:42:41.977290 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:42:41.977498 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-25 22:42:41.987613 (MainThread): 
2021-01-25 22:42:41.988018 (MainThread): Completed successfully
2021-01-25 22:42:41.988230 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 22:42:41.988582 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1dbca400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1dc5d668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1dc5d400>]}
2021-01-25 22:42:41.988975 (MainThread): Flushing usage events
2021-01-25 22:53:14.094076 (MainThread): Running with dbt=0.18.1
2021-01-25 22:53:14.215277 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['d_crop_types--target', 'unmanaged'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:53:14.216946 (MainThread): Tracking: tracking
2021-01-25 22:53:14.226007 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ca69cb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ca1a9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ca1a9ef0>]}
2021-01-25 22:53:14.283883 (MainThread): Partial parsing not enabled
2021-01-25 22:53:14.285534 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:53:14.291440 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:53:14.295036 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:53:14.299300 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:53:14.324110 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:53:14.328747 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:53:14.374385 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:53:14.376902 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:53:14.382883 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:53:14.383398 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:53:14.389005 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:53:14.407568 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:53:14.425049 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:53:14.433795 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:53:14.448525 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:53:14.459386 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:53:14.487001 (MainThread): Parsing macros/core.sql
2021-01-25 22:53:14.494691 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:53:14.573348 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:53:14.590570 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:53:14.594412 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:53:14.596891 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:53:14.599162 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:53:14.603504 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:53:14.607087 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:53:14.624961 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:53:14.628944 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:53:14.641086 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:53:14.692105 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:53:14.724800 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:53:14.728583 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:53:14.738801 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:53:14.751062 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:53:14.777430 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:53:14.790843 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:53:14.830716 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:53:14.834922 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:53:14.838309 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:53:14.842071 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:53:14.857161 (MainThread): Partial parsing not enabled
2021-01-25 22:53:14.971738 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:53:15.016921 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:53:15.038714 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:53:15.060472 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:53:15.084606 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:53:15.106498 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:53:15.143006 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:53:15.163599 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:53:16.575543 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40c9e8c6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40c9f4d2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40c9f4d9b0>]}
2021-01-25 22:53:16.576018 (MainThread): Flushing usage events
2021-01-25 22:53:17.135189 (MainThread): Connection 'test.subsurface.stg__land_values_built_surface_implies_premises_code' was properly closed.
2021-01-25 22:53:17.136644 (MainThread): Encountered an error:
2021-01-25 22:53:17.137314 (MainThread): Compilation Error in model d_municipalities (models/marts/d_municipalities.sql)
  Model 'model.subsurface.d_municipalities' (models/marts/d_municipalities.sql) depends on a node named 'municipalities' which was not found
2021-01-25 22:53:17.164566 (MainThread): Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 351, in load_all
    manifest = loader.create_manifest()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 327, in create_manifest
    self.process_manifest(manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 298, in process_manifest
    process_refs(manifest, project_name)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 644, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 628, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 387, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 538, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model d_municipalities (models/marts/d_municipalities.sql)
  Model 'model.subsurface.d_municipalities' (models/marts/d_municipalities.sql) depends on a node named 'municipalities' which was not found

2021-01-25 22:53:50.903924 (MainThread): Running with dbt=0.18.1
2021-01-25 22:53:51.024149 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['d_crop_types--target', 'unmanaged'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:53:51.025693 (MainThread): Tracking: tracking
2021-01-25 22:53:51.035253 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224098bb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224049ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224049aef0>]}
2021-01-25 22:53:51.093630 (MainThread): Partial parsing not enabled
2021-01-25 22:53:51.095299 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:53:51.101082 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:53:51.104558 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:53:51.108870 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:53:51.134603 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:53:51.139313 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:53:51.184706 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:53:51.187286 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:53:51.193425 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:53:51.193980 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:53:51.199519 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:53:51.217873 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:53:51.235421 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:53:51.244017 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:53:51.259051 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:53:51.270098 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:53:51.298471 (MainThread): Parsing macros/core.sql
2021-01-25 22:53:51.305816 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:53:51.384615 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:53:51.401900 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:53:51.405486 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:53:51.407930 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:53:51.410150 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:53:51.414383 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:53:51.417913 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:53:51.435710 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:53:51.439684 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:53:51.451884 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:53:51.507336 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:53:51.539772 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:53:51.543529 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:53:51.553358 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:53:51.565700 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:53:51.592059 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:53:51.605092 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:53:51.644474 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:53:51.648582 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:53:51.652255 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:53:51.656017 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:53:51.671209 (MainThread): Partial parsing not enabled
2021-01-25 22:53:51.788391 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:53:51.833680 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:53:51.855998 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:53:51.878528 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:53:51.903570 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:53:51.925657 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:53:51.962909 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:53:51.984000 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:53:53.419499 (MainThread): [WARNING]: Test 'test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_municipalities_' (models/staging/schema.yml) depends on a node named 'municipalities' which was not found
2021-01-25 22:53:53.811484 (MainThread): Found 6 models, 43 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:53:53.812772 (MainThread): The selector 'd_crop_types--target' does not match any nodes and will be ignored
2021-01-25 22:53:53.813520 (MainThread): The selector 'unmanaged' does not match any nodes and will be ignored
2021-01-25 22:53:53.818260 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-01-25 22:53:53.818861 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224013de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22400acba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22400acd68>]}
2021-01-25 22:53:53.819301 (MainThread): Flushing usage events
2021-01-25 22:53:54.305238 (MainThread): Connection 'test.subsurface.stg__land_values_built_surface_implies_premises_code' was properly closed.
2021-01-25 22:54:13.435512 (MainThread): Running with dbt=0.18.1
2021-01-25 22:54:13.556967 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['d_crop_types'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:54:13.558636 (MainThread): Tracking: tracking
2021-01-25 22:54:13.568045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32800cf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff327b20e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff327b20eb8>]}
2021-01-25 22:54:13.626234 (MainThread): Partial parsing not enabled
2021-01-25 22:54:13.627902 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:54:13.634005 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:54:13.638205 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:54:13.642505 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:54:13.667336 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:54:13.671858 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:54:13.717649 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:54:13.720197 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:54:13.726241 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:54:13.726805 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:54:13.732427 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:54:13.750996 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:54:13.768668 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:54:13.777270 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:54:13.792030 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:54:13.803136 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:54:13.831287 (MainThread): Parsing macros/core.sql
2021-01-25 22:54:13.838827 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:54:13.918805 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:54:13.935963 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:54:13.939615 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:54:13.942057 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:54:13.944292 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:54:13.948641 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:54:13.952183 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:54:13.969911 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:54:13.973875 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:54:13.986102 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:54:14.037478 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:54:14.069567 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:54:14.073283 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:54:14.083268 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:54:14.095241 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:54:14.121429 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:54:14.134778 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:54:14.174588 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:54:14.178681 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:54:14.182033 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:54:14.185799 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:54:14.201178 (MainThread): Partial parsing not enabled
2021-01-25 22:54:14.316661 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:54:14.361408 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:54:14.383431 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:54:14.405339 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:54:14.430163 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:54:14.452445 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:54:14.488052 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:54:14.509156 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:54:15.932153 (MainThread): [WARNING]: Test 'test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_municipalities_' (models/staging/schema.yml) depends on a node named 'municipalities' which was not found
2021-01-25 22:54:16.323706 (MainThread): Found 6 models, 43 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:54:16.329201 (MainThread): 
2021-01-25 22:54:16.330009 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:54:16.333387 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:54:16.361566 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:54:16.361879 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:54:16.362084 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:54:16.362234 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:54:16.495881 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:54:16.611117 (ThreadPoolExecutor-0_0): SQL status: OK in 0.25 seconds
2021-01-25 22:54:16.627437 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:54:16.745395 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:54:16.757930 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:54:16.758255 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:54:16.758529 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:54:16.758792 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:54:16.879415 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:54:17.090431 (ThreadPoolExecutor-1_0): SQL status: OK in 0.33 seconds
2021-01-25 22:54:17.120130 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:54:17.121260 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:54:17.127114 (MainThread): 23:54:17 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:54:17.130459 (MainThread): 23:54:17 | 
2021-01-25 22:54:17.147200 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-25 22:54:17.149731 (Thread-1): 23:54:17 | 1 of 1 START view model @fab4.d_crop_types........................... [RUN]
2021-01-25 22:54:17.156079 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:54:17.157021 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-25 22:54:17.225010 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-25 22:54:17.233037 (Thread-1): finished collecting timing info
2021-01-25 22:54:17.325030 (Thread-1): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-25 22:54:17.326307 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:54:17.326593 (Thread-1): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-25 22:54:17.326810 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:54:17.327047 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:54:17.447701 (Thread-1): Connected to db: None
2021-01-25 22:54:17.583224 (Thread-1): SQL status: OK in 0.26 seconds
2021-01-25 22:54:17.594825 (Thread-1): finished collecting timing info
2021-01-25 22:54:17.596132 (Thread-1): On model.subsurface.d_crop_types: ROLLBACK
2021-01-25 22:54:17.597422 (Thread-1): On model.subsurface.d_crop_types: Close
2021-01-25 22:54:17.603790 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee95b46d-8aa0-4c48-9e56-b7ddb5c2d174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32790c2e8>]}
2021-01-25 22:54:17.609380 (Thread-1): 23:54:17 | 1 of 1 OK created view model @fab4.d_crop_types...................... [OK in 0.45s]
2021-01-25 22:54:17.611043 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-25 22:54:17.672072 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:54:17.672480 (MainThread): On master: ROLLBACK
2021-01-25 22:54:17.672692 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:54:17.672832 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:54:17.795162 (MainThread): Connected to db: None
2021-01-25 22:54:17.795600 (MainThread): On master: ROLLBACK
2021-01-25 22:54:17.795837 (MainThread): On master: Close
2021-01-25 22:54:17.797337 (MainThread): 23:54:17 | 
2021-01-25 22:54:17.797793 (MainThread): 23:54:17 | Finished running 1 view model in 1.47s.
2021-01-25 22:54:17.798128 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:54:17.798400 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:54:17.798610 (MainThread): Connection 'model.subsurface.d_crop_types' was properly closed.
2021-01-25 22:54:17.806632 (MainThread): 
2021-01-25 22:54:17.807243 (MainThread): Completed successfully
2021-01-25 22:54:17.807585 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 22:54:17.808288 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff326c16c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3277090f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32765b4e0>]}
2021-01-25 22:54:17.808855 (MainThread): Flushing usage events
2021-01-25 22:54:24.367271 (MainThread): Running with dbt=0.18.1
2021-01-25 22:54:24.486796 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['d_premises_types'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:54:24.488340 (MainThread): Tracking: tracking
2021-01-25 22:54:24.497192 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cea169080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cea169e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cea169e80>]}
2021-01-25 22:54:24.555480 (MainThread): Partial parsing not enabled
2021-01-25 22:54:24.557119 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:54:24.563285 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:54:24.566944 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:54:24.571194 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:54:24.596855 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:54:24.601496 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:54:24.647339 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:54:24.649858 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:54:24.655825 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:54:24.656340 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:54:24.661998 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:54:24.680644 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:54:24.698309 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:54:24.706994 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:54:24.721889 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:54:24.732943 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:54:24.761051 (MainThread): Parsing macros/core.sql
2021-01-25 22:54:24.768629 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:54:24.849317 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:54:24.866426 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:54:24.870184 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:54:24.872672 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:54:24.874953 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:54:24.879266 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:54:24.882847 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:54:24.900883 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:54:24.904865 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:54:24.917137 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:54:24.968912 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:54:25.001954 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:54:25.005758 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:54:25.015726 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:54:25.027938 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:54:25.053863 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:54:25.066701 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:54:25.106143 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:54:25.110241 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:54:25.113647 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:54:25.117390 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:54:25.132684 (MainThread): Partial parsing not enabled
2021-01-25 22:54:25.248356 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:54:25.293799 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:54:25.316049 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:54:25.338110 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:54:25.362904 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:54:25.385632 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:54:25.422986 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:54:25.443947 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:54:26.873997 (MainThread): [WARNING]: Test 'test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_municipalities_' (models/staging/schema.yml) depends on a node named 'municipalities' which was not found
2021-01-25 22:54:27.265295 (MainThread): Found 6 models, 43 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:54:27.270734 (MainThread): 
2021-01-25 22:54:27.271503 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:54:27.274897 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:54:27.305115 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:54:27.305735 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:54:27.306120 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:54:27.306548 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:54:27.450137 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:54:27.564555 (ThreadPoolExecutor-0_0): SQL status: OK in 0.26 seconds
2021-01-25 22:54:27.579581 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:54:27.694685 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:54:27.706634 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:54:27.706899 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:54:27.707115 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:54:27.707320 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:54:27.826993 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:54:28.030133 (ThreadPoolExecutor-1_0): SQL status: OK in 0.32 seconds
2021-01-25 22:54:28.055529 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:54:28.056666 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:54:28.062181 (MainThread): 23:54:28 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:54:28.067752 (MainThread): 23:54:28 | 
2021-01-25 22:54:28.075702 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 22:54:28.079879 (Thread-1): 23:54:28 | 1 of 1 START view model @fab4.d_premises_types....................... [RUN]
2021-01-25 22:54:28.083678 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:54:28.086429 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 22:54:28.136376 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 22:54:28.137058 (Thread-1): finished collecting timing info
2021-01-25 22:54:28.195107 (Thread-1): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-25 22:54:28.195780 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:54:28.196064 (Thread-1): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-25 22:54:28.196285 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:54:28.196490 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:54:28.314624 (Thread-1): Connected to db: None
2021-01-25 22:54:28.335268 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-25 22:54:28.335576 (Thread-1): Rolling back transaction.
2021-01-25 22:54:28.335794 (Thread-1): On model.subsurface.d_premises_types: ROLLBACK
2021-01-25 22:54:28.336098 (Thread-1): On model.subsurface.d_premises_types: Close
2021-01-25 22:54:28.337378 (Thread-1): finished collecting timing info
2021-01-25 22:54:28.339377 (Thread-1): Runtime Error in model d_premises_types (models/marts/d_premises_types.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."d_premises_types" as (\n    select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  "@fab4"."premises_types"\n\nunion all\n\nselect\n  \'N/A\'\n  ,\'N/A\'\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Type mismatch in column 1 of UNION ALL\n\n\n[Error Id: 8d6d32ba-2e74-429e-9a5f-5cc7b377ae6a on fabri...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."d_premises_types" as (\n    select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  "@fab4"."premises_types"\n\nunion all\n\nselect\n  \'N/A\'\n  ,\'N/A\'\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Type mismatch in column 1 of UNION ALL\n\n\n[Error Id: 8d6d32ba-2e74-429e-9a5f-5cc7b377ae6a on fabri...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model d_premises_types (models/marts/d_premises_types.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."d_premises_types" as (\n    select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  "@fab4"."premises_types"\n\nunion all\n\nselect\n  \'N/A\'\n  ,\'N/A\'\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Type mismatch in column 1 of UNION ALL\n\n\n[Error Id: 8d6d32ba-2e74-429e-9a5f-5cc7b377ae6a on fabri...[see log] (1040) (SQLExecDirectW)')
2021-01-25 22:54:28.342213 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afc1918-3dab-4696-8ef0-ecc3de645694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce9c9cb00>]}
2021-01-25 22:54:28.348947 (Thread-1): 23:54:28 | 1 of 1 ERROR creating view model @fab4.d_premises_types.............. [ERROR in 0.26s]
2021-01-25 22:54:28.350589 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 22:54:28.379974 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:54:28.380491 (MainThread): On master: ROLLBACK
2021-01-25 22:54:28.380839 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:54:28.381182 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:54:28.500268 (MainThread): Connected to db: None
2021-01-25 22:54:28.500711 (MainThread): On master: ROLLBACK
2021-01-25 22:54:28.500987 (MainThread): On master: Close
2021-01-25 22:54:28.502491 (MainThread): 23:54:28 | 
2021-01-25 22:54:28.502884 (MainThread): 23:54:28 | Finished running 1 view model in 1.23s.
2021-01-25 22:54:28.503199 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:54:28.503468 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:54:28.503684 (MainThread): Connection 'model.subsurface.d_premises_types' was properly closed.
2021-01-25 22:54:28.511092 (MainThread): 
2021-01-25 22:54:28.511602 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 22:54:28.511881 (MainThread): 
2021-01-25 22:54:28.512074 (MainThread): Runtime Error in model d_premises_types (models/marts/d_premises_types.sql)
2021-01-25 22:54:28.512252 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."d_premises_types" as (\n    select\n  premises_code\n  ,premises_label_en as premises_label\nfrom\n  "@fab4"."premises_types"\n\nunion all\n\nselect\n  \'N/A\'\n  ,\'N/A\'\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Type mismatch in column 1 of UNION ALL\n\n\n[Error Id: 8d6d32ba-2e74-429e-9a5f-5cc7b377ae6a on fabri...[see log] (1040) (SQLExecDirectW)')
2021-01-25 22:54:28.512490 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-25 22:54:28.512878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce926d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce9c988d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce9c98ba8>]}
2021-01-25 22:54:28.513317 (MainThread): Flushing usage events
2021-01-25 22:58:07.434656 (MainThread): Running with dbt=0.18.1
2021-01-25 22:58:07.556055 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-25 22:58:07.557608 (MainThread): Tracking: tracking
2021-01-25 22:58:07.566753 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b39a4def0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b399d5d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b399d5dd8>]}
2021-01-25 22:58:07.624716 (MainThread): Partial parsing not enabled
2021-01-25 22:58:07.626423 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:58:07.633035 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:58:07.637096 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:58:07.641528 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:58:07.667015 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:58:07.671830 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:58:07.718399 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:58:07.721009 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:58:07.727068 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:58:07.727643 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:58:07.733417 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:58:07.752230 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:58:07.769917 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:58:07.778539 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:58:07.793441 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:58:07.804570 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:58:07.832270 (MainThread): Parsing macros/core.sql
2021-01-25 22:58:07.839884 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:58:07.920589 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:58:07.937850 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:58:07.941521 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:58:07.944065 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:58:07.946373 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:58:07.950715 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:58:07.954411 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:58:07.975590 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:58:07.979642 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:58:07.992331 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:58:08.044927 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:58:08.076918 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:58:08.080717 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:58:08.091314 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:58:08.104375 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:58:08.130855 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:58:08.143965 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:58:08.183674 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:58:08.187811 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:58:08.191575 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:58:08.195717 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:58:08.211098 (MainThread): Partial parsing not enabled
2021-01-25 22:58:08.328314 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:58:08.373311 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:58:08.396340 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:58:08.418153 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:58:08.442828 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:58:08.465191 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:58:08.501075 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:58:08.521924 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:58:09.961549 (MainThread): [WARNING]: Test 'test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_municipalities_' (models/staging/schema.yml) depends on a node named 'municipalities' which was not found
2021-01-25 22:58:10.361372 (MainThread): Found 6 models, 43 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:58:10.367189 (MainThread): 
2021-01-25 22:58:10.367937 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:58:10.379321 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:58:10.408422 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:58:10.408838 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:58:10.409205 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:58:10.409684 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:10.547154 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:58:10.682503 (ThreadPoolExecutor-0_0): SQL status: OK in 0.27 seconds
2021-01-25 22:58:10.707742 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:58:10.834157 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:58:10.847146 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:58:10.847435 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:58:10.847645 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:58:10.847854 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:10.962672 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:58:11.204693 (ThreadPoolExecutor-1_0): SQL status: OK in 0.36 seconds
2021-01-25 22:58:11.242125 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:58:11.243257 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:58:11.246333 (MainThread): 23:58:11 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:58:11.250842 (MainThread): 23:58:11 | 
2021-01-25 22:58:11.269558 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-25 22:58:11.277392 (Thread-1): 23:58:11 | 1 of 3 START seed file @fab4.crop_types.............................. [RUN]
2021-01-25 22:58:11.278832 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-25 22:58:11.279373 (Thread-1): finished collecting timing info
2021-01-25 22:58:11.471292 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 22:58:11.476134 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 22:58:11.476406 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 22:58:11.476602 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:58:11.476793 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:11.592140 (Thread-1): Connected to db: None
2021-01-25 22:58:11.819103 (Thread-1): SQL status: OK in 0.34 seconds
2021-01-25 22:58:11.841448 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_blue">]
2021-01-25 22:58:11.842920 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 22:58:11.849593 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 22:58:11.850834 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 22:58:12.247893 (Thread-1): SQL status: OK in 0.40 seconds
2021-01-25 22:58:12.271459 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_blue">]
2021-01-25 22:58:12.290803 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 22:58:12.291866 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."subsurface"."@fab4"."crop_types_green"
2021-01-25 22:58:12.303309 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-25 22:58:12.317157 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_types"
2021-01-25 22:58:12.331109 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 22:58:12.331464 (Thread-1): On seed.subsurface.crop_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."crop_types_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_label as varchar)
        as crop_label
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'B'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_label )

  )

  
2021-01-25 22:58:12.444071 (Thread-1): SQL status: OK in 0.11 seconds
2021-01-25 22:58:12.455576 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 22:58:12.456816 (Thread-1): On seed.subsurface.crop_types: 
    
  create or replace view "@fab4"."crop_types" as (
    select * from "$scratch"."subsurface"."@fab4"."crop_types_green"
  )

  
2021-01-25 22:58:12.523250 (Thread-1): SQL status: OK in 0.07 seconds
2021-01-25 22:58:12.529509 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-25 22:58:12.529848 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."subsurface"."@fab4"."crop_types_blue"
2021-01-25 22:58:12.559842 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-25 22:58:12.583577 (Thread-1): finished collecting timing info
2021-01-25 22:58:12.585001 (Thread-1): On seed.subsurface.crop_types: ROLLBACK
2021-01-25 22:58:12.586053 (Thread-1): On seed.subsurface.crop_types: Close
2021-01-25 22:58:12.589646 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b318b23-5b0c-4bd7-b69d-135950b531d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b394c6828>]}
2021-01-25 22:58:12.590274 (Thread-1): 23:58:12 | 1 of 3 OK loaded seed file no_schema.crop_types...................... [OK in 1.31s]
2021-01-25 22:58:12.590681 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-25 22:58:12.591078 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-25 22:58:12.593858 (Thread-1): 23:58:12 | 2 of 3 START seed file @fab4.premises_types.......................... [RUN]
2021-01-25 22:58:12.594748 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-25 22:58:12.595124 (Thread-1): finished collecting timing info
2021-01-25 22:58:12.616178 (Thread-1): On "seed.subsurface.premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 22:58:12.621785 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 22:58:12.622070 (Thread-1): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 22:58:12.622291 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 22:58:12.622579 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:12.739751 (Thread-1): Connected to db: None
2021-01-25 22:58:12.955870 (Thread-1): SQL status: OK in 0.33 seconds
2021-01-25 22:58:12.978865 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_blue">]
2021-01-25 22:58:12.980374 (Thread-1): On "seed.subsurface.premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 22:58:12.987431 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 22:58:12.991092 (Thread-1): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 22:58:13.197906 (Thread-1): SQL status: OK in 0.21 seconds
2021-01-25 22:58:13.224420 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_blue">]
2021-01-25 22:58:13.233493 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 22:58:13.235156 (Thread-1): On seed.subsurface.premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."premises_types_green"
2021-01-25 22:58:13.249622 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-25 22:58:13.253121 (Thread-1): Writing runtime SQL for node "seed.subsurface.premises_types"
2021-01-25 22:58:13.254868 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 22:58:13.256095 (Thread-1): On seed.subsurface.premises_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."premises_types_green"
  as (
    select
    cast(premises_code as varchar)
        as premises_code,cast(premises_label_fr as varchar)
        as premises_label_fr,cast(premises_label_en as varchar)
        as premises_label_en
  from
    (values
      
        (
            '1'
          ,
            'Maison'
          ,
            'House'
          ),
      
        (
            '2'
          ,
            'Appartement'
          ,
            'Flat'
          ),
      
        (
            '3'
          ,
            'Dépendance'
          ,
            'Outbuilding'
          ),
      
        (
            '4'
          ,
            'Local industriel. commercial ou assimilé'
          ,
            'Industrial premises. commercial or similar'
          )
      ) temp_table ( premises_code, premises_label_fr, premises_label_en )

  )

  
2021-01-25 22:58:13.657846 (Thread-1): SQL status: OK in 0.40 seconds
2021-01-25 22:58:13.661582 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 22:58:13.662817 (Thread-1): On seed.subsurface.premises_types: 
    
  create or replace view "@fab4"."premises_types" as (
    select * from "$scratch"."subsurface"."@fab4"."premises_types_green"
  )

  
2021-01-25 22:58:13.714953 (Thread-1): SQL status: OK in 0.05 seconds
2021-01-25 22:58:13.720230 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-25 22:58:13.720487 (Thread-1): On seed.subsurface.premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."premises_types_blue"
2021-01-25 22:58:13.729196 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-25 22:58:13.735225 (Thread-1): finished collecting timing info
2021-01-25 22:58:13.736773 (Thread-1): On seed.subsurface.premises_types: ROLLBACK
2021-01-25 22:58:13.737805 (Thread-1): On seed.subsurface.premises_types: Close
2021-01-25 22:58:13.740662 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b318b23-5b0c-4bd7-b69d-135950b531d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b3959fd68>]}
2021-01-25 22:58:13.742070 (Thread-1): 23:58:13 | 2 of 3 OK loaded seed file no_schema.premises_types.................. [OK in 1.15s]
2021-01-25 22:58:13.742454 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-25 22:58:13.742831 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-25 22:58:13.745151 (Thread-1): 23:58:13 | 3 of 3 START seed file @fab4.transfer_types.......................... [RUN]
2021-01-25 22:58:13.746291 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-25 22:58:13.746684 (Thread-1): finished collecting timing info
2021-01-25 22:58:13.768689 (Thread-1): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 22:58:13.775663 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 22:58:13.776272 (Thread-1): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 22:58:13.776682 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 22:58:13.776933 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:13.896545 (Thread-1): Connected to db: None
2021-01-25 22:58:14.135502 (Thread-1): SQL status: OK in 0.36 seconds
2021-01-25 22:58:14.161468 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_blue">]
2021-01-25 22:58:14.162983 (Thread-1): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 22:58:14.170122 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 22:58:14.171234 (Thread-1): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 22:58:14.509634 (Thread-1): SQL status: OK in 0.34 seconds
2021-01-25 22:58:14.528996 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_blue">]
2021-01-25 22:58:14.537085 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 22:58:14.538262 (Thread-1): On seed.subsurface.transfer_types: drop table if exists "$scratch"."subsurface"."@fab4"."transfer_types_green"
2021-01-25 22:58:14.546819 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-25 22:58:14.550225 (Thread-1): Writing runtime SQL for node "seed.subsurface.transfer_types"
2021-01-25 22:58:14.551979 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 22:58:14.553012 (Thread-1): On seed.subsurface.transfer_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."transfer_types_green"
  as (
    select
    cast(transfer_label_fr as varchar)
        as transfer_label_fr,cast(transfer_label_en as varchar)
        as transfer_label_en
  from
    (values
      
        (
            'Expropriation'
          ,
            'Expropriation'
          ),
      
        (
            'Vente'
          ,
            'Sale'
          ),
      
        (
            'Echange'
          ,
            'Exchange'
          ),
      
        (
            'Adjudication'
          ,
            'Sale by tender'
          ),
      
        (
            'Vente en l''état futur d''achèvement'
          ,
            'Sale before completion'
          ),
      
        (
            'Vente terrain à bâtir'
          ,
            'Building plot sale'
          )
      ) temp_table ( transfer_label_fr, transfer_label_en )

  )

  
2021-01-25 22:58:14.832153 (Thread-1): SQL status: OK in 0.28 seconds
2021-01-25 22:58:14.836197 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 22:58:14.837364 (Thread-1): On seed.subsurface.transfer_types: 
    
  create or replace view "@fab4"."transfer_types" as (
    select * from "$scratch"."subsurface"."@fab4"."transfer_types_green"
  )

  
2021-01-25 22:58:14.924979 (Thread-1): SQL status: OK in 0.09 seconds
2021-01-25 22:58:14.934946 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-25 22:58:14.936031 (Thread-1): On seed.subsurface.transfer_types: drop table if exists "$scratch"."subsurface"."@fab4"."transfer_types_blue"
2021-01-25 22:58:14.946055 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-25 22:58:14.956634 (Thread-1): finished collecting timing info
2021-01-25 22:58:14.957397 (Thread-1): On seed.subsurface.transfer_types: ROLLBACK
2021-01-25 22:58:14.957754 (Thread-1): On seed.subsurface.transfer_types: Close
2021-01-25 22:58:14.961468 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b318b23-5b0c-4bd7-b69d-135950b531d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b3988cac8>]}
2021-01-25 22:58:14.962159 (Thread-1): 23:58:14 | 3 of 3 OK loaded seed file no_schema.transfer_types.................. [OK in 1.22s]
2021-01-25 22:58:14.964914 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-25 22:58:15.036740 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:58:15.037325 (MainThread): On master: ROLLBACK
2021-01-25 22:58:15.037724 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:58:15.038102 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:15.156093 (MainThread): Connected to db: None
2021-01-25 22:58:15.156572 (MainThread): On master: ROLLBACK
2021-01-25 22:58:15.156859 (MainThread): On master: Close
2021-01-25 22:58:15.158615 (MainThread): 23:58:15 | 
2021-01-25 22:58:15.159115 (MainThread): 23:58:15 | Finished running 3 seeds in 4.79s.
2021-01-25 22:58:15.159516 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:58:15.159827 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:58:15.160106 (MainThread): Connection 'seed.subsurface.transfer_types' was properly closed.
2021-01-25 22:58:15.182396 (MainThread): 
2021-01-25 22:58:15.182822 (MainThread): Completed successfully
2021-01-25 22:58:15.183095 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-25 22:58:15.183534 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b3988e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b396f2b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b396f29b0>]}
2021-01-25 22:58:15.184807 (MainThread): Flushing usage events
2021-01-25 22:58:51.726587 (MainThread): Running with dbt=0.18.1
2021-01-25 22:58:51.845349 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['d_premises_types'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:58:51.846927 (MainThread): Tracking: tracking
2021-01-25 22:58:51.856223 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb543d24320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb543d24ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb543d24f60>]}
2021-01-25 22:58:51.913872 (MainThread): Partial parsing not enabled
2021-01-25 22:58:51.915601 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:58:51.921827 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:58:51.925466 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:58:51.929729 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:58:51.955153 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:58:51.959848 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:58:52.005468 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:58:52.008012 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:58:52.013944 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:58:52.014495 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:58:52.020195 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:58:52.038553 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:58:52.055886 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:58:52.064524 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:58:52.079325 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:58:52.090485 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:58:52.118921 (MainThread): Parsing macros/core.sql
2021-01-25 22:58:52.126484 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:58:52.206100 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:58:52.223543 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:58:52.228039 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:58:52.230575 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:58:52.232837 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:58:52.237165 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:58:52.240768 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:58:52.259211 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:58:52.263198 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:58:52.275930 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:58:52.327292 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:58:52.360217 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:58:52.363963 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:58:52.373702 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:58:52.385683 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:58:52.412153 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:58:52.425479 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:58:52.464986 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:58:52.469055 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:58:52.472452 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:58:52.476260 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:58:52.491363 (MainThread): Partial parsing not enabled
2021-01-25 22:58:52.608057 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:58:52.653784 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:58:52.676092 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:58:52.698260 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:58:52.723201 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:58:52.745291 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:58:52.781507 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:58:52.802549 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:58:54.232232 (MainThread): [WARNING]: Test 'test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_municipalities_' (models/staging/schema.yml) depends on a node named 'municipalities' which was not found
2021-01-25 22:58:54.623776 (MainThread): Found 6 models, 43 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:58:54.629204 (MainThread): 
2021-01-25 22:58:54.629980 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:58:54.633425 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:58:54.663151 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:58:54.663449 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:58:54.663599 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:58:54.663739 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:54.799097 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:58:55.196353 (ThreadPoolExecutor-0_0): SQL status: OK in 0.53 seconds
2021-01-25 22:58:55.219760 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:58:55.339128 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:58:55.350824 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:58:55.351085 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:58:55.351259 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:58:55.351429 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:55.468492 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:58:55.658806 (ThreadPoolExecutor-1_0): SQL status: OK in 0.31 seconds
2021-01-25 22:58:55.691460 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:58:55.692537 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:58:55.696413 (MainThread): 23:58:55 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:58:55.698062 (MainThread): 23:58:55 | 
2021-01-25 22:58:55.713499 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 22:58:55.715932 (Thread-1): 23:58:55 | 1 of 1 START view model @fab4.d_premises_types....................... [RUN]
2021-01-25 22:58:55.719303 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:58:55.720920 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 22:58:55.790187 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 22:58:55.791747 (Thread-1): finished collecting timing info
2021-01-25 22:58:55.916639 (Thread-1): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-25 22:58:55.918299 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:58:55.919456 (Thread-1): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-25 22:58:55.920403 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:58:55.921340 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:56.037244 (Thread-1): Connected to db: None
2021-01-25 22:58:56.119425 (Thread-1): SQL status: OK in 0.20 seconds
2021-01-25 22:58:56.130963 (Thread-1): finished collecting timing info
2021-01-25 22:58:56.131573 (Thread-1): On model.subsurface.d_premises_types: ROLLBACK
2021-01-25 22:58:56.131866 (Thread-1): On model.subsurface.d_premises_types: Close
2021-01-25 22:58:56.133717 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76b421ba-cc8c-4f12-8b61-6d683f4bb731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb543bbd908>]}
2021-01-25 22:58:56.135876 (Thread-1): 23:58:56 | 1 of 1 OK created view model @fab4.d_premises_types.................. [OK in 0.41s]
2021-01-25 22:58:56.136222 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 22:58:56.166644 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:58:56.167164 (MainThread): On master: ROLLBACK
2021-01-25 22:58:56.167515 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:58:56.167834 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:58:56.289957 (MainThread): Connected to db: None
2021-01-25 22:58:56.290465 (MainThread): On master: ROLLBACK
2021-01-25 22:58:56.290795 (MainThread): On master: Close
2021-01-25 22:58:56.292449 (MainThread): 23:58:56 | 
2021-01-25 22:58:56.292866 (MainThread): 23:58:56 | Finished running 1 view model in 1.66s.
2021-01-25 22:58:56.293143 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:58:56.293393 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:58:56.293635 (MainThread): Connection 'model.subsurface.d_premises_types' was properly closed.
2021-01-25 22:58:56.301453 (MainThread): 
2021-01-25 22:58:56.302012 (MainThread): Completed successfully
2021-01-25 22:58:56.302439 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 22:58:56.302975 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb543b8a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb543b8a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb543b8a748>]}
2021-01-25 22:58:56.303542 (MainThread): Flushing usage events
2021-01-25 22:59:36.828417 (MainThread): Running with dbt=0.18.1
2021-01-25 22:59:36.952956 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['f_land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:59:36.954518 (MainThread): Tracking: tracking
2021-01-25 22:59:36.963698 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb09cdf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb0464e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb0464eb8>]}
2021-01-25 22:59:37.021577 (MainThread): Partial parsing not enabled
2021-01-25 22:59:37.023275 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:59:37.029474 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:59:37.033079 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:59:37.037257 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:59:37.062386 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:59:37.067120 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:59:37.112185 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:59:37.114736 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:59:37.120751 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:59:37.121264 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:59:37.126940 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:59:37.145362 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:59:37.162741 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:59:37.171257 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:59:37.186259 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:59:37.198080 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:59:37.226911 (MainThread): Parsing macros/core.sql
2021-01-25 22:59:37.234657 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:59:37.314722 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:59:37.332166 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:59:37.335856 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:59:37.338286 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:59:37.340527 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:59:37.344810 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:59:37.348388 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:59:37.366540 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:59:37.370553 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:59:37.383153 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:59:37.436549 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:59:37.468647 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:59:37.472458 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:59:37.482577 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:59:37.495023 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:59:37.521712 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:59:37.535174 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:59:37.574417 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:59:37.578475 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:59:37.581930 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:59:37.585663 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:59:37.600905 (MainThread): Partial parsing not enabled
2021-01-25 22:59:37.717851 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:59:37.762632 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:59:37.785240 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:59:37.808063 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:59:37.832520 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:59:37.854351 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:59:37.890739 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:59:37.911846 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:59:39.757324 (MainThread): Found 6 models, 44 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:59:39.762837 (MainThread): 
2021-01-25 22:59:39.763573 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:59:39.767256 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:59:39.799965 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:59:39.800229 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:59:39.800396 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:59:39.800576 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:59:39.935560 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:59:40.040939 (ThreadPoolExecutor-0_0): SQL status: OK in 0.24 seconds
2021-01-25 22:59:40.061971 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:59:40.180433 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:59:40.196519 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:59:40.196784 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:59:40.196975 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:59:40.197156 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:59:40.310951 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:59:40.546850 (ThreadPoolExecutor-1_0): SQL status: OK in 0.35 seconds
2021-01-25 22:59:40.573909 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:59:40.577370 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:59:40.582934 (MainThread): 23:59:40 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:59:40.584285 (MainThread): 23:59:40 | 
2021-01-25 22:59:40.596078 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 22:59:40.599562 (Thread-1): 23:59:40 | 1 of 1 START view model @fab4.f_land_values.......................... [RUN]
2021-01-25 22:59:40.600748 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:59:40.601213 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 22:59:40.722672 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 22:59:40.723365 (Thread-1): finished collecting timing info
2021-01-25 22:59:40.762631 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-25 22:59:40.763398 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 22:59:40.763801 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 22:59:40.764030 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:59:40.764234 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:59:40.881729 (Thread-1): Connected to db: None
2021-01-25 22:59:41.054961 (Thread-1): SQL status: OK in 0.29 seconds
2021-01-25 22:59:41.064103 (Thread-1): finished collecting timing info
2021-01-25 22:59:41.064686 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-25 22:59:41.064975 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-25 22:59:41.070030 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '265468bf-a350-4d69-9428-195eb67d6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb02c9780>]}
2021-01-25 22:59:41.072204 (Thread-1): 23:59:41 | 1 of 1 OK created view model @fab4.f_land_values..................... [OK in 0.47s]
2021-01-25 22:59:41.072551 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 22:59:41.110600 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:59:41.111212 (MainThread): On master: ROLLBACK
2021-01-25 22:59:41.111548 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:59:41.111855 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:59:41.232560 (MainThread): Connected to db: None
2021-01-25 22:59:41.232921 (MainThread): On master: ROLLBACK
2021-01-25 22:59:41.233060 (MainThread): On master: Close
2021-01-25 22:59:41.235116 (MainThread): 23:59:41 | 
2021-01-25 22:59:41.235510 (MainThread): 23:59:41 | Finished running 1 view model in 1.47s.
2021-01-25 22:59:41.235820 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:59:41.236137 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:59:41.236415 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-25 22:59:41.247480 (MainThread): 
2021-01-25 22:59:41.247952 (MainThread): Completed successfully
2021-01-25 22:59:41.248317 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 22:59:41.248793 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb0e142e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafaffe5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafaffe5748>]}
2021-01-25 22:59:41.249299 (MainThread): Flushing usage events
2021-01-25 22:59:50.679465 (MainThread): Running with dbt=0.18.1
2021-01-25 22:59:50.800185 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['d_municipalities'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 22:59:50.801725 (MainThread): Tracking: tracking
2021-01-25 22:59:50.810910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b7045fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b6adce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b6adcef0>]}
2021-01-25 22:59:50.868953 (MainThread): Partial parsing not enabled
2021-01-25 22:59:50.870645 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:59:50.876705 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:59:50.880170 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 22:59:50.884431 (MainThread): Parsing macros/helpers.sql
2021-01-25 22:59:50.909557 (MainThread): Parsing macros/catalog.sql
2021-01-25 22:59:50.914247 (MainThread): Parsing macros/adapters.sql
2021-01-25 22:59:50.959870 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 22:59:50.962412 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 22:59:50.968313 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 22:59:50.968821 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 22:59:50.974561 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 22:59:50.993901 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:59:51.011579 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:59:51.020381 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 22:59:51.035270 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:59:51.046411 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:59:51.074909 (MainThread): Parsing macros/core.sql
2021-01-25 22:59:51.082209 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 22:59:51.162246 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 22:59:51.179257 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 22:59:51.182873 (MainThread): Parsing macros/etc/query.sql
2021-01-25 22:59:51.185291 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 22:59:51.187540 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 22:59:51.191852 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 22:59:51.195568 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 22:59:51.213508 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 22:59:51.217546 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 22:59:51.229928 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 22:59:51.283017 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 22:59:51.323362 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 22:59:51.327139 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 22:59:51.337030 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 22:59:51.349113 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 22:59:51.375840 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 22:59:51.388698 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 22:59:51.431955 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 22:59:51.436531 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 22:59:51.441002 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 22:59:51.445401 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 22:59:51.460532 (MainThread): Partial parsing not enabled
2021-01-25 22:59:51.576478 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:59:51.622126 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 22:59:51.644416 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 22:59:51.666767 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 22:59:51.691263 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 22:59:51.713370 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 22:59:51.749642 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 22:59:51.770807 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 22:59:53.562220 (MainThread): Found 6 models, 44 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 22:59:53.567813 (MainThread): 
2021-01-25 22:59:53.568564 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:59:53.571882 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 22:59:53.599375 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 22:59:53.599710 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 22:59:53.599944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 22:59:53.600088 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:59:53.735742 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 22:59:53.851660 (ThreadPoolExecutor-0_0): SQL status: OK in 0.25 seconds
2021-01-25 22:59:53.878614 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 22:59:54.016147 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 22:59:54.030116 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 22:59:54.030413 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 22:59:54.031268 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 22:59:54.031479 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:59:54.143587 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 22:59:54.355150 (ThreadPoolExecutor-1_0): SQL status: OK in 0.32 seconds
2021-01-25 22:59:54.395279 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 22:59:54.395659 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 22:59:54.401386 (MainThread): 23:59:54 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 22:59:54.401759 (MainThread): 23:59:54 | 
2021-01-25 22:59:54.414880 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-25 22:59:54.417431 (Thread-1): 23:59:54 | 1 of 1 START view model @fab4.d_municipalities....................... [RUN]
2021-01-25 22:59:54.418165 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:59:54.418507 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-25 22:59:54.470502 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-25 22:59:54.471275 (Thread-1): finished collecting timing info
2021-01-25 22:59:54.576065 (Thread-1): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-25 22:59:54.576793 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-25 22:59:54.577085 (Thread-1): On model.subsurface.d_municipalities: 
  create or replace view "@fab4"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,departement_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-25 22:59:54.577308 (Thread-1): Opening a new connection, currently in state init
2021-01-25 22:59:54.577518 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:59:54.691044 (Thread-1): Connected to db: None
2021-01-25 22:59:54.808448 (Thread-1): SQL status: OK in 0.23 seconds
2021-01-25 22:59:54.816712 (Thread-1): finished collecting timing info
2021-01-25 22:59:54.817457 (Thread-1): On model.subsurface.d_municipalities: ROLLBACK
2021-01-25 22:59:54.818960 (Thread-1): On model.subsurface.d_municipalities: Close
2021-01-25 22:59:54.821432 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3930f9b2-f1f9-433e-9a37-b13fbb0cc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b69768d0>]}
2021-01-25 22:59:54.825099 (Thread-1): 23:59:54 | 1 of 1 OK created view model @fab4.d_municipalities.................. [OK in 0.40s]
2021-01-25 22:59:54.830623 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-25 22:59:54.839632 (MainThread): Acquiring new dremio connection "master".
2021-01-25 22:59:54.839986 (MainThread): On master: ROLLBACK
2021-01-25 22:59:54.840165 (MainThread): Opening a new connection, currently in state init
2021-01-25 22:59:54.840296 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 22:59:54.961630 (MainThread): Connected to db: None
2021-01-25 22:59:54.962014 (MainThread): On master: ROLLBACK
2021-01-25 22:59:54.962198 (MainThread): On master: Close
2021-01-25 22:59:54.964226 (MainThread): 23:59:54 | 
2021-01-25 22:59:54.965798 (MainThread): 23:59:54 | Finished running 1 view model in 1.40s.
2021-01-25 22:59:54.971767 (MainThread): Connection 'master' was properly closed.
2021-01-25 22:59:54.972068 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 22:59:54.972201 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-25 22:59:54.982178 (MainThread): 
2021-01-25 22:59:54.982635 (MainThread): Completed successfully
2021-01-25 22:59:54.982974 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-25 22:59:54.983477 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b693eac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b6640c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b6640ac8>]}
2021-01-25 22:59:54.983978 (MainThread): Flushing usage events
2021-01-25 23:00:20.177901 (MainThread): Running with dbt=0.18.1
2021-01-25 23:00:20.301763 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 23:00:20.303353 (MainThread): Tracking: tracking
2021-01-25 23:00:20.312821 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc70c65e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc70c65ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc70c65f60>]}
2021-01-25 23:00:20.371328 (MainThread): Partial parsing not enabled
2021-01-25 23:00:20.372976 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:00:20.379046 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:00:20.382901 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:00:20.387276 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:00:20.412509 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:00:20.417185 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:00:20.462427 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:00:20.464921 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:00:20.470795 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:00:20.471306 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:00:20.477006 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:00:20.495532 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:00:20.512899 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:00:20.521626 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:00:20.536492 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:00:20.547509 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:00:20.575856 (MainThread): Parsing macros/core.sql
2021-01-25 23:00:20.583165 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:00:20.661959 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:00:20.679301 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:00:20.682888 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:00:20.685285 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:00:20.687492 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:00:20.691769 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:00:20.695563 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:00:20.713351 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:00:20.717313 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:00:20.730415 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:00:20.781826 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:00:20.814215 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:00:20.818040 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:00:20.828004 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:00:20.839947 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:00:20.865785 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:00:20.878841 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:00:20.919825 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:00:20.924018 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:00:20.927603 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:00:20.931341 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:00:20.946575 (MainThread): Partial parsing not enabled
2021-01-25 23:00:21.062459 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:00:21.107327 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:00:21.129912 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:00:21.152211 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:00:21.176710 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:00:21.199071 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:00:21.235735 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:00:21.256773 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:00:23.060344 (MainThread): Found 6 models, 44 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:00:23.066296 (MainThread): 
2021-01-25 23:00:23.067097 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:00:23.195122 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:00:23.216740 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:00:23.217095 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:00:23.217343 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 23:00:23.217592 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:00:23.348004 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:00:23.586719 (ThreadPoolExecutor-1_0): SQL status: OK in 0.37 seconds
2021-01-25 23:00:23.619024 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:00:23.620182 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:00:23.623512 (MainThread): 00:00:23 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:00:23.624845 (MainThread): 00:00:23 | 
2021-01-25 23:00:23.645704 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:00:23.646169 (Thread-1): 00:00:23 | 1 of 9 START test not_null_stg__land_values_lots_count............... [RUN]
2021-01-25 23:00:23.647491 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:00:23.648412 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:00:23.718471 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 23:00:23.719944 (Thread-1): finished collecting timing info
2021-01-25 23:00:23.721552 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:00:23.722593 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where lots_count is null



2021-01-25 23:00:23.723689 (Thread-1): Opening a new connection, currently in state init
2021-01-25 23:00:23.725195 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:00:23.840821 (Thread-1): Connected to db: None
2021-01-25 23:00:26.177799 (Thread-1): SQL status: OK in 2.45 seconds
2021-01-25 23:00:26.186006 (Thread-1): finished collecting timing info
2021-01-25 23:00:26.186841 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: ROLLBACK
2021-01-25 23:00:26.187044 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: Close
2021-01-25 23:00:26.189013 (Thread-1): 00:00:26 | 1 of 9 PASS not_null_stg__land_values_lots_count..................... [PASS in 2.54s]
2021-01-25 23:00:26.189419 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:00:26.189835 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:00:26.190490 (Thread-1): 00:00:26 | 2 of 9 START test not_null_stg__land_values_municipality_code........ [RUN]
2021-01-25 23:00:26.191296 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:00:26.191686 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:00:26.279460 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 23:00:26.280151 (Thread-1): finished collecting timing info
2021-01-25 23:00:26.280856 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:00:26.281125 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where municipality_code is null



2021-01-25 23:00:26.281336 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:00:26.281535 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:00:26.402374 (Thread-1): Connected to db: None
2021-01-25 23:00:41.978709 (Thread-1): SQL status: OK in 15.70 seconds
2021-01-25 23:00:41.987129 (Thread-1): finished collecting timing info
2021-01-25 23:00:41.987833 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: ROLLBACK
2021-01-25 23:00:41.988074 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: Close
2021-01-25 23:00:41.990088 (Thread-1): 00:00:41 | 2 of 9 PASS not_null_stg__land_values_municipality_code.............. [PASS in 15.80s]
2021-01-25 23:00:41.991539 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:00:41.999326 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:00:41.999830 (Thread-1): 00:00:41 | 3 of 9 START test not_null_stg__land_values_transaction_date......... [RUN]
2021-01-25 23:00:42.000472 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:00:42.000780 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:00:42.033454 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 23:00:42.034210 (Thread-1): finished collecting timing info
2021-01-25 23:00:42.034914 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:00:42.035195 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transaction_date is null



2021-01-25 23:00:42.035417 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:00:42.035628 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:00:42.150409 (Thread-1): Connected to db: None
2021-01-25 23:00:56.621866 (Thread-1): SQL status: OK in 14.59 seconds
2021-01-25 23:00:56.634106 (Thread-1): finished collecting timing info
2021-01-25 23:00:56.634818 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: ROLLBACK
2021-01-25 23:00:56.635079 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: Close
2021-01-25 23:00:56.637065 (Thread-1): 00:00:56 | 3 of 9 PASS not_null_stg__land_values_transaction_date............... [PASS in 14.64s]
2021-01-25 23:00:56.638534 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:00:56.642669 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:00:56.643258 (Thread-1): 00:00:56 | 4 of 9 START test not_null_stg__land_values_transfer_label_fr........ [RUN]
2021-01-25 23:00:56.645362 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:00:56.650581 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:00:56.690932 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 23:00:56.693941 (Thread-1): finished collecting timing info
2021-01-25 23:00:56.698059 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:00:56.699036 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transfer_label_fr is null



2021-01-25 23:00:56.699306 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:00:56.699422 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:00:56.813796 (Thread-1): Connected to db: None
2021-01-25 23:00:57.955737 (Thread-1): SQL status: OK in 1.26 seconds
2021-01-25 23:00:57.969021 (Thread-1): finished collecting timing info
2021-01-25 23:00:57.969747 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: ROLLBACK
2021-01-25 23:00:57.970100 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: Close
2021-01-25 23:00:57.972129 (Thread-1): 00:00:57 | 4 of 9 PASS not_null_stg__land_values_transfer_label_fr.............. [PASS in 1.33s]
2021-01-25 23:00:57.974030 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:00:57.975139 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_
2021-01-25 23:00:57.976358 (Thread-1): 00:00:57 | 5 of 9 START test relationships_stg__land_values_crop_code__crop_code__ref_crop_types_ [RUN]
2021-01-25 23:00:57.980074 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_".
2021-01-25 23:00:57.980436 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_
2021-01-25 23:00:58.046092 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_"
2021-01-25 23:00:58.047957 (Thread-1): finished collecting timing info
2021-01-25 23:00:58.048809 (Thread-1): Using dremio connection "test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_".
2021-01-25 23:00:58.049212 (Thread-1): On test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_: 
    
    




select count(*) as validation_errors
from (
    select crop_code as id from "@fab4"."stg__land_values"
) as child
left join (
    select crop_code as id from "@fab4"."crop_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:00:58.049608 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:00:58.049957 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:00:58.174963 (Thread-1): Connected to db: None
2021-01-25 23:01:02.312868 (Thread-1): SQL status: OK in 4.26 seconds
2021-01-25 23:01:02.322303 (Thread-1): finished collecting timing info
2021-01-25 23:01:02.323064 (Thread-1): On test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_: ROLLBACK
2021-01-25 23:01:02.323306 (Thread-1): On test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_: Close
2021-01-25 23:01:02.325607 (Thread-1): 00:01:02 | 5 of 9 PASS relationships_stg__land_values_crop_code__crop_code__ref_crop_types_ [PASS in 4.35s]
2021-01-25 23:01:02.326795 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_
2021-01-25 23:01:02.328066 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_
2021-01-25 23:01:02.328570 (Thread-1): 00:01:02 | 6 of 9 START test relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_ [RUN]
2021-01-25 23:01:02.329655 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_".
2021-01-25 23:01:02.330000 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_
2021-01-25 23:01:02.368762 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_"
2021-01-25 23:01:02.369627 (Thread-1): finished collecting timing info
2021-01-25 23:01:02.370284 (Thread-1): Using dremio connection "test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_".
2021-01-25 23:01:02.370539 (Thread-1): On test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_: 
    
    




select count(*) as validation_errors
from (
    select municipality_code as id from "@fab4"."stg__land_values"
) as child
left join (
    select municipality_code as id from "@fab4"."stg__municipalities"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:01:02.370706 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:01:02.370855 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:01:02.486941 (Thread-1): Connected to db: None
2021-01-25 23:01:19.321227 (Thread-1): SQL status: OK in 16.95 seconds
2021-01-25 23:01:19.345354 (Thread-1): finished collecting timing info
2021-01-25 23:01:19.346106 (Thread-1): On test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_: ROLLBACK
2021-01-25 23:01:19.346375 (Thread-1): On test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_: Close
2021-01-25 23:01:19.348289 (Thread-1): 00:01:19 | 6 of 9 FAIL 129778 relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_ [FAIL 129778 in 17.02s]
2021-01-25 23:01:19.349828 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_
2021-01-25 23:01:19.353708 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_
2021-01-25 23:01:19.354274 (Thread-1): 00:01:19 | 7 of 9 START test relationships_stg__land_values_premises_code__premises_code__ref_premises_types_ [RUN]
2021-01-25 23:01:19.354938 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_".
2021-01-25 23:01:19.355233 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_
2021-01-25 23:01:19.405098 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_"
2021-01-25 23:01:19.412349 (Thread-1): finished collecting timing info
2021-01-25 23:01:19.413537 (Thread-1): Using dremio connection "test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_".
2021-01-25 23:01:19.414199 (Thread-1): On test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_: 
    
    




select count(*) as validation_errors
from (
    select premises_code as id from "@fab4"."stg__land_values"
) as child
left join (
    select premises_code as id from "@fab4"."premises_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:01:19.414594 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:01:19.416660 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:01:19.537799 (Thread-1): Connected to db: None
2021-01-25 23:01:23.415104 (Thread-1): SQL status: OK in 4.00 seconds
2021-01-25 23:01:23.424968 (Thread-1): finished collecting timing info
2021-01-25 23:01:23.425745 (Thread-1): On test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_: ROLLBACK
2021-01-25 23:01:23.426042 (Thread-1): On test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_: Close
2021-01-25 23:01:23.427533 (Thread-1): 00:01:23 | 7 of 9 PASS relationships_stg__land_values_premises_code__premises_code__ref_premises_types_ [PASS in 4.07s]
2021-01-25 23:01:23.427965 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_
2021-01-25 23:01:23.428375 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:01:23.428776 (Thread-1): 00:01:23 | 8 of 9 START test stg__land_values_built_surface_implies_premises_code [RUN]
2021-01-25 23:01:23.429514 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:01:23.430574 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:01:23.470046 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 23:01:23.470860 (Thread-1): finished collecting timing info
2021-01-25 23:01:23.471799 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:01:23.472037 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  built_surface is not null
  and premises_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 23:01:23.472191 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:01:23.472341 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:01:23.647760 (Thread-1): Connected to db: None
2021-01-25 23:01:25.505680 (Thread-1): SQL status: OK in 2.03 seconds
2021-01-25 23:01:25.517033 (Thread-1): finished collecting timing info
2021-01-25 23:01:25.517594 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: ROLLBACK
2021-01-25 23:01:25.517852 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: Close
2021-01-25 23:01:25.519427 (Thread-1): 00:01:25 | 8 of 9 PASS stg__land_values_built_surface_implies_premises_code..... [PASS in 2.09s]
2021-01-25 23:01:25.519761 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:01:25.520189 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:01:25.520776 (Thread-1): 00:01:25 | 9 of 9 START test stg__land_values_land_surface_implies_crop_code.... [RUN]
2021-01-25 23:01:25.521572 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:01:25.521944 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:01:25.549572 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 23:01:25.551026 (Thread-1): finished collecting timing info
2021-01-25 23:01:25.551714 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:01:25.551995 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  land_surface is not null
  and crop_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 23:01:25.552219 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:01:25.552428 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:01:25.667780 (Thread-1): Connected to db: None
2021-01-25 23:01:27.641288 (Thread-1): SQL status: OK in 2.09 seconds
2021-01-25 23:01:27.650693 (Thread-1): finished collecting timing info
2021-01-25 23:01:27.651424 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: ROLLBACK
2021-01-25 23:01:27.651693 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: Close
2021-01-25 23:01:27.653708 (Thread-1): 00:01:27 | 9 of 9 PASS stg__land_values_land_surface_implies_crop_code.......... [PASS in 2.13s]
2021-01-25 23:01:27.655429 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:01:27.714922 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:01:27.716229 (MainThread): 00:01:27 | 
2021-01-25 23:01:27.716809 (MainThread): 00:01:27 | Finished running 9 tests in 64.65s.
2021-01-25 23:01:27.717284 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:01:27.717702 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:01:27.718133 (MainThread): Connection 'test.subsurface.stg__land_values_land_surface_implies_crop_code' was properly closed.
2021-01-25 23:01:27.771383 (MainThread): 
2021-01-25 23:01:27.771847 (MainThread): Completed with 1 error and 0 warnings:
2021-01-25 23:01:27.772197 (MainThread): 
2021-01-25 23:01:27.772526 (MainThread): Failure in test relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_ (models/staging/schema.yml)
2021-01-25 23:01:27.784524 (MainThread):   Got 129778 results, expected 0.
2021-01-25 23:01:27.784930 (MainThread): 
2021-01-25 23:01:27.785204 (MainThread):   compiled SQL at target/compiled/subsurface/models/staging/schema.yml/schema_test/relationships_stg__land_values_d237e45832b227598b921d51a7c6b30a.sql
2021-01-25 23:01:27.785434 (MainThread): 
Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
2021-01-25 23:01:27.785826 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7084d860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7087a588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc70882390>]}
2021-01-25 23:01:27.786274 (MainThread): Flushing usage events
2021-01-25 23:14:11.814748 (MainThread): Running with dbt=0.18.1
2021-01-25 23:14:11.934735 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values+'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 23:14:11.936107 (MainThread): Tracking: tracking
2021-01-25 23:14:11.944865 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c747fcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c74294eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c74294f28>]}
2021-01-25 23:14:12.003056 (MainThread): Partial parsing not enabled
2021-01-25 23:14:12.004716 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:14:12.010717 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:14:12.014164 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:14:12.019063 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:14:12.043492 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:14:12.048150 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:14:12.094901 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:14:12.097362 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:14:12.103222 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:14:12.103731 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:14:12.109344 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:14:12.131216 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:14:12.148878 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:14:12.157398 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:14:12.172340 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:14:12.184101 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:14:12.216818 (MainThread): Parsing macros/core.sql
2021-01-25 23:14:12.224256 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:14:12.305842 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:14:12.322706 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:14:12.326287 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:14:12.328766 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:14:12.330999 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:14:12.335352 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:14:12.338850 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:14:12.356693 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:14:12.360770 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:14:12.372942 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:14:12.424516 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:14:12.457544 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:14:12.461482 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:14:12.471466 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:14:12.483561 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:14:12.509572 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:14:12.522723 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:14:12.562928 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:14:12.566980 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:14:12.570291 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:14:12.574017 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:14:12.589062 (MainThread): Partial parsing not enabled
2021-01-25 23:14:12.704414 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:14:12.749128 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:14:12.771296 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:14:12.793418 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:14:12.818588 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:14:12.841026 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:14:12.877814 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:14:12.898643 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:14:13.783789 (MainThread): Flushing usage events
2021-01-25 23:14:14.319923 (MainThread): Connection 'test.subsurface.stg__land_values_built_surface_implies_premises_code' was properly closed.
2021-01-25 23:14:14.321372 (MainThread): ctrl-c
2021-01-25 23:14:20.855106 (MainThread): Running with dbt=0.18.1
2021-01-25 23:14:20.977710 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg__land_values+'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 23:14:20.979178 (MainThread): Tracking: tracking
2021-01-25 23:14:20.987964 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c4e44fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c4e52d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c48dce48>]}
2021-01-25 23:14:21.045833 (MainThread): Partial parsing not enabled
2021-01-25 23:14:21.048054 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:14:21.054303 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:14:21.057839 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:14:21.062131 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:14:21.087831 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:14:21.092630 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:14:21.138551 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:14:21.141043 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:14:21.146911 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:14:21.147424 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:14:21.153018 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:14:21.171629 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:14:21.189538 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:14:21.198209 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:14:21.212987 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:14:21.225195 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:14:21.253614 (MainThread): Parsing macros/core.sql
2021-01-25 23:14:21.261259 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:14:21.341920 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:14:21.359039 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:14:21.362689 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:14:21.365110 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:14:21.367342 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:14:21.371637 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:14:21.375198 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:14:21.393797 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:14:21.397805 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:14:21.409936 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:14:21.461177 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:14:21.494492 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:14:21.498225 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:14:21.508226 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:14:21.520607 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:14:21.546716 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:14:21.560143 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:14:21.600326 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:14:21.604441 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:14:21.607988 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:14:21.611740 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:14:21.626858 (MainThread): Partial parsing not enabled
2021-01-25 23:14:21.741034 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:14:21.785592 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:14:21.807764 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:14:21.830088 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:14:21.855265 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:14:21.877487 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:14:21.914288 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:14:21.935025 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:14:23.726833 (MainThread): Found 6 models, 44 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:14:23.732585 (MainThread): 
2021-01-25 23:14:23.733328 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:14:23.743071 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 23:14:23.773912 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 23:14:23.774176 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 23:14:23.775097 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 23:14:23.775350 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:23.907453 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 23:14:24.025696 (ThreadPoolExecutor-0_0): SQL status: OK in 0.25 seconds
2021-01-25 23:14:24.048035 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 23:14:24.165110 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:14:24.177679 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:14:24.178077 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:14:24.178404 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 23:14:24.178726 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:24.296189 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:14:24.615814 (ThreadPoolExecutor-1_0): SQL status: OK in 0.44 seconds
2021-01-25 23:14:24.652817 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:14:24.653307 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:14:24.656948 (MainThread): 00:14:24 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:14:24.658651 (MainThread): 00:14:24 | 
2021-01-25 23:14:24.671636 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 23:14:24.694099 (Thread-1): 00:14:24 | 1 of 2 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 23:14:24.694997 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:14:24.695386 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 23:14:24.818397 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:14:24.819137 (Thread-1): finished collecting timing info
2021-01-25 23:14:24.858736 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:14:24.866825 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:14:24.867243 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 23:14:24.867553 (Thread-1): Opening a new connection, currently in state init
2021-01-25 23:14:24.867835 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:24.986929 (Thread-1): Connected to db: None
2021-01-25 23:14:25.065637 (Thread-1): SQL status: OK in 0.20 seconds
2021-01-25 23:14:25.074106 (Thread-1): finished collecting timing info
2021-01-25 23:14:25.074872 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 23:14:25.075208 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 23:14:25.078014 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13df7a75-95c4-43fa-bf44-e1dda9c56509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c43d1f60>]}
2021-01-25 23:14:25.080572 (Thread-1): 00:14:25 | 1 of 2 OK created view model @fab4.stg__land_values.................. [OK in 0.38s]
2021-01-25 23:14:25.080939 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 23:14:25.082478 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 23:14:25.085527 (Thread-1): 00:14:25 | 2 of 2 START view model @fab4.f_land_values.......................... [RUN]
2021-01-25 23:14:25.086422 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:14:25.086747 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 23:14:25.127514 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 23:14:25.128217 (Thread-1): finished collecting timing info
2021-01-25 23:14:25.139202 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-25 23:14:25.140014 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 23:14:25.140309 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 23:14:25.140596 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:14:25.140828 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:25.257067 (Thread-1): Connected to db: None
2021-01-25 23:14:25.408753 (Thread-1): SQL status: OK in 0.27 seconds
2021-01-25 23:14:25.419927 (Thread-1): finished collecting timing info
2021-01-25 23:14:25.421416 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-25 23:14:25.422501 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-25 23:14:25.425220 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13df7a75-95c4-43fa-bf44-e1dda9c56509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c44642e8>]}
2021-01-25 23:14:25.428627 (Thread-1): 00:14:25 | 2 of 2 OK created view model @fab4.f_land_values..................... [OK in 0.34s]
2021-01-25 23:14:25.431729 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 23:14:25.512565 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:14:25.513066 (MainThread): On master: ROLLBACK
2021-01-25 23:14:25.513413 (MainThread): Opening a new connection, currently in state init
2021-01-25 23:14:25.513745 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:25.637096 (MainThread): Connected to db: None
2021-01-25 23:14:25.637510 (MainThread): On master: ROLLBACK
2021-01-25 23:14:25.637730 (MainThread): On master: Close
2021-01-25 23:14:25.639969 (MainThread): 00:14:25 | 
2021-01-25 23:14:25.644454 (MainThread): 00:14:25 | Finished running 2 view models in 1.91s.
2021-01-25 23:14:25.646563 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:14:25.646844 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:14:25.646979 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-25 23:14:25.680137 (MainThread): 
2021-01-25 23:14:25.681726 (MainThread): Completed successfully
2021-01-25 23:14:25.683938 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-25 23:14:25.696154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c44b08d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c5bef160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c451a748>]}
2021-01-25 23:14:25.696636 (MainThread): Flushing usage events
2021-01-25 23:14:35.721755 (MainThread): Running with dbt=0.18.1
2021-01-25 23:14:35.845023 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values+'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 23:14:35.847813 (MainThread): Tracking: tracking
2021-01-25 23:14:35.857164 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d345f4128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d345f4eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d345f4f28>]}
2021-01-25 23:14:35.916476 (MainThread): Partial parsing not enabled
2021-01-25 23:14:35.918578 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:14:35.923679 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:14:35.927248 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:14:35.932077 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:14:35.957210 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:14:35.961892 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:14:36.007352 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:14:36.009827 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:14:36.015609 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:14:36.016117 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:14:36.021685 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:14:36.040314 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:14:36.057369 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:14:36.065991 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:14:36.080417 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:14:36.091415 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:14:36.119482 (MainThread): Parsing macros/core.sql
2021-01-25 23:14:36.126943 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:14:36.207241 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:14:36.224831 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:14:36.228630 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:14:36.231084 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:14:36.233287 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:14:36.237649 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:14:36.241308 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:14:36.258985 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:14:36.263062 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:14:36.274900 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:14:36.326893 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:14:36.359185 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:14:36.363010 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:14:36.372759 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:14:36.384817 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:14:36.411176 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:14:36.424416 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:14:36.464153 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:14:36.468192 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:14:36.471550 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:14:36.475268 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:14:36.490471 (MainThread): Partial parsing not enabled
2021-01-25 23:14:36.607031 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:14:36.652435 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:14:36.674235 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:14:36.696463 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:14:36.721189 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:14:36.743018 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:14:36.778663 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:14:36.799304 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:14:38.597224 (MainThread): Found 6 models, 44 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:14:38.603934 (MainThread): 
2021-01-25 23:14:38.604732 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:14:38.731023 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:14:38.752446 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:14:38.752790 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:14:38.753037 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 23:14:38.753258 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:38.888923 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:14:39.120732 (ThreadPoolExecutor-1_0): SQL status: OK in 0.37 seconds
2021-01-25 23:14:39.180297 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:14:39.181291 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:14:39.184999 (MainThread): 00:14:39 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:14:39.186421 (MainThread): 00:14:39 | 
2021-01-25 23:14:39.222899 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:14:39.223334 (Thread-1): 00:14:39 | 1 of 26 START test not_null_f_land_values_built_surface.............. [RUN]
2021-01-25 23:14:39.224077 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-25 23:14:39.224399 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:14:39.284421 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-25 23:14:39.285320 (Thread-1): finished collecting timing info
2021-01-25 23:14:39.286116 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-25 23:14:39.286426 (Thread-1): On test.subsurface.not_null_f_land_values_built_surface: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where built_surface is null



2021-01-25 23:14:39.286657 (Thread-1): Opening a new connection, currently in state init
2021-01-25 23:14:39.286863 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:39.399634 (Thread-1): Connected to db: None
2021-01-25 23:14:43.424355 (Thread-1): SQL status: OK in 4.14 seconds
2021-01-25 23:14:43.435332 (Thread-1): finished collecting timing info
2021-01-25 23:14:43.436046 (Thread-1): On test.subsurface.not_null_f_land_values_built_surface: ROLLBACK
2021-01-25 23:14:43.436307 (Thread-1): On test.subsurface.not_null_f_land_values_built_surface: Close
2021-01-25 23:14:43.437669 (Thread-1): 00:14:43 | 1 of 26 PASS not_null_f_land_values_built_surface.................... [PASS in 4.21s]
2021-01-25 23:14:43.438062 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:14:43.438508 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:14:43.439336 (Thread-1): 00:14:43 | 2 of 26 START test not_null_f_land_values_crop_code.................. [RUN]
2021-01-25 23:14:43.440124 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-25 23:14:43.440499 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:14:43.530778 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-25 23:14:43.531371 (Thread-1): finished collecting timing info
2021-01-25 23:14:43.532049 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-25 23:14:43.532324 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where crop_code is null



2021-01-25 23:14:43.532573 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:14:43.532801 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:43.649362 (Thread-1): Connected to db: None
2021-01-25 23:14:46.713380 (Thread-1): SQL status: OK in 3.18 seconds
2021-01-25 23:14:46.721976 (Thread-1): finished collecting timing info
2021-01-25 23:14:46.722617 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: ROLLBACK
2021-01-25 23:14:46.722839 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: Close
2021-01-25 23:14:46.724755 (Thread-1): 00:14:46 | 2 of 26 PASS not_null_f_land_values_crop_code........................ [PASS in 3.28s]
2021-01-25 23:14:46.726256 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:14:46.731338 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:14:46.731956 (Thread-1): 00:14:46 | 3 of 26 START test not_null_f_land_values_land_surface............... [RUN]
2021-01-25 23:14:46.732611 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-25 23:14:46.732934 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:14:46.782145 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-25 23:14:46.783629 (Thread-1): finished collecting timing info
2021-01-25 23:14:46.785659 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-25 23:14:46.786665 (Thread-1): On test.subsurface.not_null_f_land_values_land_surface: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where land_surface is null



2021-01-25 23:14:46.787598 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:14:46.788590 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:46.902878 (Thread-1): Connected to db: None
2021-01-25 23:14:50.934582 (Thread-1): SQL status: OK in 4.15 seconds
2021-01-25 23:14:50.949841 (Thread-1): finished collecting timing info
2021-01-25 23:14:50.951262 (Thread-1): On test.subsurface.not_null_f_land_values_land_surface: ROLLBACK
2021-01-25 23:14:50.952296 (Thread-1): On test.subsurface.not_null_f_land_values_land_surface: Close
2021-01-25 23:14:50.954586 (Thread-1): 00:14:50 | 3 of 26 PASS not_null_f_land_values_land_surface..................... [PASS in 4.22s]
2021-01-25 23:14:50.957432 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:14:50.966596 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:14:50.967280 (Thread-1): 00:14:50 | 4 of 26 START test not_null_f_land_values_lane....................... [RUN]
2021-01-25 23:14:50.968026 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-25 23:14:50.968419 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-25 23:14:51.009166 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-25 23:14:51.011306 (Thread-1): finished collecting timing info
2021-01-25 23:14:51.011985 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-25 23:14:51.012211 (Thread-1): On test.subsurface.not_null_f_land_values_lane: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane is null



2021-01-25 23:14:51.012368 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:14:51.012559 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:51.131130 (Thread-1): Connected to db: None
2021-01-25 23:14:54.419082 (Thread-1): SQL status: OK in 3.41 seconds
2021-01-25 23:14:54.427251 (Thread-1): finished collecting timing info
2021-01-25 23:14:54.427840 (Thread-1): On test.subsurface.not_null_f_land_values_lane: ROLLBACK
2021-01-25 23:14:54.428008 (Thread-1): On test.subsurface.not_null_f_land_values_lane: Close
2021-01-25 23:14:54.429913 (Thread-1): 00:14:54 | 4 of 26 PASS not_null_f_land_values_lane............................. [PASS in 3.46s]
2021-01-25 23:14:54.430380 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:14:54.430834 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:14:54.431448 (Thread-1): 00:14:54 | 5 of 26 START test not_null_f_land_values_lane_code.................. [RUN]
2021-01-25 23:14:54.432252 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-25 23:14:54.432631 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:14:54.460526 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-25 23:14:54.461131 (Thread-1): finished collecting timing info
2021-01-25 23:14:54.461804 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-25 23:14:54.462080 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane_code is null



2021-01-25 23:14:54.462305 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:14:54.462576 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:14:54.618042 (Thread-1): Connected to db: None
2021-01-25 23:15:03.309883 (Thread-1): SQL status: OK in 8.85 seconds
2021-01-25 23:15:03.324743 (Thread-1): finished collecting timing info
2021-01-25 23:15:03.325467 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: ROLLBACK
2021-01-25 23:15:03.325719 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: Close
2021-01-25 23:15:03.327769 (Thread-1): 00:15:03 | 5 of 26 PASS not_null_f_land_values_lane_code........................ [PASS in 8.90s]
2021-01-25 23:15:03.331568 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:15:03.332854 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:15:03.333833 (Thread-1): 00:15:03 | 6 of 26 START test not_null_f_land_values_lane_type.................. [RUN]
2021-01-25 23:15:03.335800 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-25 23:15:03.338581 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:15:03.366809 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-25 23:15:03.369965 (Thread-1): finished collecting timing info
2021-01-25 23:15:03.371153 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-25 23:15:03.371453 (Thread-1): On test.subsurface.not_null_f_land_values_lane_type: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane_type is null



2021-01-25 23:15:03.371620 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:03.371761 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:03.485654 (Thread-1): Connected to db: None
2021-01-25 23:15:06.341887 (Thread-1): SQL status: OK in 2.97 seconds
2021-01-25 23:15:06.349904 (Thread-1): finished collecting timing info
2021-01-25 23:15:06.350539 (Thread-1): On test.subsurface.not_null_f_land_values_lane_type: ROLLBACK
2021-01-25 23:15:06.350860 (Thread-1): On test.subsurface.not_null_f_land_values_lane_type: Close
2021-01-25 23:15:06.352472 (Thread-1): 00:15:06 | 6 of 26 PASS not_null_f_land_values_lane_type........................ [PASS in 3.02s]
2021-01-25 23:15:06.352995 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:15:06.353466 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:15:06.354167 (Thread-1): 00:15:06 | 7 of 26 START test not_null_f_land_values_lots_count................. [RUN]
2021-01-25 23:15:06.355088 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-25 23:15:06.355497 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:15:06.379473 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-25 23:15:06.380965 (Thread-1): finished collecting timing info
2021-01-25 23:15:06.382232 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-25 23:15:06.382789 (Thread-1): On test.subsurface.not_null_f_land_values_lots_count: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lots_count is null



2021-01-25 23:15:06.383166 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:06.383393 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:06.504667 (Thread-1): Connected to db: None
2021-01-25 23:15:10.614206 (Thread-1): SQL status: OK in 4.23 seconds
2021-01-25 23:15:10.628807 (Thread-1): finished collecting timing info
2021-01-25 23:15:10.629431 (Thread-1): On test.subsurface.not_null_f_land_values_lots_count: ROLLBACK
2021-01-25 23:15:10.629644 (Thread-1): On test.subsurface.not_null_f_land_values_lots_count: Close
2021-01-25 23:15:10.632038 (Thread-1): 00:15:10 | 7 of 26 PASS not_null_f_land_values_lots_count....................... [PASS in 4.28s]
2021-01-25 23:15:10.633744 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:15:10.638607 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:15:10.639203 (Thread-1): 00:15:10 | 8 of 26 START test not_null_f_land_values_main_rooms_count........... [RUN]
2021-01-25 23:15:10.639852 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-25 23:15:10.642677 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:15:10.677118 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-25 23:15:10.677816 (Thread-1): finished collecting timing info
2021-01-25 23:15:10.678493 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-25 23:15:10.678733 (Thread-1): On test.subsurface.not_null_f_land_values_main_rooms_count: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where main_rooms_count is null



2021-01-25 23:15:10.678887 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:10.679026 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:10.811728 (Thread-1): Connected to db: None
2021-01-25 23:15:14.481763 (Thread-1): SQL status: OK in 3.80 seconds
2021-01-25 23:15:14.490496 (Thread-1): finished collecting timing info
2021-01-25 23:15:14.491110 (Thread-1): On test.subsurface.not_null_f_land_values_main_rooms_count: ROLLBACK
2021-01-25 23:15:14.491398 (Thread-1): On test.subsurface.not_null_f_land_values_main_rooms_count: Close
2021-01-25 23:15:14.492793 (Thread-1): 00:15:14 | 8 of 26 PASS not_null_f_land_values_main_rooms_count................. [PASS in 3.85s]
2021-01-25 23:15:14.493169 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:15:14.493537 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:15:14.494887 (Thread-1): 00:15:14 | 9 of 26 START test not_null_f_land_values_municipality_code.......... [RUN]
2021-01-25 23:15:14.495724 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-25 23:15:14.496128 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:15:14.522367 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-25 23:15:14.523589 (Thread-1): finished collecting timing info
2021-01-25 23:15:14.524294 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-25 23:15:14.524572 (Thread-1): On test.subsurface.not_null_f_land_values_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where municipality_code is null



2021-01-25 23:15:14.524852 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:14.525069 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:14.651616 (Thread-1): Connected to db: None
2021-01-25 23:15:30.948713 (Thread-1): SQL status: OK in 16.42 seconds
2021-01-25 23:15:30.957148 (Thread-1): finished collecting timing info
2021-01-25 23:15:30.957699 (Thread-1): On test.subsurface.not_null_f_land_values_municipality_code: ROLLBACK
2021-01-25 23:15:30.957948 (Thread-1): On test.subsurface.not_null_f_land_values_municipality_code: Close
2021-01-25 23:15:30.959380 (Thread-1): 00:15:30 | 9 of 26 PASS not_null_f_land_values_municipality_code................ [PASS in 16.46s]
2021-01-25 23:15:30.959849 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:15:30.960256 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:15:30.960875 (Thread-1): 00:15:30 | 10 of 26 START test not_null_f_land_values_premises_code............. [RUN]
2021-01-25 23:15:30.961507 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-25 23:15:30.961828 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:15:30.985391 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-25 23:15:30.986743 (Thread-1): finished collecting timing info
2021-01-25 23:15:30.988052 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-25 23:15:30.988598 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where premises_code is null



2021-01-25 23:15:30.989049 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:30.989420 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:31.104036 (Thread-1): Connected to db: None
2021-01-25 23:15:33.909199 (Thread-1): SQL status: OK in 2.92 seconds
2021-01-25 23:15:33.921611 (Thread-1): finished collecting timing info
2021-01-25 23:15:33.922146 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: ROLLBACK
2021-01-25 23:15:33.922424 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: Close
2021-01-25 23:15:33.923662 (Thread-1): 00:15:33 | 10 of 26 PASS not_null_f_land_values_premises_code................... [PASS in 2.96s]
2021-01-25 23:15:33.923972 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:15:33.924314 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:15:33.924895 (Thread-1): 00:15:33 | 11 of 26 START test not_null_f_land_values_transaction_amount........ [RUN]
2021-01-25 23:15:33.925676 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-25 23:15:33.926061 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:15:33.956729 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-25 23:15:33.957322 (Thread-1): finished collecting timing info
2021-01-25 23:15:33.958007 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-25 23:15:33.958273 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_amount: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transaction_amount is null



2021-01-25 23:15:33.958521 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:33.958728 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:34.074359 (Thread-1): Connected to db: None
2021-01-25 23:15:40.041129 (Thread-1): SQL status: OK in 6.08 seconds
2021-01-25 23:15:40.056807 (Thread-1): finished collecting timing info
2021-01-25 23:15:40.057481 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_amount: ROLLBACK
2021-01-25 23:15:40.057745 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_amount: Close
2021-01-25 23:15:40.059648 (Thread-1): 00:15:40 | 11 of 26 PASS not_null_f_land_values_transaction_amount.............. [PASS in 6.13s]
2021-01-25 23:15:40.060119 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:15:40.060545 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:15:40.061124 (Thread-1): 00:15:40 | 12 of 26 START test not_null_f_land_values_transaction_date.......... [RUN]
2021-01-25 23:15:40.061870 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-25 23:15:40.062228 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:15:40.088741 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-25 23:15:40.090495 (Thread-1): finished collecting timing info
2021-01-25 23:15:40.091505 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-25 23:15:40.091841 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transaction_date is null



2021-01-25 23:15:40.092040 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:40.092153 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:40.215630 (Thread-1): Connected to db: None
2021-01-25 23:15:56.629547 (Thread-1): SQL status: OK in 16.54 seconds
2021-01-25 23:15:56.639960 (Thread-1): finished collecting timing info
2021-01-25 23:15:56.640495 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: ROLLBACK
2021-01-25 23:15:56.640741 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: Close
2021-01-25 23:15:56.642035 (Thread-1): 00:15:56 | 12 of 26 PASS not_null_f_land_values_transaction_date................ [PASS in 16.58s]
2021-01-25 23:15:56.642444 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:15:56.642804 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:15:56.643779 (Thread-1): 00:15:56 | 13 of 26 START test not_null_f_land_values_transfer_label............ [RUN]
2021-01-25 23:15:56.644523 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-25 23:15:56.644856 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:15:56.677198 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-25 23:15:56.678714 (Thread-1): finished collecting timing info
2021-01-25 23:15:56.680088 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-25 23:15:56.681036 (Thread-1): On test.subsurface.not_null_f_land_values_transfer_label: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transfer_label is null



2021-01-25 23:15:56.681946 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:56.682884 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:56.801307 (Thread-1): Connected to db: None
2021-01-25 23:15:57.036449 (Thread-1): SQL status: OK in 0.35 seconds
2021-01-25 23:15:57.048503 (Thread-1): finished collecting timing info
2021-01-25 23:15:57.049130 (Thread-1): On test.subsurface.not_null_f_land_values_transfer_label: ROLLBACK
2021-01-25 23:15:57.049341 (Thread-1): On test.subsurface.not_null_f_land_values_transfer_label: Close
2021-01-25 23:15:57.050539 (Thread-1): 00:15:57 | 13 of 26 PASS not_null_f_land_values_transfer_label.................. [PASS in 0.41s]
2021-01-25 23:15:57.050879 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:15:57.051094 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:15:57.051489 (Thread-1): 00:15:57 | 14 of 26 START test not_null_f_land_values_zip_code.................. [RUN]
2021-01-25 23:15:57.052370 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-25 23:15:57.052754 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:15:57.087074 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-25 23:15:57.088850 (Thread-1): finished collecting timing info
2021-01-25 23:15:57.089412 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-25 23:15:57.089660 (Thread-1): On test.subsurface.not_null_f_land_values_zip_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where zip_code is null



2021-01-25 23:15:57.089860 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:15:57.090048 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:15:57.204160 (Thread-1): Connected to db: None
2021-01-25 23:16:05.700887 (Thread-1): SQL status: OK in 8.61 seconds
2021-01-25 23:16:05.709484 (Thread-1): finished collecting timing info
2021-01-25 23:16:05.710163 (Thread-1): On test.subsurface.not_null_f_land_values_zip_code: ROLLBACK
2021-01-25 23:16:05.710415 (Thread-1): On test.subsurface.not_null_f_land_values_zip_code: Close
2021-01-25 23:16:05.712198 (Thread-1): 00:16:05 | 14 of 26 PASS not_null_f_land_values_zip_code........................ [PASS in 8.66s]
2021-01-25 23:16:05.712631 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:16:05.712997 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:16:05.713583 (Thread-1): 00:16:05 | 15 of 26 START test not_null_stg__land_values_lots_count............. [RUN]
2021-01-25 23:16:05.714280 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:16:05.714625 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:16:05.742784 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 23:16:05.744383 (Thread-1): finished collecting timing info
2021-01-25 23:16:05.745037 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:16:05.745308 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where lots_count is null



2021-01-25 23:16:05.745513 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:16:05.745692 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:16:05.860572 (Thread-1): Connected to db: None
2021-01-25 23:16:08.192566 (Thread-1): SQL status: OK in 2.45 seconds
2021-01-25 23:16:08.201252 (Thread-1): finished collecting timing info
2021-01-25 23:16:08.201889 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: ROLLBACK
2021-01-25 23:16:08.202190 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: Close
2021-01-25 23:16:08.203622 (Thread-1): 00:16:08 | 15 of 26 PASS not_null_stg__land_values_lots_count................... [PASS in 2.49s]
2021-01-25 23:16:08.204231 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:16:08.204610 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:16:08.206111 (Thread-1): 00:16:08 | 16 of 26 START test not_null_stg__land_values_municipality_code...... [RUN]
2021-01-25 23:16:08.206806 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:16:08.207140 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:16:08.230865 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 23:16:08.232185 (Thread-1): finished collecting timing info
2021-01-25 23:16:08.233398 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:16:08.233877 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where municipality_code is null



2021-01-25 23:16:08.234265 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:16:08.235103 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:16:08.356480 (Thread-1): Connected to db: None
2021-01-25 23:16:23.876395 (Thread-1): SQL status: OK in 15.64 seconds
2021-01-25 23:16:23.888125 (Thread-1): finished collecting timing info
2021-01-25 23:16:23.888704 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: ROLLBACK
2021-01-25 23:16:23.888875 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: Close
2021-01-25 23:16:23.890855 (Thread-1): 00:16:23 | 16 of 26 PASS not_null_stg__land_values_municipality_code............ [PASS in 15.68s]
2021-01-25 23:16:23.891270 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:16:23.891664 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:16:23.893141 (Thread-1): 00:16:23 | 17 of 26 START test not_null_stg__land_values_transaction_date....... [RUN]
2021-01-25 23:16:23.893934 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:16:23.894299 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:16:23.929295 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 23:16:23.929999 (Thread-1): finished collecting timing info
2021-01-25 23:16:23.931119 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:16:23.931358 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transaction_date is null



2021-01-25 23:16:23.931570 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:16:23.931768 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:16:24.053808 (Thread-1): Connected to db: None
2021-01-25 23:16:39.470235 (Thread-1): SQL status: OK in 15.54 seconds
2021-01-25 23:16:39.484829 (Thread-1): finished collecting timing info
2021-01-25 23:16:39.485534 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: ROLLBACK
2021-01-25 23:16:39.485857 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: Close
2021-01-25 23:16:39.487903 (Thread-1): 00:16:39 | 17 of 26 PASS not_null_stg__land_values_transaction_date............. [PASS in 15.59s]
2021-01-25 23:16:39.488972 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:16:39.489380 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:16:39.492976 (Thread-1): 00:16:39 | 18 of 26 START test not_null_stg__land_values_transfer_label_fr...... [RUN]
2021-01-25 23:16:39.495668 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:16:39.496039 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:16:39.527590 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 23:16:39.528398 (Thread-1): finished collecting timing info
2021-01-25 23:16:39.529053 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:16:39.529262 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transfer_label_fr is null



2021-01-25 23:16:39.529425 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:16:39.529571 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:16:39.646483 (Thread-1): Connected to db: None
2021-01-25 23:16:40.717286 (Thread-1): SQL status: OK in 1.19 seconds
2021-01-25 23:16:40.729283 (Thread-1): finished collecting timing info
2021-01-25 23:16:40.729872 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: ROLLBACK
2021-01-25 23:16:40.730149 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: Close
2021-01-25 23:16:40.731509 (Thread-1): 00:16:40 | 18 of 26 PASS not_null_stg__land_values_transfer_label_fr............ [PASS in 1.24s]
2021-01-25 23:16:40.731827 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:16:40.732047 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:16:40.733131 (Thread-1): 00:16:40 | 19 of 26 START test relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_ [RUN]
2021-01-25 23:16:40.733780 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:16:40.734389 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:16:40.785489 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-25 23:16:40.787640 (Thread-1): finished collecting timing info
2021-01-25 23:16:40.788584 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:16:40.788995 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: 
    
    




select count(*) as validation_errors
from (
    select crop_code as id from "@fab4"."f_land_values"
) as child
left join (
    select crop_code as id from "@fab4"."d_crop_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:16:40.789303 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:16:40.789519 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:16:40.901489 (Thread-1): Connected to db: None
2021-01-25 23:16:51.575139 (Thread-1): SQL status: OK in 10.79 seconds
2021-01-25 23:16:51.583719 (Thread-1): finished collecting timing info
2021-01-25 23:16:51.584312 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: ROLLBACK
2021-01-25 23:16:51.584586 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: Close
2021-01-25 23:16:51.585875 (Thread-1): 00:16:51 | 19 of 26 PASS relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_ [PASS in 10.85s]
2021-01-25 23:16:51.586210 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:16:51.586606 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:16:51.587156 (Thread-1): 00:16:51 | 20 of 26 START test relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_ [RUN]
2021-01-25 23:16:51.587894 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:16:51.588250 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:16:51.623190 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-25 23:16:51.623884 (Thread-1): finished collecting timing info
2021-01-25 23:16:51.624504 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:16:51.624758 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: 
    
    




select count(*) as validation_errors
from (
    select municipality_code as id from "@fab4"."f_land_values"
) as child
left join (
    select municipality_code as id from "@fab4"."d_municipalities"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:16:51.624968 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:16:51.625161 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:16:51.745200 (Thread-1): Connected to db: None
2021-01-25 23:17:12.195475 (Thread-1): SQL status: OK in 20.57 seconds
2021-01-25 23:17:12.202942 (Thread-1): finished collecting timing info
2021-01-25 23:17:12.203636 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: ROLLBACK
2021-01-25 23:17:12.203941 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: Close
2021-01-25 23:17:12.205259 (Thread-1): 00:17:12 | 20 of 26 PASS relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_ [PASS in 20.62s]
2021-01-25 23:17:12.206501 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:17:12.214662 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:17:12.215355 (Thread-1): 00:17:12 | 21 of 26 START test relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_ [RUN]
2021-01-25 23:17:12.216033 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:17:12.216335 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:17:12.266044 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-25 23:17:12.268491 (Thread-1): finished collecting timing info
2021-01-25 23:17:12.269235 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:17:12.269573 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: 
    
    




select count(*) as validation_errors
from (
    select premises_code as id from "@fab4"."f_land_values"
) as child
left join (
    select premises_code as id from "@fab4"."d_premises_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:17:12.274521 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:17:12.274883 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:17:12.409143 (Thread-1): Connected to db: None
2021-01-25 23:17:23.106203 (Thread-1): SQL status: OK in 10.83 seconds
2021-01-25 23:17:23.114651 (Thread-1): finished collecting timing info
2021-01-25 23:17:23.115243 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: ROLLBACK
2021-01-25 23:17:23.115416 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: Close
2021-01-25 23:17:23.116824 (Thread-1): 00:17:23 | 21 of 26 PASS relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_ [PASS in 10.90s]
2021-01-25 23:17:23.117233 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:17:23.117651 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_
2021-01-25 23:17:23.118197 (Thread-1): 00:17:23 | 22 of 26 START test relationships_stg__land_values_crop_code__crop_code__ref_crop_types_ [RUN]
2021-01-25 23:17:23.118990 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_".
2021-01-25 23:17:23.119358 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_
2021-01-25 23:17:23.148614 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_"
2021-01-25 23:17:23.149320 (Thread-1): finished collecting timing info
2021-01-25 23:17:23.149944 (Thread-1): Using dremio connection "test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_".
2021-01-25 23:17:23.150197 (Thread-1): On test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_: 
    
    




select count(*) as validation_errors
from (
    select crop_code as id from "@fab4"."stg__land_values"
) as child
left join (
    select crop_code as id from "@fab4"."crop_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:17:23.150462 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:17:23.150688 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:17:23.293902 (Thread-1): Connected to db: None
2021-01-25 23:17:27.370125 (Thread-1): SQL status: OK in 4.22 seconds
2021-01-25 23:17:27.379267 (Thread-1): finished collecting timing info
2021-01-25 23:17:27.379882 (Thread-1): On test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_: ROLLBACK
2021-01-25 23:17:27.380063 (Thread-1): On test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_: Close
2021-01-25 23:17:27.382043 (Thread-1): 00:17:27 | 22 of 26 PASS relationships_stg__land_values_crop_code__crop_code__ref_crop_types_ [PASS in 4.26s]
2021-01-25 23:17:27.382476 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_crop_code__crop_code__ref_crop_types_
2021-01-25 23:17:27.382907 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_
2021-01-25 23:17:27.383492 (Thread-1): 00:17:27 | 23 of 26 START test relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_ [RUN]
2021-01-25 23:17:27.384268 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_".
2021-01-25 23:17:27.384633 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_
2021-01-25 23:17:27.420753 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_"
2021-01-25 23:17:27.422050 (Thread-1): finished collecting timing info
2021-01-25 23:17:27.423077 (Thread-1): Using dremio connection "test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_".
2021-01-25 23:17:27.423341 (Thread-1): On test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_: 
    
    




select count(*) as validation_errors
from (
    select municipality_code as id from "@fab4"."stg__land_values"
) as child
left join (
    select municipality_code as id from "@fab4"."stg__municipalities"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:17:27.423552 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:17:27.423737 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:17:27.542703 (Thread-1): Connected to db: None
2021-01-25 23:17:44.416954 (Thread-1): SQL status: OK in 16.99 seconds
2021-01-25 23:17:44.425202 (Thread-1): finished collecting timing info
2021-01-25 23:17:44.425736 (Thread-1): On test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_: ROLLBACK
2021-01-25 23:17:44.425979 (Thread-1): On test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_: Close
2021-01-25 23:17:44.427334 (Thread-1): 00:17:44 | 23 of 26 PASS relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_ [PASS in 17.04s]
2021-01-25 23:17:44.427769 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_municipality_code__municipality_code__ref_stg__municipalities_
2021-01-25 23:17:44.428159 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_
2021-01-25 23:17:44.428637 (Thread-1): 00:17:44 | 24 of 26 START test relationships_stg__land_values_premises_code__premises_code__ref_premises_types_ [RUN]
2021-01-25 23:17:44.429468 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_".
2021-01-25 23:17:44.429820 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_
2021-01-25 23:17:44.462193 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_"
2021-01-25 23:17:44.463186 (Thread-1): finished collecting timing info
2021-01-25 23:17:44.464387 (Thread-1): Using dremio connection "test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_".
2021-01-25 23:17:44.465031 (Thread-1): On test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_: 
    
    




select count(*) as validation_errors
from (
    select premises_code as id from "@fab4"."stg__land_values"
) as child
left join (
    select premises_code as id from "@fab4"."premises_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:17:44.465644 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:17:44.466063 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:17:44.601258 (Thread-1): Connected to db: None
2021-01-25 23:17:48.408592 (Thread-1): SQL status: OK in 3.94 seconds
2021-01-25 23:17:48.420763 (Thread-1): finished collecting timing info
2021-01-25 23:17:48.421352 (Thread-1): On test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_: ROLLBACK
2021-01-25 23:17:48.421519 (Thread-1): On test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_: Close
2021-01-25 23:17:48.422750 (Thread-1): 00:17:48 | 24 of 26 PASS relationships_stg__land_values_premises_code__premises_code__ref_premises_types_ [PASS in 3.99s]
2021-01-25 23:17:48.423237 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_premises_code__premises_code__ref_premises_types_
2021-01-25 23:17:48.423699 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:17:48.424290 (Thread-1): 00:17:48 | 25 of 26 START test stg__land_values_built_surface_implies_premises_code [RUN]
2021-01-25 23:17:48.425084 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:17:48.425501 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:17:48.461647 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 23:17:48.463279 (Thread-1): finished collecting timing info
2021-01-25 23:17:48.464502 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:17:48.464961 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  built_surface is not null
  and premises_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 23:17:48.465184 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:17:48.465388 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:17:48.583248 (Thread-1): Connected to db: None
2021-01-25 23:17:50.506734 (Thread-1): SQL status: OK in 2.04 seconds
2021-01-25 23:17:50.515659 (Thread-1): finished collecting timing info
2021-01-25 23:17:50.516188 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: ROLLBACK
2021-01-25 23:17:50.516357 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: Close
2021-01-25 23:17:50.518101 (Thread-1): 00:17:50 | 25 of 26 PASS stg__land_values_built_surface_implies_premises_code... [PASS in 2.09s]
2021-01-25 23:17:50.518442 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:17:50.518815 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:17:50.519343 (Thread-1): 00:17:50 | 26 of 26 START test stg__land_values_land_surface_implies_crop_code.. [RUN]
2021-01-25 23:17:50.520048 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:17:50.520431 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:17:50.558824 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 23:17:50.559490 (Thread-1): finished collecting timing info
2021-01-25 23:17:50.560115 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:17:50.560373 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  land_surface is not null
  and crop_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 23:17:50.560653 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:17:50.560917 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:17:50.684161 (Thread-1): Connected to db: None
2021-01-25 23:17:52.565787 (Thread-1): SQL status: OK in 2.01 seconds
2021-01-25 23:17:52.576635 (Thread-1): finished collecting timing info
2021-01-25 23:17:52.577403 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: ROLLBACK
2021-01-25 23:17:52.578609 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: Close
2021-01-25 23:17:52.580698 (Thread-1): 00:17:52 | 26 of 26 PASS stg__land_values_land_surface_implies_crop_code........ [PASS in 2.06s]
2021-01-25 23:17:52.586585 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:17:52.680450 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:17:52.681730 (MainThread): 00:17:52 | 
2021-01-25 23:17:52.682485 (MainThread): 00:17:52 | Finished running 26 tests in 194.08s.
2021-01-25 23:17:52.683169 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:17:52.683680 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:17:52.684165 (MainThread): Connection 'test.subsurface.stg__land_values_land_surface_implies_crop_code' was properly closed.
2021-01-25 23:17:52.803226 (MainThread): 
2021-01-25 23:17:52.803737 (MainThread): Completed successfully
2021-01-25 23:17:52.804085 (MainThread): 
Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
2021-01-25 23:17:52.804579 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d341d59b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3413dc18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d341d28d0>]}
2021-01-25 23:17:52.805073 (MainThread): Flushing usage events
2021-01-25 23:21:49.602567 (MainThread): Running with dbt=0.18.1
2021-01-25 23:21:49.742422 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['d_crop_types+'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 23:21:49.743963 (MainThread): Tracking: tracking
2021-01-25 23:21:49.753201 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7912a358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd76983e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd76983ef0>]}
2021-01-25 23:21:49.810860 (MainThread): Partial parsing not enabled
2021-01-25 23:21:49.812558 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:21:49.818851 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:21:49.822588 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:21:49.826842 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:21:49.851874 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:21:49.856410 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:21:49.902184 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:21:49.904729 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:21:49.910630 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:21:49.911134 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:21:49.916748 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:21:49.935341 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:21:49.953691 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:21:49.962200 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:21:49.977283 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:21:49.988312 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:21:50.016587 (MainThread): Parsing macros/core.sql
2021-01-25 23:21:50.024139 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:21:50.103672 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:21:50.120780 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:21:50.124411 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:21:50.126885 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:21:50.129084 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:21:50.133293 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:21:50.136998 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:21:50.154790 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:21:50.158660 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:21:50.170750 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:21:50.223362 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:21:50.256019 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:21:50.259748 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:21:50.269686 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:21:50.281652 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:21:50.307675 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:21:50.320730 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:21:50.359810 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:21:50.363902 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:21:50.367256 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:21:50.371264 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:21:50.386286 (MainThread): Partial parsing not enabled
2021-01-25 23:21:50.501395 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:21:50.547215 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:21:50.569338 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:21:50.591298 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:21:50.615779 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:21:50.638131 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:21:50.673685 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:21:50.694491 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:21:52.655635 (MainThread): Found 6 models, 50 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:21:52.661878 (MainThread): 
2021-01-25 23:21:52.662638 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:21:52.800525 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:21:52.822549 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:21:52.822861 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:21:52.823074 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 23:21:52.823272 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:21:52.953303 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:21:53.156476 (ThreadPoolExecutor-1_0): SQL status: OK in 0.33 seconds
2021-01-25 23:21:53.199025 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:21:53.200071 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:21:53.203941 (MainThread): 00:21:53 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:21:53.205607 (MainThread): 00:21:53 | 
2021-01-25 23:21:53.221260 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:21:53.221746 (Thread-1): 00:21:53 | 1 of 3 START test not_null_d_crop_types_crop_code.................... [RUN]
2021-01-25 23:21:53.222587 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-25 23:21:53.223013 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:21:53.287325 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-25 23:21:53.290501 (Thread-1): finished collecting timing info
2021-01-25 23:21:53.292425 (Thread-1): Using dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-25 23:21:53.293306 (Thread-1): On test.subsurface.not_null_d_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."d_crop_types"
where crop_code is null



2021-01-25 23:21:53.294265 (Thread-1): Opening a new connection, currently in state init
2021-01-25 23:21:53.295307 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:21:53.409289 (Thread-1): Connected to db: None
2021-01-25 23:21:53.560955 (Thread-1): SQL status: OK in 0.27 seconds
2021-01-25 23:21:53.569833 (Thread-1): finished collecting timing info
2021-01-25 23:21:53.570546 (Thread-1): On test.subsurface.not_null_d_crop_types_crop_code: ROLLBACK
2021-01-25 23:21:53.571578 (Thread-1): On test.subsurface.not_null_d_crop_types_crop_code: Close
2021-01-25 23:21:53.574505 (Thread-1): 00:21:53 | 1 of 3 PASS not_null_d_crop_types_crop_code.......................... [PASS in 0.35s]
2021-01-25 23:21:53.576753 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:21:53.578027 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:21:53.578911 (Thread-1): 00:21:53 | 2 of 3 START test relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_ [RUN]
2021-01-25 23:21:53.580211 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:21:53.581348 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:21:53.615355 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-25 23:21:53.616043 (Thread-1): finished collecting timing info
2021-01-25 23:21:53.616703 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:21:53.616969 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: 
    
    




select count(*) as validation_errors
from (
    select crop_code as id from "@fab4"."f_land_values"
) as child
left join (
    select crop_code as id from "@fab4"."d_crop_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:21:53.617206 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:21:53.617449 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:21:53.732961 (Thread-1): Connected to db: None
2021-01-25 23:22:04.104813 (Thread-1): SQL status: OK in 10.49 seconds
2021-01-25 23:22:04.118025 (Thread-1): finished collecting timing info
2021-01-25 23:22:04.118727 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: ROLLBACK
2021-01-25 23:22:04.119072 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: Close
2021-01-25 23:22:04.120420 (Thread-1): 00:22:04 | 2 of 3 PASS relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_ [PASS in 10.54s]
2021-01-25 23:22:04.120827 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:22:04.121219 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:22:04.121780 (Thread-1): 00:22:04 | 3 of 3 START test unique_d_crop_types_crop_code...................... [RUN]
2021-01-25 23:22:04.122542 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-25 23:22:04.122924 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:22:04.161980 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-25 23:22:04.163398 (Thread-1): finished collecting timing info
2021-01-25 23:22:04.164877 (Thread-1): Using dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-25 23:22:04.165995 (Thread-1): On test.subsurface.unique_d_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from (

    select
        crop_code

    from "@fab4"."d_crop_types"
    where crop_code is not null
    group by crop_code
    having count(*) > 1

) validation_errors



2021-01-25 23:22:04.167121 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:22:04.168043 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:22:04.289760 (Thread-1): Connected to db: None
2021-01-25 23:22:04.501533 (Thread-1): SQL status: OK in 0.33 seconds
2021-01-25 23:22:04.511067 (Thread-1): finished collecting timing info
2021-01-25 23:22:04.512170 (Thread-1): On test.subsurface.unique_d_crop_types_crop_code: ROLLBACK
2021-01-25 23:22:04.512981 (Thread-1): On test.subsurface.unique_d_crop_types_crop_code: Close
2021-01-25 23:22:04.514806 (Thread-1): 00:22:04 | 3 of 3 PASS unique_d_crop_types_crop_code............................ [PASS in 0.39s]
2021-01-25 23:22:04.515937 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:22:04.549685 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:22:04.550865 (MainThread): 00:22:04 | 
2021-01-25 23:22:04.551481 (MainThread): 00:22:04 | Finished running 3 tests in 11.89s.
2021-01-25 23:22:04.552082 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:22:04.552549 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:22:04.553128 (MainThread): Connection 'test.subsurface.unique_d_crop_types_crop_code' was properly closed.
2021-01-25 23:22:04.569935 (MainThread): 
2021-01-25 23:22:04.570378 (MainThread): Completed successfully
2021-01-25 23:22:04.570720 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-25 23:22:04.571195 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd767ef1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd76981a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd76872dd8>]}
2021-01-25 23:22:04.571740 (MainThread): Flushing usage events
2021-01-25 23:22:13.007916 (MainThread): Running with dbt=0.18.1
2021-01-25 23:22:13.128206 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['d_premises_types'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 23:22:13.131067 (MainThread): Tracking: tracking
2021-01-25 23:22:13.140767 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ce7e55f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ce28cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ce28cf60>]}
2021-01-25 23:22:13.199941 (MainThread): Partial parsing not enabled
2021-01-25 23:22:13.202076 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:22:13.207239 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:22:13.210740 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:22:13.214964 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:22:13.239767 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:22:13.244391 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:22:13.290756 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:22:13.293371 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:22:13.299169 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:22:13.299678 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:22:13.305239 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:22:13.323529 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:22:13.340737 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:22:13.349928 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:22:13.364820 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:22:13.375962 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:22:13.404547 (MainThread): Parsing macros/core.sql
2021-01-25 23:22:13.411930 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:22:13.490375 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:22:13.507493 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:22:13.511154 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:22:13.513578 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:22:13.515796 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:22:13.520225 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:22:13.523748 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:22:13.541589 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:22:13.545557 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:22:13.557822 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:22:13.610853 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:22:13.643617 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:22:13.647381 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:22:13.657219 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:22:13.669407 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:22:13.696224 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:22:13.709556 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:22:13.748891 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:22:13.753411 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:22:13.756779 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:22:13.760457 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:22:13.775811 (MainThread): Partial parsing not enabled
2021-01-25 23:22:13.891395 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:22:13.936516 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:22:13.959401 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:22:13.981739 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:22:14.006688 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:22:14.028939 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:22:14.065081 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:22:14.085709 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:22:16.069603 (MainThread): Found 6 models, 50 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:22:16.075685 (MainThread): 
2021-01-25 23:22:16.076427 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:22:16.216253 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:22:16.236608 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:22:16.236931 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:22:16.237141 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 23:22:16.237328 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:22:16.369237 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:22:16.587955 (ThreadPoolExecutor-1_0): SQL status: OK in 0.35 seconds
2021-01-25 23:22:16.635909 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:22:16.636834 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:22:16.641093 (MainThread): 00:22:16 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:22:16.641502 (MainThread): 00:22:16 | 
2021-01-25 23:22:16.654471 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:22:16.655664 (Thread-1): 00:22:16 | 1 of 3 START test not_null_d_premises_types_premises_code............ [RUN]
2021-01-25 23:22:16.660343 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-25 23:22:16.662674 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:22:16.708266 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-25 23:22:16.708880 (Thread-1): finished collecting timing info
2021-01-25 23:22:16.709571 (Thread-1): Using dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-25 23:22:16.709842 (Thread-1): On test.subsurface.not_null_d_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."d_premises_types"
where premises_code is null



2021-01-25 23:22:16.710070 (Thread-1): Opening a new connection, currently in state init
2021-01-25 23:22:16.710287 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:22:16.830563 (Thread-1): Connected to db: None
2021-01-25 23:22:17.045331 (Thread-1): SQL status: OK in 0.34 seconds
2021-01-25 23:22:17.053732 (Thread-1): finished collecting timing info
2021-01-25 23:22:17.054573 (Thread-1): On test.subsurface.not_null_d_premises_types_premises_code: ROLLBACK
2021-01-25 23:22:17.054977 (Thread-1): On test.subsurface.not_null_d_premises_types_premises_code: Close
2021-01-25 23:22:17.056460 (Thread-1): 00:22:17 | 1 of 3 PASS not_null_d_premises_types_premises_code.................. [PASS in 0.40s]
2021-01-25 23:22:17.056982 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:22:17.057456 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:22:17.058731 (Thread-1): 00:22:17 | 2 of 3 START test relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_ [RUN]
2021-01-25 23:22:17.059575 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:22:17.059997 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:22:17.094730 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-25 23:22:17.095529 (Thread-1): finished collecting timing info
2021-01-25 23:22:17.096212 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:22:17.096487 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: 
    
    




select count(*) as validation_errors
from (
    select premises_code as id from "@fab4"."f_land_values"
) as child
left join (
    select premises_code as id from "@fab4"."d_premises_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:22:17.096741 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:22:17.096970 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:22:17.211604 (Thread-1): Connected to db: None
2021-01-25 23:22:27.940427 (Thread-1): SQL status: OK in 10.84 seconds
2021-01-25 23:22:27.948745 (Thread-1): finished collecting timing info
2021-01-25 23:22:27.949355 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: ROLLBACK
2021-01-25 23:22:27.949525 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: Close
2021-01-25 23:22:27.951349 (Thread-1): 00:22:27 | 2 of 3 PASS relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_ [PASS in 10.89s]
2021-01-25 23:22:27.951690 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:22:27.952071 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:22:27.952629 (Thread-1): 00:22:27 | 3 of 3 START test unique_d_premises_types_premises_code.............. [RUN]
2021-01-25 23:22:27.953388 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-25 23:22:27.953756 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:22:27.980503 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-25 23:22:27.981272 (Thread-1): finished collecting timing info
2021-01-25 23:22:27.981969 (Thread-1): Using dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-25 23:22:27.982253 (Thread-1): On test.subsurface.unique_d_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from (

    select
        premises_code

    from "@fab4"."d_premises_types"
    where premises_code is not null
    group by premises_code
    having count(*) > 1

) validation_errors



2021-01-25 23:22:27.982512 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:22:27.982725 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:22:28.103036 (Thread-1): Connected to db: None
2021-01-25 23:22:28.326832 (Thread-1): SQL status: OK in 0.34 seconds
2021-01-25 23:22:28.338680 (Thread-1): finished collecting timing info
2021-01-25 23:22:28.339368 (Thread-1): On test.subsurface.unique_d_premises_types_premises_code: ROLLBACK
2021-01-25 23:22:28.339591 (Thread-1): On test.subsurface.unique_d_premises_types_premises_code: Close
2021-01-25 23:22:28.341054 (Thread-1): 00:22:28 | 3 of 3 PASS unique_d_premises_types_premises_code.................... [PASS in 0.39s]
2021-01-25 23:22:28.341532 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:22:28.380249 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:22:28.381456 (MainThread): 00:22:28 | 
2021-01-25 23:22:28.382014 (MainThread): 00:22:28 | Finished running 3 tests in 12.31s.
2021-01-25 23:22:28.382592 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:22:28.383003 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:22:28.383462 (MainThread): Connection 'test.subsurface.unique_d_premises_types_premises_code' was properly closed.
2021-01-25 23:22:28.407499 (MainThread): 
2021-01-25 23:22:28.408162 (MainThread): Completed successfully
2021-01-25 23:22:28.408703 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-25 23:22:28.409302 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ce0ec860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ce03a9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ce03a9b0>]}
2021-01-25 23:22:28.410545 (MainThread): Flushing usage events
2021-01-25 23:22:49.342046 (MainThread): Running with dbt=0.18.1
2021-01-25 23:22:49.466533 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['municipalities'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 23:22:49.468082 (MainThread): Tracking: tracking
2021-01-25 23:22:49.477260 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d900c42e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d9004cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d9004cf60>]}
2021-01-25 23:22:49.535293 (MainThread): Partial parsing not enabled
2021-01-25 23:22:49.536942 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:22:49.542859 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:22:49.546369 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:22:49.550753 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:22:49.575954 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:22:49.580659 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:22:49.627653 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:22:49.630202 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:22:49.636219 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:22:49.636738 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:22:49.642411 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:22:49.661161 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:22:49.678652 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:22:49.687262 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:22:49.702712 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:22:49.713937 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:22:49.742584 (MainThread): Parsing macros/core.sql
2021-01-25 23:22:49.750257 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:22:49.829579 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:22:49.846630 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:22:49.850387 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:22:49.852811 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:22:49.855078 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:22:49.859339 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:22:49.863383 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:22:49.881069 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:22:49.885065 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:22:49.897842 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:22:49.952552 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:22:49.985544 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:22:49.989338 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:22:49.999634 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:22:50.011903 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:22:50.038791 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:22:50.052092 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:22:50.091774 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:22:50.096188 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:22:50.099590 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:22:50.103331 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:22:50.118447 (MainThread): Partial parsing not enabled
2021-01-25 23:22:50.235085 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:22:50.279491 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:22:50.301433 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:22:50.323363 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:22:50.347703 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:22:50.369968 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:22:50.405709 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:22:50.426482 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:22:52.412083 (MainThread): Found 6 models, 50 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:22:52.413412 (MainThread): The selector 'municipalities' does not match any nodes and will be ignored
2021-01-25 23:22:52.418609 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-01-25 23:22:52.419100 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8fc2c0b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8fc2c898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8fc2ccf8>]}
2021-01-25 23:22:52.419510 (MainThread): Flushing usage events
2021-01-25 23:22:52.905180 (MainThread): Connection 'test.subsurface.stg__land_values_built_surface_implies_premises_code' was properly closed.
2021-01-25 23:22:59.475525 (MainThread): Running with dbt=0.18.1
2021-01-25 23:22:59.596685 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['d_municipalities'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 23:22:59.598220 (MainThread): Tracking: tracking
2021-01-25 23:22:59.607330 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4be85f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4b91ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4b91cef0>]}
2021-01-25 23:22:59.665237 (MainThread): Partial parsing not enabled
2021-01-25 23:22:59.666903 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:22:59.672881 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:22:59.676393 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:22:59.680629 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:22:59.706499 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:22:59.711172 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:22:59.757344 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:22:59.760041 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:22:59.765963 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:22:59.766545 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:22:59.772054 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:22:59.790456 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:22:59.807720 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:22:59.816186 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:22:59.831096 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:22:59.842085 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:22:59.870169 (MainThread): Parsing macros/core.sql
2021-01-25 23:22:59.877606 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:22:59.957836 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:22:59.974912 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:22:59.978584 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:22:59.981000 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:22:59.983203 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:22:59.987460 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:22:59.991160 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:23:00.009017 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:23:00.013022 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:23:00.025142 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:23:00.077208 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:23:00.109419 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:23:00.113095 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:23:00.122843 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:23:00.135085 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:23:00.161861 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:23:00.174964 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:23:00.215266 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:23:00.219375 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:23:00.222816 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:23:00.226562 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:23:00.241632 (MainThread): Partial parsing not enabled
2021-01-25 23:23:00.357713 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:23:00.402531 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:23:00.424805 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:23:00.446709 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:23:00.470919 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:23:00.493012 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:23:00.530280 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:23:00.551371 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:23:02.529372 (MainThread): Found 6 models, 50 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:23:02.535494 (MainThread): 
2021-01-25 23:23:02.536242 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:23:02.677147 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:23:02.697314 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:23:02.697583 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:23:02.697748 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 23:23:02.697923 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:23:02.828319 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:23:03.024421 (ThreadPoolExecutor-1_0): SQL status: OK in 0.33 seconds
2021-01-25 23:23:03.067747 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:23:03.068984 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:23:03.073881 (MainThread): 00:23:03 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:23:03.077189 (MainThread): 00:23:03 | 
2021-01-25 23:23:03.091497 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:23:03.091954 (Thread-1): 00:23:03 | 1 of 3 START test not_null_d_municipalities_municipality_code........ [RUN]
2021-01-25 23:23:03.093371 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-25 23:23:03.093731 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:23:03.163984 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-25 23:23:03.165348 (Thread-1): finished collecting timing info
2021-01-25 23:23:03.166696 (Thread-1): Using dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-25 23:23:03.167633 (Thread-1): On test.subsurface.not_null_d_municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."d_municipalities"
where municipality_code is null



2021-01-25 23:23:03.168625 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:23:03.169632 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:23:03.284879 (Thread-1): Connected to db: None
2021-01-25 23:23:03.463712 (Thread-1): SQL status: OK in 0.30 seconds
2021-01-25 23:23:03.476104 (Thread-1): finished collecting timing info
2021-01-25 23:23:03.476770 (Thread-1): On test.subsurface.not_null_d_municipalities_municipality_code: ROLLBACK
2021-01-25 23:23:03.477112 (Thread-1): On test.subsurface.not_null_d_municipalities_municipality_code: Close
2021-01-25 23:23:03.478880 (Thread-1): 00:23:03 | 1 of 3 PASS not_null_d_municipalities_municipality_code.............. [PASS in 0.39s]
2021-01-25 23:23:03.481612 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:23:03.482262 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:23:03.482831 (Thread-1): 00:23:03 | 2 of 3 START test relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_ [RUN]
2021-01-25 23:23:03.483678 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:23:03.484206 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:23:03.517311 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-25 23:23:03.518176 (Thread-1): finished collecting timing info
2021-01-25 23:23:03.518949 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:23:03.519269 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: 
    
    




select count(*) as validation_errors
from (
    select municipality_code as id from "@fab4"."f_land_values"
) as child
left join (
    select municipality_code as id from "@fab4"."d_municipalities"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:23:03.519517 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:23:03.519764 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:23:03.636367 (Thread-1): Connected to db: None
2021-01-25 23:23:24.349861 (Thread-1): SQL status: OK in 20.83 seconds
2021-01-25 23:23:24.361296 (Thread-1): finished collecting timing info
2021-01-25 23:23:24.361977 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: ROLLBACK
2021-01-25 23:23:24.362202 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: Close
2021-01-25 23:23:24.363488 (Thread-1): 00:23:24 | 2 of 3 PASS relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_ [PASS in 20.88s]
2021-01-25 23:23:24.363923 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:23:24.364352 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:23:24.364958 (Thread-1): 00:23:24 | 3 of 3 START test unique_d_municipalities_municipality_code.......... [RUN]
2021-01-25 23:23:24.365742 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-25 23:23:24.366147 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:23:24.388880 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-25 23:23:24.389678 (Thread-1): finished collecting timing info
2021-01-25 23:23:24.391461 (Thread-1): Using dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-25 23:23:24.391848 (Thread-1): On test.subsurface.unique_d_municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from (

    select
        municipality_code

    from "@fab4"."d_municipalities"
    where municipality_code is not null
    group by municipality_code
    having count(*) > 1

) validation_errors



2021-01-25 23:23:24.392105 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:23:24.392250 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:23:24.515971 (Thread-1): Connected to db: None
2021-01-25 23:23:24.751936 (Thread-1): SQL status: OK in 0.36 seconds
2021-01-25 23:23:24.760689 (Thread-1): finished collecting timing info
2021-01-25 23:23:24.761230 (Thread-1): On test.subsurface.unique_d_municipalities_municipality_code: ROLLBACK
2021-01-25 23:23:24.761378 (Thread-1): On test.subsurface.unique_d_municipalities_municipality_code: Close
2021-01-25 23:23:24.763590 (Thread-1): 00:23:24 | 3 of 3 PASS unique_d_municipalities_municipality_code................ [PASS in 0.40s]
2021-01-25 23:23:24.764100 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:23:24.844297 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:23:24.845380 (MainThread): 00:23:24 | 
2021-01-25 23:23:24.846244 (MainThread): 00:23:24 | Finished running 3 tests in 22.31s.
2021-01-25 23:23:24.848234 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:23:24.851037 (MainThread): Connection 'test.subsurface.unique_d_municipalities_municipality_code' was properly closed.
2021-01-25 23:23:24.877055 (MainThread): 
2021-01-25 23:23:24.877409 (MainThread): Completed successfully
2021-01-25 23:23:24.877756 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-25 23:23:24.878310 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4b4fe978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4b604550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4b849c88>]}
2021-01-25 23:23:24.878939 (MainThread): Flushing usage events
2021-01-25 23:25:57.507750 (MainThread): Running with dbt=0.18.1
2021-01-25 23:25:57.630934 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg__land_values+'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-25 23:25:57.632789 (MainThread): Tracking: tracking
2021-01-25 23:25:57.641876 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b4fdc2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b4fdcef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b4fdcf60>]}
2021-01-25 23:25:57.700346 (MainThread): Partial parsing not enabled
2021-01-25 23:25:57.701976 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:25:57.708144 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:25:57.712113 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:25:57.716390 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:25:57.740992 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:25:57.745647 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:25:57.791989 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:25:57.794640 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:25:57.800500 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:25:57.801003 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:25:57.806595 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:25:57.825081 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:25:57.842069 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:25:57.850531 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:25:57.865091 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:25:57.875826 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:25:57.903714 (MainThread): Parsing macros/core.sql
2021-01-25 23:25:57.911039 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:25:57.989670 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:25:58.006926 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:25:58.011250 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:25:58.013682 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:25:58.015902 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:25:58.020203 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:25:58.023766 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:25:58.041592 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:25:58.045566 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:25:58.057735 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:25:58.110042 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:25:58.142358 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:25:58.146006 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:25:58.155840 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:25:58.167929 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:25:58.194583 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:25:58.207843 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:25:58.247476 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:25:58.251497 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:25:58.254805 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:25:58.258582 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:25:58.273501 (MainThread): Partial parsing not enabled
2021-01-25 23:25:58.390085 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:25:58.434601 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:25:58.456405 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:25:58.477958 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:25:58.502461 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:25:58.524590 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:25:58.560389 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:25:58.581449 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:26:00.497643 (MainThread): Found 6 models, 48 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:26:00.504701 (MainThread): 
2021-01-25 23:26:00.505464 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:26:00.642718 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:26:00.665814 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:26:00.666082 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:26:00.666253 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 23:26:00.666479 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:00.798842 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:26:01.003842 (ThreadPoolExecutor-1_0): SQL status: OK in 0.34 seconds
2021-01-25 23:26:01.059968 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:26:01.060988 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:26:01.063951 (MainThread): 00:26:01 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:26:01.064316 (MainThread): 00:26:01 | 
2021-01-25 23:26:01.087107 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:26:01.087604 (Thread-1): 00:26:01 | 1 of 24 START test not_null_f_land_values_built_surface.............. [RUN]
2021-01-25 23:26:01.091117 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-25 23:26:01.094594 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:26:01.159281 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-25 23:26:01.160781 (Thread-1): finished collecting timing info
2021-01-25 23:26:01.162336 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-25 23:26:01.163435 (Thread-1): On test.subsurface.not_null_f_land_values_built_surface: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where built_surface is null



2021-01-25 23:26:01.164405 (Thread-1): Opening a new connection, currently in state init
2021-01-25 23:26:01.165386 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:01.286443 (Thread-1): Connected to db: None
2021-01-25 23:26:04.653341 (Thread-1): SQL status: OK in 3.49 seconds
2021-01-25 23:26:04.670783 (Thread-1): finished collecting timing info
2021-01-25 23:26:04.671391 (Thread-1): On test.subsurface.not_null_f_land_values_built_surface: ROLLBACK
2021-01-25 23:26:04.671665 (Thread-1): On test.subsurface.not_null_f_land_values_built_surface: Close
2021-01-25 23:26:04.672880 (Thread-1): 00:26:04 | 1 of 24 PASS not_null_f_land_values_built_surface.................... [PASS in 3.58s]
2021-01-25 23:26:04.673189 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:26:04.673507 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:26:04.674761 (Thread-1): 00:26:04 | 2 of 24 START test not_null_f_land_values_crop_code.................. [RUN]
2021-01-25 23:26:04.675490 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-25 23:26:04.675829 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:26:04.712044 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-25 23:26:04.712900 (Thread-1): finished collecting timing info
2021-01-25 23:26:04.713662 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-25 23:26:04.713984 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where crop_code is null



2021-01-25 23:26:04.716887 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:04.717227 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:04.837433 (Thread-1): Connected to db: None
2021-01-25 23:26:07.461720 (Thread-1): SQL status: OK in 2.74 seconds
2021-01-25 23:26:07.471358 (Thread-1): finished collecting timing info
2021-01-25 23:26:07.472033 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: ROLLBACK
2021-01-25 23:26:07.472348 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: Close
2021-01-25 23:26:07.473580 (Thread-1): 00:26:07 | 2 of 24 PASS not_null_f_land_values_crop_code........................ [PASS in 2.80s]
2021-01-25 23:26:07.473987 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:26:07.474366 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:26:07.474881 (Thread-1): 00:26:07 | 3 of 24 START test not_null_f_land_values_land_surface............... [RUN]
2021-01-25 23:26:07.475617 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-25 23:26:07.475994 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:26:07.499170 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-25 23:26:07.500203 (Thread-1): finished collecting timing info
2021-01-25 23:26:07.501601 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-25 23:26:07.502168 (Thread-1): On test.subsurface.not_null_f_land_values_land_surface: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where land_surface is null



2021-01-25 23:26:07.502613 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:07.503131 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:07.617480 (Thread-1): Connected to db: None
2021-01-25 23:26:11.159337 (Thread-1): SQL status: OK in 3.66 seconds
2021-01-25 23:26:11.172193 (Thread-1): finished collecting timing info
2021-01-25 23:26:11.172893 (Thread-1): On test.subsurface.not_null_f_land_values_land_surface: ROLLBACK
2021-01-25 23:26:11.173183 (Thread-1): On test.subsurface.not_null_f_land_values_land_surface: Close
2021-01-25 23:26:11.174816 (Thread-1): 00:26:11 | 3 of 24 PASS not_null_f_land_values_land_surface..................... [PASS in 3.70s]
2021-01-25 23:26:11.175124 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:26:11.175468 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:26:11.175964 (Thread-1): 00:26:11 | 4 of 24 START test not_null_f_land_values_lane....................... [RUN]
2021-01-25 23:26:11.176687 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-25 23:26:11.177138 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-25 23:26:11.206867 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-25 23:26:11.207633 (Thread-1): finished collecting timing info
2021-01-25 23:26:11.209388 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-25 23:26:11.210180 (Thread-1): On test.subsurface.not_null_f_land_values_lane: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane is null



2021-01-25 23:26:11.210571 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:11.210964 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:11.323027 (Thread-1): Connected to db: None
2021-01-25 23:26:14.498879 (Thread-1): SQL status: OK in 3.29 seconds
2021-01-25 23:26:14.509903 (Thread-1): finished collecting timing info
2021-01-25 23:26:14.510482 (Thread-1): On test.subsurface.not_null_f_land_values_lane: ROLLBACK
2021-01-25 23:26:14.510756 (Thread-1): On test.subsurface.not_null_f_land_values_lane: Close
2021-01-25 23:26:14.512049 (Thread-1): 00:26:14 | 4 of 24 PASS not_null_f_land_values_lane............................. [PASS in 3.34s]
2021-01-25 23:26:14.512400 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:26:14.512752 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:26:14.513329 (Thread-1): 00:26:14 | 5 of 24 START test not_null_f_land_values_lane_code.................. [RUN]
2021-01-25 23:26:14.514173 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-25 23:26:14.514602 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:26:14.548927 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-25 23:26:14.550335 (Thread-1): finished collecting timing info
2021-01-25 23:26:14.551652 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-25 23:26:14.552568 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane_code is null



2021-01-25 23:26:14.552875 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:14.553055 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:14.669709 (Thread-1): Connected to db: None
2021-01-25 23:26:22.888236 (Thread-1): SQL status: OK in 8.34 seconds
2021-01-25 23:26:22.907631 (Thread-1): finished collecting timing info
2021-01-25 23:26:22.908299 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: ROLLBACK
2021-01-25 23:26:22.908537 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: Close
2021-01-25 23:26:22.909883 (Thread-1): 00:26:22 | 5 of 24 PASS not_null_f_land_values_lane_code........................ [PASS in 8.40s]
2021-01-25 23:26:22.910282 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:26:22.910728 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:26:22.911314 (Thread-1): 00:26:22 | 6 of 24 START test not_null_f_land_values_lane_type.................. [RUN]
2021-01-25 23:26:22.912045 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-25 23:26:22.912426 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:26:22.945974 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-25 23:26:22.946737 (Thread-1): finished collecting timing info
2021-01-25 23:26:22.947548 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-25 23:26:22.947817 (Thread-1): On test.subsurface.not_null_f_land_values_lane_type: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane_type is null



2021-01-25 23:26:22.948028 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:22.948226 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:23.061815 (Thread-1): Connected to db: None
2021-01-25 23:26:25.833593 (Thread-1): SQL status: OK in 2.89 seconds
2021-01-25 23:26:25.847718 (Thread-1): finished collecting timing info
2021-01-25 23:26:25.848335 (Thread-1): On test.subsurface.not_null_f_land_values_lane_type: ROLLBACK
2021-01-25 23:26:25.848550 (Thread-1): On test.subsurface.not_null_f_land_values_lane_type: Close
2021-01-25 23:26:25.851271 (Thread-1): 00:26:25 | 6 of 24 PASS not_null_f_land_values_lane_type........................ [PASS in 2.94s]
2021-01-25 23:26:25.852713 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:26:25.853925 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:26:25.854652 (Thread-1): 00:26:25 | 7 of 24 START test not_null_f_land_values_lots_count................. [RUN]
2021-01-25 23:26:25.856801 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-25 23:26:25.857930 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:26:25.877718 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-25 23:26:25.878441 (Thread-1): finished collecting timing info
2021-01-25 23:26:25.879083 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-25 23:26:25.879267 (Thread-1): On test.subsurface.not_null_f_land_values_lots_count: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lots_count is null



2021-01-25 23:26:25.879414 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:25.879553 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:26.002416 (Thread-1): Connected to db: None
2021-01-25 23:26:29.716201 (Thread-1): SQL status: OK in 3.84 seconds
2021-01-25 23:26:29.726950 (Thread-1): finished collecting timing info
2021-01-25 23:26:29.727552 (Thread-1): On test.subsurface.not_null_f_land_values_lots_count: ROLLBACK
2021-01-25 23:26:29.727732 (Thread-1): On test.subsurface.not_null_f_land_values_lots_count: Close
2021-01-25 23:26:29.729890 (Thread-1): 00:26:29 | 7 of 24 PASS not_null_f_land_values_lots_count....................... [PASS in 3.87s]
2021-01-25 23:26:29.731036 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:26:29.731378 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:26:29.732492 (Thread-1): 00:26:29 | 8 of 24 START test not_null_f_land_values_main_rooms_count........... [RUN]
2021-01-25 23:26:29.733897 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-25 23:26:29.734214 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:26:29.829066 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-25 23:26:29.829804 (Thread-1): finished collecting timing info
2021-01-25 23:26:29.830462 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-25 23:26:29.830734 (Thread-1): On test.subsurface.not_null_f_land_values_main_rooms_count: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where main_rooms_count is null



2021-01-25 23:26:29.831106 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:29.831327 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:29.948264 (Thread-1): Connected to db: None
2021-01-25 23:26:33.107396 (Thread-1): SQL status: OK in 3.28 seconds
2021-01-25 23:26:33.116415 (Thread-1): finished collecting timing info
2021-01-25 23:26:33.117023 (Thread-1): On test.subsurface.not_null_f_land_values_main_rooms_count: ROLLBACK
2021-01-25 23:26:33.117225 (Thread-1): On test.subsurface.not_null_f_land_values_main_rooms_count: Close
2021-01-25 23:26:33.119513 (Thread-1): 00:26:33 | 8 of 24 PASS not_null_f_land_values_main_rooms_count................. [PASS in 3.39s]
2021-01-25 23:26:33.119949 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:26:33.120374 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:26:33.120806 (Thread-1): 00:26:33 | 9 of 24 START test not_null_f_land_values_municipality_code.......... [RUN]
2021-01-25 23:26:33.121506 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-25 23:26:33.121879 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:26:33.161467 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-25 23:26:33.162250 (Thread-1): finished collecting timing info
2021-01-25 23:26:33.163023 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-25 23:26:33.163224 (Thread-1): On test.subsurface.not_null_f_land_values_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where municipality_code is null



2021-01-25 23:26:33.163339 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:33.163444 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:33.274616 (Thread-1): Connected to db: None
2021-01-25 23:26:47.968258 (Thread-1): SQL status: OK in 14.80 seconds
2021-01-25 23:26:47.978554 (Thread-1): finished collecting timing info
2021-01-25 23:26:47.979198 (Thread-1): On test.subsurface.not_null_f_land_values_municipality_code: ROLLBACK
2021-01-25 23:26:47.979490 (Thread-1): On test.subsurface.not_null_f_land_values_municipality_code: Close
2021-01-25 23:26:47.980972 (Thread-1): 00:26:47 | 9 of 24 PASS not_null_f_land_values_municipality_code................ [PASS in 14.86s]
2021-01-25 23:26:47.981387 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:26:47.981794 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:26:47.982450 (Thread-1): 00:26:47 | 10 of 24 START test not_null_f_land_values_premises_code............. [RUN]
2021-01-25 23:26:47.983660 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-25 23:26:47.983969 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:26:48.011296 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-25 23:26:48.012487 (Thread-1): finished collecting timing info
2021-01-25 23:26:48.013338 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-25 23:26:48.013616 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where premises_code is null



2021-01-25 23:26:48.013831 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:48.014187 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:48.128596 (Thread-1): Connected to db: None
2021-01-25 23:26:50.819903 (Thread-1): SQL status: OK in 2.81 seconds
2021-01-25 23:26:50.827591 (Thread-1): finished collecting timing info
2021-01-25 23:26:50.828241 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: ROLLBACK
2021-01-25 23:26:50.828548 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: Close
2021-01-25 23:26:50.829849 (Thread-1): 00:26:50 | 10 of 24 PASS not_null_f_land_values_premises_code................... [PASS in 2.85s]
2021-01-25 23:26:50.830210 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:26:50.830633 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:26:50.831237 (Thread-1): 00:26:50 | 11 of 24 START test not_null_f_land_values_transaction_amount........ [RUN]
2021-01-25 23:26:50.832019 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-25 23:26:50.832390 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:26:50.858741 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-25 23:26:50.861443 (Thread-1): finished collecting timing info
2021-01-25 23:26:50.862687 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-25 23:26:50.863012 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_amount: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transaction_amount is null



2021-01-25 23:26:50.863218 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:50.863378 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:50.978270 (Thread-1): Connected to db: None
2021-01-25 23:26:56.381907 (Thread-1): SQL status: OK in 5.52 seconds
2021-01-25 23:26:56.389305 (Thread-1): finished collecting timing info
2021-01-25 23:26:56.389858 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_amount: ROLLBACK
2021-01-25 23:26:56.390109 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_amount: Close
2021-01-25 23:26:56.391355 (Thread-1): 00:26:56 | 11 of 24 PASS not_null_f_land_values_transaction_amount.............. [PASS in 5.56s]
2021-01-25 23:26:56.391716 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:26:56.392092 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:26:56.392766 (Thread-1): 00:26:56 | 12 of 24 START test not_null_f_land_values_transaction_date.......... [RUN]
2021-01-25 23:26:56.393594 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-25 23:26:56.393979 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:26:56.421517 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-25 23:26:56.423343 (Thread-1): finished collecting timing info
2021-01-25 23:26:56.424006 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-25 23:26:56.424272 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transaction_date is null



2021-01-25 23:26:56.424485 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:26:56.424728 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:26:56.546687 (Thread-1): Connected to db: None
2021-01-25 23:27:12.494779 (Thread-1): SQL status: OK in 16.07 seconds
2021-01-25 23:27:12.508239 (Thread-1): finished collecting timing info
2021-01-25 23:27:12.508769 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: ROLLBACK
2021-01-25 23:27:12.508914 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: Close
2021-01-25 23:27:12.510767 (Thread-1): 00:27:12 | 12 of 24 PASS not_null_f_land_values_transaction_date................ [PASS in 16.12s]
2021-01-25 23:27:12.511212 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:27:12.511599 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:27:12.512004 (Thread-1): 00:27:12 | 13 of 24 START test not_null_f_land_values_transfer_label............ [RUN]
2021-01-25 23:27:12.512739 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-25 23:27:12.514643 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:27:12.543627 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-25 23:27:12.544998 (Thread-1): finished collecting timing info
2021-01-25 23:27:12.545834 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-25 23:27:12.546103 (Thread-1): On test.subsurface.not_null_f_land_values_transfer_label: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transfer_label is null



2021-01-25 23:27:12.546333 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:27:12.546561 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:27:12.664561 (Thread-1): Connected to db: None
2021-01-25 23:27:13.010995 (Thread-1): SQL status: OK in 0.46 seconds
2021-01-25 23:27:13.025951 (Thread-1): finished collecting timing info
2021-01-25 23:27:13.026736 (Thread-1): On test.subsurface.not_null_f_land_values_transfer_label: ROLLBACK
2021-01-25 23:27:13.027078 (Thread-1): On test.subsurface.not_null_f_land_values_transfer_label: Close
2021-01-25 23:27:13.028641 (Thread-1): 00:27:13 | 13 of 24 PASS not_null_f_land_values_transfer_label.................. [PASS in 0.52s]
2021-01-25 23:27:13.029326 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:27:13.029783 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:27:13.030414 (Thread-1): 00:27:13 | 14 of 24 START test not_null_f_land_values_zip_code.................. [RUN]
2021-01-25 23:27:13.031225 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-25 23:27:13.031634 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:27:13.071602 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-25 23:27:13.073042 (Thread-1): finished collecting timing info
2021-01-25 23:27:13.074377 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-25 23:27:13.075300 (Thread-1): On test.subsurface.not_null_f_land_values_zip_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where zip_code is null



2021-01-25 23:27:13.076674 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:27:13.081617 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:27:13.203398 (Thread-1): Connected to db: None
2021-01-25 23:27:22.497384 (Thread-1): SQL status: OK in 9.42 seconds
2021-01-25 23:27:22.504379 (Thread-1): finished collecting timing info
2021-01-25 23:27:22.504982 (Thread-1): On test.subsurface.not_null_f_land_values_zip_code: ROLLBACK
2021-01-25 23:27:22.505150 (Thread-1): On test.subsurface.not_null_f_land_values_zip_code: Close
2021-01-25 23:27:22.506982 (Thread-1): 00:27:22 | 14 of 24 PASS not_null_f_land_values_zip_code........................ [PASS in 9.48s]
2021-01-25 23:27:22.507388 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:27:22.507731 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:27:22.508281 (Thread-1): 00:27:22 | 15 of 24 START test not_null_stg__land_values_lots_count............. [RUN]
2021-01-25 23:27:22.508997 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:27:22.509338 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:27:22.537109 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 23:27:22.538070 (Thread-1): finished collecting timing info
2021-01-25 23:27:22.538855 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:27:22.539138 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where lots_count is null



2021-01-25 23:27:22.539385 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:27:22.539631 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:27:22.664598 (Thread-1): Connected to db: None
2021-01-25 23:27:25.063547 (Thread-1): SQL status: OK in 2.52 seconds
2021-01-25 23:27:25.077661 (Thread-1): finished collecting timing info
2021-01-25 23:27:25.078276 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: ROLLBACK
2021-01-25 23:27:25.078532 (Thread-1): On test.subsurface.not_null_stg__land_values_lots_count: Close
2021-01-25 23:27:25.079802 (Thread-1): 00:27:25 | 15 of 24 PASS not_null_stg__land_values_lots_count................... [PASS in 2.57s]
2021-01-25 23:27:25.080190 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:27:25.080552 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:27:25.081100 (Thread-1): 00:27:25 | 16 of 24 START test not_null_stg__land_values_municipality_code...... [RUN]
2021-01-25 23:27:25.081950 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:27:25.082297 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:27:25.115669 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 23:27:25.116528 (Thread-1): finished collecting timing info
2021-01-25 23:27:25.117396 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:27:25.117685 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where municipality_code is null



2021-01-25 23:27:25.117939 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:27:25.118153 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:27:25.241816 (Thread-1): Connected to db: None
2021-01-25 23:27:39.145995 (Thread-1): SQL status: OK in 14.03 seconds
2021-01-25 23:27:39.164239 (Thread-1): finished collecting timing info
2021-01-25 23:27:39.164791 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: ROLLBACK
2021-01-25 23:27:39.165036 (Thread-1): On test.subsurface.not_null_stg__land_values_municipality_code: Close
2021-01-25 23:27:39.167838 (Thread-1): 00:27:39 | 16 of 24 PASS not_null_stg__land_values_municipality_code............ [PASS in 14.09s]
2021-01-25 23:27:39.169520 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:27:39.174645 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:27:39.175400 (Thread-1): 00:27:39 | 17 of 24 START test not_null_stg__land_values_transaction_date....... [RUN]
2021-01-25 23:27:39.176264 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:27:39.176901 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:27:39.291682 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 23:27:39.293766 (Thread-1): finished collecting timing info
2021-01-25 23:27:39.294548 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:27:39.294833 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transaction_date is null



2021-01-25 23:27:39.295014 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:27:39.295187 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:27:39.435769 (Thread-1): Connected to db: None
2021-01-25 23:27:54.597426 (Thread-1): SQL status: OK in 15.30 seconds
2021-01-25 23:27:54.606673 (Thread-1): finished collecting timing info
2021-01-25 23:27:54.607314 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: ROLLBACK
2021-01-25 23:27:54.607467 (Thread-1): On test.subsurface.not_null_stg__land_values_transaction_date: Close
2021-01-25 23:27:54.608615 (Thread-1): 00:27:54 | 17 of 24 PASS not_null_stg__land_values_transaction_date............. [PASS in 15.43s]
2021-01-25 23:27:54.609650 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:27:54.610093 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:27:54.610704 (Thread-1): 00:27:54 | 18 of 24 START test not_null_stg__land_values_transfer_label_fr...... [RUN]
2021-01-25 23:27:54.611458 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:27:54.611832 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:27:54.647362 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 23:27:54.648978 (Thread-1): finished collecting timing info
2021-01-25 23:27:54.650450 (Thread-1): Using dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:27:54.651317 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transfer_label_fr is null



2021-01-25 23:27:54.651591 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:27:54.651767 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:27:54.765917 (Thread-1): Connected to db: None
2021-01-25 23:27:55.905144 (Thread-1): SQL status: OK in 1.25 seconds
2021-01-25 23:27:55.916250 (Thread-1): finished collecting timing info
2021-01-25 23:27:55.916830 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: ROLLBACK
2021-01-25 23:27:55.916976 (Thread-1): On test.subsurface.not_null_stg__land_values_transfer_label_fr: Close
2021-01-25 23:27:55.918114 (Thread-1): 00:27:55 | 18 of 24 PASS not_null_stg__land_values_transfer_label_fr............ [PASS in 1.31s]
2021-01-25 23:27:55.918443 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:27:55.918781 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:27:55.920775 (Thread-1): 00:27:55 | 19 of 24 START test relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_ [RUN]
2021-01-25 23:27:55.921531 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:27:55.921917 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:27:55.955573 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-25 23:27:55.956285 (Thread-1): finished collecting timing info
2021-01-25 23:27:55.956971 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:27:55.957238 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: 
    
    




select count(*) as validation_errors
from (
    select crop_code as id from "@fab4"."f_land_values"
) as child
left join (
    select crop_code as id from "@fab4"."d_crop_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:27:55.957454 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:27:55.957656 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:27:56.077214 (Thread-1): Connected to db: None
2021-01-25 23:28:08.185492 (Thread-1): SQL status: OK in 12.23 seconds
2021-01-25 23:28:08.206057 (Thread-1): finished collecting timing info
2021-01-25 23:28:08.206882 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: ROLLBACK
2021-01-25 23:28:08.207224 (Thread-1): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: Close
2021-01-25 23:28:08.209339 (Thread-1): 00:28:08 | 19 of 24 PASS relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_ [PASS in 12.29s]
2021-01-25 23:28:08.214220 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:28:08.217368 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:28:08.218780 (Thread-1): 00:28:08 | 20 of 24 START test relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_ [RUN]
2021-01-25 23:28:08.219473 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:28:08.219841 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:28:08.295281 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-25 23:28:08.299628 (Thread-1): finished collecting timing info
2021-01-25 23:28:08.304565 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:28:08.304889 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: 
    
    




select count(*) as validation_errors
from (
    select municipality_code as id from "@fab4"."f_land_values"
) as child
left join (
    select municipality_code as id from "@fab4"."d_municipalities"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:28:08.305089 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:28:08.305224 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:28:08.506286 (Thread-1): Connected to db: None
2021-01-25 23:28:29.930424 (Thread-1): SQL status: OK in 21.63 seconds
2021-01-25 23:28:29.939757 (Thread-1): finished collecting timing info
2021-01-25 23:28:29.940287 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: ROLLBACK
2021-01-25 23:28:29.940432 (Thread-1): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: Close
2021-01-25 23:28:29.941555 (Thread-1): 00:28:29 | 20 of 24 PASS relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_ [PASS in 21.72s]
2021-01-25 23:28:29.941896 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:28:29.942254 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:28:29.942822 (Thread-1): 00:28:29 | 21 of 24 START test relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_ [RUN]
2021-01-25 23:28:29.943533 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:28:29.943885 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:28:29.975638 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-25 23:28:29.977502 (Thread-1): finished collecting timing info
2021-01-25 23:28:29.978597 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:28:29.978871 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: 
    
    




select count(*) as validation_errors
from (
    select premises_code as id from "@fab4"."f_land_values"
) as child
left join (
    select premises_code as id from "@fab4"."d_premises_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:28:29.979086 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:28:29.979289 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:28:30.096248 (Thread-1): Connected to db: None
2021-01-25 23:28:40.954297 (Thread-1): SQL status: OK in 10.98 seconds
2021-01-25 23:28:40.963946 (Thread-1): finished collecting timing info
2021-01-25 23:28:40.964557 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: ROLLBACK
2021-01-25 23:28:40.964847 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: Close
2021-01-25 23:28:40.966246 (Thread-1): 00:28:40 | 21 of 24 PASS relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_ [PASS in 11.02s]
2021-01-25 23:28:40.966628 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:28:40.966989 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:28:40.967557 (Thread-1): 00:28:40 | 22 of 24 START test relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_ [RUN]
2021-01-25 23:28:40.968347 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-25 23:28:40.968700 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:28:40.999059 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-25 23:28:40.999883 (Thread-1): finished collecting timing info
2021-01-25 23:28:41.000645 (Thread-1): Using dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-25 23:28:41.001012 (Thread-1): On test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_: 
    
    




select count(*) as validation_errors
from (
    select transfer_label_fr as id from "@fab4"."stg__land_values"
) as child
left join (
    select transfer_label_fr as id from "@fab4"."transfer_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-25 23:28:41.001324 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:28:41.001533 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:28:41.122868 (Thread-1): Connected to db: None
2021-01-25 23:28:45.188046 (Thread-1): SQL status: OK in 4.19 seconds
2021-01-25 23:28:45.197039 (Thread-1): finished collecting timing info
2021-01-25 23:28:45.197579 (Thread-1): On test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_: ROLLBACK
2021-01-25 23:28:45.197724 (Thread-1): On test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_: Close
2021-01-25 23:28:45.198959 (Thread-1): 00:28:45 | 22 of 24 PASS relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_ [PASS in 4.23s]
2021-01-25 23:28:45.199251 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:28:45.199446 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:28:45.199828 (Thread-1): 00:28:45 | 23 of 24 START test stg__land_values_built_surface_implies_premises_code [RUN]
2021-01-25 23:28:45.200605 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:28:45.200894 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:28:45.241665 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 23:28:45.242476 (Thread-1): finished collecting timing info
2021-01-25 23:28:45.245309 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:28:45.246171 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  built_surface is not null
  and premises_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 23:28:45.247251 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:28:45.247511 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:28:45.370753 (Thread-1): Connected to db: None
2021-01-25 23:28:47.293038 (Thread-1): SQL status: OK in 2.05 seconds
2021-01-25 23:28:47.303124 (Thread-1): finished collecting timing info
2021-01-25 23:28:47.303657 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: ROLLBACK
2021-01-25 23:28:47.303811 (Thread-1): On test.subsurface.stg__land_values_built_surface_implies_premises_code: Close
2021-01-25 23:28:47.305066 (Thread-1): 00:28:47 | 23 of 24 PASS stg__land_values_built_surface_implies_premises_code... [PASS in 2.10s]
2021-01-25 23:28:47.305550 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:28:47.306044 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:28:47.306715 (Thread-1): 00:28:47 | 24 of 24 START test stg__land_values_land_surface_implies_crop_code.. [RUN]
2021-01-25 23:28:47.307552 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:28:47.307986 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:28:47.329331 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 23:28:47.330172 (Thread-1): finished collecting timing info
2021-01-25 23:28:47.331611 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:28:47.331904 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  land_surface is not null
  and crop_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-25 23:28:47.332113 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:28:47.333001 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:28:47.450894 (Thread-1): Connected to db: None
2021-01-25 23:28:49.342595 (Thread-1): SQL status: OK in 2.01 seconds
2021-01-25 23:28:49.350607 (Thread-1): finished collecting timing info
2021-01-25 23:28:49.351310 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: ROLLBACK
2021-01-25 23:28:49.351635 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: Close
2021-01-25 23:28:49.353066 (Thread-1): 00:28:49 | 24 of 24 PASS stg__land_values_land_surface_implies_crop_code........ [PASS in 2.05s]
2021-01-25 23:28:49.353434 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:28:49.382601 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:28:49.383312 (MainThread): 00:28:49 | 
2021-01-25 23:28:49.383592 (MainThread): 00:28:49 | Finished running 24 tests in 168.88s.
2021-01-25 23:28:49.383915 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:28:49.384220 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:28:49.384462 (MainThread): Connection 'test.subsurface.stg__land_values_land_surface_implies_crop_code' was properly closed.
2021-01-25 23:28:49.499661 (MainThread): 
2021-01-25 23:28:49.500066 (MainThread): Completed successfully
2021-01-25 23:28:49.500468 (MainThread): 
Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
2021-01-25 23:28:49.500957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b4eb6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b5008198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b4e2c048>]}
2021-01-25 23:28:49.501505 (MainThread): Flushing usage events
2021-01-25 23:33:33.005062 (MainThread): Running with dbt=0.18.1
2021-01-25 23:33:33.210231 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['+transfer_of_ownership+'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 23:33:33.212842 (MainThread): Tracking: tracking
2021-01-25 23:33:33.222901 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7cfac9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7cfacf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7cfacfd0>]}
2021-01-25 23:33:33.282435 (MainThread): Partial parsing not enabled
2021-01-25 23:33:33.284549 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:33:33.289528 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:33:33.293171 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:33:33.297395 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:33:33.321769 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:33:33.326292 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:33:33.372229 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:33:33.374743 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:33:33.380592 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:33:33.381098 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:33:33.386705 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:33:33.405301 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:33:33.422639 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:33:33.431140 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:33:33.445780 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:33:33.456725 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:33:33.484234 (MainThread): Parsing macros/core.sql
2021-01-25 23:33:33.492030 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:33:33.572064 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:33:33.588988 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:33:33.592680 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:33:33.595166 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:33:33.597342 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:33:33.601500 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:33:33.605029 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:33:33.623042 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:33:33.626973 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:33:33.639625 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:33:33.691559 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:33:33.723451 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:33:33.727206 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:33:33.737027 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:33:33.749107 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:33:33.775382 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:33:33.788351 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:33:33.827207 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:33:33.831286 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:33:33.834668 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:33:33.838375 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:33:33.853422 (MainThread): Partial parsing not enabled
2021-01-25 23:33:33.970781 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:33:34.015621 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:33:34.037777 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:33:34.059753 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:33:34.084267 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:33:34.106991 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:33:34.142857 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:33:34.163943 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:33:34.250437 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7cf3e278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7cdbb240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7ce12240>]}
2021-01-25 23:33:34.250911 (MainThread): Flushing usage events
2021-01-25 23:33:34.802553 (MainThread): Connection 'test.subsurface.stg__land_values_built_surface_implies_premises_code' was properly closed.
2021-01-25 23:33:34.804912 (MainThread): Encountered an error:
2021-01-25 23:33:34.805576 (MainThread): Compilation Error
  The schema file at marts/exposures.yml is invalid because no version is specified. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files
2021-01-25 23:33:34.822976 (MainThread): Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 544, in parse_file
    self._parse_format_version(yaml_block)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 210, in _parse_format_version
    raise_invalid_schema_yml_version(path, 'no version is specified')
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 871, in raise_invalid_schema_yml_version
    .format(path, issue)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at marts/exposures.yml is invalid because no version is specified. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files

2021-01-25 23:34:05.876262 (MainThread): Running with dbt=0.18.1
2021-01-25 23:34:05.995995 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['+transfer_of_ownership+'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 23:34:05.997336 (MainThread): Tracking: tracking
2021-01-25 23:34:06.006233 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0984adc320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0984adce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0984adcef0>]}
2021-01-25 23:34:06.065206 (MainThread): Partial parsing not enabled
2021-01-25 23:34:06.066898 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:34:06.072574 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:34:06.076134 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:34:06.080442 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:34:06.105352 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:34:06.109927 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:34:06.156348 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:34:06.158991 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:34:06.164924 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:34:06.165447 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:34:06.171033 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:34:06.189708 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:34:06.206875 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:34:06.215491 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:34:06.230234 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:34:06.241083 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:34:06.270168 (MainThread): Parsing macros/core.sql
2021-01-25 23:34:06.277669 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:34:06.359073 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:34:06.376486 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:34:06.380256 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:34:06.382757 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:34:06.384992 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:34:06.389402 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:34:06.393070 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:34:06.410755 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:34:06.414750 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:34:06.426725 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:34:06.478362 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:34:06.511064 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:34:06.514843 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:34:06.524778 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:34:06.537106 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:34:06.563782 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:34:06.577034 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:34:06.616335 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:34:06.620412 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:34:06.623855 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:34:06.627647 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:34:06.642922 (MainThread): Partial parsing not enabled
2021-01-25 23:34:06.759653 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:34:06.806610 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:34:06.828561 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:34:06.850650 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:34:06.876630 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:34:06.899484 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:34:06.935297 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:34:06.956198 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:34:08.914999 (MainThread): Found 6 models, 48 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:34:08.916261 (MainThread): The selector '+transfer_of_ownership+' does not match any nodes and will be ignored
2021-01-25 23:34:08.921399 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-01-25 23:34:08.922934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09846d7eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09846d77b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09846d7860>]}
2021-01-25 23:34:08.923425 (MainThread): Flushing usage events
2021-01-25 23:34:09.414455 (MainThread): Connection 'test.subsurface.stg__land_values_built_surface_implies_premises_code' was properly closed.
2021-01-25 23:34:32.669794 (MainThread): Running with dbt=0.18.1
2021-01-25 23:34:32.798574 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['+exposures:transfer_of_ownership'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 23:34:32.800431 (MainThread): Tracking: tracking
2021-01-25 23:34:32.810043 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ea3b4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e9e4ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e9e4ce80>]}
2021-01-25 23:34:32.867499 (MainThread): Partial parsing not enabled
2021-01-25 23:34:32.869105 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:34:32.875458 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:34:32.879773 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:34:32.885016 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:34:32.912645 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:34:32.917640 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:34:32.965875 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:34:32.968462 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:34:32.974529 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:34:32.975054 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:34:32.980791 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:34:33.000649 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:34:33.018834 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:34:33.027733 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:34:33.043102 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:34:33.054990 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:34:33.083453 (MainThread): Parsing macros/core.sql
2021-01-25 23:34:33.091084 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:34:33.170613 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:34:33.188131 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:34:33.191782 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:34:33.194387 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:34:33.196597 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:34:33.200845 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:34:33.204525 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:34:33.222169 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:34:33.226287 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:34:33.238478 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:34:33.292768 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:34:33.327058 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:34:33.330901 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:34:33.340917 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:34:33.352875 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:34:33.379693 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:34:33.393155 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:34:33.434772 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:34:33.440029 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:34:33.444070 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:34:33.448023 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:34:33.463145 (MainThread): Partial parsing not enabled
2021-01-25 23:34:33.578915 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:34:33.623417 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:34:33.645850 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:34:33.667856 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:34:33.692458 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:34:33.714562 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:34:33.770943 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:34:33.814988 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:34:36.191837 (MainThread): Found 6 models, 48 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:34:36.192724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e9a41198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e9a411d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e9a419b0>]}
2021-01-25 23:34:36.193422 (MainThread): Flushing usage events
2021-01-25 23:34:36.741021 (MainThread): Connection 'test.subsurface.stg__land_values_built_surface_implies_premises_code' was properly closed.
2021-01-25 23:34:36.742432 (MainThread): Encountered an error:
2021-01-25 23:34:36.742945 (MainThread): Runtime Error
  exposures
2021-01-25 23:34:36.771759 (MainThread): ValueError: 'exposures' is not a valid MethodName

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/graph/selector_spec.py", line 94, in parse_method
    method_name = MethodName(method_parts[0])
  File "/usr/lib/python3.7/enum.py", line 310, in __call__
    return cls.__new__(cls, value)
  File "/usr/lib/python3.7/enum.py", line 564, in __new__
    raise exc
  File "/usr/lib/python3.7/enum.py", line 548, in __new__
    result = cls._missing_(value)
  File "/usr/lib/python3.7/enum.py", line 577, in _missing_
    raise ValueError("%r is not a valid %s" % (value, cls.__name__))
ValueError: 'exposures' is not a valid MethodName

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 114, in get_graph_queue
    spec = self.get_selection_spec()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/compile.py", line 34, in get_selection_spec
    spec = parse_difference(self.args.models, self.args.exclude)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/graph/cli.py", line 69, in parse_difference
    included = parse_union_from_default(include, DEFAULT_INCLUDES)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/graph/cli.py", line 63, in parse_union_from_default
    return parse_union(components=raw, expect_exists=True)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/graph/cli.py", line 40, in parse_union
    for part in raw_spec.split(INTERSECTION_DELIMITER)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/graph/cli.py", line 40, in <listcomp>
    for part in raw_spec.split(INTERSECTION_DELIMITER)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/graph/selector_spec.py", line 131, in from_single_spec
    return cls.from_dict(raw, result.groupdict())
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/graph/selector_spec.py", line 108, in from_dict
    method_name, method_arguments = cls.parse_method(dct)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/graph/selector_spec.py", line 96, in parse_method
    raise InvalidSelectorException(method_parts[0]) from exc
dbt.exceptions.InvalidSelectorException: Runtime Error
  exposures

2021-01-25 23:34:41.908997 (MainThread): Running with dbt=0.18.1
2021-01-25 23:34:42.031772 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['+exposure:transfer_of_ownership'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 23:34:42.033384 (MainThread): Tracking: tracking
2021-01-25 23:34:42.042359 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3f6555f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3f0fceb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3f0fcf28>]}
2021-01-25 23:34:42.101165 (MainThread): Partial parsing not enabled
2021-01-25 23:34:42.102865 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:34:42.108609 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:34:42.112069 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:34:42.116243 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:34:42.141470 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:34:42.146110 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:34:42.193994 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:34:42.196560 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:34:42.202470 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:34:42.202980 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:34:42.208589 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:34:42.227384 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:34:42.244487 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:34:42.253040 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:34:42.268052 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:34:42.279079 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:34:42.307539 (MainThread): Parsing macros/core.sql
2021-01-25 23:34:42.315220 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:34:42.394691 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:34:42.412051 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:34:42.415717 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:34:42.418165 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:34:42.420388 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:34:42.424627 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:34:42.428263 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:34:42.445730 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:34:42.449728 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:34:42.461942 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:34:42.513352 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:34:42.546257 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:34:42.550464 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:34:42.560584 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:34:42.572687 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:34:42.599299 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:34:42.612159 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:34:42.651931 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:34:42.656078 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:34:42.659645 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:34:42.663400 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:34:42.678350 (MainThread): Partial parsing not enabled
2021-01-25 23:34:42.795670 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:34:42.840763 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:34:42.863032 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:34:42.885232 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:34:42.910197 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:34:42.932893 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:34:42.969697 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:34:42.990962 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:34:44.953002 (MainThread): Found 6 models, 48 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:34:44.954131 (MainThread): context manager reversed is deprecated and to be removed in 3.0.Use G.reverse(copy=False) if G.is_directed() else G instead.
2021-01-25 23:34:44.960681 (MainThread): 
2021-01-25 23:34:44.961431 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:34:44.979801 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 23:34:45.013452 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 23:34:45.013756 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 23:34:45.014079 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 23:34:45.014306 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:45.225355 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 23:34:45.340025 (ThreadPoolExecutor-0_0): SQL status: OK in 0.33 seconds
2021-01-25 23:34:45.362084 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 23:34:45.485632 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:34:45.500197 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:34:45.500573 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:34:45.500837 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 23:34:45.501111 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:45.618898 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:34:45.814573 (ThreadPoolExecutor-1_0): SQL status: OK in 0.31 seconds
2021-01-25 23:34:45.849121 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:34:45.850234 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:34:45.855608 (MainThread): 00:34:45 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:34:45.857009 (MainThread): 00:34:45 | 
2021-01-25 23:34:45.875329 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 23:34:45.879446 (Thread-1): 00:34:45 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 23:34:45.887024 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:34:45.887419 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 23:34:45.957071 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:34:45.958409 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.001288 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:34:46.002170 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:34:46.002580 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 23:34:46.003492 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:34:46.003793 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:46.119633 (Thread-1): Connected to db: None
2021-01-25 23:34:46.200178 (Thread-1): SQL status: OK in 0.20 seconds
2021-01-25 23:34:46.211201 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.211861 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 23:34:46.212211 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 23:34:46.214118 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47bd48b-48e7-4233-80ac-53d513314609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ed3f2e8>]}
2021-01-25 23:34:46.216675 (Thread-1): 00:34:46 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 0.33s]
2021-01-25 23:34:46.217017 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 23:34:46.217390 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 23:34:46.220689 (Thread-1): 00:34:46 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-25 23:34:46.221410 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:34:46.221692 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 23:34:46.246541 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:34:46.249092 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.262046 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:34:46.262949 (Thread-1): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:34:46.263380 (Thread-1): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as departement_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-25 23:34:46.263568 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:34:46.263724 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:46.378587 (Thread-1): Connected to db: None
2021-01-25 23:34:46.421473 (Thread-1): SQL status: OK in 0.16 seconds
2021-01-25 23:34:46.428054 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.428697 (Thread-1): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-25 23:34:46.429023 (Thread-1): On model.subsurface.stg__municipalities: Close
2021-01-25 23:34:46.431356 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47bd48b-48e7-4233-80ac-53d513314609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ed60080>]}
2021-01-25 23:34:46.433968 (Thread-1): 00:34:46 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 0.21s]
2021-01-25 23:34:46.434440 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 23:34:46.434852 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-25 23:34:46.437758 (Thread-1): 00:34:46 | 3 of 6 START view model @fab4.d_crop_types........................... [RUN]
2021-01-25 23:34:46.438525 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:34:46.438811 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-25 23:34:46.460085 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:34:46.460818 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.472867 (Thread-1): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:34:46.473692 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:34:46.474061 (Thread-1): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-25 23:34:46.474237 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:34:46.474424 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:46.585858 (Thread-1): Connected to db: None
2021-01-25 23:34:46.628008 (Thread-1): SQL status: OK in 0.15 seconds
2021-01-25 23:34:46.634387 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.634954 (Thread-1): On model.subsurface.d_crop_types: ROLLBACK
2021-01-25 23:34:46.635247 (Thread-1): On model.subsurface.d_crop_types: Close
2021-01-25 23:34:46.637081 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47bd48b-48e7-4233-80ac-53d513314609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ee898d0>]}
2021-01-25 23:34:46.639215 (Thread-1): 00:34:46 | 3 of 6 OK created view model @fab4.d_crop_types...................... [OK in 0.20s]
2021-01-25 23:34:46.639550 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-25 23:34:46.639899 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 23:34:46.643210 (Thread-1): 00:34:46 | 4 of 6 START view model @fab4.d_premises_types....................... [RUN]
2021-01-25 23:34:46.643924 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:34:46.644218 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 23:34:46.667394 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:34:46.668071 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.678603 (Thread-1): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:34:46.679619 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:34:46.679966 (Thread-1): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-25 23:34:46.680163 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:34:46.680317 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:46.799026 (Thread-1): Connected to db: None
2021-01-25 23:34:46.841224 (Thread-1): SQL status: OK in 0.16 seconds
2021-01-25 23:34:46.847871 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.848502 (Thread-1): On model.subsurface.d_premises_types: ROLLBACK
2021-01-25 23:34:46.848832 (Thread-1): On model.subsurface.d_premises_types: Close
2021-01-25 23:34:46.851226 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47bd48b-48e7-4233-80ac-53d513314609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ed60080>]}
2021-01-25 23:34:46.853723 (Thread-1): 00:34:46 | 4 of 6 OK created view model @fab4.d_premises_types.................. [OK in 0.21s]
2021-01-25 23:34:46.854118 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 23:34:46.854541 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 23:34:46.857518 (Thread-1): 00:34:46 | 5 of 6 START view model @fab4.f_land_values.......................... [RUN]
2021-01-25 23:34:46.858399 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:34:46.858714 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 23:34:46.899432 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 23:34:46.901118 (Thread-1): finished collecting timing info
2021-01-25 23:34:46.910960 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-25 23:34:46.911785 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 23:34:46.912141 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 23:34:46.912361 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:34:46.912563 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:47.027728 (Thread-1): Connected to db: None
2021-01-25 23:34:47.149352 (Thread-1): SQL status: OK in 0.24 seconds
2021-01-25 23:34:47.155964 (Thread-1): finished collecting timing info
2021-01-25 23:34:47.157323 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-25 23:34:47.161570 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-25 23:34:47.164082 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47bd48b-48e7-4233-80ac-53d513314609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ef617b8>]}
2021-01-25 23:34:47.171014 (Thread-1): 00:34:47 | 5 of 6 OK created view model @fab4.f_land_values..................... [OK in 0.31s]
2021-01-25 23:34:47.171456 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 23:34:47.171858 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-25 23:34:47.174682 (Thread-1): 00:34:47 | 6 of 6 START view model @fab4.d_municipalities....................... [RUN]
2021-01-25 23:34:47.175389 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:34:47.175672 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-25 23:34:47.212888 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-25 23:34:47.213706 (Thread-1): finished collecting timing info
2021-01-25 23:34:47.226764 (Thread-1): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-25 23:34:47.227596 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:34:47.227882 (Thread-1): On model.subsurface.d_municipalities: 
  create or replace view "@fab4"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,departement_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-25 23:34:47.228070 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:34:47.228210 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:47.355589 (Thread-1): Connected to db: None
2021-01-25 23:34:47.415856 (Thread-1): SQL status: OK in 0.19 seconds
2021-01-25 23:34:47.421101 (Thread-1): finished collecting timing info
2021-01-25 23:34:47.421648 (Thread-1): On model.subsurface.d_municipalities: ROLLBACK
2021-01-25 23:34:47.421933 (Thread-1): On model.subsurface.d_municipalities: Close
2021-01-25 23:34:47.424190 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47bd48b-48e7-4233-80ac-53d513314609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ee9ee48>]}
2021-01-25 23:34:47.427447 (Thread-1): 00:34:47 | 6 of 6 OK created view model @fab4.d_municipalities.................. [OK in 0.25s]
2021-01-25 23:34:47.429515 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-25 23:34:47.496317 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:34:47.496927 (MainThread): On master: ROLLBACK
2021-01-25 23:34:47.497325 (MainThread): Opening a new connection, currently in state init
2021-01-25 23:34:47.497725 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:34:47.614842 (MainThread): Connected to db: None
2021-01-25 23:34:47.615208 (MainThread): On master: ROLLBACK
2021-01-25 23:34:47.615358 (MainThread): On master: Close
2021-01-25 23:34:47.617445 (MainThread): 00:34:47 | 
2021-01-25 23:34:47.617808 (MainThread): 00:34:47 | Finished running 6 view models in 2.66s.
2021-01-25 23:34:47.618117 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:34:47.618400 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-25 23:34:47.656982 (MainThread): 
2021-01-25 23:34:47.657369 (MainThread): Completed successfully
2021-01-25 23:34:47.657700 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-25 23:34:47.658177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ed34d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ece17b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3ece1f28>]}
2021-01-25 23:34:47.658699 (MainThread): Flushing usage events
2021-01-25 23:35:03.704663 (MainThread): Running with dbt=0.18.1
2021-01-25 23:35:03.828374 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-01-25 23:35:03.830094 (MainThread): Tracking: tracking
2021-01-25 23:35:03.839390 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87c2e4f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87c26ddd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87c26de48>]}
2021-01-25 23:35:03.898492 (MainThread): Partial parsing not enabled
2021-01-25 23:35:03.900114 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:35:03.906367 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:35:03.910272 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:35:03.914615 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:35:03.939970 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:35:03.944515 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:35:03.990281 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:35:03.992970 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:35:03.998970 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:35:03.999480 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:35:04.005109 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:35:04.023709 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:35:04.041084 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:35:04.049697 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:35:04.064985 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:35:04.076278 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:35:04.104988 (MainThread): Parsing macros/core.sql
2021-01-25 23:35:04.112587 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:35:04.192987 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:35:04.210284 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:35:04.214026 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:35:04.216525 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:35:04.218736 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:35:04.222957 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:35:04.226504 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:35:04.244520 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:35:04.248462 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:35:04.260595 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:35:04.313003 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:35:04.346008 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:35:04.349799 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:35:04.359865 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:35:04.372335 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:35:04.399217 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:35:04.412617 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:35:04.453074 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:35:04.457154 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:35:04.460575 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:35:04.464476 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:35:04.479819 (MainThread): Partial parsing not enabled
2021-01-25 23:35:04.596456 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:35:04.641201 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:35:04.663120 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:35:04.685416 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:35:04.710095 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:35:04.732804 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:35:04.768696 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:35:04.789780 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:35:06.754369 (MainThread): Found 6 models, 48 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:35:06.761982 (MainThread): 
2021-01-25 23:35:06.762820 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:35:06.901241 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:35:06.922254 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:35:06.922569 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:35:06.922742 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 23:35:06.922917 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:35:07.052459 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 23:35:07.248687 (ThreadPoolExecutor-0_0): SQL status: OK in 0.33 seconds
2021-01-25 23:35:07.287435 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:35:07.288439 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-25 23:35:07.292319 (MainThread): 00:35:07 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:35:07.294037 (MainThread): 00:35:07 | 
2021-01-25 23:35:07.320231 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 23:35:07.321742 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:35:07.322118 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 23:35:07.387252 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:35:07.387956 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.388733 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.389826 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 23:35:07.390176 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 23:35:07.391535 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:35:07.391863 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 23:35:07.410571 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:35:07.411254 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.411994 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.413055 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 23:35:07.413443 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-25 23:35:07.414767 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-25 23:35:07.415093 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-25 23:35:07.439115 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.439692 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.440834 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-25 23:35:07.441238 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-25 23:35:07.442470 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-25 23:35:07.442808 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-25 23:35:07.456205 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.456751 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.457811 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-25 23:35:07.458186 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-25 23:35:07.459478 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-25 23:35:07.459802 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-25 23:35:07.472534 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.473071 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.474143 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-25 23:35:07.474526 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:35:07.475813 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:35:07.476206 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:35:07.506138 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 23:35:07.506892 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.507632 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.508705 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:35:07.509079 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:35:07.509999 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:35:07.510296 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:35:07.527267 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 23:35:07.527958 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.528685 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.529749 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:35:07.530129 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:35:07.531200 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:35:07.531540 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:35:07.548402 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 23:35:07.549107 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.549788 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.550874 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:35:07.551245 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:35:07.552170 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:35:07.552468 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:35:07.569098 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 23:35:07.569788 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.570483 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.571553 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:35:07.571931 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:35:07.572869 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:35:07.573200 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:35:07.599398 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 23:35:07.600109 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.600841 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.601923 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:35:07.602294 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:35:07.603233 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:35:07.603539 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:35:07.618306 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 23:35:07.619020 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.619750 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.620814 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:35:07.621191 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-25 23:35:07.622112 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:35:07.622440 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-25 23:35:07.638547 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-25 23:35:07.639231 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.639905 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.640977 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-25 23:35:07.641515 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:35:07.642631 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 23:35:07.643041 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:35:07.660319 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-25 23:35:07.661036 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.661712 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.662803 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:35:07.663162 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:35:07.664110 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 23:35:07.664472 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:35:07.682572 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-25 23:35:07.683330 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.684065 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.685146 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:35:07.685534 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:35:07.686479 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 23:35:07.686786 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:35:07.704990 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-25 23:35:07.705825 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.706546 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.707684 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:35:07.708067 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:35:07.709014 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 23:35:07.709322 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:35:07.728555 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-25 23:35:07.729383 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.730135 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.731343 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:35:07.731775 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:35:07.732844 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 23:35:07.733247 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:35:07.767691 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-25 23:35:07.768487 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.769412 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.770664 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:35:07.771143 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:35:07.772080 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 23:35:07.772441 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:35:07.804173 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-25 23:35:07.805013 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.805754 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.807694 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:35:07.808646 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:35:07.810639 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 23:35:07.811042 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:35:07.841676 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-25 23:35:07.843870 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.845234 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.847134 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:35:07.848595 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-25 23:35:07.850541 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:35:07.851111 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-25 23:35:07.877381 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:35:07.878185 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.878961 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.880343 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-25 23:35:07.881757 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:35:07.884111 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 23:35:07.884589 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:35:07.912926 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 23:35:07.966450 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.967730 (Thread-1): finished collecting timing info
2021-01-25 23:35:07.969108 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:35:07.970126 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:35:07.972736 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 23:35:07.973701 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:35:08.000992 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 23:35:08.002492 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.003239 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.004346 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:35:08.005240 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 23:35:08.007682 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 23:35:08.008387 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 23:35:08.032624 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 23:35:08.033842 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.034766 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.036165 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 23:35:08.036616 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 23:35:08.037498 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:35:08.037834 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 23:35:08.058057 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:35:08.058756 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.059405 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.060474 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 23:35:08.060834 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:35:08.061927 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 23:35:08.062255 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:35:08.079073 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-25 23:35:08.079765 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.080425 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.081616 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:35:08.082013 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:35:08.082962 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 23:35:08.083267 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:35:08.100017 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-25 23:35:08.100697 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.101341 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.102433 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:35:08.102790 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:35:08.103703 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 23:35:08.104012 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:35:08.120707 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-25 23:35:08.121438 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.122065 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.123163 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:35:08.123530 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-25 23:35:08.124433 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 23:35:08.124732 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-25 23:35:08.143466 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-25 23:35:08.144149 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.144792 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.145862 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-25 23:35:08.146224 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 23:35:08.147203 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:35:08.147509 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 23:35:08.174166 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 23:35:08.174882 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.175614 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.176689 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 23:35:08.177086 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:35:08.178765 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 23:35:08.179103 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:35:08.196415 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-25 23:35:08.197149 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.197915 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.199029 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:35:08.199395 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:35:08.200295 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 23:35:08.200594 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:35:08.218050 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-25 23:35:08.218818 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.219547 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.220646 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:35:08.221079 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:35:08.221982 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-25 23:35:08.222294 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:35:08.244080 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-25 23:35:08.244776 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.245441 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.246532 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:35:08.246935 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:35:08.247825 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 23:35:08.248192 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:35:08.266479 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-25 23:35:08.267205 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.267865 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.268921 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:35:08.269293 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:35:08.270186 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 23:35:08.270512 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:35:08.288379 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-25 23:35:08.289222 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.289898 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.291035 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:35:08.291449 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:35:08.292298 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-25 23:35:08.292559 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:35:08.310420 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-25 23:35:08.311115 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.311785 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.312848 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:35:08.313253 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:35:08.314155 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-25 23:35:08.314547 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:35:08.333121 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-25 23:35:08.333815 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.334515 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.335597 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:35:08.335947 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:35:08.336842 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-25 23:35:08.337263 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:35:08.355221 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-25 23:35:08.355921 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.356592 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.357662 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:35:08.358027 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:35:08.358958 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-25 23:35:08.359260 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:35:08.379248 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-25 23:35:08.379936 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.380621 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.381679 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:35:08.382101 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:35:08.383092 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-25 23:35:08.383457 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:35:08.460240 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-25 23:35:08.460934 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.461665 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.462753 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:35:08.463110 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:35:08.464015 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-25 23:35:08.464369 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:35:08.481583 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-25 23:35:08.482380 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.483190 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.484310 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:35:08.484745 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:35:08.485667 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-25 23:35:08.485985 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:35:08.505007 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-25 23:35:08.505753 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.506447 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.507599 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:35:08.507977 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:35:08.508922 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-25 23:35:08.509247 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:35:08.530010 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-25 23:35:08.530767 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.531657 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.532841 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:35:08.533414 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:35:08.534443 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-25 23:35:08.534838 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:35:08.554754 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-25 23:35:08.555726 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.556564 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.557757 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:35:08.558156 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:35:08.559155 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-25 23:35:08.559490 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-25 23:35:08.580534 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-25 23:35:08.581336 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.582090 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.583386 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:35:08.583899 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:35:08.584874 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-25 23:35:08.585199 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:35:08.605981 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-25 23:35:08.606868 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.607568 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.608748 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:35:08.609136 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:35:08.610102 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-25 23:35:08.610485 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:35:08.631861 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-25 23:35:08.632650 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.633357 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.634658 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:35:08.635082 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:35:08.636037 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-25 23:35:08.636356 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:35:08.656552 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-25 23:35:08.657364 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.658066 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.659307 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:35:08.659701 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:35:08.660684 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-25 23:35:08.661019 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:35:08.682627 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-25 23:35:08.683428 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.684123 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.685254 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:35:08.685635 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:35:08.686599 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-25 23:35:08.686935 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:35:08.708370 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-25 23:35:08.709149 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.709850 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.711060 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:35:08.711472 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:35:08.712451 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-25 23:35:08.712781 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:35:08.734723 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-25 23:35:08.735501 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.736195 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.737507 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:35:08.737963 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:35:08.738980 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-25 23:35:08.739371 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:35:08.760777 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-25 23:35:08.761739 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.762549 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.763836 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:35:08.764252 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:35:08.765194 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-25 23:35:08.765559 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:35:08.787219 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-25 23:35:08.788001 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.788689 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.789875 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:35:08.790290 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:35:08.791299 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-25 23:35:08.791631 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:35:08.812109 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-25 23:35:08.812893 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.813633 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.814876 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:35:08.815338 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:35:08.816291 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-25 23:35:08.816622 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:35:08.836407 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-25 23:35:08.837246 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.837944 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.839161 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:35:08.839611 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:35:08.840805 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:35:08.841212 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:35:08.868327 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-25 23:35:08.869157 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.869881 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.871090 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:35:08.871486 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:35:08.872455 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:35:08.872783 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:35:08.897570 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-25 23:35:08.898437 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.899217 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.900417 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:35:08.900812 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:35:08.901801 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:35:08.902193 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:35:08.927066 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-25 23:35:08.927861 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.928564 (Thread-1): finished collecting timing info
2021-01-25 23:35:08.929828 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:35:08.967673 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:35:08.968101 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:35:08.968390 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-25 23:35:09.241897 (MainThread): 00:35:09 | Done.
2021-01-25 23:35:09.280192 (MainThread): Acquiring new dremio connection "generate_catalog".
2021-01-25 23:35:09.280534 (MainThread): 00:35:09 | Building catalog
2021-01-25 23:35:09.617727 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "@fab4.information_schema".
2021-01-25 23:35:09.635900 (ThreadPoolExecutor-1_0): Using dremio connection "@fab4.information_schema".
2021-01-25 23:35:09.636253 (ThreadPoolExecutor-1_0): On @fab4.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('@fab4')
    and (table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-25 23:35:09.636501 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 23:35:09.636715 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:35:09.753176 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:35:10.576587 (ThreadPoolExecutor-1_0): SQL status: OK in 0.94 seconds
2021-01-25 23:35:10.607212 (ThreadPoolExecutor-1_0): On @fab4.information_schema: ROLLBACK
2021-01-25 23:35:10.607627 (ThreadPoolExecutor-1_0): On @fab4.information_schema: Close
2021-01-25 23:35:10.609297 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "fs.information_schema".
2021-01-25 23:35:10.615835 (ThreadPoolExecutor-1_0): Using dremio connection "fs.information_schema".
2021-01-25 23:35:10.616210 (ThreadPoolExecutor-1_0): On fs.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('fs')
    and (table_schema = lower('geo') or table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-25 23:35:10.616499 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 23:35:10.616732 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:35:10.753584 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:35:11.342740 (ThreadPoolExecutor-1_0): SQL status: OK in 0.73 seconds
2021-01-25 23:35:11.388573 (ThreadPoolExecutor-1_0): On fs.information_schema: ROLLBACK
2021-01-25 23:35:11.388923 (ThreadPoolExecutor-1_0): On fs.information_schema: Close
2021-01-25 23:35:11.716224 (MainThread): 00:35:11 | Catalog written to /home/fabrice/subsurface/target/catalog.json
2021-01-25 23:35:11.717052 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87c1721d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87c172fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa87c1724e0>]}
2021-01-25 23:35:11.717568 (MainThread): Flushing usage events
2021-01-25 23:35:12.204804 (MainThread): Connection 'generate_catalog' was properly closed.
2021-01-25 23:35:12.206171 (MainThread): Connection 'fs.information_schema' was properly closed.
2021-01-25 23:36:28.269593 (MainThread): Running with dbt=0.18.1
2021-01-25 23:36:28.390167 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-01-25 23:36:28.391785 (MainThread): Tracking: tracking
2021-01-25 23:36:28.400676 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f1762390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6eefbde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6eefbde80>]}
2021-01-25 23:36:28.458922 (MainThread): Partial parsing not enabled
2021-01-25 23:36:28.460586 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:36:28.466783 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:36:28.470257 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:36:28.474812 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:36:28.500425 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:36:28.505032 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:36:28.551251 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:36:28.553758 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:36:28.559890 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:36:28.560393 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:36:28.566036 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:36:28.584686 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:36:28.602512 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:36:28.610972 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:36:28.626397 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:36:28.637412 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:36:28.665858 (MainThread): Parsing macros/core.sql
2021-01-25 23:36:28.673419 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:36:28.753283 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:36:28.770717 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:36:28.774393 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:36:28.776847 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:36:28.779079 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:36:28.783332 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:36:28.786877 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:36:28.804753 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:36:28.808730 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:36:28.821141 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:36:28.874308 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:36:28.906631 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:36:28.910301 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:36:28.920238 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:36:28.932345 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:36:28.959026 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:36:28.972219 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:36:29.011679 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:36:29.015819 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:36:29.019241 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:36:29.023126 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:36:29.038053 (MainThread): Partial parsing not enabled
2021-01-25 23:36:29.154533 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:36:29.199624 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:36:29.222216 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:36:29.244541 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:36:29.269158 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:36:29.291103 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:36:29.327382 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:36:29.348443 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:36:31.297020 (MainThread): Found 6 models, 48 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:36:31.304620 (MainThread): 
2021-01-25 23:36:31.305392 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:36:31.440082 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:36:31.461547 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:36:31.461811 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:36:31.462693 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 23:36:31.462953 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:36:31.599804 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 23:36:31.820270 (ThreadPoolExecutor-0_0): SQL status: OK in 0.36 seconds
2021-01-25 23:36:31.860975 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:36:31.862082 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-25 23:36:31.865170 (MainThread): 00:36:31 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:36:31.866878 (MainThread): 00:36:31 | 
2021-01-25 23:36:31.882885 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 23:36:31.884078 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:36:31.884441 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 23:36:31.963735 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:36:31.965186 (Thread-1): finished collecting timing info
2021-01-25 23:36:31.966581 (Thread-1): finished collecting timing info
2021-01-25 23:36:31.968241 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 23:36:31.969283 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 23:36:31.971524 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:36:31.972503 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 23:36:31.991494 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:36:31.992258 (Thread-1): finished collecting timing info
2021-01-25 23:36:31.992979 (Thread-1): finished collecting timing info
2021-01-25 23:36:31.994053 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 23:36:31.994427 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-25 23:36:31.995753 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-25 23:36:31.996080 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-25 23:36:32.019402 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.019964 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.021032 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-25 23:36:32.021382 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-25 23:36:32.022641 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-25 23:36:32.022974 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-25 23:36:32.036259 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.036786 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.037848 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-25 23:36:32.038205 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-25 23:36:32.039427 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-25 23:36:32.039771 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-25 23:36:32.052356 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.052879 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.053945 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-25 23:36:32.054301 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:36:32.055625 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:36:32.055940 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:36:32.085992 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 23:36:32.086753 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.087443 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.088494 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:36:32.088858 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:36:32.089780 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:36:32.090087 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:36:32.107349 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 23:36:32.108034 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.108730 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.109797 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:36:32.110150 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:36:32.111091 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:36:32.111396 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:36:32.127821 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 23:36:32.128508 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.129140 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.130210 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:36:32.130610 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:36:32.131538 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:36:32.131852 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:36:32.148273 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 23:36:32.148962 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.149614 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.150671 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:36:32.151108 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:36:32.151972 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:36:32.152332 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:36:32.177511 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 23:36:32.178209 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.178894 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.180024 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:36:32.180378 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:36:32.181278 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:36:32.181591 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:36:32.196462 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 23:36:32.197157 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.197846 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.198918 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:36:32.199299 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-25 23:36:32.200244 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:36:32.200575 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-25 23:36:32.214999 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-25 23:36:32.215686 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.216351 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.217424 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-25 23:36:32.217789 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:36:32.218940 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 23:36:32.219264 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:36:32.235848 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-25 23:36:32.236550 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.237173 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.238246 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:36:32.238640 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:36:32.239581 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 23:36:32.239887 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:36:32.256249 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-25 23:36:32.256944 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.257591 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.258783 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:36:32.259139 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:36:32.260055 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 23:36:32.260389 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:36:32.276625 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-25 23:36:32.277310 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.277957 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.279075 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:36:32.279434 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:36:32.280364 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 23:36:32.280666 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:36:32.297091 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-25 23:36:32.297765 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.298433 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.299529 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:36:32.299987 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:36:32.300936 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 23:36:32.301248 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:36:32.319379 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-25 23:36:32.320072 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.320696 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.321937 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:36:32.322285 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:36:32.323237 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 23:36:32.323551 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:36:32.340509 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-25 23:36:32.341195 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.341840 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.342923 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:36:32.343293 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:36:32.344228 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 23:36:32.344583 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:36:32.361001 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-25 23:36:32.361698 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.362353 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.363441 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:36:32.363796 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-25 23:36:32.364721 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:36:32.365033 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-25 23:36:32.379467 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:36:32.380148 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.380800 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.381866 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-25 23:36:32.382251 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:36:32.383407 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 23:36:32.383735 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:36:32.400328 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 23:36:32.401044 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.401682 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.402787 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:36:32.403152 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:36:32.404093 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 23:36:32.404399 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:36:32.420934 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 23:36:32.421676 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.422342 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.423407 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:36:32.423778 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 23:36:32.424697 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 23:36:32.425004 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 23:36:32.441479 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 23:36:32.442163 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.442826 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.443898 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 23:36:32.444275 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 23:36:32.445217 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:36:32.445523 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 23:36:32.459642 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:36:32.460324 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.460975 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.462041 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 23:36:32.462419 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:36:32.463504 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 23:36:32.463839 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:36:32.480363 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-25 23:36:32.481043 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.481692 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.482771 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:36:32.483157 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:36:32.484093 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 23:36:32.484403 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:36:32.500957 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-25 23:36:32.501658 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.502295 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.503372 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:36:32.503766 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:36:32.504693 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 23:36:32.504998 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:36:32.521264 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-25 23:36:32.521956 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.522654 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.523738 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:36:32.524118 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-25 23:36:32.525037 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 23:36:32.525344 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-25 23:36:32.543895 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-25 23:36:32.544590 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.545230 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.546283 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-25 23:36:32.546665 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 23:36:32.547585 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:36:32.547950 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 23:36:32.574429 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 23:36:32.575117 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.575768 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.576839 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 23:36:32.577217 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:36:32.578867 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 23:36:32.579198 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:36:32.595779 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-25 23:36:32.596514 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.597169 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.598208 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:36:32.598581 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:36:32.599478 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 23:36:32.599787 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:36:32.616046 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-25 23:36:32.616758 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.617391 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.618481 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:36:32.618844 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:36:32.619743 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-25 23:36:32.620106 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:36:32.641572 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-25 23:36:32.642269 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.642938 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.643998 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:36:32.644375 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:36:32.645297 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 23:36:32.645600 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:36:32.661949 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-25 23:36:32.662658 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.663306 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.664370 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:36:32.664739 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:36:32.665697 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 23:36:32.666014 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:36:32.684174 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-25 23:36:32.684882 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.685546 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.686771 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:36:32.687153 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:36:32.688122 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-25 23:36:32.688443 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:36:32.707903 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-25 23:36:32.708721 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.709461 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.710716 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:36:32.711138 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:36:32.712141 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-25 23:36:32.712474 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:36:32.738574 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-25 23:36:32.739367 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.740144 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.741288 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:36:32.741653 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:36:32.742502 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-25 23:36:32.743028 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:36:32.762806 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-25 23:36:32.763556 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.764398 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.765565 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:36:32.765982 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:36:32.766960 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-25 23:36:32.767348 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:36:32.789284 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-25 23:36:32.790029 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.790812 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.792897 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:36:32.793279 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:36:32.794180 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-25 23:36:32.794614 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:36:32.874595 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-25 23:36:32.875336 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.876149 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.877324 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:36:32.877703 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:36:32.878516 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-25 23:36:32.879034 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:36:32.899162 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-25 23:36:32.899917 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.901123 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.902306 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:36:32.902713 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:36:32.903614 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-25 23:36:32.904015 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:36:32.923058 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-25 23:36:32.923807 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.924559 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.925730 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:36:32.926140 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:36:32.927032 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-25 23:36:32.927417 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:36:32.946967 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-25 23:36:32.947721 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.948415 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.949553 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:36:32.949916 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:36:32.950840 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-25 23:36:32.951228 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:36:32.970898 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-25 23:36:32.971665 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.972424 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.973640 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:36:32.974093 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:36:32.975070 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-25 23:36:32.975457 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-25 23:36:32.995062 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-25 23:36:32.995820 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.996598 (Thread-1): finished collecting timing info
2021-01-25 23:36:32.997755 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:36:32.998115 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:36:32.999032 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-25 23:36:32.999415 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:36:33.018992 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-25 23:36:33.019795 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.020543 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.021730 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:36:33.022113 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:36:33.023088 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-25 23:36:33.023494 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:36:33.044948 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-25 23:36:33.045701 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.046586 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.047776 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:36:33.048137 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:36:33.048876 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-25 23:36:33.049370 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:36:33.068731 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-25 23:36:33.069556 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.070310 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.071535 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:36:33.071912 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:36:33.072850 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-25 23:36:33.073244 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:36:33.092490 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-25 23:36:33.093254 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.094009 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.095826 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:36:33.096311 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:36:33.097282 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-25 23:36:33.097597 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:36:33.117148 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-25 23:36:33.117878 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.118602 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.119750 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:36:33.120128 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:36:33.121080 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-25 23:36:33.121402 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:36:33.140465 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-25 23:36:33.141218 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.141930 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.143137 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:36:33.143563 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:36:33.144613 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-25 23:36:33.144964 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:36:33.164824 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-25 23:36:33.165574 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.166293 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.167519 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:36:33.167918 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:36:33.168884 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-25 23:36:33.169282 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:36:33.189130 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-25 23:36:33.189886 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.190637 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.191831 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:36:33.192247 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:36:33.193002 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-25 23:36:33.193384 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:36:33.212520 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-25 23:36:33.213311 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.214026 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.215242 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:36:33.215676 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:36:33.216619 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-25 23:36:33.216978 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:36:33.235764 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-25 23:36:33.236515 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.237246 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.238388 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:36:33.238775 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:36:33.239764 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:36:33.240087 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:36:33.266638 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-25 23:36:33.267429 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.268209 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.269370 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:36:33.269787 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:36:33.270791 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:36:33.271125 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:36:33.295923 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-25 23:36:33.296670 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.297405 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.298572 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:36:33.299036 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:36:33.299997 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:36:33.300326 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:36:33.324466 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-25 23:36:33.325229 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.325950 (Thread-1): finished collecting timing info
2021-01-25 23:36:33.327164 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:36:33.370591 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:36:33.371069 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:36:33.371400 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-25 23:36:33.629642 (MainThread): 00:36:33 | Done.
2021-01-25 23:36:33.634063 (MainThread): Acquiring new dremio connection "generate_catalog".
2021-01-25 23:36:33.634367 (MainThread): 00:36:33 | Building catalog
2021-01-25 23:36:33.986832 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "@fab4.information_schema".
2021-01-25 23:36:34.006084 (ThreadPoolExecutor-1_0): Using dremio connection "@fab4.information_schema".
2021-01-25 23:36:34.006550 (ThreadPoolExecutor-1_0): On @fab4.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('@fab4')
    and (table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-25 23:36:34.006840 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-25 23:36:34.007106 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:36:34.130180 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:36:34.678921 (ThreadPoolExecutor-1_0): SQL status: OK in 0.67 seconds
2021-01-25 23:36:34.730083 (ThreadPoolExecutor-1_0): On @fab4.information_schema: ROLLBACK
2021-01-25 23:36:34.730435 (ThreadPoolExecutor-1_0): On @fab4.information_schema: Close
2021-01-25 23:36:34.731809 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "fs.information_schema".
2021-01-25 23:36:34.743712 (ThreadPoolExecutor-1_0): Using dremio connection "fs.information_schema".
2021-01-25 23:36:34.744105 (ThreadPoolExecutor-1_0): On fs.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('fs')
    and (table_schema = lower('geo') or table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-25 23:36:34.744340 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 23:36:34.744538 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:36:34.914148 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:36:35.553455 (ThreadPoolExecutor-1_0): SQL status: OK in 0.81 seconds
2021-01-25 23:36:35.589838 (ThreadPoolExecutor-1_0): On fs.information_schema: ROLLBACK
2021-01-25 23:36:35.590339 (ThreadPoolExecutor-1_0): On fs.information_schema: Close
2021-01-25 23:36:35.931601 (MainThread): 00:36:35 | Catalog written to /home/fabrice/subsurface/target/catalog.json
2021-01-25 23:36:35.932449 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6eeee4c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6eeee42e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6eeee48d0>]}
2021-01-25 23:36:35.932964 (MainThread): Flushing usage events
2021-01-25 23:36:36.416983 (MainThread): Connection 'generate_catalog' was properly closed.
2021-01-25 23:36:36.418576 (MainThread): Connection 'fs.information_schema' was properly closed.
2021-01-25 23:36:48.492634 (MainThread): Running with dbt=0.18.1
2021-01-25 23:36:48.615995 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-01-25 23:36:48.617597 (MainThread): Tracking: tracking
2021-01-25 23:36:48.626660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f786e628f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f786e630e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f786e630e80>]}
2021-01-25 23:36:48.632034 (MainThread): Serving docs at 0.0.0.0:8080
2021-01-25 23:36:48.632437 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-01-25 23:36:48.632726 (MainThread): Press Ctrl+C to exit.


2021-01-25 23:36:54.024851 (MainThread): subprocess 17825 is still running
2021-01-25 23:42:52.685391 (MainThread): Flushing usage events
2021-01-25 23:42:53.244699 (MainThread): ctrl-c
2021-01-25 23:43:11.455678 (MainThread): Running with dbt=0.18.1
2021-01-25 23:43:11.595315 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-01-25 23:43:11.596791 (MainThread): Tracking: tracking
2021-01-25 23:43:11.605857 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d906a4c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9013be48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9013beb8>]}
2021-01-25 23:43:11.668786 (MainThread): Partial parsing not enabled
2021-01-25 23:43:11.670638 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:43:11.678050 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:43:11.681535 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:43:11.685994 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:43:11.712404 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:43:11.717011 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:43:11.764941 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:43:11.767502 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:43:11.774388 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:43:11.774919 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:43:11.780540 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:43:11.800035 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:43:11.818261 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:43:11.827811 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:43:11.843588 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:43:11.854623 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:43:11.884232 (MainThread): Parsing macros/core.sql
2021-01-25 23:43:11.892836 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:43:11.976686 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:43:11.994765 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:43:11.998363 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:43:12.000804 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:43:12.003212 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:43:12.008561 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:43:12.012124 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:43:12.031046 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:43:12.035035 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:43:12.047824 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:43:12.102143 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:43:12.136135 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:43:12.140850 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:43:12.151017 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:43:12.163843 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:43:12.192122 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:43:12.205332 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:43:12.247943 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:43:12.252052 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:43:12.255640 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:43:12.260235 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:43:12.277395 (MainThread): Partial parsing not enabled
2021-01-25 23:43:12.395979 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:43:12.442311 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:43:12.464637 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:43:12.487009 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:43:12.512399 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:43:12.536052 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:43:12.567521 (MainThread): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-25 23:43:12.605401 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:43:12.627534 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:43:14.644105 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:43:14.650829 (MainThread): 
2021-01-25 23:43:14.651602 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:43:14.806537 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:43:14.826664 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:43:14.826997 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:43:14.827237 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 23:43:14.827451 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:43:15.039638 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 23:43:15.237827 (ThreadPoolExecutor-0_0): SQL status: OK in 0.41 seconds
2021-01-25 23:43:15.271849 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:43:15.272299 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-25 23:43:15.275535 (MainThread): 00:43:15 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:43:15.275848 (MainThread): 00:43:15 | 
2021-01-25 23:43:15.278524 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 23:43:15.279189 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:43:15.279423 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 23:43:15.334418 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:43:15.335178 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.335956 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.337093 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 23:43:15.337515 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 23:43:15.338922 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:43:15.339289 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 23:43:15.358589 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:43:15.359270 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.360028 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.361107 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 23:43:15.361480 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-25 23:43:15.362867 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-25 23:43:15.363288 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-25 23:43:15.387853 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.388436 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.389701 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-25 23:43:15.390188 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-25 23:43:15.391518 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-25 23:43:15.391887 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-25 23:43:15.406247 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.406882 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.407974 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-25 23:43:15.408330 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-25 23:43:15.409582 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-25 23:43:15.409903 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-25 23:43:15.424235 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.424793 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.425857 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-25 23:43:15.426232 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:43:15.427562 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:43:15.427937 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:43:15.459560 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 23:43:15.460326 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.461041 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.462108 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:43:15.462482 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:43:15.463268 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:43:15.463869 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:43:15.481044 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 23:43:15.481772 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.482470 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.483635 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:43:15.484005 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:43:15.484938 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:43:15.485295 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:43:15.507223 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 23:43:15.507972 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.508750 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.509816 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:43:15.510148 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:43:15.511075 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:43:15.511466 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:43:15.530830 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 23:43:15.531515 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.532202 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.533275 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:43:15.533612 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:43:15.534520 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:43:15.534886 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:43:15.560683 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 23:43:15.561378 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.562069 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.563239 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:43:15.563685 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:43:15.564595 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:43:15.564949 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:43:15.580215 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 23:43:15.580926 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.581674 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.582792 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:43:15.583128 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-25 23:43:15.584013 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:43:15.584384 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-25 23:43:15.599624 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-25 23:43:15.600313 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.601001 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.602111 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-25 23:43:15.602464 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:43:15.603351 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 23:43:15.603974 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:43:15.620844 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-25 23:43:15.621539 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.622366 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.623544 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:43:15.623920 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:43:15.624793 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 23:43:15.625150 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:43:15.642466 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-25 23:43:15.643148 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.643832 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.644897 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:43:15.645233 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:43:15.646069 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 23:43:15.646459 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:43:15.663346 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-25 23:43:15.664049 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.664715 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.665787 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:43:15.666132 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:43:15.666888 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 23:43:15.667395 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:43:15.686454 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-25 23:43:15.687163 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.687842 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.688983 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:43:15.689478 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:43:15.690384 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 23:43:15.690743 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:43:15.708086 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-25 23:43:15.708761 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.709444 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.710529 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:43:15.710943 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:43:15.711970 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 23:43:15.712323 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:43:15.728970 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-25 23:43:15.729686 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.730390 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.731463 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:43:15.731800 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:43:15.732632 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 23:43:15.732999 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:43:15.749974 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-25 23:43:15.750684 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.751379 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.752488 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:43:15.752822 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-25 23:43:15.753678 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:43:15.754051 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-25 23:43:15.769045 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:43:15.769729 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.770389 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.771540 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-25 23:43:15.771957 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:43:15.772706 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 23:43:15.773081 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:43:15.790518 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 23:43:15.791252 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.791987 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.792887 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:43:15.793273 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:43:15.794129 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 23:43:15.794519 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:43:15.811202 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 23:43:15.811890 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.812569 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.813643 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:43:15.813998 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 23:43:15.814901 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 23:43:15.815272 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 23:43:15.832076 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 23:43:15.832771 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.833554 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.834677 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 23:43:15.835077 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 23:43:15.835956 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:43:15.836311 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 23:43:15.852091 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:43:15.852991 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.853707 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.854984 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 23:43:15.856854 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:43:15.858274 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 23:43:15.858854 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:43:15.876560 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-25 23:43:15.877293 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.877969 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.879110 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:43:15.879474 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:43:15.880232 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 23:43:15.880742 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:43:15.899080 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-25 23:43:15.899815 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.900499 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.901626 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:43:15.901990 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:43:15.902902 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 23:43:15.903302 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:43:15.923427 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-25 23:43:15.924156 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.924852 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.925977 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:43:15.926352 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-25 23:43:15.927262 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 23:43:15.927653 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-25 23:43:15.944711 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-25 23:43:15.945434 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.946118 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.947272 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-25 23:43:15.947640 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 23:43:15.948529 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:43:15.948922 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 23:43:15.976995 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 23:43:15.977735 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.978471 (Thread-1): finished collecting timing info
2021-01-25 23:43:15.979605 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 23:43:15.979969 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:43:15.980725 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 23:43:15.981359 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:43:15.999440 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-25 23:43:16.000202 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.000935 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.002061 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:43:16.002444 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:43:16.003354 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 23:43:16.003741 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:43:16.020828 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-25 23:43:16.021573 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.022365 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.024275 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:43:16.024638 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:43:16.025527 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-25 23:43:16.025887 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:43:16.046925 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-25 23:43:16.047666 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.048395 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.049504 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:43:16.049867 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:43:16.050808 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 23:43:16.051191 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:43:16.068849 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-25 23:43:16.069549 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.070283 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.071424 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:43:16.071857 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:43:16.072632 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 23:43:16.073924 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:43:16.091013 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-25 23:43:16.091735 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.092355 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.093204 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:43:16.093638 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:43:16.094585 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-25 23:43:16.094954 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:43:16.112540 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-25 23:43:16.113305 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.113969 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.115089 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:43:16.115450 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:43:16.116340 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-25 23:43:16.116727 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:43:16.133697 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-25 23:43:16.134443 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.135120 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.136240 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:43:16.136601 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:43:16.137466 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-25 23:43:16.137856 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:43:16.157715 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-25 23:43:16.158456 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.159185 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.160310 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:43:16.160656 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:43:16.161499 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-25 23:43:16.161879 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:43:16.239712 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-25 23:43:16.240494 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.241260 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.242445 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:43:16.242820 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:43:16.243758 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-25 23:43:16.244174 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:43:16.263888 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-25 23:43:16.264665 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.265565 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.266947 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:43:16.267396 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:43:16.268215 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-25 23:43:16.268739 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:43:16.288858 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-25 23:43:16.290747 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.291477 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.292591 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:43:16.292945 (Thread-1): Began running node analysis.subsurface.top100_most_expensive_cities
2021-01-25 23:43:16.293743 (Thread-1): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-25 23:43:16.294285 (Thread-1): Compiling analysis.subsurface.top100_most_expensive_cities
2021-01-25 23:43:16.326961 (Thread-1): Writing injected SQL for node "analysis.subsurface.top100_most_expensive_cities"
2021-01-25 23:43:16.386223 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.387404 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.390168 (Thread-1): Finished running node analysis.subsurface.top100_most_expensive_cities
2021-01-25 23:43:16.391082 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:43:16.393456 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-25 23:43:16.394501 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:43:16.414031 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-25 23:43:16.414852 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.415487 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.416539 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:43:16.416875 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:43:16.417701 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-25 23:43:16.418065 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:43:16.439533 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-25 23:43:16.440235 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.440919 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.441978 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:43:16.442358 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:43:16.443228 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-25 23:43:16.443581 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:43:16.461182 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-25 23:43:16.461908 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.462607 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.463695 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:43:16.464086 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:43:16.465010 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-25 23:43:16.465362 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-25 23:43:16.485190 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-25 23:43:16.485908 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.486733 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.487789 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:43:16.488171 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:43:16.488991 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-25 23:43:16.489417 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:43:16.508323 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-25 23:43:16.509006 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.509738 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.510849 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:43:16.511254 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:43:16.512088 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-25 23:43:16.512450 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:43:16.530795 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-25 23:43:16.531496 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.532142 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.533228 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:43:16.533667 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:43:16.534411 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-25 23:43:16.534932 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:43:16.552804 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-25 23:43:16.553532 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.554208 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.555483 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:43:16.555891 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:43:16.556696 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-25 23:43:16.557088 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:43:16.575555 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-25 23:43:16.576235 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.576876 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.577936 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:43:16.578273 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:43:16.579138 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-25 23:43:16.579543 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:43:16.598352 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-25 23:43:16.599036 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.599678 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.600744 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:43:16.601076 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:43:16.601914 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-25 23:43:16.602270 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:43:16.626412 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-25 23:43:16.627156 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.627839 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.628943 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:43:16.629342 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:43:16.630093 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-25 23:43:16.630731 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:43:16.658503 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-25 23:43:16.659224 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.659911 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.661015 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:43:16.661445 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:43:16.662147 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-25 23:43:16.662657 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:43:16.693518 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-25 23:43:16.694237 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.694931 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.696031 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:43:16.696421 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:43:16.697445 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-25 23:43:16.697833 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:43:16.725866 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-25 23:43:16.726716 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.727401 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.729402 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:43:16.729907 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:43:16.731147 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-25 23:43:16.732016 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:43:16.760247 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-25 23:43:16.760979 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.761689 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.762934 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:43:16.763396 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:43:16.764659 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:43:16.767204 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:43:16.800913 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-25 23:43:16.802514 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.804810 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.806509 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:43:16.806958 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:43:16.807742 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:43:16.808235 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:43:16.841532 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-25 23:43:16.842287 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.843062 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.844264 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:43:16.844698 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:43:16.847507 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:43:16.848893 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:43:16.909709 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-25 23:43:16.912161 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.913183 (Thread-1): finished collecting timing info
2021-01-25 23:43:16.915006 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:43:16.948817 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:43:16.949108 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-25 23:43:17.213491 (MainThread): 00:43:17 | Done.
2021-01-25 23:43:17.214068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d90695f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8fff0208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8ffe5cf8>]}
2021-01-25 23:43:17.214584 (MainThread): Flushing usage events
2021-01-25 23:43:38.467752 (MainThread): Running with dbt=0.18.1
2021-01-25 23:43:38.589250 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-01-25 23:43:38.591040 (MainThread): Tracking: tracking
2021-01-25 23:43:38.600037 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e34c4b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2f5be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2f5bef0>]}
2021-01-25 23:43:38.657737 (MainThread): Partial parsing not enabled
2021-01-25 23:43:38.659409 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:43:38.665465 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:43:38.669655 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:43:38.674953 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:43:38.700894 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:43:38.705947 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:43:38.752271 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:43:38.754890 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:43:38.761549 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:43:38.762059 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:43:38.767658 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:43:38.786067 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:43:38.803721 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:43:38.812327 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:43:38.827469 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:43:38.838750 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:43:38.867034 (MainThread): Parsing macros/core.sql
2021-01-25 23:43:38.874934 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:43:38.955603 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:43:38.972839 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:43:38.976452 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:43:38.978888 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:43:38.981097 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:43:38.985441 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:43:38.989403 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:43:39.007597 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:43:39.011518 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:43:39.024051 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:43:39.076832 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:43:39.110664 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:43:39.114381 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:43:39.124707 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:43:39.163031 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:43:39.210050 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:43:39.226462 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:43:39.271755 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:43:39.275837 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:43:39.279226 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:43:39.282932 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:43:39.299129 (MainThread): Partial parsing not enabled
2021-01-25 23:43:39.422484 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:43:39.469252 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:43:39.493336 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:43:39.516135 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:43:39.542932 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:43:39.565983 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:43:39.597433 (MainThread): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-25 23:43:39.635135 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:43:39.657686 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:43:41.679643 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:43:41.687540 (MainThread): 
2021-01-25 23:43:41.688316 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:43:41.832830 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:43:41.858762 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:43:41.859019 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:43:41.859185 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 23:43:41.859350 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:43:41.992436 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 23:43:42.229381 (ThreadPoolExecutor-0_0): SQL status: OK in 0.37 seconds
2021-01-25 23:43:42.268033 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:43:42.268449 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-25 23:43:42.271624 (MainThread): 00:43:42 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:43:42.272141 (MainThread): 00:43:42 | 
2021-01-25 23:43:42.293418 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 23:43:42.295714 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:43:42.296760 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 23:43:42.364960 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:43:42.366550 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.368155 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.370452 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 23:43:42.371703 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 23:43:42.373815 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:43:42.374968 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 23:43:42.399998 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:43:42.400746 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.401494 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.402622 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 23:43:42.402963 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-25 23:43:42.404408 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-25 23:43:42.404788 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-25 23:43:42.430036 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.430636 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.431739 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-25 23:43:42.432104 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-25 23:43:42.433353 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-25 23:43:42.433671 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-25 23:43:42.447908 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.448477 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.449537 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-25 23:43:42.449891 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-25 23:43:42.451110 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-25 23:43:42.451479 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-25 23:43:42.465448 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.465988 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.467117 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-25 23:43:42.467485 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:43:42.468786 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-25 23:43:42.469149 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:43:42.498422 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-25 23:43:42.499110 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.499864 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.500931 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-25 23:43:42.501279 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:43:42.502193 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-25 23:43:42.502625 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:43:42.519866 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-25 23:43:42.520766 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.522579 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.523777 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-25 23:43:42.524227 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:43:42.525302 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-25 23:43:42.525647 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:43:42.544458 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-25 23:43:42.545166 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.545847 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.546924 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-25 23:43:42.547346 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:43:42.548614 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-25 23:43:42.548975 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:43:42.565992 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-25 23:43:42.566695 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.567392 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.568463 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-25 23:43:42.568817 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:43:42.569789 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:43:42.570096 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:43:42.596643 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-25 23:43:42.597359 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.598042 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.599184 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-25 23:43:42.599531 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:43:42.600483 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:43:42.600789 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:43:42.616104 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-25 23:43:42.616807 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.617559 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.618625 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-25 23:43:42.619083 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-25 23:43:42.620014 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:43:42.620365 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-25 23:43:42.641838 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-25 23:43:42.643351 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.644795 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.647373 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-25 23:43:42.648281 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:43:42.649562 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-25 23:43:42.650487 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:43:42.668100 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-25 23:43:42.668790 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.669432 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.670544 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-25 23:43:42.670953 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:43:42.672511 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-25 23:43:42.672874 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:43:42.690364 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-25 23:43:42.691052 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.691694 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.693677 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-25 23:43:42.694017 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:43:42.694915 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-25 23:43:42.695274 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:43:42.712548 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-25 23:43:42.713233 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.713864 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.714942 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-25 23:43:42.715287 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:43:42.716151 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-25 23:43:42.716506 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:43:42.735981 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-25 23:43:42.736688 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.737373 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.739393 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-25 23:43:42.739757 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:43:42.740610 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-25 23:43:42.740974 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:43:42.759243 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-25 23:43:42.759927 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.760680 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.761740 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-25 23:43:42.762076 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:43:42.762796 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-25 23:43:42.763296 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:43:42.780454 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-25 23:43:42.781133 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.781774 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.782864 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-25 23:43:42.783200 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:43:42.784058 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-25 23:43:42.784412 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:43:42.801871 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-25 23:43:42.802592 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.803250 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.804386 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-25 23:43:42.805562 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-25 23:43:42.806895 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:43:42.807188 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-25 23:43:42.823705 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:43:42.824448 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.825164 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.826377 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-25 23:43:42.826767 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:43:42.827865 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-25 23:43:42.828175 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:43:42.845459 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-25 23:43:42.846147 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.846818 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.847841 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-25 23:43:42.848241 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:43:42.849110 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-25 23:43:42.849435 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:43:42.866861 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-25 23:43:42.867548 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.868194 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.869248 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-25 23:43:42.869601 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-25 23:43:42.870572 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-25 23:43:42.871788 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-25 23:43:42.888059 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-25 23:43:42.889397 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.890034 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.891115 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-25 23:43:42.891477 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 23:43:42.892313 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:43:42.892578 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 23:43:42.907723 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:43:42.908392 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.909095 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.910185 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 23:43:42.910581 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:43:42.911725 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-25 23:43:42.912042 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:43:42.930758 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-25 23:43:42.931473 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.932158 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.933294 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-25 23:43:42.933670 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:43:42.934660 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-25 23:43:42.935005 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:43:42.956818 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-25 23:43:42.957559 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.958364 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.959595 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-25 23:43:42.960060 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:43:42.961073 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-25 23:43:42.961452 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:43:42.984032 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-25 23:43:42.984778 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.985502 (Thread-1): finished collecting timing info
2021-01-25 23:43:42.987106 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-25 23:43:42.987656 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-25 23:43:42.989585 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-25 23:43:42.989954 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-25 23:43:43.010495 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-25 23:43:43.011230 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.011926 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.013056 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-25 23:43:43.013430 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 23:43:43.014426 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:43:43.014780 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 23:43:43.048495 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 23:43:43.049227 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.049968 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.051132 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 23:43:43.051532 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:43:43.053357 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-25 23:43:43.053698 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:43:43.074098 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-25 23:43:43.074885 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.075661 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.076833 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-25 23:43:43.077221 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:43:43.078187 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-25 23:43:43.078541 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:43:43.098923 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-25 23:43:43.099687 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.100375 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.101501 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-25 23:43:43.101891 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:43:43.102863 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-25 23:43:43.103190 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:43:43.129022 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-25 23:43:43.129769 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.130517 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.131699 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-25 23:43:43.132086 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:43:43.133108 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-25 23:43:43.133413 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:43:43.155131 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-25 23:43:43.155918 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.156612 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.157841 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-25 23:43:43.158259 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:43:43.159280 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-25 23:43:43.159603 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:43:43.180154 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-25 23:43:43.180879 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.181563 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.182734 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-25 23:43:43.183123 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:43:43.184067 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-25 23:43:43.184403 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:43:43.206742 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-25 23:43:43.207478 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.208187 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.209377 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-25 23:43:43.209814 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:43:43.210751 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-25 23:43:43.211095 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:43:43.231515 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-25 23:43:43.232254 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.233018 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.234158 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-25 23:43:43.234558 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:43:43.235564 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-25 23:43:43.235893 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:43:43.260572 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-25 23:43:43.261362 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.262080 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.263322 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-25 23:43:43.263688 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:43:43.264617 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-25 23:43:43.264926 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:43:43.347444 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-25 23:43:43.348231 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.349080 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.350387 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-25 23:43:43.350862 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:43:43.351847 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-25 23:43:43.352172 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:43:43.373419 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-25 23:43:43.374158 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.374971 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.376151 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-25 23:43:43.376537 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:43:43.377512 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-25 23:43:43.377831 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:43:43.398302 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-25 23:43:43.399070 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.399819 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.400948 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-25 23:43:43.401350 (Thread-1): Began running node analysis.subsurface.top100_most_expensive_cities
2021-01-25 23:43:43.402294 (Thread-1): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-25 23:43:43.402634 (Thread-1): Compiling analysis.subsurface.top100_most_expensive_cities
2021-01-25 23:43:43.433036 (Thread-1): Writing injected SQL for node "analysis.subsurface.top100_most_expensive_cities"
2021-01-25 23:43:43.433745 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.434512 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.435673 (Thread-1): Finished running node analysis.subsurface.top100_most_expensive_cities
2021-01-25 23:43:43.436044 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:43:43.436990 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-25 23:43:43.437368 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:43:43.459154 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-25 23:43:43.459947 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.460658 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.461818 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-25 23:43:43.462211 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:43:43.463210 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-25 23:43:43.463586 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:43:43.484107 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-25 23:43:43.484841 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.485562 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.486769 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-25 23:43:43.487189 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:43:43.488227 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-25 23:43:43.489506 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:43:43.509899 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-25 23:43:43.510634 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.511324 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.512476 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-25 23:43:43.512869 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:43:43.513820 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-25 23:43:43.514142 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-25 23:43:43.536162 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-25 23:43:43.536926 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.537742 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.539959 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-25 23:43:43.540431 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:43:43.541418 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-25 23:43:43.541752 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:43:43.562535 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-25 23:43:43.563317 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.564030 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.565231 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-25 23:43:43.565637 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:43:43.566643 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-25 23:43:43.566975 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:43:43.588925 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-25 23:43:43.589666 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.590425 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.591557 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-25 23:43:43.591922 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:43:43.592631 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-25 23:43:43.592900 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:43:43.613734 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-25 23:43:43.614664 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.615454 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.616708 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-25 23:43:43.617136 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:43:43.618007 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-25 23:43:43.618501 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:43:43.639289 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-25 23:43:43.640163 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.640858 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.641991 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-25 23:43:43.642365 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:43:43.643266 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-25 23:43:43.643644 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:43:43.665414 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-25 23:43:43.666159 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.666942 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.668114 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-25 23:43:43.668492 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:43:43.669317 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-25 23:43:43.669801 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:43:43.689887 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-25 23:43:43.690690 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.691411 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.692453 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-25 23:43:43.692759 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:43:43.693558 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-25 23:43:43.693930 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:43:43.714568 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-25 23:43:43.715317 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.716073 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.717251 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-25 23:43:43.717625 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:43:43.718586 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-25 23:43:43.719012 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:43:43.742153 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-25 23:43:43.742918 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.743642 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.744770 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-25 23:43:43.745131 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:43:43.746687 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-25 23:43:43.747062 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:43:43.768268 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-25 23:43:43.769084 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.769861 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.771223 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-25 23:43:43.772588 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:43:43.773648 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-25 23:43:43.774021 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:43:43.794699 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-25 23:43:43.795503 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.796275 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.797546 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-25 23:43:43.797981 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:43:43.799097 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-25 23:43:43.799469 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:43:43.825374 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-25 23:43:43.826149 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.826981 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.828216 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-25 23:43:43.828625 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:43:43.829670 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-25 23:43:43.830072 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:43:43.858993 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-25 23:43:43.860231 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.861488 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.862990 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-25 23:43:43.863880 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:43:43.865161 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-25 23:43:43.866004 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:43:43.889854 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-25 23:43:43.891147 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.891829 (Thread-1): finished collecting timing info
2021-01-25 23:43:43.892970 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-25 23:43:43.948761 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:43:43.949320 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:43:43.949703 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-25 23:43:44.216480 (MainThread): 00:43:44 | Done.
2021-01-25 23:43:44.217028 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2e62f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2e7cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2e7cf98>]}
2021-01-25 23:43:44.217570 (MainThread): Flushing usage events
2021-01-25 23:57:05.493695 (MainThread): Running with dbt=0.18.1
2021-01-25 23:57:05.617635 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['+exposure:transfer_of_ownership'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 23:57:05.619429 (MainThread): Tracking: tracking
2021-01-25 23:57:05.628631 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634826c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63481f4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63481f4f60>]}
2021-01-25 23:57:05.695287 (MainThread): Partial parsing not enabled
2021-01-25 23:57:05.696838 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:57:05.703060 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:57:05.706516 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:57:05.711143 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:57:05.737230 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:57:05.741790 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:57:05.791083 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:57:05.794509 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:57:05.801203 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:57:05.801702 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:57:05.807307 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:57:05.826409 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:57:05.844391 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:57:05.853767 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:57:05.869629 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:57:05.880722 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:57:05.910199 (MainThread): Parsing macros/core.sql
2021-01-25 23:57:05.918694 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:57:06.002111 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:57:06.019823 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:57:06.023710 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:57:06.026157 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:57:06.028386 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:57:06.032720 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:57:06.036493 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:57:06.054750 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:57:06.058677 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:57:06.071328 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:57:06.123895 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:57:06.159200 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:57:06.163792 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:57:06.174253 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:57:06.186868 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:57:06.213315 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:57:06.226498 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:57:06.266043 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:57:06.270544 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:57:06.273860 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:57:06.277823 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:57:06.293264 (MainThread): Partial parsing not enabled
2021-01-25 23:57:06.410918 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:57:06.456647 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:06.479456 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:06.502225 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:57:06.526769 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:57:06.549116 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:57:06.579669 (MainThread): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-25 23:57:06.616502 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:57:06.637621 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:57:08.623456 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:57:08.624514 (MainThread): context manager reversed is deprecated and to be removed in 3.0.Use G.reverse(copy=False) if G.is_directed() else G instead.
2021-01-25 23:57:08.630246 (MainThread): 
2021-01-25 23:57:08.631057 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:57:08.652890 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 23:57:08.680942 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 23:57:08.681196 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 23:57:08.681344 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 23:57:08.681492 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:08.839917 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 23:57:08.963442 (ThreadPoolExecutor-0_0): SQL status: OK in 0.28 seconds
2021-01-25 23:57:08.996304 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 23:57:09.136295 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:57:09.149981 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:57:09.151359 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:57:09.151681 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 23:57:09.151914 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:09.272544 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:57:09.470207 (ThreadPoolExecutor-1_0): SQL status: OK in 0.32 seconds
2021-01-25 23:57:09.498062 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:57:09.498363 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:57:09.501765 (MainThread): 00:57:09 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:57:09.502153 (MainThread): 00:57:09 | 
2021-01-25 23:57:09.516878 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 23:57:09.520519 (Thread-1): 00:57:09 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 23:57:09.521333 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:57:09.521769 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 23:57:09.580198 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:57:09.581420 (Thread-1): finished collecting timing info
2021-01-25 23:57:09.624600 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:57:09.629123 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:57:09.629501 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 23:57:09.629790 (Thread-1): Opening a new connection, currently in state init
2021-01-25 23:57:09.630008 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:09.745688 (Thread-1): Connected to db: None
2021-01-25 23:57:09.825474 (Thread-1): SQL status: OK in 0.20 seconds
2021-01-25 23:57:09.836187 (Thread-1): finished collecting timing info
2021-01-25 23:57:09.836870 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 23:57:09.837157 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 23:57:09.839192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d08cb1a-d9d2-44b6-b7aa-91030cb67f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6347dcae10>]}
2021-01-25 23:57:09.841896 (Thread-1): 00:57:09 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 0.32s]
2021-01-25 23:57:09.843982 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 23:57:09.844440 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 23:57:09.852424 (Thread-1): 00:57:09 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-25 23:57:09.859377 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:57:09.859821 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 23:57:09.911031 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:57:09.911800 (Thread-1): finished collecting timing info
2021-01-25 23:57:09.923720 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:57:09.924594 (Thread-1): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:57:09.924938 (Thread-1): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-25 23:57:09.925150 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:09.925348 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:10.046792 (Thread-1): Connected to db: None
2021-01-25 23:57:10.089807 (Thread-1): SQL status: OK in 0.16 seconds
2021-01-25 23:57:10.096757 (Thread-1): finished collecting timing info
2021-01-25 23:57:10.098760 (Thread-1): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-25 23:57:10.101703 (Thread-1): On model.subsurface.stg__municipalities: Close
2021-01-25 23:57:10.104530 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d08cb1a-d9d2-44b6-b7aa-91030cb67f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6347eaf898>]}
2021-01-25 23:57:10.107887 (Thread-1): 00:57:10 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 0.25s]
2021-01-25 23:57:10.109515 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 23:57:10.113461 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-25 23:57:10.116154 (Thread-1): 00:57:10 | 3 of 6 START view model @fab4.d_crop_types........................... [RUN]
2021-01-25 23:57:10.122967 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:10.123360 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-25 23:57:10.154391 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:57:10.155117 (Thread-1): finished collecting timing info
2021-01-25 23:57:10.163524 (Thread-1): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:57:10.166074 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:10.166607 (Thread-1): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-25 23:57:10.166962 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:10.167258 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:10.296124 (Thread-1): Connected to db: None
2021-01-25 23:57:10.341126 (Thread-1): SQL status: OK in 0.17 seconds
2021-01-25 23:57:10.347743 (Thread-1): finished collecting timing info
2021-01-25 23:57:10.348973 (Thread-1): On model.subsurface.d_crop_types: ROLLBACK
2021-01-25 23:57:10.349317 (Thread-1): On model.subsurface.d_crop_types: Close
2021-01-25 23:57:10.351470 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d08cb1a-d9d2-44b6-b7aa-91030cb67f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6347e9f7f0>]}
2021-01-25 23:57:10.354267 (Thread-1): 00:57:10 | 3 of 6 OK created view model @fab4.d_crop_types...................... [OK in 0.23s]
2021-01-25 23:57:10.354654 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-25 23:57:10.355059 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 23:57:10.358202 (Thread-1): 00:57:10 | 4 of 6 START view model @fab4.d_premises_types....................... [RUN]
2021-01-25 23:57:10.358952 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:10.359249 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 23:57:10.380661 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:57:10.383021 (Thread-1): finished collecting timing info
2021-01-25 23:57:10.395147 (Thread-1): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:57:10.395955 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:10.396382 (Thread-1): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-25 23:57:10.396638 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:10.396818 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:10.512180 (Thread-1): Connected to db: None
2021-01-25 23:57:10.559448 (Thread-1): SQL status: OK in 0.16 seconds
2021-01-25 23:57:10.566608 (Thread-1): finished collecting timing info
2021-01-25 23:57:10.568920 (Thread-1): On model.subsurface.d_premises_types: ROLLBACK
2021-01-25 23:57:10.569248 (Thread-1): On model.subsurface.d_premises_types: Close
2021-01-25 23:57:10.572675 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d08cb1a-d9d2-44b6-b7aa-91030cb67f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6347eaf898>]}
2021-01-25 23:57:10.575781 (Thread-1): 00:57:10 | 4 of 6 OK created view model @fab4.d_premises_types.................. [OK in 0.21s]
2021-01-25 23:57:10.577258 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 23:57:10.577716 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 23:57:10.580873 (Thread-1): 00:57:10 | 5 of 6 START view model @fab4.f_land_values.......................... [RUN]
2021-01-25 23:57:10.581649 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:57:10.581932 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 23:57:10.627708 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 23:57:10.672819 (Thread-1): finished collecting timing info
2021-01-25 23:57:10.685288 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-25 23:57:10.686041 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 23:57:10.686348 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-25 23:57:10.686585 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:10.686798 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:10.807858 (Thread-1): Connected to db: None
2021-01-25 23:57:10.947388 (Thread-1): SQL status: OK in 0.26 seconds
2021-01-25 23:57:10.953532 (Thread-1): finished collecting timing info
2021-01-25 23:57:10.954996 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-25 23:57:10.956088 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-25 23:57:10.958756 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d08cb1a-d9d2-44b6-b7aa-91030cb67f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6348057a58>]}
2021-01-25 23:57:10.960951 (Thread-1): 00:57:10 | 5 of 6 OK created view model @fab4.f_land_values..................... [OK in 0.38s]
2021-01-25 23:57:10.961294 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-25 23:57:10.961651 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-25 23:57:10.964788 (Thread-1): 00:57:10 | 6 of 6 START view model @fab4.d_municipalities....................... [RUN]
2021-01-25 23:57:10.965558 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:57:10.965863 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-25 23:57:10.986650 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-25 23:57:10.987422 (Thread-1): finished collecting timing info
2021-01-25 23:57:11.000743 (Thread-1): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-25 23:57:11.001581 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:57:11.001972 (Thread-1): On model.subsurface.d_municipalities: 
  create or replace view "@fab4"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-25 23:57:11.002150 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:11.002343 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:11.115100 (Thread-1): Connected to db: None
2021-01-25 23:57:11.189931 (Thread-1): SQL status: OK in 0.19 seconds
2021-01-25 23:57:11.197018 (Thread-1): finished collecting timing info
2021-01-25 23:57:11.197674 (Thread-1): On model.subsurface.d_municipalities: ROLLBACK
2021-01-25 23:57:11.198000 (Thread-1): On model.subsurface.d_municipalities: Close
2021-01-25 23:57:11.201491 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d08cb1a-d9d2-44b6-b7aa-91030cb67f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634805acc0>]}
2021-01-25 23:57:11.203771 (Thread-1): 00:57:11 | 6 of 6 OK created view model @fab4.d_municipalities.................. [OK in 0.24s]
2021-01-25 23:57:11.204094 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-25 23:57:11.234734 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:57:11.235243 (MainThread): On master: ROLLBACK
2021-01-25 23:57:11.235451 (MainThread): Opening a new connection, currently in state init
2021-01-25 23:57:11.235654 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:11.356509 (MainThread): Connected to db: None
2021-01-25 23:57:11.356857 (MainThread): On master: ROLLBACK
2021-01-25 23:57:11.357000 (MainThread): On master: Close
2021-01-25 23:57:11.359027 (MainThread): 00:57:11 | 
2021-01-25 23:57:11.359347 (MainThread): 00:57:11 | Finished running 6 view models in 2.73s.
2021-01-25 23:57:11.359593 (MainThread): Connection 'master' was properly closed.
2021-01-25 23:57:11.359802 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-25 23:57:11.360004 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-25 23:57:11.403479 (MainThread): 
2021-01-25 23:57:11.403947 (MainThread): Completed successfully
2021-01-25 23:57:11.404254 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-25 23:57:11.404699 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634805d978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6347dcaba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6348063cf8>]}
2021-01-25 23:57:11.405201 (MainThread): Flushing usage events
2021-01-25 23:57:52.729592 (MainThread): Running with dbt=0.18.1
2021-01-25 23:57:52.852363 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['+exposure:transfer_of_ownership'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-25 23:57:52.853598 (MainThread): Tracking: tracking
2021-01-25 23:57:52.861848 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaaaedf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa584e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa584ef0>]}
2021-01-25 23:57:52.921173 (MainThread): Partial parsing not enabled
2021-01-25 23:57:52.922910 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:57:52.928968 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:57:52.933401 (MainThread): Parsing macros/get_custom_database.sql
2021-01-25 23:57:52.938079 (MainThread): Parsing macros/helpers.sql
2021-01-25 23:57:52.963499 (MainThread): Parsing macros/catalog.sql
2021-01-25 23:57:52.968419 (MainThread): Parsing macros/adapters.sql
2021-01-25 23:57:53.015638 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-25 23:57:53.018150 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-25 23:57:53.024074 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-25 23:57:53.024641 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-25 23:57:53.030195 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-25 23:57:53.049024 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:57:53.066797 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:57:53.076155 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-25 23:57:53.091455 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:57:53.103401 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:57:53.133210 (MainThread): Parsing macros/core.sql
2021-01-25 23:57:53.140649 (MainThread): Parsing macros/adapters/common.sql
2021-01-25 23:57:53.233229 (MainThread): Parsing macros/etc/datetime.sql
2021-01-25 23:57:53.250923 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-25 23:57:53.254542 (MainThread): Parsing macros/etc/query.sql
2021-01-25 23:57:53.256972 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-25 23:57:53.259200 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-25 23:57:53.263496 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-25 23:57:53.267342 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-25 23:57:53.285679 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-25 23:57:53.289612 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-25 23:57:53.302631 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-25 23:57:53.355126 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-25 23:57:53.388696 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-25 23:57:53.392575 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-25 23:57:53.402867 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-25 23:57:53.415121 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-25 23:57:53.441869 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-25 23:57:53.455649 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-25 23:57:53.495832 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-25 23:57:53.500560 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-25 23:57:53.504114 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-25 23:57:53.507878 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-25 23:57:53.523349 (MainThread): Partial parsing not enabled
2021-01-25 23:57:53.640434 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-25 23:57:53.687148 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:53.709525 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:53.731454 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:57:53.756367 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:57:53.778464 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:57:53.809052 (MainThread): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-25 23:57:53.845467 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-25 23:57:53.866601 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-25 23:57:55.845451 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-25 23:57:55.846577 (MainThread): context manager reversed is deprecated and to be removed in 3.0.Use G.reverse(copy=False) if G.is_directed() else G instead.
2021-01-25 23:57:55.852349 (MainThread): 
2021-01-25 23:57:55.853106 (MainThread): Acquiring new dremio connection "master".
2021-01-25 23:57:55.875339 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-25 23:57:55.904447 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-25 23:57:55.904715 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-25 23:57:55.904880 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-25 23:57:55.905052 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:56.052316 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-25 23:57:56.167363 (ThreadPoolExecutor-0_0): SQL status: OK in 0.26 seconds
2021-01-25 23:57:56.187175 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-25 23:57:56.383431 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-25 23:57:56.399804 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-25 23:57:56.401088 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-25 23:57:56.402116 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-25 23:57:56.403075 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:56.525145 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-25 23:57:56.751692 (ThreadPoolExecutor-1_0): SQL status: OK in 0.35 seconds
2021-01-25 23:57:56.784664 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-25 23:57:56.785892 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-25 23:57:56.789800 (MainThread): 00:57:56 | Concurrency: 1 threads (target='unmanaged')
2021-01-25 23:57:56.795691 (MainThread): 00:57:56 | 
2021-01-25 23:57:56.803939 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-25 23:57:56.807407 (Thread-1): 00:57:56 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-25 23:57:56.809687 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:57:56.811647 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-25 23:57:56.893378 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:57:56.895093 (Thread-1): finished collecting timing info
2021-01-25 23:57:56.948300 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-25 23:57:56.949966 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-25 23:57:56.951067 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-25 23:57:56.952031 (Thread-1): Opening a new connection, currently in state init
2021-01-25 23:57:56.953410 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:57.077994 (Thread-1): Connected to db: None
2021-01-25 23:57:57.164423 (Thread-1): SQL status: OK in 0.21 seconds
2021-01-25 23:57:57.174550 (Thread-1): finished collecting timing info
2021-01-25 23:57:57.178627 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-25 23:57:57.179031 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-25 23:57:57.182892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803834f8-6c66-4a0a-9e07-a7512be0d9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa3c75c0>]}
2021-01-25 23:57:57.185203 (Thread-1): 00:57:57 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 0.37s]
2021-01-25 23:57:57.185539 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-25 23:57:57.185874 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-25 23:57:57.188370 (Thread-1): 00:57:57 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-25 23:57:57.189467 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:57:57.189834 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-25 23:57:57.222913 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:57:57.223612 (Thread-1): finished collecting timing info
2021-01-25 23:57:57.239853 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-25 23:57:57.240647 (Thread-1): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-25 23:57:57.241028 (Thread-1): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-25 23:57:57.241258 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:57.241467 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:57.358955 (Thread-1): Connected to db: None
2021-01-25 23:57:57.402855 (Thread-1): SQL status: OK in 0.16 seconds
2021-01-25 23:57:57.409801 (Thread-1): finished collecting timing info
2021-01-25 23:57:57.410471 (Thread-1): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-25 23:57:57.410810 (Thread-1): On model.subsurface.stg__municipalities: Close
2021-01-25 23:57:57.413403 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803834f8-6c66-4a0a-9e07-a7512be0d9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa22c080>]}
2021-01-25 23:57:57.416453 (Thread-1): 00:57:57 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 0.22s]
2021-01-25 23:57:57.416784 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-25 23:57:57.417129 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-25 23:57:57.419962 (Thread-1): 00:57:57 | 3 of 6 START table model @fab4.d_crop_types.......................... [RUN]
2021-01-25 23:57:57.420900 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:57.421205 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-25 23:57:57.443897 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:57:57.444632 (Thread-1): finished collecting timing info
2021-01-25 23:57:57.508300 (Thread-1): On "model.subsurface.d_crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 23:57:57.513163 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:57.513441 (Thread-1): On model.subsurface.d_crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 23:57:57.513629 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:57.513814 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:57.634760 (Thread-1): Connected to db: None
2021-01-25 23:57:57.833509 (Thread-1): SQL status: OK in 0.32 seconds
2021-01-25 23:57:57.847151 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 23:57:57.848983 (Thread-1): On "model.subsurface.d_crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 23:57:57.853543 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:57.853816 (Thread-1): On model.subsurface.d_crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 23:57:58.146303 (Thread-1): SQL status: OK in 0.29 seconds
2021-01-25 23:57:58.166351 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 23:57:58.187792 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:58.189027 (Thread-1): On model.subsurface.d_crop_types: drop table if exists "$scratch"."subsurface"."@fab4"."d_crop_types_green"
2021-01-25 23:57:58.208033 (Thread-1): SQL status: OK in 0.02 seconds
2021-01-25 23:57:58.225224 (Thread-1): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-25 23:57:58.226933 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:58.228138 (Thread-1): On model.subsurface.d_crop_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."d_crop_types_green"
  
  
  as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

  
2021-01-25 23:57:58.370119 (Thread-1): SQL status: OK in 0.14 seconds
2021-01-25 23:57:58.372614 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-25 23:57:58.372988 (Thread-1): On model.subsurface.d_crop_types: 
    
  create or replace view "@fab4"."d_crop_types" as (
    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"
  )

  
2021-01-25 23:57:58.516322 (Thread-1): Error running SQL: 
    
  create or replace view "@fab4"."d_crop_types" as (
    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"
  )

  
2021-01-25 23:57:58.516685 (Thread-1): Rolling back transaction.
2021-01-25 23:57:58.516962 (Thread-1): On model.subsurface.d_crop_types: ROLLBACK
2021-01-25 23:57:58.517277 (Thread-1): On model.subsurface.d_crop_types: Close
2021-01-25 23:57:58.518385 (Thread-1): finished collecting timing info
2021-01-25 23:57:58.520185 (Thread-1): Runtime Error in model d_crop_types (models/marts/d_crop_types.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."d_crop_types" as (\n    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: RuntimeException: Error while running command to get file permissions : ExitCodeException exitCode=2: ls: impossible d\'accéder à \'/opt/dremio/data/pdfs/scratch/subsurface/@fab4/...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."d_crop_types" as (\n    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: RuntimeException: Error while running command to get file permissions : ExitCodeException exitCode=2: ls: impossible d\'accéder à \'/opt/dremio/data/pdfs/scratch/subsurface/@fab4/...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model d_crop_types (models/marts/d_crop_types.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."d_crop_types" as (\n    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: RuntimeException: Error while running command to get file permissions : ExitCodeException exitCode=2: ls: impossible d\'accéder à \'/opt/dremio/data/pdfs/scratch/subsurface/@fab4/...[see log] (1040) (SQLExecDirectW)')
2021-01-25 23:57:58.525179 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803834f8-6c66-4a0a-9e07-a7512be0d9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa3ed1d0>]}
2021-01-25 23:57:58.529139 (Thread-1): 00:57:58 | 3 of 6 ERROR creating table model @fab4.d_crop_types................. [ERROR in 1.10s]
2021-01-25 23:57:58.531349 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-25 23:57:58.543577 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-25 23:57:58.546201 (Thread-1): 00:57:58 | 4 of 6 START table model @fab4.d_premises_types...................... [RUN]
2021-01-25 23:57:58.546960 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:58.549013 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-25 23:57:58.605414 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:57:58.609358 (Thread-1): finished collecting timing info
2021-01-25 23:57:58.628912 (Thread-1): On "model.subsurface.d_premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 23:57:58.637941 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:58.639133 (Thread-1): On model.subsurface.d_premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 23:57:58.641256 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:58.642229 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:58.781974 (Thread-1): Connected to db: None
2021-01-25 23:57:58.992285 (Thread-1): SQL status: OK in 0.35 seconds
2021-01-25 23:57:59.017753 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 23:57:59.019805 (Thread-1): On "model.subsurface.d_premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 23:57:59.029251 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:59.030408 (Thread-1): On model.subsurface.d_premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 23:57:59.235537 (Thread-1): SQL status: OK in 0.20 seconds
2021-01-25 23:57:59.253979 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 23:57:59.262060 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:59.263207 (Thread-1): On model.subsurface.d_premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."d_premises_types_green"
2021-01-25 23:57:59.279706 (Thread-1): SQL status: OK in 0.02 seconds
2021-01-25 23:57:59.292234 (Thread-1): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-25 23:57:59.293792 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:59.299837 (Thread-1): On model.subsurface.d_premises_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."d_premises_types_green"
  
  
  as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

  
2021-01-25 23:57:59.467207 (Thread-1): SQL status: OK in 0.17 seconds
2021-01-25 23:57:59.470747 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:59.471946 (Thread-1): On model.subsurface.d_premises_types: 
    
  create or replace view "@fab4"."d_premises_types" as (
    select * from "$scratch"."subsurface"."@fab4"."d_premises_types_green"
  )

  
2021-01-25 23:57:59.561040 (Thread-1): SQL status: OK in 0.09 seconds
2021-01-25 23:57:59.568033 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-25 23:57:59.568316 (Thread-1): On model.subsurface.d_premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."d_premises_types_blue"
2021-01-25 23:57:59.575041 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-25 23:57:59.592441 (Thread-1): finished collecting timing info
2021-01-25 23:57:59.593001 (Thread-1): On model.subsurface.d_premises_types: ROLLBACK
2021-01-25 23:57:59.593277 (Thread-1): On model.subsurface.d_premises_types: Close
2021-01-25 23:57:59.595183 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803834f8-6c66-4a0a-9e07-a7512be0d9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea9658710>]}
2021-01-25 23:57:59.598789 (Thread-1): 00:57:59 | 4 of 6 OK created table model @fab4.d_premises_types................. [OK in 1.05s]
2021-01-25 23:57:59.599847 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-25 23:57:59.600273 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-25 23:57:59.602769 (Thread-1): 00:57:59 | 5 of 6 START table model @fab4.f_land_values......................... [RUN]
2021-01-25 23:57:59.603634 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-25 23:57:59.603997 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-25 23:57:59.646236 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-25 23:57:59.646954 (Thread-1): finished collecting timing info
2021-01-25 23:57:59.662754 (Thread-1): On "model.subsurface.f_land_values": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 23:57:59.668266 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 23:57:59.668535 (Thread-1): On model.subsurface.f_land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 23:57:59.668741 (Thread-1): Opening a new connection, currently in state closed
2021-01-25 23:57:59.668949 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-25 23:57:59.789527 (Thread-1): Connected to db: None
2021-01-25 23:57:59.984788 (Thread-1): SQL status: OK in 0.32 seconds
2021-01-25 23:58:00.012072 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 23:58:00.013792 (Thread-1): On "model.subsurface.f_land_values": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-25 23:58:00.021594 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 23:58:00.022655 (Thread-1): On model.subsurface.f_land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-25 23:58:00.290554 (Thread-1): SQL status: OK in 0.27 seconds
2021-01-25 23:58:00.320852 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-25 23:58:00.327476 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 23:58:00.328423 (Thread-1): On model.subsurface.f_land_values: drop table if exists "$scratch"."subsurface"."@fab4"."f_land_values_green"
2021-01-25 23:58:00.335555 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-25 23:58:00.337888 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-25 23:58:00.338687 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-25 23:58:00.339020 (Thread-1): On model.subsurface.f_land_values: 
    

  create table
    "$scratch"."subsurface"."@fab4"."f_land_values_green"
  
  
  as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

  
2021-01-26 00:00:14.503498 (Thread-1): SQL status: OK in 134.13 seconds
2021-01-26 00:00:14.573582 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-26 00:00:14.573869 (Thread-1): On model.subsurface.f_land_values: 
    
  create or replace view "@fab4"."f_land_values" as (
    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"
  )

  
2021-01-26 00:00:15.581968 (Thread-1): Error running SQL: 
    
  create or replace view "@fab4"."f_land_values" as (
    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"
  )

  
2021-01-26 00:00:15.583748 (Thread-1): Rolling back transaction.
2021-01-26 00:00:15.584338 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-26 00:00:15.584785 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-26 00:00:15.588242 (Thread-1): finished collecting timing info
2021-01-26 00:00:15.591833 (Thread-1): Runtime Error in model f_land_values (models/marts/f_land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."f_land_values" as (\n    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.@fab4.f_land_values_green\' not found\n\n\n[Error Id: 1826b2b1-b5db-4630-96ea-08b71d909bb4 on fabrice-pc:31010]\n\n  (com.dremio.exec...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."f_land_values" as (\n    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.@fab4.f_land_values_green\' not found\n\n\n[Error Id: 1826b2b1-b5db-4630-96ea-08b71d909bb4 on fabrice-pc:31010]\n\n  (com.dremio.exec...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model f_land_values (models/marts/f_land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."f_land_values" as (\n    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.@fab4.f_land_values_green\' not found\n\n\n[Error Id: 1826b2b1-b5db-4630-96ea-08b71d909bb4 on fabrice-pc:31010]\n\n  (com.dremio.exec...[see log] (1040) (SQLExecDirectW)')
2021-01-26 00:00:15.661316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803834f8-6c66-4a0a-9e07-a7512be0d9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa163080>]}
2021-01-26 00:00:15.665002 (Thread-1): 01:00:15 | 5 of 6 ERROR creating table model @fab4.f_land_values................ [ERROR in 136.05s]
2021-01-26 00:00:15.665747 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 00:00:15.666288 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 00:00:15.670037 (Thread-1): 01:00:15 | 6 of 6 START table model @fab4.d_municipalities...................... [RUN]
2021-01-26 00:00:15.670779 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:00:15.671003 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 00:00:15.688133 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 00:00:15.745961 (Thread-1): finished collecting timing info
2021-01-26 00:00:15.764010 (Thread-1): On "model.subsurface.d_municipalities": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:00:15.768679 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:00:15.768949 (Thread-1): On model.subsurface.d_municipalities: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:00:15.769123 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:00:15.769305 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:00:16.153115 (Thread-1): Connected to db: None
2021-01-26 00:00:16.442116 (Thread-1): SQL status: OK in 0.67 seconds
2021-01-26 00:00:16.484290 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:00:16.486062 (Thread-1): On "model.subsurface.d_municipalities": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:00:16.498429 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:00:16.499616 (Thread-1): On model.subsurface.d_municipalities: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:00:16.695549 (Thread-1): SQL status: OK in 0.19 seconds
2021-01-26 00:00:16.713101 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:00:16.716506 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:00:16.716767 (Thread-1): On model.subsurface.d_municipalities: drop table if exists "$scratch"."subsurface"."@fab4"."d_municipalities_green"
2021-01-26 00:00:16.725409 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-26 00:00:16.728597 (Thread-1): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-26 00:00:16.744494 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:00:16.744870 (Thread-1): On model.subsurface.d_municipalities: 
    

  create table
    "$scratch"."subsurface"."@fab4"."d_municipalities_green"
  
  
  as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

  
2021-01-26 00:00:17.109754 (Thread-1): SQL status: OK in 0.36 seconds
2021-01-26 00:00:17.115512 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:00:17.116476 (Thread-1): On model.subsurface.d_municipalities: 
    
  create or replace view "@fab4"."d_municipalities" as (
    select * from "$scratch"."subsurface"."@fab4"."d_municipalities_green"
  )

  
2021-01-26 00:00:17.196073 (Thread-1): SQL status: OK in 0.08 seconds
2021-01-26 00:00:17.203258 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:00:17.204452 (Thread-1): On model.subsurface.d_municipalities: drop table if exists "$scratch"."subsurface"."@fab4"."d_municipalities_blue"
2021-01-26 00:00:17.216315 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-26 00:00:17.222803 (Thread-1): finished collecting timing info
2021-01-26 00:00:17.223492 (Thread-1): On model.subsurface.d_municipalities: ROLLBACK
2021-01-26 00:00:17.223811 (Thread-1): On model.subsurface.d_municipalities: Close
2021-01-26 00:00:17.225884 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803834f8-6c66-4a0a-9e07-a7512be0d9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa35ca58>]}
2021-01-26 00:00:17.229593 (Thread-1): 01:00:17 | 6 of 6 OK created table model @fab4.d_municipalities................. [OK in 1.55s]
2021-01-26 00:00:17.230014 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 00:00:17.287487 (MainThread): Acquiring new dremio connection "master".
2021-01-26 00:00:17.288016 (MainThread): On master: ROLLBACK
2021-01-26 00:00:17.288360 (MainThread): Opening a new connection, currently in state init
2021-01-26 00:00:17.288693 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:00:17.414876 (MainThread): Connected to db: None
2021-01-26 00:00:17.415201 (MainThread): On master: ROLLBACK
2021-01-26 00:00:17.415316 (MainThread): On master: Close
2021-01-26 00:00:17.417290 (MainThread): 01:00:17 | 
2021-01-26 00:00:17.417660 (MainThread): 01:00:17 | Finished running 2 view models, 4 table models in 141.56s.
2021-01-26 00:00:17.417905 (MainThread): Connection 'master' was properly closed.
2021-01-26 00:00:17.418098 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-26 00:00:17.418370 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-26 00:00:17.540610 (MainThread): 
2021-01-26 00:00:17.541040 (MainThread): Completed with 2 errors and 0 warnings:
2021-01-26 00:00:17.541393 (MainThread): 
2021-01-26 00:00:17.541719 (MainThread): Runtime Error in model d_crop_types (models/marts/d_crop_types.sql)
2021-01-26 00:00:17.542190 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."d_crop_types" as (\n    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: RuntimeException: Error while running command to get file permissions : ExitCodeException exitCode=2: ls: impossible d\'accéder à \'/opt/dremio/data/pdfs/scratch/subsurface/@fab4/...[see log] (1040) (SQLExecDirectW)')
2021-01-26 00:00:17.542588 (MainThread): 
2021-01-26 00:00:17.543209 (MainThread): Runtime Error in model f_land_values (models/marts/f_land_values.sql)
2021-01-26 00:00:17.543864 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."f_land_values" as (\n    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.@fab4.f_land_values_green\' not found\n\n\n[Error Id: 1826b2b1-b5db-4630-96ea-08b71d909bb4 on fabrice-pc:31010]\n\n  (com.dremio.exec...[see log] (1040) (SQLExecDirectW)')
2021-01-26 00:00:17.544234 (MainThread): 
Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
2021-01-26 00:00:17.544808 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa22eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa42d048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa400320>]}
2021-01-26 00:00:17.545464 (MainThread): Flushing usage events
2021-01-26 00:00:54.766822 (MainThread): Running with dbt=0.18.1
2021-01-26 00:00:55.055181 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['+exposure:transfer_of_ownership'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-26 00:00:55.059922 (MainThread): Tracking: tracking
2021-01-26 00:00:55.121114 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600f715978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600f1bcef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600f1bcf60>]}
2021-01-26 00:00:55.182439 (MainThread): Partial parsing not enabled
2021-01-26 00:00:55.198662 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 00:00:55.238496 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 00:00:55.261450 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 00:00:55.268954 (MainThread): Parsing macros/helpers.sql
2021-01-26 00:00:55.298223 (MainThread): Parsing macros/catalog.sql
2021-01-26 00:00:55.303341 (MainThread): Parsing macros/adapters.sql
2021-01-26 00:00:55.351050 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 00:00:55.353703 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 00:00:55.360474 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 00:00:55.361250 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 00:00:55.367160 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 00:00:55.387126 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 00:00:55.405347 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 00:00:55.414893 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 00:00:55.430450 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 00:00:55.442410 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 00:00:55.483848 (MainThread): Parsing macros/core.sql
2021-01-26 00:00:55.496126 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 00:00:55.581815 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 00:00:55.599986 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 00:00:55.603800 (MainThread): Parsing macros/etc/query.sql
2021-01-26 00:00:55.606438 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 00:00:55.609678 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 00:00:55.614293 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 00:00:55.618029 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 00:00:55.636983 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 00:00:55.641961 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 00:00:55.654220 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 00:00:55.709224 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 00:00:55.744182 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 00:00:55.748738 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 00:00:55.759605 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 00:00:55.771746 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 00:00:55.799965 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 00:00:55.814152 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 00:00:55.855087 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 00:00:55.860379 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 00:00:55.864082 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 00:00:55.868014 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 00:00:55.883891 (MainThread): Partial parsing not enabled
2021-01-26 00:00:56.043085 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:00:56.100948 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:00:56.131101 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:00:56.155398 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 00:00:56.192134 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:00:56.219269 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:00:56.255599 (MainThread): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-26 00:00:56.300207 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 00:00:56.328674 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 00:00:58.383386 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 00:00:58.384423 (MainThread): context manager reversed is deprecated and to be removed in 3.0.Use G.reverse(copy=False) if G.is_directed() else G instead.
2021-01-26 00:00:58.390229 (MainThread): 
2021-01-26 00:00:58.391052 (MainThread): Acquiring new dremio connection "master".
2021-01-26 00:00:58.411103 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-26 00:00:58.441216 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-26 00:00:58.442180 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-26 00:00:58.442816 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 00:00:58.443342 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:00:58.786902 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 00:00:58.922833 (ThreadPoolExecutor-0_0): SQL status: OK in 0.48 seconds
2021-01-26 00:00:58.969718 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-26 00:00:59.104091 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 00:00:59.118930 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 00:00:59.119266 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 00:00:59.119947 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-26 00:00:59.120218 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:00:59.233082 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-26 00:00:59.487725 (ThreadPoolExecutor-1_0): SQL status: OK in 0.37 seconds
2021-01-26 00:00:59.516953 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 00:00:59.517992 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-26 00:00:59.520487 (MainThread): 01:00:59 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 00:00:59.520834 (MainThread): 01:00:59 | 
2021-01-26 00:00:59.548983 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 00:00:59.554409 (Thread-1): 01:00:59 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-26 00:00:59.555292 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:00:59.555788 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 00:00:59.616300 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 00:00:59.630125 (Thread-1): finished collecting timing info
2021-01-26 00:00:59.677137 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-26 00:00:59.682633 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:00:59.683003 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-26 00:00:59.683265 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:00:59.683519 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:00:59.803428 (Thread-1): Connected to db: None
2021-01-26 00:00:59.870370 (Thread-1): SQL status: OK in 0.19 seconds
2021-01-26 00:00:59.882082 (Thread-1): finished collecting timing info
2021-01-26 00:00:59.887118 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-26 00:00:59.887426 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-26 00:00:59.889278 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebc82ab-aecf-4c4a-bd33-9ce6c3c575de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600ee700f0>]}
2021-01-26 00:00:59.898923 (Thread-1): 01:00:59 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 0.33s]
2021-01-26 00:00:59.899248 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 00:00:59.899597 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 00:00:59.902400 (Thread-1): 01:00:59 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-26 00:00:59.903740 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:00:59.904394 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 00:00:59.939846 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 00:00:59.941135 (Thread-1): finished collecting timing info
2021-01-26 00:00:59.952060 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-26 00:00:59.952885 (Thread-1): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:00:59.953417 (Thread-1): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-26 00:00:59.953634 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:00:59.953876 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:01:00.070668 (Thread-1): Connected to db: None
2021-01-26 00:01:00.116524 (Thread-1): SQL status: OK in 0.16 seconds
2021-01-26 00:01:00.123175 (Thread-1): finished collecting timing info
2021-01-26 00:01:00.126851 (Thread-1): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-26 00:01:00.128141 (Thread-1): On model.subsurface.stg__municipalities: Close
2021-01-26 00:01:00.131425 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebc82ab-aecf-4c4a-bd33-9ce6c3c575de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600efd30f0>]}
2021-01-26 00:01:00.135160 (Thread-1): 01:01:00 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 0.23s]
2021-01-26 00:01:00.136794 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 00:01:00.150306 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 00:01:00.153391 (Thread-1): 01:01:00 | 3 of 6 START table model @fab4.d_crop_types.......................... [RUN]
2021-01-26 00:01:00.155474 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:01:00.155875 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 00:01:00.180931 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 00:01:00.181741 (Thread-1): finished collecting timing info
2021-01-26 00:01:00.244955 (Thread-1): On "model.subsurface.d_crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:01:00.249885 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:01:00.250146 (Thread-1): On model.subsurface.d_crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:01:00.250266 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:01:00.250389 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:01:00.368509 (Thread-1): Connected to db: None
2021-01-26 00:01:00.563973 (Thread-1): SQL status: OK in 0.31 seconds
2021-01-26 00:01:00.588345 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_municipalities_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:01:00.593237 (Thread-1): On "model.subsurface.d_crop_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:01:00.599946 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:01:00.601074 (Thread-1): On model.subsurface.d_crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:01:00.811907 (Thread-1): SQL status: OK in 0.21 seconds
2021-01-26 00:01:00.844531 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_municipalities_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:01:00.862453 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:01:00.863537 (Thread-1): On model.subsurface.d_crop_types: drop table if exists "$scratch"."subsurface"."@fab4"."d_crop_types_green"
2021-01-26 00:01:00.872135 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-26 00:01:00.886308 (Thread-1): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-26 00:01:00.887227 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:01:00.887722 (Thread-1): On model.subsurface.d_crop_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."d_crop_types_green"
  
  
  as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

  
2021-01-26 00:01:01.036610 (Thread-1): SQL status: OK in 0.15 seconds
2021-01-26 00:01:01.039179 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:01:01.039482 (Thread-1): On model.subsurface.d_crop_types: 
    
  create or replace view "@fab4"."d_crop_types" as (
    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"
  )

  
2021-01-26 00:01:01.084232 (Thread-1): Error running SQL: 
    
  create or replace view "@fab4"."d_crop_types" as (
    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"
  )

  
2021-01-26 00:01:01.084548 (Thread-1): Rolling back transaction.
2021-01-26 00:01:01.084796 (Thread-1): On model.subsurface.d_crop_types: ROLLBACK
2021-01-26 00:01:01.085027 (Thread-1): On model.subsurface.d_crop_types: Close
2021-01-26 00:01:01.086042 (Thread-1): finished collecting timing info
2021-01-26 00:01:01.087237 (Thread-1): Runtime Error in model d_crop_types (models/marts/d_crop_types.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."d_crop_types" as (\n    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nVALIDATION ERROR: java.io.FileNotFoundException: File /opt/dremio/data/pdfs/scratch/subsurface/@fab4/d_crop_types_green/0_0_0.parquet does not exist\n\n\n[Error Id: 063fa908-e654-41f9-a7c3-9833cf8...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."d_crop_types" as (\n    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nVALIDATION ERROR: java.io.FileNotFoundException: File /opt/dremio/data/pdfs/scratch/subsurface/@fab4/d_crop_types_green/0_0_0.parquet does not exist\n\n\n[Error Id: 063fa908-e654-41f9-a7c3-9833cf8...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model d_crop_types (models/marts/d_crop_types.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."d_crop_types" as (\n    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nVALIDATION ERROR: java.io.FileNotFoundException: File /opt/dremio/data/pdfs/scratch/subsurface/@fab4/d_crop_types_green/0_0_0.parquet does not exist\n\n\n[Error Id: 063fa908-e654-41f9-a7c3-9833cf8...[see log] (1040) (SQLExecDirectW)')
2021-01-26 00:01:01.147247 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebc82ab-aecf-4c4a-bd33-9ce6c3c575de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600ee70cf8>]}
2021-01-26 00:01:01.150237 (Thread-1): 01:01:01 | 3 of 6 ERROR creating table model @fab4.d_crop_types................. [ERROR in 0.99s]
2021-01-26 00:01:01.150675 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 00:01:01.151119 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 00:01:01.154811 (Thread-1): 01:01:01 | 4 of 6 START table model @fab4.d_premises_types...................... [RUN]
2021-01-26 00:01:01.155554 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:01:01.155874 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 00:01:01.179268 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 00:01:01.180022 (Thread-1): finished collecting timing info
2021-01-26 00:01:01.200467 (Thread-1): On "model.subsurface.d_premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:01:01.208868 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:01:01.209181 (Thread-1): On model.subsurface.d_premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:01:01.209411 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:01:01.209630 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:01:01.328531 (Thread-1): Connected to db: None
2021-01-26 00:01:01.511671 (Thread-1): SQL status: OK in 0.30 seconds
2021-01-26 00:01:01.536445 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_municipalities_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:01:01.537998 (Thread-1): On "model.subsurface.d_premises_types": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:01:01.546912 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:01:01.548062 (Thread-1): On model.subsurface.d_premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:01:01.804604 (Thread-1): SQL status: OK in 0.26 seconds
2021-01-26 00:01:01.820874 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_municipalities_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:01:01.830997 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:01:01.832092 (Thread-1): On model.subsurface.d_premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."d_premises_types_blue"
2021-01-26 00:01:01.843911 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-26 00:01:01.847227 (Thread-1): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-26 00:01:01.848056 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:01:01.848375 (Thread-1): On model.subsurface.d_premises_types: 
    

  create table
    "$scratch"."subsurface"."@fab4"."d_premises_types_blue"
  
  
  as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

  
2021-01-26 00:01:01.993146 (Thread-1): SQL status: OK in 0.14 seconds
2021-01-26 00:01:01.995924 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:01:01.996369 (Thread-1): On model.subsurface.d_premises_types: 
    
  create or replace view "@fab4"."d_premises_types" as (
    select * from "$scratch"."subsurface"."@fab4"."d_premises_types_blue"
  )

  
2021-01-26 00:01:02.054641 (Thread-1): SQL status: OK in 0.06 seconds
2021-01-26 00:01:02.061142 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:01:02.061576 (Thread-1): On model.subsurface.d_premises_types: drop table if exists "$scratch"."subsurface"."@fab4"."d_premises_types_green"
2021-01-26 00:01:02.095884 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-26 00:01:02.118517 (Thread-1): finished collecting timing info
2021-01-26 00:01:02.119920 (Thread-1): On model.subsurface.d_premises_types: ROLLBACK
2021-01-26 00:01:02.120953 (Thread-1): On model.subsurface.d_premises_types: Close
2021-01-26 00:01:02.124324 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebc82ab-aecf-4c4a-bd33-9ce6c3c575de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600e2949b0>]}
2021-01-26 00:01:02.128779 (Thread-1): 01:01:02 | 4 of 6 OK created table model @fab4.d_premises_types................. [OK in 0.97s]
2021-01-26 00:01:02.130352 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 00:01:02.135992 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 00:01:02.141887 (Thread-1): 01:01:02 | 5 of 6 START table model @fab4.f_land_values......................... [RUN]
2021-01-26 00:01:02.145045 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 00:01:02.145439 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 00:01:02.214683 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 00:01:02.218738 (Thread-1): finished collecting timing info
2021-01-26 00:01:02.237234 (Thread-1): On "model.subsurface.f_land_values": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:01:02.244557 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-26 00:01:02.245840 (Thread-1): On model.subsurface.f_land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:01:02.246800 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:01:02.247643 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:01:02.367779 (Thread-1): Connected to db: None
2021-01-26 00:01:02.787209 (Thread-1): SQL status: OK in 0.54 seconds
2021-01-26 00:01:02.810201 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_municipalities_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:01:02.811049 (Thread-1): On "model.subsurface.f_land_values": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:01:02.815925 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-26 00:01:02.816192 (Thread-1): On model.subsurface.f_land_values: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:01:03.282716 (Thread-1): SQL status: OK in 0.47 seconds
2021-01-26 00:01:03.309230 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_municipalities_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:01:03.313648 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-26 00:01:03.314388 (Thread-1): On model.subsurface.f_land_values: drop table if exists "$scratch"."subsurface"."@fab4"."f_land_values_green"
2021-01-26 00:01:03.325091 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-26 00:01:03.327572 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-26 00:01:03.329180 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-26 00:01:03.330228 (Thread-1): On model.subsurface.f_land_values: 
    

  create table
    "$scratch"."subsurface"."@fab4"."f_land_values_green"
  
  
  as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

  
2021-01-26 00:03:22.517658 (Thread-1): SQL status: OK in 139.19 seconds
2021-01-26 00:03:22.758658 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-26 00:03:22.758976 (Thread-1): On model.subsurface.f_land_values: 
    
  create or replace view "@fab4"."f_land_values" as (
    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"
  )

  
2021-01-26 00:03:23.055377 (Thread-1): Error running SQL: 
    
  create or replace view "@fab4"."f_land_values" as (
    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"
  )

  
2021-01-26 00:03:23.055768 (Thread-1): Rolling back transaction.
2021-01-26 00:03:23.056058 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-26 00:03:23.056318 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-26 00:03:23.058557 (Thread-1): finished collecting timing info
2021-01-26 00:03:23.059850 (Thread-1): Runtime Error in model f_land_values (models/marts/f_land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."f_land_values" as (\n    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.@fab4.f_land_values_green\' not found\n\n\n[Error Id: 44ff90e6-dc3b-473b-b301-6c926c2b1f5c on fabrice-pc:31010]\n\n  (com.dremio.exec...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."f_land_values" as (\n    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.@fab4.f_land_values_green\' not found\n\n\n[Error Id: 44ff90e6-dc3b-473b-b301-6c926c2b1f5c on fabrice-pc:31010]\n\n  (com.dremio.exec...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/fabrice/.local/lib/python3.7/site-packages/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model f_land_values (models/marts/f_land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."f_land_values" as (\n    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.@fab4.f_land_values_green\' not found\n\n\n[Error Id: 44ff90e6-dc3b-473b-b301-6c926c2b1f5c on fabrice-pc:31010]\n\n  (com.dremio.exec...[see log] (1040) (SQLExecDirectW)')
2021-01-26 00:03:23.061054 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebc82ab-aecf-4c4a-bd33-9ce6c3c575de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600efd3208>]}
2021-01-26 00:03:23.063611 (Thread-1): 01:03:23 | 5 of 6 ERROR creating table model @fab4.f_land_values................ [ERROR in 140.92s]
2021-01-26 00:03:23.064006 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 00:03:23.064270 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 00:03:23.066790 (Thread-1): 01:03:23 | 6 of 6 START table model @fab4.d_municipalities...................... [RUN]
2021-01-26 00:03:23.067454 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:03:23.067740 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 00:03:23.084692 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 00:03:23.086267 (Thread-1): finished collecting timing info
2021-01-26 00:03:23.109483 (Thread-1): On "model.subsurface.d_municipalities": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:03:23.117614 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:03:23.117961 (Thread-1): On model.subsurface.d_municipalities: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:03:23.118144 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:03:23.118312 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:03:24.164043 (Thread-1): Connected to db: None
2021-01-26 00:03:24.496607 (Thread-1): SQL status: OK in 1.38 seconds
2021-01-26 00:03:24.530719 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_municipalities_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:03:24.531624 (Thread-1): On "model.subsurface.d_municipalities": cache miss for schema "$scratch.subsurface.@fab4", this is inefficient
2021-01-26 00:03:24.544776 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:03:24.546236 (Thread-1): On model.subsurface.d_municipalities: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'subsurface.@fab4')
      and table_type <> 'system_table'
  
2021-01-26 00:03:24.797867 (Thread-1): SQL status: OK in 0.25 seconds
2021-01-26 00:03:24.839661 (Thread-1): with database=$scratch, schema=subsurface.@fab4, relations=[<DremioRelation "$scratch"."subsurface"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_municipalities_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."d_premises_types_blue">, <DremioRelation "$scratch"."subsurface"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."subsurface"."@fab4"."transfer_types_green">]
2021-01-26 00:03:24.858256 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:03:24.859426 (Thread-1): On model.subsurface.d_municipalities: drop table if exists "$scratch"."subsurface"."@fab4"."d_municipalities_blue"
2021-01-26 00:03:24.867912 (Thread-1): SQL status: OK in 0.01 seconds
2021-01-26 00:03:24.878249 (Thread-1): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-26 00:03:24.880324 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:03:24.881824 (Thread-1): On model.subsurface.d_municipalities: 
    

  create table
    "$scratch"."subsurface"."@fab4"."d_municipalities_blue"
  
  
  as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

  
2021-01-26 00:03:25.377404 (Thread-1): SQL status: OK in 0.49 seconds
2021-01-26 00:03:25.379511 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:03:25.379757 (Thread-1): On model.subsurface.d_municipalities: 
    
  create or replace view "@fab4"."d_municipalities" as (
    select * from "$scratch"."subsurface"."@fab4"."d_municipalities_blue"
  )

  
2021-01-26 00:03:25.451304 (Thread-1): SQL status: OK in 0.07 seconds
2021-01-26 00:03:25.457390 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:03:25.458545 (Thread-1): On model.subsurface.d_municipalities: drop table if exists "$scratch"."subsurface"."@fab4"."d_municipalities_green"
2021-01-26 00:03:25.494502 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-26 00:03:25.563057 (Thread-1): finished collecting timing info
2021-01-26 00:03:25.563596 (Thread-1): On model.subsurface.d_municipalities: ROLLBACK
2021-01-26 00:03:25.563877 (Thread-1): On model.subsurface.d_municipalities: Close
2021-01-26 00:03:25.566016 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebc82ab-aecf-4c4a-bd33-9ce6c3c575de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600f04ecf8>]}
2021-01-26 00:03:25.569206 (Thread-1): 01:03:25 | 6 of 6 OK created table model @fab4.d_municipalities................. [OK in 2.50s]
2021-01-26 00:03:25.569522 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 00:03:25.661177 (MainThread): Acquiring new dremio connection "master".
2021-01-26 00:03:25.661792 (MainThread): On master: ROLLBACK
2021-01-26 00:03:25.662183 (MainThread): Opening a new connection, currently in state init
2021-01-26 00:03:25.662600 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:03:25.786036 (MainThread): Connected to db: None
2021-01-26 00:03:25.786422 (MainThread): On master: ROLLBACK
2021-01-26 00:03:25.786587 (MainThread): On master: Close
2021-01-26 00:03:25.788950 (MainThread): 01:03:25 | 
2021-01-26 00:03:25.789305 (MainThread): 01:03:25 | Finished running 2 view models, 4 table models in 147.40s.
2021-01-26 00:03:25.789570 (MainThread): Connection 'master' was properly closed.
2021-01-26 00:03:25.789788 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-26 00:03:25.832955 (MainThread): 
2021-01-26 00:03:25.833472 (MainThread): Completed with 2 errors and 0 warnings:
2021-01-26 00:03:25.833779 (MainThread): 
2021-01-26 00:03:25.834225 (MainThread): Runtime Error in model d_crop_types (models/marts/d_crop_types.sql)
2021-01-26 00:03:25.834776 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."d_crop_types" as (\n    select * from "$scratch"."subsurface"."@fab4"."d_crop_types_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nVALIDATION ERROR: java.io.FileNotFoundException: File /opt/dremio/data/pdfs/scratch/subsurface/@fab4/d_crop_types_green/0_0_0.parquet does not exist\n\n\n[Error Id: 063fa908-e654-41f9-a7c3-9833cf8...[see log] (1040) (SQLExecDirectW)')
2021-01-26 00:03:25.836141 (MainThread): 
2021-01-26 00:03:25.836538 (MainThread): Runtime Error in model f_land_values (models/marts/f_land_values.sql)
2021-01-26 00:03:25.836848 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n    \n  create or replace view "@fab4"."f_land_values" as (\n    select * from "$scratch"."subsurface"."@fab4"."f_land_values_green"\n  )\n\n  \n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValidatorException: Table \'$scratch.subsurface.@fab4.f_land_values_green\' not found\n\n\n[Error Id: 44ff90e6-dc3b-473b-b301-6c926c2b1f5c on fabrice-pc:31010]\n\n  (com.dremio.exec...[see log] (1040) (SQLExecDirectW)')
2021-01-26 00:03:25.837157 (MainThread): 
Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
2021-01-26 00:03:25.837638 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600ee68828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600ee07710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f600ee075f8>]}
2021-01-26 00:03:25.838199 (MainThread): Flushing usage events
2021-01-26 00:09:59.966101 (MainThread): Running with dbt=0.18.1
2021-01-26 00:10:00.168481 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['+exposure:transfer_of_ownership'], partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-26 00:10:00.170987 (MainThread): Tracking: tracking
2021-01-26 00:10:00.211640 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd93e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8efadd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8efae48>]}
2021-01-26 00:10:00.265631 (MainThread): Partial parsing not enabled
2021-01-26 00:10:00.280987 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 00:10:00.312395 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 00:10:00.327049 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 00:10:00.335471 (MainThread): Parsing macros/helpers.sql
2021-01-26 00:10:00.362471 (MainThread): Parsing macros/catalog.sql
2021-01-26 00:10:00.367464 (MainThread): Parsing macros/adapters.sql
2021-01-26 00:10:00.415166 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 00:10:00.417884 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 00:10:00.424302 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 00:10:00.425085 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 00:10:00.430841 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 00:10:00.450142 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 00:10:00.467995 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 00:10:00.477115 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 00:10:00.492752 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 00:10:00.504366 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 00:10:00.541053 (MainThread): Parsing macros/core.sql
2021-01-26 00:10:00.552547 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 00:10:00.640736 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 00:10:00.659522 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 00:10:00.663382 (MainThread): Parsing macros/etc/query.sql
2021-01-26 00:10:00.666053 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 00:10:00.668511 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 00:10:00.673694 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 00:10:00.677452 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 00:10:00.696508 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 00:10:00.700651 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 00:10:00.714157 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 00:10:00.768588 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 00:10:00.803514 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 00:10:00.807566 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 00:10:00.817713 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 00:10:00.830867 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 00:10:00.859829 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 00:10:00.874387 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 00:10:00.916020 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 00:10:00.921320 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 00:10:00.924968 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 00:10:00.928930 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 00:10:00.945229 (MainThread): Partial parsing not enabled
2021-01-26 00:10:01.070169 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:10:01.140435 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:10:01.190663 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:10:01.212754 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 00:10:01.236997 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:10:01.258927 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:10:01.289243 (MainThread): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-26 00:10:01.344730 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 00:10:01.378302 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 00:10:03.442789 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 00:10:03.444030 (MainThread): context manager reversed is deprecated and to be removed in 3.0.Use G.reverse(copy=False) if G.is_directed() else G instead.
2021-01-26 00:10:03.449339 (MainThread): 
2021-01-26 00:10:03.450140 (MainThread): Acquiring new dremio connection "master".
2021-01-26 00:10:03.468678 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-26 00:10:03.499368 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-26 00:10:03.499705 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-26 00:10:03.499909 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 00:10:03.500081 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:03.771341 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 00:10:03.880871 (ThreadPoolExecutor-0_0): SQL status: OK in 0.38 seconds
2021-01-26 00:10:03.918689 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-26 00:10:04.053316 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 00:10:04.067915 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 00:10:04.068486 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 00:10:04.068802 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-26 00:10:04.069071 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:04.191350 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-26 00:10:04.399402 (ThreadPoolExecutor-1_0): SQL status: OK in 0.33 seconds
2021-01-26 00:10:04.433860 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 00:10:04.435117 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-26 00:10:04.439862 (MainThread): 01:10:04 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 00:10:04.440302 (MainThread): 01:10:04 | 
2021-01-26 00:10:04.466589 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 00:10:04.472115 (Thread-1): 01:10:04 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-26 00:10:04.477717 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:10:04.487363 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 00:10:04.559440 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 00:10:04.560716 (Thread-1): finished collecting timing info
2021-01-26 00:10:04.602008 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-26 00:10:04.603502 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:10:04.603961 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-26 00:10:04.604218 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:10:04.604944 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:04.722820 (Thread-1): Connected to db: None
2021-01-26 00:10:04.795539 (Thread-1): SQL status: OK in 0.19 seconds
2021-01-26 00:10:04.805288 (Thread-1): finished collecting timing info
2021-01-26 00:10:04.808225 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-26 00:10:04.809032 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-26 00:10:04.811147 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59d6ca4-65b5-4b6f-bf14-851e312e98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8c3c7f0>]}
2021-01-26 00:10:04.813332 (Thread-1): 01:10:04 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 0.33s]
2021-01-26 00:10:04.813685 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 00:10:04.814058 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 00:10:04.816969 (Thread-1): 01:10:04 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-26 00:10:04.817736 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:10:04.818057 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 00:10:04.850632 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 00:10:04.851341 (Thread-1): finished collecting timing info
2021-01-26 00:10:04.865629 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-26 00:10:04.866555 (Thread-1): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:10:04.866847 (Thread-1): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-26 00:10:04.867042 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:10:04.867264 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:04.983629 (Thread-1): Connected to db: None
2021-01-26 00:10:05.034717 (Thread-1): SQL status: OK in 0.17 seconds
2021-01-26 00:10:05.042227 (Thread-1): finished collecting timing info
2021-01-26 00:10:05.042930 (Thread-1): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-26 00:10:05.043234 (Thread-1): On model.subsurface.stg__municipalities: Close
2021-01-26 00:10:05.045138 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59d6ca4-65b5-4b6f-bf14-851e312e98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8b24978>]}
2021-01-26 00:10:05.047374 (Thread-1): 01:10:05 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 0.23s]
2021-01-26 00:10:05.047787 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 00:10:05.048155 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 00:10:05.050880 (Thread-1): 01:10:05 | 3 of 6 START view model @fab4.d_crop_types........................... [RUN]
2021-01-26 00:10:05.051928 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:10:05.053098 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 00:10:05.077966 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 00:10:05.078935 (Thread-1): finished collecting timing info
2021-01-26 00:10:05.089678 (Thread-1): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-26 00:10:05.090620 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:10:05.091037 (Thread-1): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-26 00:10:05.091310 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:10:05.091548 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:05.210865 (Thread-1): Connected to db: None
2021-01-26 00:10:05.256973 (Thread-1): SQL status: OK in 0.17 seconds
2021-01-26 00:10:05.264075 (Thread-1): finished collecting timing info
2021-01-26 00:10:05.265234 (Thread-1): On model.subsurface.d_crop_types: ROLLBACK
2021-01-26 00:10:05.265567 (Thread-1): On model.subsurface.d_crop_types: Close
2021-01-26 00:10:05.267414 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59d6ca4-65b5-4b6f-bf14-851e312e98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8b1d9e8>]}
2021-01-26 00:10:05.270432 (Thread-1): 01:10:05 | 3 of 6 OK created view model @fab4.d_crop_types...................... [OK in 0.22s]
2021-01-26 00:10:05.270757 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 00:10:05.271089 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 00:10:05.274529 (Thread-1): 01:10:05 | 4 of 6 START view model @fab4.d_premises_types....................... [RUN]
2021-01-26 00:10:05.275309 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:10:05.275620 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 00:10:05.303390 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 00:10:05.304168 (Thread-1): finished collecting timing info
2021-01-26 00:10:05.321100 (Thread-1): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-26 00:10:05.322219 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:10:05.322495 (Thread-1): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-26 00:10:05.322685 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:10:05.322890 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:05.440076 (Thread-1): Connected to db: None
2021-01-26 00:10:05.480583 (Thread-1): SQL status: OK in 0.16 seconds
2021-01-26 00:10:05.485539 (Thread-1): finished collecting timing info
2021-01-26 00:10:05.487157 (Thread-1): On model.subsurface.d_premises_types: ROLLBACK
2021-01-26 00:10:05.488298 (Thread-1): On model.subsurface.d_premises_types: Close
2021-01-26 00:10:05.491174 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59d6ca4-65b5-4b6f-bf14-851e312e98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8c2f898>]}
2021-01-26 00:10:05.494551 (Thread-1): 01:10:05 | 4 of 6 OK created view model @fab4.d_premises_types.................. [OK in 0.22s]
2021-01-26 00:10:05.494938 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 00:10:05.495317 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 00:10:05.498043 (Thread-1): 01:10:05 | 5 of 6 START view model @fab4.f_land_values.......................... [RUN]
2021-01-26 00:10:05.498799 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 00:10:05.499121 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 00:10:05.538819 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 00:10:05.540383 (Thread-1): finished collecting timing info
2021-01-26 00:10:05.552407 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-26 00:10:05.553441 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-26 00:10:05.553923 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-26 00:10:05.554202 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:10:05.554507 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:05.670723 (Thread-1): Connected to db: None
2021-01-26 00:10:05.822253 (Thread-1): SQL status: OK in 0.27 seconds
2021-01-26 00:10:05.829151 (Thread-1): finished collecting timing info
2021-01-26 00:10:05.829816 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-26 00:10:05.830119 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-26 00:10:05.832256 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59d6ca4-65b5-4b6f-bf14-851e312e98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8cdfe10>]}
2021-01-26 00:10:05.837461 (Thread-1): 01:10:05 | 5 of 6 OK created view model @fab4.f_land_values..................... [OK in 0.33s]
2021-01-26 00:10:05.838056 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 00:10:05.838487 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 00:10:05.841565 (Thread-1): 01:10:05 | 6 of 6 START view model @fab4.d_municipalities....................... [RUN]
2021-01-26 00:10:05.842278 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:10:05.842631 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 00:10:05.868817 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 00:10:05.871606 (Thread-1): finished collecting timing info
2021-01-26 00:10:05.885542 (Thread-1): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-26 00:10:05.886417 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:10:05.886816 (Thread-1): On model.subsurface.d_municipalities: 
  create or replace view "@fab4"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-26 00:10:05.886976 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 00:10:05.887125 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:06.028419 (Thread-1): Connected to db: None
2021-01-26 00:10:06.191638 (Thread-1): SQL status: OK in 0.30 seconds
2021-01-26 00:10:06.198070 (Thread-1): finished collecting timing info
2021-01-26 00:10:06.199488 (Thread-1): On model.subsurface.d_municipalities: ROLLBACK
2021-01-26 00:10:06.200822 (Thread-1): On model.subsurface.d_municipalities: Close
2021-01-26 00:10:06.205445 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59d6ca4-65b5-4b6f-bf14-851e312e98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8b24978>]}
2021-01-26 00:10:06.208631 (Thread-1): 01:10:06 | 6 of 6 OK created view model @fab4.d_municipalities.................. [OK in 0.36s]
2021-01-26 00:10:06.215092 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 00:10:06.287725 (MainThread): Acquiring new dremio connection "master".
2021-01-26 00:10:06.288405 (MainThread): On master: ROLLBACK
2021-01-26 00:10:06.288694 (MainThread): Opening a new connection, currently in state init
2021-01-26 00:10:06.288859 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:06.417976 (MainThread): Connected to db: None
2021-01-26 00:10:06.418448 (MainThread): On master: ROLLBACK
2021-01-26 00:10:06.418737 (MainThread): On master: Close
2021-01-26 00:10:06.421276 (MainThread): 01:10:06 | 
2021-01-26 00:10:06.424559 (MainThread): 01:10:06 | Finished running 6 view models in 2.97s.
2021-01-26 00:10:06.425712 (MainThread): Connection 'master' was properly closed.
2021-01-26 00:10:06.427451 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-26 00:10:06.493726 (MainThread): 
2021-01-26 00:10:06.494128 (MainThread): Completed successfully
2021-01-26 00:10:06.494480 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-26 00:10:06.494982 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8b24978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8b34780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd8c7d3c8>]}
2021-01-26 00:10:06.495458 (MainThread): Flushing usage events
2021-01-26 00:10:18.748878 (MainThread): Running with dbt=0.18.1
2021-01-26 00:10:18.872360 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-01-26 00:10:18.873904 (MainThread): Tracking: tracking
2021-01-26 00:10:18.883045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511c204d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511cfaf748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511bd1ae10>]}
2021-01-26 00:10:18.941334 (MainThread): Partial parsing not enabled
2021-01-26 00:10:18.943084 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 00:10:18.949224 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 00:10:18.953698 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 00:10:18.958602 (MainThread): Parsing macros/helpers.sql
2021-01-26 00:10:18.983574 (MainThread): Parsing macros/catalog.sql
2021-01-26 00:10:18.988498 (MainThread): Parsing macros/adapters.sql
2021-01-26 00:10:19.034896 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 00:10:19.037754 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 00:10:19.043616 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 00:10:19.044181 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 00:10:19.049795 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 00:10:19.068661 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 00:10:19.085929 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 00:10:19.094612 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 00:10:19.110007 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 00:10:19.121748 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 00:10:19.149844 (MainThread): Parsing macros/core.sql
2021-01-26 00:10:19.157617 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 00:10:19.239647 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 00:10:19.257060 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 00:10:19.260833 (MainThread): Parsing macros/etc/query.sql
2021-01-26 00:10:19.263344 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 00:10:19.265539 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 00:10:19.270130 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 00:10:19.273659 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 00:10:19.292278 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 00:10:19.296273 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 00:10:19.309065 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 00:10:19.361866 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 00:10:19.394831 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 00:10:19.398559 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 00:10:19.409154 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 00:10:19.421525 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 00:10:19.448026 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 00:10:19.461446 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 00:10:19.501303 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 00:10:19.505787 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 00:10:19.509295 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 00:10:19.513012 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 00:10:19.528630 (MainThread): Partial parsing not enabled
2021-01-26 00:10:19.646264 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:10:19.690129 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:10:19.711096 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:10:19.731714 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 00:10:19.755233 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:10:19.775862 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:10:19.805664 (MainThread): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-26 00:10:19.842690 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 00:10:19.863472 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 00:10:21.853817 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 00:10:21.862109 (MainThread): 
2021-01-26 00:10:21.862915 (MainThread): Acquiring new dremio connection "master".
2021-01-26 00:10:22.004641 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 00:10:22.028678 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 00:10:22.028980 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 00:10:22.029171 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 00:10:22.029360 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:10:22.159958 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 00:10:22.336573 (ThreadPoolExecutor-0_0): SQL status: OK in 0.31 seconds
2021-01-26 00:10:22.371151 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 00:10:22.371479 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-26 00:10:22.373862 (MainThread): 01:10:22 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 00:10:22.374175 (MainThread): 01:10:22 | 
2021-01-26 00:10:22.383788 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 00:10:22.384704 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:10:22.385123 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 00:10:22.437729 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 00:10:22.438453 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.439194 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.440263 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 00:10:22.440712 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 00:10:22.442087 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:10:22.442471 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 00:10:22.461510 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 00:10:22.462195 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.462927 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.463990 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 00:10:22.464346 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-26 00:10:22.465679 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-26 00:10:22.466012 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-26 00:10:22.490112 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.490775 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.491856 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-26 00:10:22.492212 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-26 00:10:22.493256 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-26 00:10:22.493622 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-26 00:10:22.507127 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.507664 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.508732 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-26 00:10:22.509110 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-26 00:10:22.510375 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-26 00:10:22.510724 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-26 00:10:22.524750 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.525372 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.526482 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-26 00:10:22.526856 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 00:10:22.528138 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-26 00:10:22.528480 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 00:10:22.556695 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-26 00:10:22.567483 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.568640 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.570233 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 00:10:22.571004 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 00:10:22.572350 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-26 00:10:22.572733 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 00:10:22.592980 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-26 00:10:22.593674 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.594385 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.595462 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 00:10:22.595830 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 00:10:22.596753 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-26 00:10:22.597070 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 00:10:22.613864 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-26 00:10:22.614721 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.615408 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.616473 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 00:10:22.616856 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 00:10:22.617837 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-26 00:10:22.618193 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 00:10:22.635568 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-26 00:10:22.636261 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.636895 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.637947 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 00:10:22.638340 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 00:10:22.639273 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 00:10:22.639582 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 00:10:22.666052 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-26 00:10:22.667160 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.667787 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.668870 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 00:10:22.669322 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 00:10:22.670336 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 00:10:22.670700 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 00:10:22.685765 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-26 00:10:22.686485 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.687131 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.688286 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 00:10:22.688672 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 00:10:22.689606 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:10:22.689915 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 00:10:22.704795 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 00:10:22.705489 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.706188 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.707312 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 00:10:22.707747 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 00:10:22.708908 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-26 00:10:22.709242 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 00:10:22.726513 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-26 00:10:22.727228 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.727877 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.728930 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 00:10:22.729289 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 00:10:22.730234 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-26 00:10:22.730574 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 00:10:22.747257 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-26 00:10:22.747972 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.748672 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.749742 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 00:10:22.750095 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 00:10:22.751088 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-26 00:10:22.751519 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 00:10:22.768191 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-26 00:10:22.768969 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.769672 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.770836 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 00:10:22.771260 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 00:10:22.772190 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-26 00:10:22.772519 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 00:10:22.791272 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-26 00:10:22.791984 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.792553 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.793463 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 00:10:22.793883 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 00:10:22.794848 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-26 00:10:22.795174 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 00:10:22.812142 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-26 00:10:22.812852 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.813498 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.814579 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 00:10:22.815066 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 00:10:22.816015 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-26 00:10:22.816367 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 00:10:22.833087 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-26 00:10:22.833779 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.834555 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.835696 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 00:10:22.836146 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 00:10:22.837068 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-26 00:10:22.837425 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 00:10:22.854049 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-26 00:10:22.854790 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.855496 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.856550 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 00:10:22.856909 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 00:10:22.857835 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:10:22.858152 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 00:10:22.873043 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 00:10:22.873714 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.874463 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.875548 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 00:10:22.875965 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 00:10:22.877070 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-26 00:10:22.877408 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-26 00:10:22.894513 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-26 00:10:22.932709 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.933673 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.936733 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 00:10:22.937455 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 00:10:22.938968 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-26 00:10:22.939420 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-26 00:10:22.957764 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-26 00:10:22.958529 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.959269 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.960377 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 00:10:22.960771 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-26 00:10:22.961675 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-26 00:10:22.962023 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-26 00:10:22.979573 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-26 00:10:22.980350 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.981010 (Thread-1): finished collecting timing info
2021-01-26 00:10:22.982175 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-26 00:10:22.982574 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 00:10:22.983560 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:10:22.983886 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 00:10:22.999319 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 00:10:23.000045 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.000787 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.002735 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 00:10:23.003188 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 00:10:23.004294 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-26 00:10:23.004631 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-26 00:10:23.021757 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-26 00:10:23.022498 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.023238 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.024324 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 00:10:23.024750 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 00:10:23.025670 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-26 00:10:23.026017 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 00:10:23.043788 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-26 00:10:23.044487 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.045137 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.046190 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 00:10:23.046751 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 00:10:23.047838 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-26 00:10:23.048167 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 00:10:23.068087 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-26 00:10:23.068855 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.070245 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.071337 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 00:10:23.071728 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-26 00:10:23.072635 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-26 00:10:23.072937 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-26 00:10:23.089855 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-26 00:10:23.090588 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.091235 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.092238 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-26 00:10:23.092565 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 00:10:23.093315 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 00:10:23.093674 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 00:10:23.121666 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 00:10:23.122386 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.123135 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.124222 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 00:10:23.124589 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 00:10:23.126263 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-26 00:10:23.126633 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 00:10:23.146127 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-26 00:10:23.146929 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.147693 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.148812 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 00:10:23.149173 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 00:10:23.149917 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-26 00:10:23.150459 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 00:10:23.174247 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-26 00:10:23.175162 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.175958 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.177138 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 00:10:23.177610 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 00:10:23.178447 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-26 00:10:23.178966 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 00:10:23.201944 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-26 00:10:23.202882 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.203788 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.204919 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 00:10:23.205322 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 00:10:23.206182 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-26 00:10:23.206703 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 00:10:23.223857 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-26 00:10:23.224608 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.225359 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.226476 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 00:10:23.226842 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 00:10:23.227687 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-26 00:10:23.228132 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 00:10:23.245071 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-26 00:10:23.245813 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.246533 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.247636 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 00:10:23.248003 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 00:10:23.248952 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-26 00:10:23.249332 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 00:10:23.267048 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-26 00:10:23.292111 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.292877 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.294147 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 00:10:23.294682 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 00:10:23.295837 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-26 00:10:23.296346 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 00:10:23.316716 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-26 00:10:23.317507 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.318257 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.320252 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 00:10:23.320618 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 00:10:23.321491 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-26 00:10:23.321879 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 00:10:23.341426 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-26 00:10:23.342193 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.342967 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.344055 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 00:10:23.344413 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 00:10:23.345289 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-26 00:10:23.345688 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-26 00:10:23.422193 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-26 00:10:23.423019 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.423723 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.424820 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 00:10:23.425178 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 00:10:23.425907 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-26 00:10:23.426419 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 00:10:23.443847 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-26 00:10:23.444613 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.445320 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.446392 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 00:10:23.446738 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 00:10:23.447539 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-26 00:10:23.447901 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-26 00:10:23.465142 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-26 00:10:23.465852 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.466567 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.467683 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 00:10:23.468110 (Thread-1): Began running node analysis.subsurface.top100_most_expensive_cities
2021-01-26 00:10:23.469578 (Thread-1): Acquiring new dremio connection "analysis.subsurface.top100_most_expensive_cities".
2021-01-26 00:10:23.470073 (Thread-1): Compiling analysis.subsurface.top100_most_expensive_cities
2021-01-26 00:10:23.495027 (Thread-1): Writing injected SQL for node "analysis.subsurface.top100_most_expensive_cities"
2021-01-26 00:10:23.518269 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.520844 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.522561 (Thread-1): Finished running node analysis.subsurface.top100_most_expensive_cities
2021-01-26 00:10:23.524278 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 00:10:23.525481 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-26 00:10:23.526043 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-26 00:10:23.564487 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-26 00:10:23.565240 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.565881 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.566958 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 00:10:23.567319 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 00:10:23.569160 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-26 00:10:23.569518 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-26 00:10:23.586298 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-26 00:10:23.587015 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.587655 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.588828 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 00:10:23.589191 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 00:10:23.590058 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-26 00:10:23.590410 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-26 00:10:23.607090 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-26 00:10:23.607787 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.608438 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.609493 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 00:10:23.609878 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-26 00:10:23.610793 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-26 00:10:23.611121 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-26 00:10:23.630225 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-26 00:10:23.631001 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.631648 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.632706 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-26 00:10:23.633082 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 00:10:23.633976 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-26 00:10:23.634379 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-26 00:10:23.651229 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-26 00:10:23.652065 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.652834 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.653920 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 00:10:23.654372 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 00:10:23.655281 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-26 00:10:23.655602 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-26 00:10:23.673015 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-26 00:10:23.673719 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.674390 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.675474 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 00:10:23.675851 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 00:10:23.676773 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-26 00:10:23.677090 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-26 00:10:23.693826 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-26 00:10:23.694576 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.695231 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.696294 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 00:10:23.696665 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 00:10:23.697559 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-26 00:10:23.697887 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 00:10:23.714717 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-26 00:10:23.716175 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.716753 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.717916 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 00:10:23.718398 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 00:10:23.719386 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-26 00:10:23.719734 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 00:10:23.737097 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-26 00:10:23.737826 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.738520 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.739640 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 00:10:23.740018 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 00:10:23.740956 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-26 00:10:23.741292 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-26 00:10:23.757839 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-26 00:10:23.758626 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.759340 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.760444 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 00:10:23.760831 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 00:10:23.761744 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-26 00:10:23.762117 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 00:10:23.778880 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-26 00:10:23.779619 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.780300 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.781403 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 00:10:23.781779 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 00:10:23.782745 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-26 00:10:23.783078 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 00:10:23.802614 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-26 00:10:23.803397 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.804076 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.805178 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 00:10:23.805551 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 00:10:23.806483 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-26 00:10:23.806854 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 00:10:23.823793 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-26 00:10:23.824503 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.825187 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.826296 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 00:10:23.826692 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 00:10:23.827659 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-26 00:10:23.828004 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-26 00:10:23.845306 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-26 00:10:23.846076 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.846829 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.847939 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 00:10:23.848315 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 00:10:23.849241 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-26 00:10:23.849572 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 00:10:23.870587 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-26 00:10:23.871315 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.872022 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.873138 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 00:10:23.873515 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 00:10:23.874482 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-26 00:10:23.874815 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 00:10:23.895726 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-26 00:10:23.896479 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.897161 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.898281 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 00:10:23.898707 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 00:10:23.899669 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-26 00:10:23.900007 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 00:10:23.920942 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-26 00:10:23.921723 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.922405 (Thread-1): finished collecting timing info
2021-01-26 00:10:23.923513 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 00:10:23.927811 (MainThread): Connection 'master' was properly closed.
2021-01-26 00:10:23.928164 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-26 00:10:24.191462 (MainThread): 01:10:24 | Done.
2021-01-26 00:10:24.192201 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511adc38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511adc35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511bbf16d8>]}
2021-01-26 00:10:24.192683 (MainThread): Flushing usage events
2021-01-26 00:18:01.617326 (MainThread): Running with dbt=0.18.1
2021-01-26 00:18:01.740555 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-01-26 00:18:01.742083 (MainThread): Tracking: tracking
2021-01-26 00:18:01.751850 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51789fbb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51789fbd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51789fbe80>]}
2021-01-26 00:18:01.809982 (MainThread): Partial parsing not enabled
2021-01-26 00:18:01.811830 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 00:18:01.818079 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 00:18:01.822403 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 00:18:01.826988 (MainThread): Parsing macros/helpers.sql
2021-01-26 00:18:01.852450 (MainThread): Parsing macros/catalog.sql
2021-01-26 00:18:01.857005 (MainThread): Parsing macros/adapters.sql
2021-01-26 00:18:01.904693 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 00:18:01.907221 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 00:18:01.913128 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 00:18:01.913642 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 00:18:01.919688 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 00:18:01.938425 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 00:18:01.956219 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 00:18:01.964912 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 00:18:01.979751 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 00:18:01.990976 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 00:18:02.019847 (MainThread): Parsing macros/core.sql
2021-01-26 00:18:02.027274 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 00:18:02.108588 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 00:18:02.126000 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 00:18:02.129661 (MainThread): Parsing macros/etc/query.sql
2021-01-26 00:18:02.132178 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 00:18:02.134804 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 00:18:02.139084 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 00:18:02.142636 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 00:18:02.160668 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 00:18:02.164741 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 00:18:02.177055 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 00:18:02.228912 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 00:18:02.262457 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 00:18:02.267061 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 00:18:02.276978 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 00:18:02.289607 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 00:18:02.316653 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 00:18:02.329503 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 00:18:02.369528 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 00:18:02.373690 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 00:18:02.377188 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 00:18:02.380945 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 00:18:02.396648 (MainThread): Partial parsing not enabled
2021-01-26 00:18:02.514087 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:18:02.557798 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:18:02.578904 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:18:02.599405 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 00:18:02.622802 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:18:02.643276 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:18:02.672503 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 00:18:02.709243 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 00:18:02.729954 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 00:18:04.721525 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 00:18:04.729536 (MainThread): 
2021-01-26 00:18:04.730344 (MainThread): Acquiring new dremio connection "master".
2021-01-26 00:18:04.872194 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 00:18:04.895841 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 00:18:04.896757 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 00:18:04.897049 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 00:18:04.897237 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 00:18:05.039913 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 00:18:05.239561 (ThreadPoolExecutor-0_0): SQL status: OK in 0.34 seconds
2021-01-26 00:18:05.269966 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 00:18:05.270255 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-26 00:18:05.272850 (MainThread): 01:18:05 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 00:18:05.273168 (MainThread): 01:18:05 | 
2021-01-26 00:18:05.279730 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 00:18:05.280510 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 00:18:05.280816 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 00:18:05.335290 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 00:18:05.335990 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.336780 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.337880 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 00:18:05.338223 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 00:18:05.339186 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 00:18:05.339953 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 00:18:05.358672 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 00:18:05.359360 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.360118 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.361254 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 00:18:05.361590 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-26 00:18:05.362965 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-26 00:18:05.363283 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-26 00:18:05.387502 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.388044 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.389073 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-26 00:18:05.389436 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-26 00:18:05.390070 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-26 00:18:05.390405 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-26 00:18:05.405445 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.406000 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.407143 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-26 00:18:05.407485 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-26 00:18:05.408710 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-26 00:18:05.409034 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-26 00:18:05.422997 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.423536 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.424609 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-26 00:18:05.424954 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 00:18:05.425849 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-26 00:18:05.426607 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 00:18:05.454920 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-26 00:18:05.455610 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.456356 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.457442 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 00:18:05.457778 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 00:18:05.458643 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-26 00:18:05.459008 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 00:18:05.476205 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-26 00:18:05.476961 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.477787 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.478918 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 00:18:05.479318 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 00:18:05.480201 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-26 00:18:05.480574 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 00:18:05.498129 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-26 00:18:05.498839 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.499716 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.500842 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 00:18:05.501241 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 00:18:05.502141 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-26 00:18:05.502501 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 00:18:05.519598 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-26 00:18:05.520287 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.521004 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.522082 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 00:18:05.522436 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 00:18:05.523322 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 00:18:05.523691 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 00:18:05.549504 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-26 00:18:05.550547 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.551273 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.552376 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 00:18:05.552783 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 00:18:05.553670 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 00:18:05.554033 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 00:18:05.569291 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-26 00:18:05.569975 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.570745 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.571822 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 00:18:05.572176 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 00:18:05.572895 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 00:18:05.573423 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 00:18:05.588400 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 00:18:05.589083 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.589829 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.590947 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 00:18:05.591366 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 00:18:05.592391 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-26 00:18:05.592642 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 00:18:05.609515 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-26 00:18:05.610203 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.610926 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.612038 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 00:18:05.612363 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 00:18:05.613219 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-26 00:18:05.613586 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 00:18:05.631174 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-26 00:18:05.631887 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.632603 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.633851 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 00:18:05.634270 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 00:18:05.635150 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-26 00:18:05.635506 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 00:18:05.652110 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-26 00:18:05.652787 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.653472 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.654574 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 00:18:05.654919 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 00:18:05.655792 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-26 00:18:05.656156 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 00:18:05.675221 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-26 00:18:05.675899 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.676593 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.677657 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 00:18:05.678046 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 00:18:05.678751 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-26 00:18:05.679221 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 00:18:05.696910 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-26 00:18:05.697599 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.698292 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.699442 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 00:18:05.699875 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 00:18:05.700699 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-26 00:18:05.701187 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 00:18:05.717683 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-26 00:18:05.718383 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.719075 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.720147 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 00:18:05.720486 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 00:18:05.721334 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-26 00:18:05.721692 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 00:18:05.738541 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-26 00:18:05.739227 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.739914 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.740989 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 00:18:05.741330 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 00:18:05.742164 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 00:18:05.742557 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 00:18:05.757339 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 00:18:05.758082 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.758799 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.759890 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 00:18:05.760299 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 00:18:05.761409 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-26 00:18:05.761808 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-26 00:18:05.779008 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-26 00:18:05.779717 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.780400 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.781474 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 00:18:05.781837 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 00:18:05.782622 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-26 00:18:05.783367 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-26 00:18:05.801270 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-26 00:18:05.802031 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.802697 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.803767 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 00:18:05.804096 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-26 00:18:05.804909 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-26 00:18:05.805267 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-26 00:18:05.822474 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-26 00:18:05.823186 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.823831 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.824913 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-26 00:18:05.825252 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 00:18:05.826096 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 00:18:05.826481 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 00:18:05.841352 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 00:18:05.842109 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.842857 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.843953 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 00:18:05.844367 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 00:18:05.845481 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-26 00:18:05.845820 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-26 00:18:05.862604 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-26 00:18:05.863374 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.864024 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.865093 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 00:18:05.865432 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 00:18:05.866439 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-26 00:18:05.867333 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 00:18:05.884312 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-26 00:18:05.885062 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.885699 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.886786 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 00:18:05.887121 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 00:18:05.887944 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-26 00:18:05.888305 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 00:18:05.907581 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-26 00:18:05.908293 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.908961 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.910045 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 00:18:05.910417 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-26 00:18:05.911262 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-26 00:18:05.911629 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-26 00:18:05.928352 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-26 00:18:05.929192 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.929832 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.930905 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-26 00:18:05.931246 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 00:18:05.932084 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 00:18:05.932499 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 00:18:05.959327 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 00:18:05.960095 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.960790 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.961913 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 00:18:05.962248 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 00:18:05.963210 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-26 00:18:05.964300 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 00:18:05.981190 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-26 00:18:05.981950 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.982704 (Thread-1): finished collecting timing info
2021-01-26 00:18:05.983867 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 00:18:05.984330 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 00:18:05.985216 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-26 00:18:05.985569 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 00:18:06.002520 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-26 00:18:06.003246 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.003896 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.004963 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 00:18:06.005307 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 00:18:06.006130 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-26 00:18:06.006529 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 00:18:06.027177 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-26 00:18:06.027892 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.028578 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.029655 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 00:18:06.029999 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 00:18:06.030897 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-26 00:18:06.031269 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 00:18:06.047966 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-26 00:18:06.048680 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.049396 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.050567 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 00:18:06.050995 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 00:18:06.051853 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-26 00:18:06.052198 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 00:18:06.069147 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-26 00:18:06.069849 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.070522 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.071600 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 00:18:06.071945 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 00:18:06.072673 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-26 00:18:06.073154 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 00:18:06.090922 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-26 00:18:06.091668 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.092306 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.093153 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 00:18:06.093557 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 00:18:06.094477 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-26 00:18:06.094821 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 00:18:06.111923 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-26 00:18:06.112626 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.113292 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.114394 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 00:18:06.114788 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 00:18:06.115581 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-26 00:18:06.115968 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 00:18:06.135133 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-26 00:18:06.135839 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.136485 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.137550 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 00:18:06.137886 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 00:18:06.138727 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-26 00:18:06.139091 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-26 00:18:06.213011 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-26 00:18:06.213704 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.214482 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.215573 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 00:18:06.215985 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 00:18:06.216734 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-26 00:18:06.217124 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 00:18:06.233849 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-26 00:18:06.234659 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.235453 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.236531 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 00:18:06.236870 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 00:18:06.237678 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-26 00:18:06.238043 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-26 00:18:06.254878 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-26 00:18:06.255584 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.256279 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.257416 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 00:18:06.257765 (Thread-1): Began running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 00:18:06.258600 (Thread-1): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 00:18:06.258966 (Thread-1): Compiling analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 00:18:06.283764 (Thread-1): Writing injected SQL for node "analysis.subsurface.most_expensive_departments_for_flats"
2021-01-26 00:18:06.284355 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.285137 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.286233 (Thread-1): Finished running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 00:18:06.286682 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 00:18:06.287422 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-26 00:18:06.287937 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-26 00:18:06.314134 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-26 00:18:06.315061 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.315996 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.318565 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 00:18:06.319615 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 00:18:06.320714 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-26 00:18:06.321688 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-26 00:18:06.344665 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-26 00:18:06.345382 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.346158 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.347254 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 00:18:06.347587 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 00:18:06.348405 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-26 00:18:06.348767 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-26 00:18:06.365457 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-26 00:18:06.366197 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.366965 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.368172 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 00:18:06.368581 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-26 00:18:06.369417 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-26 00:18:06.369778 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-26 00:18:06.388197 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-26 00:18:06.388906 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.389589 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.390687 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-26 00:18:06.391033 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 00:18:06.391830 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-26 00:18:06.392137 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-26 00:18:06.409008 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-26 00:18:06.409692 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.410404 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.411507 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 00:18:06.411882 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 00:18:06.412672 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-26 00:18:06.413029 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-26 00:18:06.435358 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-26 00:18:06.436121 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.436942 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.438028 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 00:18:06.438454 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 00:18:06.439196 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-26 00:18:06.439561 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-26 00:18:06.458002 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-26 00:18:06.458696 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.459431 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.460493 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 00:18:06.460830 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 00:18:06.461546 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-26 00:18:06.462051 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 00:18:06.479167 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-26 00:18:06.479847 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.480529 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.481599 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 00:18:06.481940 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 00:18:06.482734 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-26 00:18:06.483260 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 00:18:06.501007 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-26 00:18:06.501684 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.502383 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.503448 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 00:18:06.503786 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 00:18:06.504620 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-26 00:18:06.504979 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-26 00:18:06.522034 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-26 00:18:06.522756 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.523446 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.524521 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 00:18:06.524911 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 00:18:06.525665 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-26 00:18:06.525993 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 00:18:06.542910 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-26 00:18:06.543598 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.544284 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.545390 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 00:18:06.545719 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 00:18:06.546574 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-26 00:18:06.546939 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 00:18:06.566178 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-26 00:18:06.566998 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.567734 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.568825 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 00:18:06.569229 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 00:18:06.570072 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-26 00:18:06.570449 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 00:18:06.587293 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-26 00:18:06.587993 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.588674 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.589730 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 00:18:06.590059 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 00:18:06.590883 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-26 00:18:06.591246 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-26 00:18:06.608401 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-26 00:18:06.609092 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.609742 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.610842 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 00:18:06.611211 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 00:18:06.612084 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-26 00:18:06.612439 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 00:18:06.633771 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-26 00:18:06.634466 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.635217 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.636287 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 00:18:06.636619 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 00:18:06.637430 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-26 00:18:06.637805 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 00:18:06.659039 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-26 00:18:06.659732 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.660378 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.661448 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 00:18:06.661824 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 00:18:06.662703 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-26 00:18:06.663069 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 00:18:06.684712 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-26 00:18:06.685384 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.686167 (Thread-1): finished collecting timing info
2021-01-26 00:18:06.687290 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 00:18:06.728674 (MainThread): Connection 'master' was properly closed.
2021-01-26 00:18:06.729150 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-26 00:18:06.994605 (MainThread): 01:18:06 | Done.
2021-01-26 00:18:06.995196 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51789a9470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5174aa2a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5174aa2e48>]}
2021-01-26 00:18:06.995683 (MainThread): Flushing usage events
2021-01-26 06:54:07.702466 (MainThread): Running with dbt=0.18.1
2021-01-26 06:54:07.968371 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-01-26 06:54:07.986694 (MainThread): Tracking: tracking
2021-01-26 06:54:07.996186 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434b997fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434b42dd68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434b42ddd8>]}
2021-01-26 06:54:08.080348 (MainThread): Partial parsing not enabled
2021-01-26 06:54:08.097536 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 06:54:08.127970 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 06:54:08.145701 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 06:54:08.153151 (MainThread): Parsing macros/helpers.sql
2021-01-26 06:54:08.181209 (MainThread): Parsing macros/catalog.sql
2021-01-26 06:54:08.186654 (MainThread): Parsing macros/adapters.sql
2021-01-26 06:54:08.235452 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 06:54:08.242573 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 06:54:08.249297 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 06:54:08.250137 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 06:54:08.257841 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 06:54:08.278765 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 06:54:08.298599 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 06:54:08.307481 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 06:54:08.322562 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 06:54:08.334782 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 06:54:08.373398 (MainThread): Parsing macros/core.sql
2021-01-26 06:54:08.387743 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 06:54:08.476414 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 06:54:08.495755 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 06:54:08.500701 (MainThread): Parsing macros/etc/query.sql
2021-01-26 06:54:08.503301 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 06:54:08.506100 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 06:54:08.511150 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 06:54:08.514765 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 06:54:08.533567 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 06:54:08.537546 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 06:54:08.554342 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 06:54:08.612960 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 06:54:08.649282 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 06:54:08.653102 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 06:54:08.665919 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 06:54:08.678600 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 06:54:08.712471 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 06:54:08.726122 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 06:54:08.771105 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 06:54:08.775517 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 06:54:08.781015 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 06:54:08.785382 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 06:54:08.801100 (MainThread): Partial parsing not enabled
2021-01-26 06:54:08.936029 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 06:54:09.003633 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 06:54:09.038275 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 06:54:09.061111 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 06:54:09.103686 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 06:54:09.126292 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 06:54:09.168570 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 06:54:09.224699 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 06:54:09.287844 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 06:54:11.555817 (MainThread): Found 6 models, 48 tests, 0 snapshots, 1 analysis, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 06:54:11.562436 (MainThread): 
2021-01-26 06:54:11.563095 (MainThread): Acquiring new dremio connection "master".
2021-01-26 06:54:11.699151 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 06:54:11.721126 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 06:54:11.721353 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 06:54:11.721458 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 06:54:11.721548 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 06:54:14.690574 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 06:54:26.841511 (ThreadPoolExecutor-0_0): SQL status: OK in 15.12 seconds
2021-01-26 06:54:27.120112 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 06:54:27.120373 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-26 06:54:27.123305 (MainThread): 07:54:27 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 06:54:27.123967 (MainThread): 07:54:27 | 
2021-01-26 06:54:27.134918 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 06:54:27.136107 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 06:54:27.136679 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 06:54:27.226338 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 06:54:27.240268 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.240938 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.250086 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 06:54:27.250449 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 06:54:27.255405 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 06:54:27.255730 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 06:54:27.291506 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 06:54:27.293279 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.294062 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.295294 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 06:54:27.295778 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-26 06:54:27.297162 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-26 06:54:27.297495 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-26 06:54:27.333147 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.333627 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.334343 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-26 06:54:27.334638 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-26 06:54:27.335267 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-26 06:54:27.335707 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-26 06:54:27.355194 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.355700 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.356347 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-26 06:54:27.356580 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-26 06:54:27.357450 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-26 06:54:27.357739 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-26 06:54:27.371408 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.371897 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.372552 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-26 06:54:27.372818 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 06:54:27.373489 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-26 06:54:27.374000 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 06:54:27.404332 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-26 06:54:27.415079 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.415805 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.416685 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 06:54:27.417043 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 06:54:27.418003 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-26 06:54:27.418347 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 06:54:27.437053 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-26 06:54:27.437677 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.438311 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.438980 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 06:54:27.439212 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 06:54:27.439784 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-26 06:54:27.439973 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 06:54:27.461073 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-26 06:54:27.463499 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.464064 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.464711 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 06:54:27.464987 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 06:54:27.465877 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-26 06:54:27.466788 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 06:54:27.485243 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-26 06:54:27.485804 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.486337 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.486981 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 06:54:27.487242 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 06:54:27.487846 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 06:54:27.488044 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 06:54:27.514364 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-26 06:54:27.516347 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.517859 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.519131 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 06:54:27.519538 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 06:54:27.520195 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 06:54:27.520789 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 06:54:27.536364 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-26 06:54:27.536919 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.537492 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.538298 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 06:54:27.538583 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 06:54:27.539172 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 06:54:27.539363 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 06:54:27.553695 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 06:54:27.554584 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.555103 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.555778 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 06:54:27.556017 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 06:54:27.556668 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-26 06:54:27.557085 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 06:54:27.576062 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-26 06:54:27.576822 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.577583 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.578811 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 06:54:27.579192 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 06:54:27.580068 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-26 06:54:27.580648 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 06:54:27.599511 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-26 06:54:27.600074 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.600561 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.601203 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 06:54:27.601466 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 06:54:27.602101 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-26 06:54:27.602307 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 06:54:27.618549 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-26 06:54:27.619106 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.619589 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.620234 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 06:54:27.620468 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 06:54:27.621036 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-26 06:54:27.621231 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 06:54:27.639673 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-26 06:54:27.640381 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.640952 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.641644 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 06:54:27.642044 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 06:54:27.642861 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-26 06:54:27.643200 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 06:54:27.663876 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-26 06:54:27.664612 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.665550 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.666509 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 06:54:27.666760 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 06:54:27.667324 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-26 06:54:27.667537 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 06:54:27.683963 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-26 06:54:27.684649 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.685179 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.685819 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 06:54:27.686083 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 06:54:27.686665 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-26 06:54:27.686857 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 06:54:27.703928 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-26 06:54:27.704494 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.704984 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.705632 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 06:54:27.705867 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 06:54:27.706480 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 06:54:27.706673 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 06:54:27.723371 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 06:54:27.723932 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.724453 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.725161 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 06:54:27.725450 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 06:54:27.726193 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-26 06:54:27.726689 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-26 06:54:27.743454 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-26 06:54:27.773295 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.774182 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.775949 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 06:54:27.776558 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 06:54:27.777605 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-26 06:54:27.777918 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-26 06:54:27.799868 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-26 06:54:27.800431 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.800956 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.801649 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 06:54:27.801911 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-26 06:54:27.802532 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-26 06:54:27.802729 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-26 06:54:27.819077 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-26 06:54:27.819638 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.820180 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.820839 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-26 06:54:27.821104 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 06:54:27.821696 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 06:54:27.821918 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 06:54:27.836147 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 06:54:27.836698 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.837190 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.837848 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 06:54:27.838118 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 06:54:27.838884 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-26 06:54:27.839119 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-26 06:54:27.858139 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-26 06:54:27.858781 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.859662 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.860753 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 06:54:27.861189 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 06:54:27.861966 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-26 06:54:27.862411 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 06:54:27.880402 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-26 06:54:27.881003 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.881479 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.882158 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 06:54:27.882416 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 06:54:27.882986 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-26 06:54:27.883183 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 06:54:27.901419 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-26 06:54:27.902006 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.902514 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.903160 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 06:54:27.903394 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-26 06:54:27.903963 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-26 06:54:27.904155 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-26 06:54:27.922961 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-26 06:54:27.923520 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.924006 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.924701 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-26 06:54:27.924941 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 06:54:27.925613 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 06:54:27.925962 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 06:54:27.957900 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 06:54:27.958547 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.959393 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.960193 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 06:54:27.960520 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 06:54:27.961296 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-26 06:54:27.961605 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 06:54:27.979921 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-26 06:54:27.980535 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.981066 (Thread-1): finished collecting timing info
2021-01-26 06:54:27.981802 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 06:54:27.982132 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 06:54:27.982734 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-26 06:54:27.982933 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 06:54:28.001396 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-26 06:54:28.002020 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.002515 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.003157 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 06:54:28.003391 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 06:54:28.003949 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-26 06:54:28.004142 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 06:54:28.024458 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-26 06:54:28.025052 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.025720 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.026644 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 06:54:28.026898 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 06:54:28.027449 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-26 06:54:28.027640 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 06:54:28.044551 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-26 06:54:28.045363 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.046059 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.047212 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 06:54:28.047578 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 06:54:28.048488 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-26 06:54:28.049204 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 06:54:28.069076 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-26 06:54:28.069636 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.070164 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.070829 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 06:54:28.071062 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 06:54:28.071610 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-26 06:54:28.071823 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 06:54:28.088443 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-26 06:54:28.114915 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.116421 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.118003 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 06:54:28.118252 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 06:54:28.118810 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-26 06:54:28.119001 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 06:54:28.135782 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-26 06:54:28.136345 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.136878 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.137535 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 06:54:28.137799 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 06:54:28.138418 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-26 06:54:28.138616 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 06:54:28.157396 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-26 06:54:28.158052 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.158849 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.159963 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 06:54:28.161499 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 06:54:28.162528 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-26 06:54:28.162843 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-26 06:54:28.239467 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-26 06:54:28.240040 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.240570 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.241266 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 06:54:28.241529 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 06:54:28.242191 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-26 06:54:28.242415 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 06:54:28.262540 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-26 06:54:28.263354 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.264062 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.265575 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 06:54:28.266103 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 06:54:28.266757 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-26 06:54:28.266945 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-26 06:54:28.283219 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-26 06:54:28.283781 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.284274 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.284922 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 06:54:28.285201 (Thread-1): Began running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 06:54:28.285784 (Thread-1): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 06:54:28.286011 (Thread-1): Compiling analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 06:54:28.310437 (Thread-1): Writing injected SQL for node "analysis.subsurface.most_expensive_departments_for_flats"
2021-01-26 06:54:28.311740 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.312456 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.313636 (Thread-1): Finished running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 06:54:28.314073 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 06:54:28.314752 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-26 06:54:28.315378 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-26 06:54:28.332384 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-26 06:54:28.332949 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.333483 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.334174 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 06:54:28.334449 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 06:54:28.335022 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-26 06:54:28.335218 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-26 06:54:28.355995 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-26 06:54:28.356730 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.357367 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.358459 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 06:54:28.358998 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 06:54:28.359706 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-26 06:54:28.360064 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-26 06:54:28.378091 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-26 06:54:28.378658 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.379145 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.379786 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 06:54:28.380019 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-26 06:54:28.380569 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-26 06:54:28.380761 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-26 06:54:28.399129 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-26 06:54:28.399692 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.400181 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.400833 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-26 06:54:28.401067 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 06:54:28.401648 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-26 06:54:28.401840 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-26 06:54:28.418220 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-26 06:54:28.418778 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.419283 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.419952 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 06:54:28.420194 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 06:54:28.420745 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-26 06:54:28.420937 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-26 06:54:28.438327 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-26 06:54:28.439024 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.439536 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.440225 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 06:54:28.440484 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 06:54:28.441067 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-26 06:54:28.441262 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-26 06:54:28.460882 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-26 06:54:28.461782 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.462577 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.463635 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 06:54:28.464018 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 06:54:28.465576 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-26 06:54:28.465984 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 06:54:28.482534 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-26 06:54:28.483093 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.483619 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.484324 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 06:54:28.484582 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 06:54:28.485148 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-26 06:54:28.485341 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 06:54:28.501883 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-26 06:54:28.502477 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.502970 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.503618 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 06:54:28.503880 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 06:54:28.504447 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-26 06:54:28.504643 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-26 06:54:28.523829 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-26 06:54:28.524425 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.524913 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.526050 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 06:54:28.526354 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 06:54:28.526923 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-26 06:54:28.527118 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 06:54:28.543762 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-26 06:54:28.544521 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.545228 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.546465 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 06:54:28.546879 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 06:54:28.547716 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-26 06:54:28.548137 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 06:54:28.567907 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-26 06:54:28.568463 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.568947 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.569594 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 06:54:28.569830 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 06:54:28.570412 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-26 06:54:28.570605 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 06:54:28.587306 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-26 06:54:28.587974 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.588647 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.589679 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 06:54:28.590161 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 06:54:28.591080 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-26 06:54:28.591527 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-26 06:54:28.610810 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-26 06:54:28.611372 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.611908 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.612700 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 06:54:28.612936 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 06:54:28.613474 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-26 06:54:28.613662 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 06:54:28.636114 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-26 06:54:28.636674 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.637162 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.637814 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 06:54:28.638073 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 06:54:28.638627 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-26 06:54:28.638824 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 06:54:28.659936 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-26 06:54:28.660509 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.660984 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.661622 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 06:54:28.661862 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 06:54:28.662439 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-26 06:54:28.662633 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 06:54:28.685104 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-26 06:54:28.685665 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.686237 (Thread-1): finished collecting timing info
2021-01-26 06:54:28.686909 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 06:54:28.784685 (MainThread): Connection 'master' was properly closed.
2021-01-26 06:54:28.785024 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-26 06:54:29.060456 (MainThread): 07:54:29 | Done.
2021-01-26 06:54:29.079797 (MainThread): Acquiring new dremio connection "generate_catalog".
2021-01-26 06:54:29.080064 (MainThread): 07:54:29 | Building catalog
2021-01-26 06:54:29.432349 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "@fab4.information_schema".
2021-01-26 06:54:29.450796 (ThreadPoolExecutor-1_0): Using dremio connection "@fab4.information_schema".
2021-01-26 06:54:29.451024 (ThreadPoolExecutor-1_0): On @fab4.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('@fab4')
    and (table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-26 06:54:29.451154 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-26 06:54:29.451248 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 06:54:29.647944 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-26 06:54:36.300214 (ThreadPoolExecutor-1_0): SQL status: OK in 6.85 seconds
2021-01-26 06:54:36.468492 (ThreadPoolExecutor-1_0): On @fab4.information_schema: ROLLBACK
2021-01-26 06:54:36.468983 (ThreadPoolExecutor-1_0): On @fab4.information_schema: Close
2021-01-26 06:54:36.475784 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "fs.information_schema".
2021-01-26 06:54:36.481220 (ThreadPoolExecutor-1_0): Using dremio connection "fs.information_schema".
2021-01-26 06:54:36.481543 (ThreadPoolExecutor-1_0): On fs.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('fs')
    and (table_schema = lower('no_schema') or table_schema = lower('geo'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-26 06:54:36.481804 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-26 06:54:36.482054 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 06:54:36.726433 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-26 06:54:41.190832 (ThreadPoolExecutor-1_0): SQL status: OK in 4.71 seconds
2021-01-26 06:54:41.299441 (ThreadPoolExecutor-1_0): On fs.information_schema: ROLLBACK
2021-01-26 06:54:41.299746 (ThreadPoolExecutor-1_0): On fs.information_schema: Close
2021-01-26 06:54:41.658928 (MainThread): 07:54:41 | Catalog written to /home/fabrice/subsurface/target/catalog.json
2021-01-26 06:54:41.659565 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434b27b240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434b27bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434b27b7b8>]}
2021-01-26 06:54:41.659932 (MainThread): Flushing usage events
2021-01-26 06:54:42.472319 (MainThread): Connection 'generate_catalog' was properly closed.
2021-01-26 06:54:42.473482 (MainThread): Connection 'fs.information_schema' was properly closed.
2021-01-26 06:54:50.924270 (MainThread): Running with dbt=0.18.1
2021-01-26 06:54:51.050578 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-01-26 06:54:51.051791 (MainThread): Tracking: tracking
2021-01-26 06:54:51.066169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0b4aefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0afc1e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0afc1eb8>]}
2021-01-26 06:54:51.070373 (MainThread): Serving docs at 0.0.0.0:8080
2021-01-26 06:54:51.070691 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-01-26 06:54:51.070900 (MainThread): Press Ctrl+C to exit.


2021-01-26 06:55:49.707432 (MainThread): Flushing usage events
2021-01-26 06:55:50.238402 (MainThread): ctrl-c
2021-01-26 10:51:20.762231 (MainThread): Running with dbt=0.18.1
2021-01-26 10:51:21.082880 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-01-26 10:51:21.105617 (MainThread): Tracking: tracking
2021-01-26 10:51:21.174852 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff302d6fa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff302894e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff302894eb8>]}
2021-01-26 10:51:21.269289 (MainThread): Partial parsing not enabled
2021-01-26 10:51:21.285560 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:51:21.317070 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:51:21.331677 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:51:21.338287 (MainThread): Parsing macros/helpers.sql
2021-01-26 10:51:21.367524 (MainThread): Parsing macros/catalog.sql
2021-01-26 10:51:21.372515 (MainThread): Parsing macros/adapters.sql
2021-01-26 10:51:21.422656 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:51:21.425492 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 10:51:21.432400 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 10:51:21.433358 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 10:51:21.439811 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 10:51:21.460113 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:51:21.479065 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:51:21.488920 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 10:51:21.506919 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:51:21.519779 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:51:21.587472 (MainThread): Parsing macros/core.sql
2021-01-26 10:51:21.601034 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 10:51:21.688265 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 10:51:21.706749 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 10:51:21.710969 (MainThread): Parsing macros/etc/query.sql
2021-01-26 10:51:21.713731 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 10:51:21.716234 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 10:51:21.721127 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 10:51:21.725010 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 10:51:21.744217 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 10:51:21.748565 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:51:21.762234 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 10:51:21.817639 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 10:51:21.852797 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 10:51:21.857266 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 10:51:21.868091 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:51:21.881575 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 10:51:21.910718 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:51:21.924812 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:51:21.971988 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 10:51:21.976614 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 10:51:21.980927 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 10:51:22.005744 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 10:51:22.028536 (MainThread): Partial parsing not enabled
2021-01-26 10:51:22.172568 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:51:22.235728 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:51:22.271190 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:51:22.293641 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:51:22.337250 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:51:22.360853 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:51:22.392881 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_and_transfer_types_by_month".
2021-01-26 10:51:22.434651 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:51:22.491651 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:51:22.525782 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:51:24.782878 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 10:51:24.790379 (MainThread): 
2021-01-26 10:51:24.791281 (MainThread): Acquiring new dremio connection "master".
2021-01-26 10:51:24.943752 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 10:51:24.964063 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 10:51:24.964367 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 10:51:24.964607 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 10:51:24.964856 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:51:25.761312 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 10:51:26.816835 (ThreadPoolExecutor-0_0): SQL status: OK in 1.85 seconds
2021-01-26 10:51:26.921294 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 10:51:26.921816 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-26 10:51:26.924755 (MainThread): 11:51:26 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 10:51:26.927145 (MainThread): 11:51:26 | 
2021-01-26 10:51:26.963694 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 10:51:26.964725 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:51:26.965108 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 10:51:27.048202 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 10:51:27.142283 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.143227 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.149778 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 10:51:27.150347 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 10:51:27.151804 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:51:27.152409 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 10:51:27.190513 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 10:51:27.195198 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.198026 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.200580 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 10:51:27.201116 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-26 10:51:27.202660 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-26 10:51:27.203035 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-26 10:51:27.242287 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.245008 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.246928 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-26 10:51:27.248139 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-26 10:51:27.251812 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-26 10:51:27.253011 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-26 10:51:27.277520 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.279275 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.281199 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-26 10:51:27.283396 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-26 10:51:27.286484 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-26 10:51:27.287850 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-26 10:51:27.308983 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.311538 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.313561 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-26 10:51:27.314888 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:51:27.318336 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-26 10:51:27.319474 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:51:27.376204 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-26 10:51:27.393755 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.396306 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.398245 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:51:27.399993 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:51:27.401758 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-26 10:51:27.402907 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:51:27.436542 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-26 10:51:27.437653 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.438578 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.439769 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:51:27.440274 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:51:27.444172 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-26 10:51:27.445397 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:51:27.473400 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-26 10:51:27.475079 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.478497 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.480441 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:51:27.481719 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:51:27.483529 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-26 10:51:27.484664 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:51:27.513665 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-26 10:51:27.515404 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.516972 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.518933 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:51:27.521014 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:51:27.522886 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:51:27.524146 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:51:27.566684 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-26 10:51:27.568672 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.570179 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.573600 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:51:27.576929 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:51:27.578879 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:51:27.579318 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:51:27.605668 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-26 10:51:27.608251 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.610371 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.612532 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:51:27.613888 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 10:51:27.615825 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:51:27.617089 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 10:51:27.645142 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 10:51:27.720435 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.721834 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.723458 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 10:51:27.724013 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:51:27.725213 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-26 10:51:27.726003 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:51:27.743525 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-26 10:51:27.744317 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.745255 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.746439 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:51:27.746837 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:51:27.747686 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-26 10:51:27.748052 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:51:27.765577 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-26 10:51:27.766293 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.766944 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.768216 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:51:27.768909 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:51:27.769834 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-26 10:51:27.770226 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:51:27.789177 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-26 10:51:27.790265 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.791030 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.792151 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:51:27.792556 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:51:27.793461 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-26 10:51:27.793827 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:51:27.811280 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-26 10:51:27.812249 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.812997 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.814124 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:51:27.814499 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:51:27.815328 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-26 10:51:27.815696 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:51:27.833249 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-26 10:51:27.834502 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.835190 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.836371 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:51:27.836778 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:51:27.837530 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-26 10:51:27.838100 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:51:27.856023 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-26 10:51:27.857987 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.859282 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.861218 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:51:27.862181 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:51:27.863502 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-26 10:51:27.864451 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:51:27.883252 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-26 10:51:27.884537 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.885127 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.886246 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:51:27.886626 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 10:51:27.887572 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:51:27.887927 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 10:51:27.907398 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 10:51:27.908095 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.908782 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.909883 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 10:51:27.910567 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:51:27.911702 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-26 10:51:27.912049 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:51:27.930018 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-26 10:51:27.966954 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.968096 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.970233 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:51:27.971227 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:51:27.972542 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-26 10:51:27.972906 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:51:27.994119 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-26 10:51:27.994796 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.995518 (Thread-1): finished collecting timing info
2021-01-26 10:51:27.996604 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:51:27.997041 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-26 10:51:27.998013 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-26 10:51:27.998343 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-26 10:51:28.016451 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-26 10:51:28.017126 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.017862 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.018980 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-26 10:51:28.019376 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 10:51:28.020286 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:51:28.020629 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 10:51:28.036008 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 10:51:28.036666 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.037349 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.038480 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 10:51:28.038986 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:51:28.040162 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-26 10:51:28.040523 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:51:28.057855 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-26 10:51:28.058547 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.059209 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.060604 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:51:28.061075 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:51:28.062080 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-26 10:51:28.062448 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:51:28.081981 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-26 10:51:28.082655 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.083468 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.084576 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:51:28.084971 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:51:28.085899 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-26 10:51:28.086255 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:51:28.103874 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-26 10:51:28.104563 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.105352 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.106537 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:51:28.106949 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-26 10:51:28.107919 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-26 10:51:28.108260 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-26 10:51:28.125436 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-26 10:51:28.126157 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.127152 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.128358 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-26 10:51:28.128795 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 10:51:28.129751 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:51:28.130135 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 10:51:28.158316 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 10:51:28.158975 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.159660 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.161011 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 10:51:28.161527 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:51:28.163521 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-26 10:51:28.163901 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:51:28.181191 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-26 10:51:28.181873 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.182635 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.183725 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:51:28.184241 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:51:28.185179 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-26 10:51:28.185532 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:51:28.203454 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-26 10:51:28.204606 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.205173 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.206316 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:51:28.206797 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:51:28.207721 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-26 10:51:28.208122 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:51:28.229699 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-26 10:51:28.230410 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.231149 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.232232 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:51:28.232624 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:51:28.233535 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-26 10:51:28.233893 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:51:28.251912 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-26 10:51:28.252612 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.253329 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.254457 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:51:28.254817 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:51:28.255724 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-26 10:51:28.255999 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:51:28.273568 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-26 10:51:28.274290 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.274979 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.276060 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:51:28.276420 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:51:28.277439 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-26 10:51:28.277798 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:51:28.295604 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-26 10:51:28.334466 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.335399 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.337139 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:51:28.337599 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:51:28.338770 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-26 10:51:28.339553 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:51:28.361868 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-26 10:51:28.362725 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.363472 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.364558 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:51:28.364933 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:51:28.365881 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-26 10:51:28.366275 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:51:28.443838 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-26 10:51:28.444524 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.445233 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.446337 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:51:28.446684 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:51:28.447567 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-26 10:51:28.447917 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:51:28.466206 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-26 10:51:28.466913 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.467638 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.468722 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:51:28.469083 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:51:28.470040 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-26 10:51:28.470405 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:51:28.488733 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-26 10:51:28.489420 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.490120 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.491249 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:51:28.491614 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:51:28.492525 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-26 10:51:28.492872 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:51:28.510944 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-26 10:51:28.511630 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.512292 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.513395 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:51:28.513758 (Thread-1): Began running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:51:28.514705 (Thread-1): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:51:28.515060 (Thread-1): Compiling analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:51:28.541322 (Thread-1): Writing injected SQL for node "analysis.subsurface.most_expensive_departments_for_flats"
2021-01-26 10:51:28.542371 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.543073 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.544400 (Thread-1): Finished running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:51:28.544827 (Thread-1): Began running node analysis.subsurface.transactions_and_transfer_types_by_month
2021-01-26 10:51:28.545748 (Thread-1): Acquiring new dremio connection "analysis.subsurface.transactions_and_transfer_types_by_month".
2021-01-26 10:51:28.546126 (Thread-1): Compiling analysis.subsurface.transactions_and_transfer_types_by_month
2021-01-26 10:51:28.560093 (Thread-1): Writing injected SQL for node "analysis.subsurface.transactions_and_transfer_types_by_month"
2021-01-26 10:51:28.560927 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.561608 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.562855 (Thread-1): Finished running node analysis.subsurface.transactions_and_transfer_types_by_month
2021-01-26 10:51:28.563279 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:51:28.564183 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-26 10:51:28.564555 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:51:28.582742 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-26 10:51:28.583351 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.584203 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.585344 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:51:28.585751 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:51:28.586638 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-26 10:51:28.586972 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:51:28.614380 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-26 10:51:28.615489 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.616510 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.618150 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:51:28.618612 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:51:28.619654 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-26 10:51:28.620003 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:51:28.643268 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-26 10:51:28.643958 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.644633 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.645719 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:51:28.646112 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-26 10:51:28.647024 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-26 10:51:28.647362 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-26 10:51:28.665145 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-26 10:51:28.665833 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.666697 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.667788 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-26 10:51:28.668146 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:51:28.669017 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-26 10:51:28.669369 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:51:28.687449 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-26 10:51:28.688139 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.688810 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.689885 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:51:28.690304 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:51:28.691255 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-26 10:51:28.691581 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:51:28.711558 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-26 10:51:28.712250 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.712924 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.714067 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:51:28.714424 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:51:28.715312 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-26 10:51:28.715666 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:51:28.733505 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-26 10:51:28.734227 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.734892 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.735972 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:51:28.736332 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:51:28.737227 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-26 10:51:28.737638 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:51:28.755939 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-26 10:51:28.756644 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.757311 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.758444 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:51:28.758853 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:51:28.759770 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-26 10:51:28.760099 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:51:28.777977 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-26 10:51:28.778652 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.779328 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.780504 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:51:28.780860 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:51:28.781749 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-26 10:51:28.782152 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:51:28.800391 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-26 10:51:28.801086 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.801748 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.802843 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:51:28.803281 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:51:28.804202 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-26 10:51:28.804561 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:51:28.825096 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-26 10:51:28.825774 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.826469 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.827876 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:51:28.828824 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:51:28.829590 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-26 10:51:28.829924 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:51:28.847987 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-26 10:51:28.848679 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.849361 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.850472 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:51:28.850875 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:51:28.851755 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-26 10:51:28.852102 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:51:28.870113 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-26 10:51:28.870802 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.871461 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.872544 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:51:28.872877 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:51:28.873692 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-26 10:51:28.874078 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:51:28.891803 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-26 10:51:28.892481 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.893146 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.894579 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:51:28.894954 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:51:28.895793 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-26 10:51:28.896160 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:51:28.919691 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-26 10:51:28.920375 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.921130 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.922275 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:51:28.922680 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:51:28.923540 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-26 10:51:28.923908 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:51:28.948571 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-26 10:51:28.949267 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.949988 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.951094 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:51:28.951462 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:51:28.952186 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-26 10:51:28.952605 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:51:28.974202 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-26 10:51:28.975138 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.975836 (Thread-1): finished collecting timing info
2021-01-26 10:51:28.977295 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:51:29.050677 (MainThread): Connection 'master' was properly closed.
2021-01-26 10:51:29.051098 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-26 10:51:29.333149 (MainThread): 11:51:29 | Done.
2021-01-26 10:51:29.333777 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3024502b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3025cdb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3025cd6d8>]}
2021-01-26 10:51:29.334367 (MainThread): Flushing usage events
2021-01-26 10:51:59.684911 (MainThread): Running with dbt=0.18.1
2021-01-26 10:51:59.803558 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='clean', write_json=True)
2021-01-26 10:51:59.804146 (MainThread): Tracking: tracking
2021-01-26 10:51:59.812970 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0be8c0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b97e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b97eb70>]}
2021-01-26 10:51:59.813835 (MainThread): Checking target/*
2021-01-26 10:51:59.904619 (MainThread):  Cleaned target/*
2021-01-26 10:51:59.905023 (MainThread): Checking dbt_modules/*
2021-01-26 10:51:59.906072 (MainThread):  Cleaned dbt_modules/*
2021-01-26 10:51:59.906570 (MainThread): Finished cleaning all paths.
2021-01-26 10:51:59.907274 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b973ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0be8c0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b97e0f0>]}
2021-01-26 10:51:59.908027 (MainThread): Flushing usage events
2021-01-26 10:52:03.187439 (MainThread): Running with dbt=0.18.1
2021-01-26 10:52:03.316328 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-01-26 10:52:03.317815 (MainThread): Tracking: tracking
2021-01-26 10:52:03.327260 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e64b2fc88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e64644dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e64644e48>]}
2021-01-26 10:52:03.389472 (MainThread): Partial parsing not enabled
2021-01-26 10:52:03.391295 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:52:03.398765 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:52:03.403685 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:52:03.410372 (MainThread): Parsing macros/helpers.sql
2021-01-26 10:52:03.442552 (MainThread): Parsing macros/catalog.sql
2021-01-26 10:52:03.447676 (MainThread): Parsing macros/adapters.sql
2021-01-26 10:52:03.497493 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:52:03.500096 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 10:52:03.506604 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 10:52:03.507167 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 10:52:03.513187 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 10:52:03.532996 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:52:03.551650 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:52:03.561219 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 10:52:03.576795 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:52:03.588419 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:52:03.618559 (MainThread): Parsing macros/core.sql
2021-01-26 10:52:03.627072 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 10:52:03.713329 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 10:52:03.731513 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 10:52:03.735783 (MainThread): Parsing macros/etc/query.sql
2021-01-26 10:52:03.738358 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 10:52:03.740644 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 10:52:03.745423 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 10:52:03.749027 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 10:52:03.769241 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 10:52:03.773323 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:52:03.788613 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 10:52:03.844191 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 10:52:03.880790 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 10:52:03.884717 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 10:52:03.895916 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:52:03.908874 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 10:52:03.938735 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:52:03.953677 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:52:03.997688 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 10:52:04.002214 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 10:52:04.006113 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 10:52:04.010208 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 10:52:04.026497 (MainThread): Partial parsing not enabled
2021-01-26 10:52:04.149179 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:52:04.195551 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:52:04.216901 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:52:04.244338 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:52:04.270688 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:52:04.294535 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:52:04.325903 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-26 10:52:04.348033 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:52:04.393376 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:52:04.423827 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:52:06.652949 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 10:52:06.661199 (MainThread): 
2021-01-26 10:52:06.661925 (MainThread): Acquiring new dremio connection "master".
2021-01-26 10:52:06.831178 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 10:52:06.855080 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 10:52:06.855407 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 10:52:06.855609 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 10:52:06.855762 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:07.034493 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 10:52:07.592359 (ThreadPoolExecutor-0_0): SQL status: OK in 0.74 seconds
2021-01-26 10:52:07.661875 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 10:52:07.663102 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-26 10:52:07.668268 (MainThread): 11:52:07 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 10:52:07.668989 (MainThread): 11:52:07 | 
2021-01-26 10:52:07.675449 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 10:52:07.676673 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:52:07.677049 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 10:52:07.785278 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 10:52:07.787949 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.789513 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.791898 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 10:52:07.793816 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 10:52:07.796474 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:52:07.797652 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 10:52:07.821039 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 10:52:07.821736 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.822503 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.823711 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 10:52:07.824195 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-26 10:52:07.825853 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-26 10:52:07.826743 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-26 10:52:07.856793 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.857486 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.858776 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-26 10:52:07.859254 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-26 10:52:07.861650 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-26 10:52:07.862222 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-26 10:52:07.881439 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.882203 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.883712 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-26 10:52:07.884273 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-26 10:52:07.885729 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-26 10:52:07.886216 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-26 10:52:07.902969 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.903586 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.904862 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-26 10:52:07.905240 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:52:07.906424 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-26 10:52:07.907129 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:52:07.948146 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-26 10:52:07.949260 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.950033 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.951646 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:52:07.952172 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:52:07.953199 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-26 10:52:07.953626 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:52:07.976207 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-26 10:52:07.977018 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.977802 (Thread-1): finished collecting timing info
2021-01-26 10:52:07.979085 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:52:07.979487 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:52:07.980508 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-26 10:52:07.980976 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:52:08.003506 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-26 10:52:08.004261 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.005031 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.006314 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:52:08.006792 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:52:08.007792 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-26 10:52:08.008233 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:52:08.031855 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-26 10:52:08.033247 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.035015 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.036619 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:52:08.037673 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:52:08.039120 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:52:08.040086 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:52:08.076277 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-26 10:52:08.076990 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.077518 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.078983 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:52:08.079431 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:52:08.080498 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:52:08.080871 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:52:08.101177 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-26 10:52:08.101844 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.102675 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.103932 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:52:08.104338 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 10:52:08.105435 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:52:08.105857 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 10:52:08.125106 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 10:52:08.125904 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.127050 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.128377 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 10:52:08.128832 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:52:08.130781 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-26 10:52:08.131191 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:52:08.153670 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-26 10:52:08.154408 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.155166 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.156298 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:52:08.156826 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:52:08.157871 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-26 10:52:08.158283 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:52:08.180875 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-26 10:52:08.181512 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.182303 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.183537 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:52:08.183963 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:52:08.185038 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-26 10:52:08.185375 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:52:08.209832 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-26 10:52:08.210904 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.211611 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.212852 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:52:08.213811 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:52:08.215012 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-26 10:52:08.215397 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:52:08.237333 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-26 10:52:08.238025 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.238760 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.239951 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:52:08.240323 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:52:08.241344 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-26 10:52:08.241667 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:52:08.262020 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-26 10:52:08.262609 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.263322 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.264372 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:52:08.264864 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:52:08.265802 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-26 10:52:08.266204 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:52:08.284560 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-26 10:52:08.285170 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.285869 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.287039 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:52:08.287482 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:52:08.288513 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-26 10:52:08.288940 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:52:08.307527 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-26 10:52:08.308147 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.308853 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.310300 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:52:08.310657 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 10:52:08.311664 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:52:08.311978 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 10:52:08.328166 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 10:52:08.328780 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.329458 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.330610 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 10:52:08.331002 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:52:08.332154 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-26 10:52:08.332486 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:52:08.350793 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-26 10:52:08.351553 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.352251 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.353380 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:52:08.353773 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:52:08.354764 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-26 10:52:08.355087 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:52:08.373558 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-26 10:52:08.374188 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.374892 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.376016 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:52:08.376385 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-26 10:52:08.377642 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-26 10:52:08.378063 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-26 10:52:08.402418 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-26 10:52:08.403148 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.404210 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.405611 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-26 10:52:08.406099 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 10:52:08.407128 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:52:08.407541 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 10:52:08.430127 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 10:52:08.430893 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.431648 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.432903 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 10:52:08.433354 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:52:08.434770 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-26 10:52:08.435191 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:52:08.462827 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-26 10:52:08.463518 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.464656 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.465825 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:52:08.466655 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:52:08.468190 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-26 10:52:08.468614 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:52:08.497109 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-26 10:52:08.497822 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.498618 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.499843 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:52:08.500324 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:52:08.501311 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-26 10:52:08.501708 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:52:08.526789 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-26 10:52:08.527493 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.528327 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.529512 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:52:08.530052 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-26 10:52:08.531046 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-26 10:52:08.531425 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-26 10:52:08.554266 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-26 10:52:08.554874 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.555527 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.556402 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-26 10:52:08.556858 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 10:52:08.557844 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:52:08.558214 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 10:52:08.587195 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 10:52:08.587880 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.588581 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.589725 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 10:52:08.590108 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:52:08.591832 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-26 10:52:08.592195 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:52:08.610102 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-26 10:52:08.610949 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.611593 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.612750 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:52:08.613129 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:52:08.614112 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-26 10:52:08.614429 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:52:08.632563 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-26 10:52:08.633161 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.633868 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.635039 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:52:08.635441 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:52:08.636401 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-26 10:52:08.636832 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:52:08.661980 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-26 10:52:08.663141 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.663675 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.664797 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:52:08.665150 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:52:08.666295 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-26 10:52:08.666654 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:52:08.687640 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-26 10:52:08.688356 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.689042 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.690185 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:52:08.690534 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:52:08.691497 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-26 10:52:08.691838 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:52:08.709795 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-26 10:52:08.710516 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.711281 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.712411 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:52:08.712875 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:52:08.713880 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-26 10:52:08.714302 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:52:08.732383 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-26 10:52:08.733404 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.734044 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.735181 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:52:08.735564 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:52:08.736541 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-26 10:52:08.737080 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:52:08.757847 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-26 10:52:08.758506 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.759319 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.760635 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:52:08.761129 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:52:08.762126 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-26 10:52:08.762520 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:52:08.840952 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-26 10:52:08.841645 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.842397 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.843747 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:52:08.844234 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:52:08.845274 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-26 10:52:08.845720 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:52:08.867208 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-26 10:52:08.867959 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.868790 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.870127 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:52:08.870554 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:52:08.871684 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-26 10:52:08.872079 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:52:08.893678 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-26 10:52:08.894449 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.895272 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.896763 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:52:08.897263 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:52:08.898383 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-26 10:52:08.898810 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:52:08.920145 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-26 10:52:08.920900 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.921601 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.922861 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:52:08.923269 (Thread-1): Began running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:52:08.924296 (Thread-1): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:52:08.924647 (Thread-1): Compiling analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:52:08.959842 (Thread-1): Writing injected SQL for node "analysis.subsurface.most_expensive_departments_for_flats"
2021-01-26 10:52:08.960960 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.961608 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.962883 (Thread-1): Finished running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:52:08.963373 (Thread-1): Began running node analysis.subsurface.transactions_seasonality
2021-01-26 10:52:08.964511 (Thread-1): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-26 10:52:08.964965 (Thread-1): Compiling analysis.subsurface.transactions_seasonality
2021-01-26 10:52:08.981671 (Thread-1): Writing injected SQL for node "analysis.subsurface.transactions_seasonality"
2021-01-26 10:52:08.982533 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.983293 (Thread-1): finished collecting timing info
2021-01-26 10:52:08.984561 (Thread-1): Finished running node analysis.subsurface.transactions_seasonality
2021-01-26 10:52:08.985022 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:52:08.986162 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-26 10:52:08.986704 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:52:09.007431 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-26 10:52:09.008188 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.009225 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.010599 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:52:09.011113 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:52:09.012134 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-26 10:52:09.012577 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:52:09.035439 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-26 10:52:09.036193 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.037012 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.038296 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:52:09.038784 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:52:09.039860 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-26 10:52:09.040223 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:52:09.061731 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-26 10:52:09.062476 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.063285 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.064480 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:52:09.065119 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-26 10:52:09.066286 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-26 10:52:09.066750 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-26 10:52:09.088050 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-26 10:52:09.088855 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.089677 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.090978 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-26 10:52:09.091402 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:52:09.092503 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-26 10:52:09.093002 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:52:09.114363 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-26 10:52:09.115112 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.115885 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.117143 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:52:09.117577 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:52:09.118701 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-26 10:52:09.119087 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:52:09.140190 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-26 10:52:09.140933 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.141666 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.143053 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:52:09.143584 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:52:09.144655 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-26 10:52:09.145067 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:52:09.167749 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-26 10:52:09.168465 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.169234 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.170515 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:52:09.171003 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:52:09.172072 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-26 10:52:09.172482 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:52:09.194202 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-26 10:52:09.194937 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.195722 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.197078 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:52:09.197543 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:52:09.198768 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-26 10:52:09.199187 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:52:09.220109 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-26 10:52:09.220969 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.221846 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.223147 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:52:09.223567 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:52:09.224579 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-26 10:52:09.224960 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:52:09.247146 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-26 10:52:09.247900 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.248671 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.249964 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:52:09.250395 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:52:09.251467 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-26 10:52:09.251882 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:52:09.278093 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-26 10:52:09.279008 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.279812 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.281062 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:52:09.281523 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:52:09.282578 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-26 10:52:09.283017 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:52:09.304817 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-26 10:52:09.305600 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.306356 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.307629 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:52:09.308056 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:52:09.309103 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-26 10:52:09.309475 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:52:09.330984 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-26 10:52:09.331674 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.332553 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.334049 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:52:09.334645 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:52:09.335795 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-26 10:52:09.336250 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:52:09.358431 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-26 10:52:09.359199 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.360034 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.361185 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:52:09.361679 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:52:09.362733 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-26 10:52:09.363152 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:52:09.389812 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-26 10:52:09.390717 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.391624 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.392934 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:52:09.393531 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:52:09.394694 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-26 10:52:09.395105 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:52:09.421759 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-26 10:52:09.422525 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.423273 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.424715 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:52:09.425242 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:52:09.426310 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-26 10:52:09.426830 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:52:09.454069 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-26 10:52:09.454849 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.455583 (Thread-1): finished collecting timing info
2021-01-26 10:52:09.456706 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:52:09.555209 (MainThread): Connection 'master' was properly closed.
2021-01-26 10:52:09.555642 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-26 10:52:09.555796 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-26 10:52:09.829997 (MainThread): 11:52:09 | Done.
2021-01-26 10:52:09.830456 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e64233a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e64463198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e64463438>]}
2021-01-26 10:52:09.830978 (MainThread): Flushing usage events
2021-01-26 10:52:17.644117 (MainThread): Running with dbt=0.18.1
2021-01-26 10:52:17.772930 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-26 10:52:17.774427 (MainThread): Tracking: tracking
2021-01-26 10:52:17.783998 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bdf8fd68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bdaa4da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bdaa4e10>]}
2021-01-26 10:52:17.845622 (MainThread): Partial parsing not enabled
2021-01-26 10:52:17.847308 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:52:17.854316 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:52:17.859401 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:52:17.865876 (MainThread): Parsing macros/helpers.sql
2021-01-26 10:52:17.898516 (MainThread): Parsing macros/catalog.sql
2021-01-26 10:52:17.904191 (MainThread): Parsing macros/adapters.sql
2021-01-26 10:52:17.956684 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:52:17.959759 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 10:52:17.965928 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 10:52:17.966501 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 10:52:17.973332 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 10:52:17.996846 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:52:18.018243 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:52:18.028876 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 10:52:18.049175 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:52:18.061392 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:52:18.091047 (MainThread): Parsing macros/core.sql
2021-01-26 10:52:18.098933 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 10:52:18.183856 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 10:52:18.202316 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 10:52:18.206054 (MainThread): Parsing macros/etc/query.sql
2021-01-26 10:52:18.208581 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 10:52:18.211380 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 10:52:18.216108 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 10:52:18.219779 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 10:52:18.239623 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 10:52:18.243919 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:52:18.256963 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 10:52:18.312043 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 10:52:18.348564 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 10:52:18.352418 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 10:52:18.363472 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:52:18.376199 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 10:52:18.404943 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:52:18.418791 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:52:18.460973 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 10:52:18.465194 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 10:52:18.469231 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 10:52:18.473002 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 10:52:18.489280 (MainThread): Partial parsing not enabled
2021-01-26 10:52:18.637165 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:52:18.700985 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:52:18.722222 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:52:18.743942 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:52:18.768215 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:52:18.789497 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:52:18.820306 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-26 10:52:18.841895 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:52:18.880359 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:52:18.902297 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:52:21.017659 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 10:52:21.024491 (MainThread): 
2021-01-26 10:52:21.025251 (MainThread): Acquiring new dremio connection "master".
2021-01-26 10:52:21.046576 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-26 10:52:21.075217 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-26 10:52:21.075632 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-26 10:52:21.075884 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 10:52:21.076089 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:21.294066 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 10:52:22.528253 (ThreadPoolExecutor-0_0): SQL status: OK in 1.45 seconds
2021-01-26 10:52:22.562755 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-26 10:52:22.720083 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 10:52:22.736279 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 10:52:22.737166 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 10:52:22.737431 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-26 10:52:22.737594 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:22.895688 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-26 10:52:23.408795 (ThreadPoolExecutor-1_0): SQL status: OK in 0.67 seconds
2021-01-26 10:52:23.477758 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 10:52:23.484033 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-26 10:52:23.487575 (MainThread): 11:52:23 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 10:52:23.491963 (MainThread): 11:52:23 | 
2021-01-26 10:52:23.530048 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 10:52:23.533021 (Thread-1): 11:52:23 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-26 10:52:23.533931 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:52:23.534358 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 10:52:23.625467 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 10:52:23.627332 (Thread-1): finished collecting timing info
2021-01-26 10:52:23.678450 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-26 10:52:23.679385 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:52:23.679662 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-26 10:52:23.679910 (Thread-1): Opening a new connection, currently in state init
2021-01-26 10:52:23.680134 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:23.830349 (Thread-1): Connected to db: None
2021-01-26 10:52:24.310118 (Thread-1): SQL status: OK in 0.63 seconds
2021-01-26 10:52:24.335224 (Thread-1): finished collecting timing info
2021-01-26 10:52:24.336748 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-26 10:52:24.337156 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-26 10:52:24.339456 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd7f0cb-407a-4a8d-9acd-e236bbeea9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd78ecf8>]}
2021-01-26 10:52:24.346107 (Thread-1): 11:52:24 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 0.81s]
2021-01-26 10:52:24.347176 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 10:52:24.348687 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 10:52:24.351631 (Thread-1): 11:52:24 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-26 10:52:24.352414 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:52:24.352821 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 10:52:24.387168 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 10:52:24.388023 (Thread-1): finished collecting timing info
2021-01-26 10:52:24.403595 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-26 10:52:24.404422 (Thread-1): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:52:24.405725 (Thread-1): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-26 10:52:24.406107 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 10:52:24.406320 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:24.564908 (Thread-1): Connected to db: None
2021-01-26 10:52:24.687486 (Thread-1): SQL status: OK in 0.28 seconds
2021-01-26 10:52:24.697886 (Thread-1): finished collecting timing info
2021-01-26 10:52:24.705634 (Thread-1): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-26 10:52:24.712339 (Thread-1): On model.subsurface.stg__municipalities: Close
2021-01-26 10:52:24.718605 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd7f0cb-407a-4a8d-9acd-e236bbeea9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd7a4c50>]}
2021-01-26 10:52:24.725546 (Thread-1): 11:52:24 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 0.37s]
2021-01-26 10:52:24.727783 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 10:52:24.734705 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 10:52:24.744075 (Thread-1): 11:52:24 | 3 of 6 START view model @fab4.d_crop_types........................... [RUN]
2021-01-26 10:52:24.745004 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:52:24.746163 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 10:52:24.778730 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 10:52:24.779542 (Thread-1): finished collecting timing info
2021-01-26 10:52:24.794863 (Thread-1): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-26 10:52:24.795882 (Thread-1): Using dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:52:24.796168 (Thread-1): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-26 10:52:24.796336 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 10:52:24.796504 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:24.956419 (Thread-1): Connected to db: None
2021-01-26 10:52:25.181391 (Thread-1): SQL status: OK in 0.38 seconds
2021-01-26 10:52:25.187869 (Thread-1): finished collecting timing info
2021-01-26 10:52:25.188815 (Thread-1): On model.subsurface.d_crop_types: ROLLBACK
2021-01-26 10:52:25.189343 (Thread-1): On model.subsurface.d_crop_types: Close
2021-01-26 10:52:25.197225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd7f0cb-407a-4a8d-9acd-e236bbeea9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd8912b0>]}
2021-01-26 10:52:25.200172 (Thread-1): 11:52:25 | 3 of 6 OK created view model @fab4.d_crop_types...................... [OK in 0.45s]
2021-01-26 10:52:25.206289 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 10:52:25.206891 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 10:52:25.210705 (Thread-1): 11:52:25 | 4 of 6 START view model @fab4.d_premises_types....................... [RUN]
2021-01-26 10:52:25.211568 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:52:25.211919 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 10:52:25.254258 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 10:52:25.255015 (Thread-1): finished collecting timing info
2021-01-26 10:52:25.280730 (Thread-1): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-26 10:52:25.284492 (Thread-1): Using dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:52:25.284824 (Thread-1): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-26 10:52:25.284998 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 10:52:25.285818 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:25.440979 (Thread-1): Connected to db: None
2021-01-26 10:52:25.598715 (Thread-1): SQL status: OK in 0.31 seconds
2021-01-26 10:52:25.604192 (Thread-1): finished collecting timing info
2021-01-26 10:52:25.604706 (Thread-1): On model.subsurface.d_premises_types: ROLLBACK
2021-01-26 10:52:25.604986 (Thread-1): On model.subsurface.d_premises_types: Close
2021-01-26 10:52:25.609483 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd7f0cb-407a-4a8d-9acd-e236bbeea9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd88add8>]}
2021-01-26 10:52:25.613008 (Thread-1): 11:52:25 | 4 of 6 OK created view model @fab4.d_premises_types.................. [OK in 0.40s]
2021-01-26 10:52:25.618268 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 10:52:25.618831 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 10:52:25.621713 (Thread-1): 11:52:25 | 5 of 6 START view model @fab4.f_land_values.......................... [RUN]
2021-01-26 10:52:25.622571 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:52:25.622986 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 10:52:25.689306 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 10:52:25.696086 (Thread-1): finished collecting timing info
2021-01-26 10:52:25.714305 (Thread-1): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-26 10:52:25.716012 (Thread-1): Using dremio connection "model.subsurface.f_land_values".
2021-01-26 10:52:25.717273 (Thread-1): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-26 10:52:25.718440 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 10:52:25.719791 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:25.867991 (Thread-1): Connected to db: None
2021-01-26 10:52:26.425859 (Thread-1): SQL status: OK in 0.71 seconds
2021-01-26 10:52:26.436895 (Thread-1): finished collecting timing info
2021-01-26 10:52:26.441895 (Thread-1): On model.subsurface.f_land_values: ROLLBACK
2021-01-26 10:52:26.444910 (Thread-1): On model.subsurface.f_land_values: Close
2021-01-26 10:52:26.451394 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd7f0cb-407a-4a8d-9acd-e236bbeea9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd74bb38>]}
2021-01-26 10:52:26.457299 (Thread-1): 11:52:26 | 5 of 6 OK created view model @fab4.f_land_values..................... [OK in 0.83s]
2021-01-26 10:52:26.459270 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 10:52:26.468329 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 10:52:26.472869 (Thread-1): 11:52:26 | 6 of 6 START view model @fab4.d_municipalities....................... [RUN]
2021-01-26 10:52:26.477467 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:52:26.477900 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 10:52:26.521208 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 10:52:26.522001 (Thread-1): finished collecting timing info
2021-01-26 10:52:26.535042 (Thread-1): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-26 10:52:26.535848 (Thread-1): Using dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:52:26.536103 (Thread-1): On model.subsurface.d_municipalities: 
  create or replace view "@fab4"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-26 10:52:26.536270 (Thread-1): Opening a new connection, currently in state closed
2021-01-26 10:52:26.536449 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:26.686404 (Thread-1): Connected to db: None
2021-01-26 10:52:26.866215 (Thread-1): SQL status: OK in 0.33 seconds
2021-01-26 10:52:26.874974 (Thread-1): finished collecting timing info
2021-01-26 10:52:26.882147 (Thread-1): On model.subsurface.d_municipalities: ROLLBACK
2021-01-26 10:52:26.883307 (Thread-1): On model.subsurface.d_municipalities: Close
2021-01-26 10:52:26.890983 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd7f0cb-407a-4a8d-9acd-e236bbeea9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd88add8>]}
2021-01-26 10:52:26.895239 (Thread-1): 11:52:26 | 6 of 6 OK created view model @fab4.d_municipalities.................. [OK in 0.41s]
2021-01-26 10:52:26.895824 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 10:52:26.951650 (MainThread): Acquiring new dremio connection "master".
2021-01-26 10:52:26.952073 (MainThread): On master: ROLLBACK
2021-01-26 10:52:26.952321 (MainThread): Opening a new connection, currently in state init
2021-01-26 10:52:26.952504 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:52:27.125832 (MainThread): Connected to db: None
2021-01-26 10:52:27.126257 (MainThread): On master: ROLLBACK
2021-01-26 10:52:27.126551 (MainThread): On master: Close
2021-01-26 10:52:27.128208 (MainThread): 11:52:27 | 
2021-01-26 10:52:27.129363 (MainThread): 11:52:27 | Finished running 6 view models in 6.10s.
2021-01-26 10:52:27.130414 (MainThread): Connection 'master' was properly closed.
2021-01-26 10:52:27.131173 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-26 10:52:27.131460 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-26 10:52:27.198401 (MainThread): 
2021-01-26 10:52:27.199944 (MainThread): Completed successfully
2021-01-26 10:52:27.209842 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-26 10:52:27.210758 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd67e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd67e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd67eac8>]}
2021-01-26 10:52:27.211334 (MainThread): Flushing usage events
2021-01-26 10:58:04.898872 (MainThread): Running with dbt=0.18.1
2021-01-26 10:58:05.296920 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-01-26 10:58:05.307912 (MainThread): Tracking: tracking
2021-01-26 10:58:05.339086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f650734ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f650734aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f650734af60>]}
2021-01-26 10:58:05.427845 (MainThread): Partial parsing not enabled
2021-01-26 10:58:05.429534 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:58:05.454424 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:58:05.487954 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:58:05.514443 (MainThread): Parsing macros/helpers.sql
2021-01-26 10:58:05.553513 (MainThread): Parsing macros/catalog.sql
2021-01-26 10:58:05.559008 (MainThread): Parsing macros/adapters.sql
2021-01-26 10:58:05.619473 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:58:05.622270 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 10:58:05.629359 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 10:58:05.630451 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 10:58:05.638132 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 10:58:05.660861 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:58:05.681493 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:58:05.691392 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 10:58:05.708687 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:58:05.720754 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:58:05.760662 (MainThread): Parsing macros/core.sql
2021-01-26 10:58:05.773662 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 10:58:05.864266 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 10:58:05.885614 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 10:58:05.890415 (MainThread): Parsing macros/etc/query.sql
2021-01-26 10:58:05.893056 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 10:58:05.898430 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 10:58:05.905591 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 10:58:05.910861 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 10:58:05.934736 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 10:58:05.943203 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:58:05.965588 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 10:58:06.029076 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 10:58:06.063783 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 10:58:06.067618 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 10:58:06.078179 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:58:06.090861 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 10:58:06.120658 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:58:06.135228 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:58:06.176929 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 10:58:06.181613 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 10:58:06.185139 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 10:58:06.188993 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 10:58:06.208148 (MainThread): Partial parsing not enabled
2021-01-26 10:58:06.336825 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:58:06.386799 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:58:06.410929 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:58:06.432286 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:58:06.457370 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:58:06.482506 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:58:06.513925 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-26 10:58:06.543312 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:58:06.587209 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:58:06.609869 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:58:08.966987 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-26 10:58:09.809967 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 10:58:09.818279 (MainThread): 
2021-01-26 10:58:09.819118 (MainThread): Acquiring new dremio connection "master".
2021-01-26 10:58:09.982741 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 10:58:10.004491 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 10:58:10.005355 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 10:58:10.005629 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 10:58:10.005840 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:58:10.240344 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 10:58:10.798977 (ThreadPoolExecutor-0_0): SQL status: OK in 0.79 seconds
2021-01-26 10:58:10.879112 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 10:58:10.880317 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-26 10:58:10.883929 (MainThread): 11:58:10 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 10:58:10.885869 (MainThread): 11:58:10 | 
2021-01-26 10:58:10.902345 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 10:58:10.903112 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:58:10.903390 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 10:58:10.995532 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 10:58:10.996373 (Thread-1): finished collecting timing info
2021-01-26 10:58:10.997269 (Thread-1): finished collecting timing info
2021-01-26 10:58:10.998557 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 10:58:10.999787 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 10:58:11.001297 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:58:11.001753 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 10:58:11.025516 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 10:58:11.026370 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.027231 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.028495 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 10:58:11.028953 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-26 10:58:11.031025 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-26 10:58:11.032636 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-26 10:58:11.064287 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.065079 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.066602 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-26 10:58:11.067094 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-26 10:58:11.068160 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-26 10:58:11.068847 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-26 10:58:11.087053 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.087664 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.088829 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-26 10:58:11.089309 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-26 10:58:11.090870 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-26 10:58:11.091244 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-26 10:58:11.108063 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.108723 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.110293 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-26 10:58:11.110755 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:58:11.112256 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-26 10:58:11.112650 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:58:11.150486 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-26 10:58:11.151234 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.151988 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.153158 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:58:11.153581 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:58:11.154599 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-26 10:58:11.155012 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:58:11.177541 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-26 10:58:11.178435 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.179289 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.180564 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:58:11.181002 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:58:11.182030 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-26 10:58:11.182453 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:58:11.212943 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-26 10:58:11.215105 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.217107 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.220504 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:58:11.221524 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:58:11.223957 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-26 10:58:11.224683 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:58:11.274776 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-26 10:58:11.277298 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.278241 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.279647 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:58:11.280161 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:58:11.281473 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:58:11.281936 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:58:11.330349 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-26 10:58:11.331327 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.332262 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.333967 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:58:11.334648 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:58:11.335748 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:58:11.336183 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:58:11.365040 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-26 10:58:11.366025 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.367038 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.368941 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:58:11.369466 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 10:58:11.370637 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:58:11.371070 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 10:58:11.398897 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 10:58:11.400108 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.401125 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.402825 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 10:58:11.403299 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:58:11.405028 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-26 10:58:11.405501 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:58:11.467994 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-26 10:58:11.471146 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.473365 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.475538 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:58:11.476486 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:58:11.478053 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-26 10:58:11.478924 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:58:11.599823 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-26 10:58:11.606581 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.608985 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.618839 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:58:11.619890 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:58:11.622446 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-26 10:58:11.623210 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:58:11.667332 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-26 10:58:11.668129 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.668950 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.670156 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:58:11.670563 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:58:11.671607 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-26 10:58:11.672594 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:58:11.701425 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-26 10:58:11.702897 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.703575 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.705570 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:58:11.706164 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:58:11.707206 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-26 10:58:11.707786 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:58:11.739610 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-26 10:58:11.740603 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.741481 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.743205 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:58:11.743823 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:58:11.745002 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-26 10:58:11.745417 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:58:11.773512 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-26 10:58:11.774392 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.775257 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.776801 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:58:11.777367 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:58:11.778420 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-26 10:58:11.778865 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:58:11.801315 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-26 10:58:11.802111 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.802853 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.804010 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:58:11.804411 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 10:58:11.805380 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:58:11.805807 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 10:58:11.826730 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 10:58:11.827630 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.828636 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.829915 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 10:58:11.830397 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:58:11.831198 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-26 10:58:11.831791 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:58:11.863470 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-26 10:58:11.864770 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.865834 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.867152 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:58:11.867759 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:58:11.868752 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-26 10:58:11.869408 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:58:11.903580 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-26 10:58:11.904460 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.905206 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.906477 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:58:11.907050 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-26 10:58:11.908238 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-26 10:58:11.908780 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-26 10:58:11.931080 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-26 10:58:11.931907 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.932751 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.934044 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-26 10:58:11.935013 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 10:58:11.936068 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:58:11.936732 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 10:58:11.959318 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 10:58:11.960097 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.960786 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.961955 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 10:58:11.962468 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:58:11.963828 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-26 10:58:11.964229 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:58:11.987512 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-26 10:58:11.988514 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.989813 (Thread-1): finished collecting timing info
2021-01-26 10:58:11.991194 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:58:11.991812 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:58:11.993121 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-26 10:58:11.993548 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:58:12.021402 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-26 10:58:12.022455 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.023469 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.025056 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:58:12.025564 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:58:12.026640 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-26 10:58:12.027059 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:58:12.054864 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-26 10:58:12.055815 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.056972 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.058315 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:58:12.058827 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-26 10:58:12.059891 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-26 10:58:12.060315 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-26 10:58:12.085400 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-26 10:58:12.086611 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.087536 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.089124 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-26 10:58:12.089614 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 10:58:12.090730 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:58:12.091172 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 10:58:12.147958 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 10:58:12.149315 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.150283 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.151609 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 10:58:12.152169 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:58:12.154853 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-26 10:58:12.155256 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:58:12.181290 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-26 10:58:12.182146 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.182916 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.184037 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:58:12.184891 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:58:12.185974 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-26 10:58:12.186453 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:58:12.207076 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-26 10:58:12.207874 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.209091 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.210418 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:58:12.210890 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:58:12.211895 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-26 10:58:12.212298 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:58:12.251043 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-26 10:58:12.252562 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.254228 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.255907 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:58:12.257068 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:58:12.258407 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-26 10:58:12.260296 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:58:12.283794 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-26 10:58:12.285007 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.286082 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.287388 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:58:12.287859 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:58:12.289166 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-26 10:58:12.289562 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:58:12.309423 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-26 10:58:12.310235 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.310956 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.312127 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:58:12.312687 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:58:12.313678 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-26 10:58:12.314128 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:58:12.334269 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-26 10:58:12.335114 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.335836 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.337047 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:58:12.337549 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:58:12.338611 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-26 10:58:12.339083 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:58:12.362638 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-26 10:58:12.363447 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.364196 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.365412 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:58:12.365835 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:58:12.366880 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-26 10:58:12.367282 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:58:12.451143 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-26 10:58:12.451993 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.452793 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.454101 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:58:12.454973 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:58:12.456089 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-26 10:58:12.456583 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:58:12.479229 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-26 10:58:12.480246 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.481172 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.482675 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:58:12.483211 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:58:12.484289 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-26 10:58:12.484737 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:58:12.508280 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-26 10:58:12.509156 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.509884 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.511152 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:58:12.511581 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:58:12.512627 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-26 10:58:12.512992 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:58:12.534031 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-26 10:58:12.534853 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.535652 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.537050 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:58:12.537542 (Thread-1): Began running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:58:12.538645 (Thread-1): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:58:12.539013 (Thread-1): Compiling analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:58:12.572628 (Thread-1): Writing injected SQL for node "analysis.subsurface.most_expensive_departments_for_flats"
2021-01-26 10:58:12.573450 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.574081 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.574993 (Thread-1): Finished running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:58:12.575342 (Thread-1): Began running node analysis.subsurface.transactions_seasonality
2021-01-26 10:58:12.576093 (Thread-1): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-26 10:58:12.576494 (Thread-1): Compiling analysis.subsurface.transactions_seasonality
2021-01-26 10:58:12.654742 (Thread-1): Writing injected SQL for node "analysis.subsurface.transactions_seasonality"
2021-01-26 10:58:12.655549 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.656765 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.659757 (Thread-1): Finished running node analysis.subsurface.transactions_seasonality
2021-01-26 10:58:12.667842 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:58:12.679735 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-26 10:58:12.681081 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:58:12.775508 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-26 10:58:12.778030 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.781189 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.783024 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:58:12.784066 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:58:12.786169 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-26 10:58:12.786545 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:58:12.823998 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-26 10:58:12.826569 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.828048 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.831421 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:58:12.833055 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:58:12.834599 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-26 10:58:12.835651 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:58:12.886636 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-26 10:58:12.887924 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.889688 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.891810 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:58:12.895041 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-26 10:58:12.895920 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-26 10:58:12.896916 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-26 10:58:12.966285 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-26 10:58:12.970265 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.973154 (Thread-1): finished collecting timing info
2021-01-26 10:58:12.977851 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-26 10:58:12.980282 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:58:12.986552 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-26 10:58:12.992972 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:58:13.045540 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-26 10:58:13.048842 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.050637 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.052246 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:58:13.052837 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:58:13.053883 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-26 10:58:13.054316 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:58:13.080514 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-26 10:58:13.081842 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.083234 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.085033 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:58:13.086271 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:58:13.087580 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-26 10:58:13.088520 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:58:13.109522 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-26 10:58:13.110755 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.111390 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.112688 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:58:13.113209 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:58:13.114333 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-26 10:58:13.114703 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:58:13.133364 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-26 10:58:13.134100 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.134768 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.135842 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:58:13.136279 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:58:13.137199 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-26 10:58:13.137507 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:58:13.155236 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-26 10:58:13.155845 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.156466 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.157569 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:58:13.158112 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:58:13.159079 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-26 10:58:13.159439 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:58:13.176655 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-26 10:58:13.177336 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.178020 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.179123 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:58:13.179555 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:58:13.180551 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-26 10:58:13.180908 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:58:13.200592 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-26 10:58:13.201298 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.202029 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.203253 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:58:13.203675 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:58:13.204558 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-26 10:58:13.204925 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:58:13.221879 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-26 10:58:13.222611 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.223321 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.224579 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:58:13.225001 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:58:13.225883 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-26 10:58:13.226278 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:58:13.244075 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-26 10:58:13.244759 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.245464 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.246748 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:58:13.247172 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:58:13.248023 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-26 10:58:13.248338 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:58:13.266362 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-26 10:58:13.267052 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.268119 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.269668 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:58:13.270123 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:58:13.271024 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-26 10:58:13.271392 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:58:13.292460 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-26 10:58:13.293150 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.293817 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.294958 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:58:13.295340 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:58:13.296316 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-26 10:58:13.296655 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:58:13.318314 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-26 10:58:13.319010 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.319694 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.320793 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:58:13.321160 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:58:13.322052 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-26 10:58:13.322565 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:58:13.344060 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-26 10:58:13.344829 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.345590 (Thread-1): finished collecting timing info
2021-01-26 10:58:13.346987 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:58:13.423073 (MainThread): Connection 'master' was properly closed.
2021-01-26 10:58:13.423662 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-26 10:58:13.424336 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-26 10:58:13.742836 (MainThread): 11:58:13 | Done.
2021-01-26 10:58:13.743389 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6506edecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6506ed3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6506ed3710>]}
2021-01-26 10:58:13.744073 (MainThread): Flushing usage events
2021-01-26 10:58:19.926554 (MainThread): Running with dbt=0.18.1
2021-01-26 10:58:20.059868 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-01-26 10:58:20.061581 (MainThread): Tracking: tracking
2021-01-26 10:58:20.070992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14179bfbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14174d4d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14174d4da0>]}
2021-01-26 10:58:20.130923 (MainThread): Partial parsing not enabled
2021-01-26 10:58:20.132612 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:58:20.138814 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:58:20.143070 (MainThread): Parsing macros/get_custom_database.sql
2021-01-26 10:58:20.148277 (MainThread): Parsing macros/helpers.sql
2021-01-26 10:58:20.175072 (MainThread): Parsing macros/catalog.sql
2021-01-26 10:58:20.180220 (MainThread): Parsing macros/adapters.sql
2021-01-26 10:58:20.228263 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-26 10:58:20.230920 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-26 10:58:20.237205 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-26 10:58:20.237769 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-26 10:58:20.243459 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-26 10:58:20.262770 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:58:20.281140 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:58:20.290273 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-26 10:58:20.305368 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:58:20.317020 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:58:20.346295 (MainThread): Parsing macros/core.sql
2021-01-26 10:58:20.353815 (MainThread): Parsing macros/adapters/common.sql
2021-01-26 10:58:20.437789 (MainThread): Parsing macros/etc/datetime.sql
2021-01-26 10:58:20.458113 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-26 10:58:20.462806 (MainThread): Parsing macros/etc/query.sql
2021-01-26 10:58:20.466094 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-26 10:58:20.468391 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-26 10:58:20.472735 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-26 10:58:20.477266 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-26 10:58:20.496202 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-26 10:58:20.500640 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-26 10:58:20.513740 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-26 10:58:20.567911 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-26 10:58:20.604431 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-26 10:58:20.609078 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-26 10:58:20.619898 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-26 10:58:20.632729 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-26 10:58:20.660598 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-26 10:58:20.674971 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-26 10:58:20.718968 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-26 10:58:20.723129 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-26 10:58:20.726721 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-26 10:58:20.730824 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-26 10:58:20.746508 (MainThread): Partial parsing not enabled
2021-01-26 10:58:20.868298 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:58:20.912996 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:58:20.934781 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:58:20.958344 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:58:20.984588 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:58:21.009178 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:58:21.038938 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-26 10:58:21.060652 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:58:21.097271 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:58:21.118435 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:58:22.740225 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-26 10:58:23.173515 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 162 macros, 0 operations, 3 seed files, 2 sources
2021-01-26 10:58:23.181570 (MainThread): 
2021-01-26 10:58:23.182381 (MainThread): Acquiring new dremio connection "master".
2021-01-26 10:58:23.338444 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-26 10:58:23.361437 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-26 10:58:23.361730 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-26 10:58:23.361905 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-26 10:58:23.362119 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:58:23.519655 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-26 10:58:24.018126 (ThreadPoolExecutor-0_0): SQL status: OK in 0.66 seconds
2021-01-26 10:58:24.083092 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-26 10:58:24.084312 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-26 10:58:24.089192 (MainThread): 11:58:24 | Concurrency: 1 threads (target='unmanaged')
2021-01-26 10:58:24.090914 (MainThread): 11:58:24 | 
2021-01-26 10:58:24.129317 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-26 10:58:24.130211 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-26 10:58:24.130575 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-26 10:58:24.213743 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-26 10:58:24.214846 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.216435 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.218472 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-26 10:58:24.219818 (Thread-1): Began running node model.subsurface.stg__municipalities
2021-01-26 10:58:24.222108 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-26 10:58:24.222500 (Thread-1): Compiling model.subsurface.stg__municipalities
2021-01-26 10:58:24.244895 (Thread-1): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-26 10:58:24.245745 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.246562 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.247733 (Thread-1): Finished running node model.subsurface.stg__municipalities
2021-01-26 10:58:24.248160 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-26 10:58:24.249622 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-26 10:58:24.249992 (Thread-1): Compiling seed.subsurface.crop_types
2021-01-26 10:58:24.277360 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.278073 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.279277 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-26 10:58:24.279670 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-26 10:58:24.281011 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-26 10:58:24.281446 (Thread-1): Compiling seed.subsurface.premises_types
2021-01-26 10:58:24.298713 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.299381 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.300549 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-26 10:58:24.300968 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-26 10:58:24.302392 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-26 10:58:24.302822 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-26 10:58:24.317617 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.318334 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.319802 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-26 10:58:24.320376 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:58:24.321920 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-26 10:58:24.322374 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:58:24.357177 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-26 10:58:24.357995 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.358818 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.360259 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-26 10:58:24.360744 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:58:24.361834 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-26 10:58:24.362236 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:58:24.383577 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-26 10:58:24.384568 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.385442 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.386897 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-26 10:58:24.387532 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:58:24.388679 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-26 10:58:24.389119 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:58:24.411182 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-26 10:58:24.412045 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.412795 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.414198 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-26 10:58:24.414643 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:58:24.415805 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-26 10:58:24.416202 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:58:24.438099 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-26 10:58:24.438949 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.439750 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.441039 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-26 10:58:24.441461 (Thread-1): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:58:24.442680 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-26 10:58:24.443208 (Thread-1): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:58:24.476427 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-26 10:58:24.477243 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.477927 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.479191 (Thread-1): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-26 10:58:24.479594 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:58:24.480666 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-26 10:58:24.481049 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:58:24.499930 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-26 10:58:24.500758 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.501502 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.502827 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-26 10:58:24.503490 (Thread-1): Began running node model.subsurface.d_municipalities
2021-01-26 10:58:24.504674 (Thread-1): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-26 10:58:24.505169 (Thread-1): Compiling model.subsurface.d_municipalities
2021-01-26 10:58:24.523914 (Thread-1): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-26 10:58:24.524760 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.525549 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.526837 (Thread-1): Finished running node model.subsurface.d_municipalities
2021-01-26 10:58:24.527301 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:58:24.528589 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_departement_label".
2021-01-26 10:58:24.528970 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:58:24.549703 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_departement_label"
2021-01-26 10:58:24.550579 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.551324 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.552567 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_departement_label
2021-01-26 10:58:24.552983 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:58:24.554150 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-26 10:58:24.554517 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:58:24.576360 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-26 10:58:24.577295 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.578035 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.579391 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-26 10:58:24.579931 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:58:24.581082 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-26 10:58:24.581511 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:58:24.605248 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-26 10:58:24.606080 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.606813 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.608082 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-26 10:58:24.608508 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:58:24.609615 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-26 10:58:24.610017 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:58:24.631670 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-26 10:58:24.632510 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.633377 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.634741 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-26 10:58:24.635318 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:58:24.636510 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-26 10:58:24.637035 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:58:24.659201 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-26 10:58:24.660044 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.660771 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.662059 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-26 10:58:24.662505 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:58:24.663655 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-26 10:58:24.664102 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:58:24.686116 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-26 10:58:24.686926 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.687618 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.688816 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-26 10:58:24.689262 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:58:24.690343 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-26 10:58:24.690883 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:58:24.712371 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-26 10:58:24.713377 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.714401 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.715699 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-26 10:58:24.716184 (Thread-1): Began running node model.subsurface.d_crop_types
2021-01-26 10:58:24.717274 (Thread-1): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-26 10:58:24.717632 (Thread-1): Compiling model.subsurface.d_crop_types
2021-01-26 10:58:24.737823 (Thread-1): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-26 10:58:24.738703 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.739468 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.741849 (Thread-1): Finished running node model.subsurface.d_crop_types
2021-01-26 10:58:24.743122 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:58:24.744693 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-26 10:58:24.745813 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:58:24.769358 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-26 10:58:24.770688 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.771346 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.772884 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-26 10:58:24.773315 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:58:24.774463 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-26 10:58:24.774850 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:58:24.796282 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-26 10:58:24.797021 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.797757 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.799041 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-26 10:58:24.799411 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-26 10:58:24.800609 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-26 10:58:24.800944 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-26 10:58:24.822080 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-26 10:58:24.822794 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.823560 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.824898 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-26 10:58:24.825458 (Thread-1): Began running node model.subsurface.d_premises_types
2021-01-26 10:58:24.826564 (Thread-1): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-26 10:58:24.826952 (Thread-1): Compiling model.subsurface.d_premises_types
2021-01-26 10:58:24.844842 (Thread-1): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-26 10:58:24.845573 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.846342 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.848023 (Thread-1): Finished running node model.subsurface.d_premises_types
2021-01-26 10:58:24.848532 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:58:24.849916 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-26 10:58:24.850307 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:58:24.872711 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-26 10:58:24.873490 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.874381 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.875737 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-26 10:58:24.876266 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:58:24.877470 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-26 10:58:24.877960 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:58:24.907911 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-26 10:58:24.909197 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.910185 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.911352 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-26 10:58:24.911760 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:58:24.912740 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-26 10:58:24.913108 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:58:24.932391 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-26 10:58:24.933201 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.933900 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.935084 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-26 10:58:24.935529 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-26 10:58:24.936530 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-26 10:58:24.936926 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-26 10:58:24.957265 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-26 10:58:24.958064 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.958728 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.960025 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-26 10:58:24.960886 (Thread-1): Began running node model.subsurface.f_land_values
2021-01-26 10:58:24.961877 (Thread-1): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-26 10:58:24.962257 (Thread-1): Compiling model.subsurface.f_land_values
2021-01-26 10:58:24.990133 (Thread-1): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-26 10:58:24.990890 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.991549 (Thread-1): finished collecting timing info
2021-01-26 10:58:24.992767 (Thread-1): Finished running node model.subsurface.f_land_values
2021-01-26 10:58:24.993301 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:58:24.995554 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-26 10:58:24.996403 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:58:25.015582 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-26 10:58:25.016263 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.016908 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.018007 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-26 10:58:25.018349 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:58:25.019058 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-26 10:58:25.019605 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:58:25.037109 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-26 10:58:25.037887 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.038573 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.039686 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-26 10:58:25.040056 (Thread-1): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:58:25.040904 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-26 10:58:25.041307 (Thread-1): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:58:25.062861 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-26 10:58:25.063591 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.064246 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.065371 (Thread-1): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-26 10:58:25.065789 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:58:25.066602 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-26 10:58:25.066952 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:58:25.084885 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-26 10:58:25.085659 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.086337 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.087439 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-26 10:58:25.087808 (Thread-1): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:58:25.088691 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-26 10:58:25.089091 (Thread-1): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:58:25.116177 (Thread-1): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-26 10:58:25.117831 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.120352 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.122024 (Thread-1): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-26 10:58:25.123586 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:58:25.124907 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-26 10:58:25.125818 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:58:25.144388 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-26 10:58:25.145559 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.146206 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.147277 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-26 10:58:25.147630 (Thread-1): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:58:25.148538 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-26 10:58:25.148859 (Thread-1): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:58:25.175276 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-26 10:58:25.176072 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.176708 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.177996 (Thread-1): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-26 10:58:25.178375 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:58:25.179171 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-26 10:58:25.179642 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:58:25.256989 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-26 10:58:25.257758 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.258550 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.259671 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-26 10:58:25.260070 (Thread-1): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:58:25.260988 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-26 10:58:25.261371 (Thread-1): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:58:25.279628 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-26 10:58:25.280434 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.281263 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.282445 (Thread-1): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-26 10:58:25.282866 (Thread-1): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:58:25.283628 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-26 10:58:25.284162 (Thread-1): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:58:25.301922 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-26 10:58:25.302727 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.303442 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.304624 (Thread-1): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-26 10:58:25.305095 (Thread-1): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:58:25.306020 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-26 10:58:25.306415 (Thread-1): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:58:25.323602 (Thread-1): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-26 10:58:25.324389 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.325077 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.326282 (Thread-1): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-26 10:58:25.326652 (Thread-1): Began running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:58:25.327554 (Thread-1): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-26 10:58:25.328089 (Thread-1): Compiling analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:58:25.353659 (Thread-1): Writing injected SQL for node "analysis.subsurface.most_expensive_departments_for_flats"
2021-01-26 10:58:25.354482 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.355264 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.356232 (Thread-1): Finished running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-26 10:58:25.356657 (Thread-1): Began running node analysis.subsurface.transactions_seasonality
2021-01-26 10:58:25.357558 (Thread-1): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-26 10:58:25.358003 (Thread-1): Compiling analysis.subsurface.transactions_seasonality
2021-01-26 10:58:25.372592 (Thread-1): Writing injected SQL for node "analysis.subsurface.transactions_seasonality"
2021-01-26 10:58:25.373379 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.374175 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.375344 (Thread-1): Finished running node analysis.subsurface.transactions_seasonality
2021-01-26 10:58:25.375723 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:58:25.376515 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-26 10:58:25.377010 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:58:25.395139 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-26 10:58:25.395877 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.396651 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.397798 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-26 10:58:25.398295 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:58:25.399265 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-26 10:58:25.399647 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:58:25.419277 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-26 10:58:25.420080 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.420807 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.421925 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-26 10:58:25.422324 (Thread-1): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:58:25.423210 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-26 10:58:25.423598 (Thread-1): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:58:25.440939 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-26 10:58:25.441678 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.442418 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.443556 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-26 10:58:25.443980 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-26 10:58:25.444834 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-26 10:58:25.445257 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-26 10:58:25.463223 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-26 10:58:25.463993 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.464667 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.465771 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-26 10:58:25.466283 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:58:25.467200 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-26 10:58:25.467588 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:58:25.485630 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-26 10:58:25.486473 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.487182 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.488296 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-26 10:58:25.488717 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:58:25.489793 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-26 10:58:25.490266 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:58:25.509315 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-26 10:58:25.510139 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.510821 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.512132 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-26 10:58:25.512575 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:58:25.513555 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-26 10:58:25.514159 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:58:25.532199 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-26 10:58:25.533000 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.533660 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.534934 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-26 10:58:25.535502 (Thread-1): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:58:25.536494 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-26 10:58:25.536920 (Thread-1): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:58:25.556207 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-26 10:58:25.557266 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.558158 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.559438 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-26 10:58:25.559844 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:58:25.560863 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-26 10:58:25.561384 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:58:25.583075 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-26 10:58:25.583966 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.584727 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.586013 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-26 10:58:25.586421 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:58:25.587311 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-26 10:58:25.587860 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:58:25.610316 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-26 10:58:25.611217 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.611966 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.613229 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-26 10:58:25.613906 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:58:25.615182 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-26 10:58:25.615608 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:58:25.640942 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-26 10:58:25.641747 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.642562 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.643819 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-26 10:58:25.644261 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:58:25.645293 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-26 10:58:25.645719 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:58:25.667141 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-26 10:58:25.667995 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.668792 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.670347 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-26 10:58:25.670849 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:58:25.671753 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-26 10:58:25.672280 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:58:25.693346 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-26 10:58:25.694318 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.695070 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.696320 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-26 10:58:25.696725 (Thread-1): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:58:25.697739 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-26 10:58:25.698196 (Thread-1): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:58:25.719851 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-26 10:58:25.720762 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.721558 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.722880 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-26 10:58:25.723293 (Thread-1): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:58:25.724261 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-26 10:58:25.724685 (Thread-1): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:58:25.750717 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-26 10:58:25.751659 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.752438 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.753707 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-26 10:58:25.754224 (Thread-1): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:58:25.755215 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-26 10:58:25.755600 (Thread-1): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:58:25.782289 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-26 10:58:25.783172 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.783921 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.785177 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-26 10:58:25.785624 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:58:25.786803 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-26 10:58:25.787302 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:58:25.813164 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-26 10:58:25.814071 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.814821 (Thread-1): finished collecting timing info
2021-01-26 10:58:25.816102 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-26 10:58:25.877457 (MainThread): Connection 'master' was properly closed.
2021-01-26 10:58:25.878035 (MainThread): Connection 'list_@fab4_no_schema' was properly closed.
2021-01-26 10:58:25.878282 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-26 10:58:26.149216 (MainThread): 11:58:26 | Done.
2021-01-26 10:58:26.191663 (MainThread): Acquiring new dremio connection "generate_catalog".
2021-01-26 10:58:26.191950 (MainThread): 11:58:26 | Building catalog
2021-01-26 10:58:26.552068 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "@fab4.information_schema".
2021-01-26 10:58:26.569184 (ThreadPoolExecutor-1_0): Using dremio connection "@fab4.information_schema".
2021-01-26 10:58:26.570121 (ThreadPoolExecutor-1_0): On @fab4.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('@fab4')
    and (table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-26 10:58:26.570425 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-26 10:58:26.570625 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:58:26.714345 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-26 10:58:27.863151 (ThreadPoolExecutor-1_0): SQL status: OK in 1.29 seconds
2021-01-26 10:58:27.905473 (ThreadPoolExecutor-1_0): On @fab4.information_schema: ROLLBACK
2021-01-26 10:58:27.905797 (ThreadPoolExecutor-1_0): On @fab4.information_schema: Close
2021-01-26 10:58:27.908558 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "fs.information_schema".
2021-01-26 10:58:27.915501 (ThreadPoolExecutor-1_0): Using dremio connection "fs.information_schema".
2021-01-26 10:58:27.916748 (ThreadPoolExecutor-1_0): On fs.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('fs')
    and (table_schema = lower('geo') or table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-26 10:58:27.917542 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-26 10:58:27.918991 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-26 10:58:28.105042 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-26 10:58:30.182428 (ThreadPoolExecutor-1_0): SQL status: OK in 2.27 seconds
2021-01-26 10:58:30.290932 (ThreadPoolExecutor-1_0): On fs.information_schema: ROLLBACK
2021-01-26 10:58:30.298880 (ThreadPoolExecutor-1_0): On fs.information_schema: Close
2021-01-26 10:58:30.909757 (MainThread): 11:58:30 | Catalog written to /home/fabrice/subsurface/target/catalog.json
2021-01-26 10:58:30.910592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14174cd588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14174cd668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14174cd8d0>]}
2021-01-26 10:58:30.911158 (MainThread): Flushing usage events
2021-01-26 10:58:31.397492 (MainThread): Connection 'generate_catalog' was properly closed.
2021-01-26 10:58:31.398689 (MainThread): Connection 'fs.information_schema' was properly closed.
2021-01-26 10:58:38.945339 (MainThread): Running with dbt=0.18.1
2021-01-26 10:58:39.091700 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/home/fabrice/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-01-26 10:58:39.093265 (MainThread): Tracking: tracking
2021-01-26 10:58:39.102624 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e0a8f2be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e0a8f2e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e0a8f2ef0>]}
2021-01-26 10:58:39.107251 (MainThread): Serving docs at 0.0.0.0:8080
2021-01-26 10:58:39.107628 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-01-26 10:58:39.107871 (MainThread): Press Ctrl+C to exit.


2021-01-26 11:05:04.675510 (MainThread): Flushing usage events
2021-01-26 11:05:05.699298 (MainThread): ctrl-c
2021-01-28 15:29:25.674025 (MainThread): Running with dbt=0.18.1
2021-01-28 15:29:25.789338 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-01-28 15:29:25.790859 (MainThread): Tracking: tracking
2021-01-28 15:29:25.806334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2192fe9710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219c77e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219c77e978>]}
2021-01-28 15:29:25.858782 (MainThread): Partial parsing not enabled
2021-01-28 15:29:25.860423 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:29:25.866386 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:29:25.868427 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 15:29:25.897219 (MainThread): Parsing macros/catalog.sql
2021-01-28 15:29:25.901532 (MainThread): Parsing macros/adapters.sql
2021-01-28 15:29:25.941318 (MainThread): Parsing macros/helpers.sql
2021-01-28 15:29:25.971150 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:29:25.974671 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:29:25.976740 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 15:29:25.982207 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:29:26.007355 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:29:26.015318 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:29:26.026026 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 15:29:26.038087 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:29:26.062645 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 15:29:26.076039 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 15:29:26.092845 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 15:29:26.094983 (MainThread): Parsing macros/core.sql
2021-01-28 15:29:26.101642 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 15:29:26.173959 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 15:29:26.189214 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 15:29:26.190987 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 15:29:26.194046 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 15:29:26.197748 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 15:29:26.200841 (MainThread): Parsing macros/etc/query.sql
2021-01-28 15:29:26.202852 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 15:29:26.271063 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 15:29:26.295807 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 15:29:26.299166 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:29:26.310577 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:29:26.345962 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 15:29:26.391413 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 15:29:26.394673 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 15:29:26.424894 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:29:26.436531 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 15:29:26.445428 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:29:26.456403 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 15:29:26.461260 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 15:29:26.464137 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 15:29:26.467608 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 15:29:26.481130 (MainThread): Partial parsing not enabled
2021-01-28 15:29:26.559556 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:29:26.604056 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:29:26.627524 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:29:26.649278 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:29:26.672516 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:29:26.694468 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:29:26.723571 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 15:29:26.748290 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 15:29:26.781385 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:29:26.802813 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:29:28.513128 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 15:29:29.087323 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 15:29:29.093165 (MainThread): 
2021-01-28 15:29:29.093809 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:29:29.328175 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 15:29:29.369692 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 15:29:29.370065 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 15:29:29.370367 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 15:29:29.370698 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:29:29.659961 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-28 15:29:37.072076 (ThreadPoolExecutor-0_0): SQL status: OK in 7.70 seconds
2021-01-28 15:29:37.140169 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 15:29:37.140599 (ThreadPoolExecutor-0_0): On list_@fab4_no_schema: Close
2021-01-28 15:29:37.143377 (MainThread): 16:29:37 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 15:29:37.143743 (MainThread): 16:29:37 | 
2021-01-28 15:29:37.150847 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-28 15:29:37.151602 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:29:37.151887 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-28 15:29:37.157485 (Thread-2): Began running node model.subsurface.stg__municipalities
2021-01-28 15:29:37.158138 (Thread-4): Began running node seed.subsurface.crop_types
2021-01-28 15:29:37.168542 (Thread-3): Began running node seed.subsurface.premises_types
2021-01-28 15:29:37.179788 (Thread-2): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:29:37.180673 (Thread-4): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-28 15:29:37.192144 (Thread-3): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-28 15:29:37.192672 (Thread-2): Compiling model.subsurface.stg__municipalities
2021-01-28 15:29:37.198223 (Thread-4): Compiling seed.subsurface.crop_types
2021-01-28 15:29:37.219273 (Thread-3): Compiling seed.subsurface.premises_types
2021-01-28 15:29:37.248094 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-28 15:29:37.341686 (Thread-1): finished collecting timing info
2021-01-28 15:29:37.348284 (Thread-1): finished collecting timing info
2021-01-28 15:29:37.355506 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-28 15:29:37.361800 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-28 15:29:37.364123 (Thread-2): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-28 15:29:37.377207 (Thread-4): finished collecting timing info
2021-01-28 15:29:37.389733 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:29:37.403820 (Thread-3): finished collecting timing info
2021-01-28 15:29:37.405675 (Thread-2): finished collecting timing info
2021-01-28 15:29:37.406890 (Thread-4): finished collecting timing info
2021-01-28 15:29:37.408179 (Thread-1): Compiling seed.subsurface.transfer_types
2021-01-28 15:29:37.408851 (Thread-3): finished collecting timing info
2021-01-28 15:29:37.410102 (Thread-2): finished collecting timing info
2021-01-28 15:29:37.412342 (Thread-4): Finished running node seed.subsurface.crop_types
2021-01-28 15:29:37.424597 (Thread-3): Finished running node seed.subsurface.premises_types
2021-01-28 15:29:37.441062 (Thread-2): Finished running node model.subsurface.stg__municipalities
2021-01-28 15:29:37.445658 (Thread-1): finished collecting timing info
2021-01-28 15:29:37.446987 (Thread-4): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-28 15:29:37.448362 (Thread-3): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-28 15:29:37.450953 (Thread-2): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-28 15:29:37.451647 (Thread-1): finished collecting timing info
2021-01-28 15:29:37.454785 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-28 15:29:37.456233 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-28 15:29:37.457471 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-28 15:29:37.458797 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-28 15:29:37.459401 (Thread-4): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-28 15:29:37.460005 (Thread-3): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-28 15:29:37.460550 (Thread-2): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-28 15:29:37.461173 (Thread-1): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-28 15:29:37.542888 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-28 15:29:37.559704 (Thread-1): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-28 15:29:37.610535 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-28 15:29:37.621318 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-28 15:29:37.649210 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-28 15:29:37.650049 (Thread-2): finished collecting timing info
2021-01-28 15:29:37.669217 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-28 15:29:37.670750 (Thread-4): finished collecting timing info
2021-01-28 15:29:37.671898 (Thread-2): finished collecting timing info
2021-01-28 15:29:37.673918 (Thread-4): finished collecting timing info
2021-01-28 15:29:37.674839 (Thread-3): finished collecting timing info
2021-01-28 15:29:37.676769 (Thread-2): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-28 15:29:37.678254 (Thread-4): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-28 15:29:37.678956 (Thread-1): finished collecting timing info
2021-01-28 15:29:37.680233 (Thread-3): finished collecting timing info
2021-01-28 15:29:37.681571 (Thread-2): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-28 15:29:37.682247 (Thread-4): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-28 15:29:37.682896 (Thread-1): finished collecting timing info
2021-01-28 15:29:37.684801 (Thread-3): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-28 15:29:37.686069 (Thread-2): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:29:37.687882 (Thread-4): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:29:37.689211 (Thread-1): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-28 15:29:37.689940 (Thread-3): Began running node model.subsurface.d_crop_types
2021-01-28 15:29:37.690948 (Thread-2): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-28 15:29:37.691496 (Thread-4): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-28 15:29:37.692171 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-28 15:29:37.693366 (Thread-3): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:29:37.747343 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-28 15:29:37.758549 (Thread-3): Compiling model.subsurface.d_crop_types
2021-01-28 15:29:37.769012 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-28 15:29:37.839952 (Thread-2): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-28 15:29:37.862509 (Thread-4): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-28 15:29:37.882998 (Thread-3): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-28 15:29:37.886411 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-28 15:29:37.888992 (Thread-4): finished collecting timing info
2021-01-28 15:29:37.890238 (Thread-1): finished collecting timing info
2021-01-28 15:29:37.891261 (Thread-2): finished collecting timing info
2021-01-28 15:29:37.892616 (Thread-4): finished collecting timing info
2021-01-28 15:29:37.893776 (Thread-3): finished collecting timing info
2021-01-28 15:29:37.894784 (Thread-1): finished collecting timing info
2021-01-28 15:29:37.895887 (Thread-2): finished collecting timing info
2021-01-28 15:29:37.898062 (Thread-4): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-28 15:29:37.898708 (Thread-3): finished collecting timing info
2021-01-28 15:29:37.900732 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-28 15:29:37.902255 (Thread-2): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-28 15:29:37.903093 (Thread-4): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-28 15:29:37.904976 (Thread-3): Finished running node model.subsurface.d_crop_types
2021-01-28 15:29:37.905746 (Thread-1): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-28 15:29:37.906926 (Thread-2): Began running node model.subsurface.d_premises_types
2021-01-28 15:29:37.908907 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-28 15:29:37.909647 (Thread-3): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-28 15:29:37.910923 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-28 15:29:37.912553 (Thread-2): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:29:37.913735 (Thread-4): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-28 15:29:37.915199 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-28 15:29:37.915791 (Thread-1): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-28 15:29:37.916315 (Thread-2): Compiling model.subsurface.d_premises_types
2021-01-28 15:29:37.927719 (Thread-3): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-28 15:29:37.967693 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-28 15:29:38.029181 (Thread-1): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-28 15:29:38.051307 (Thread-2): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-28 15:29:38.075206 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.076526 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.079713 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-28 15:29:38.080200 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.081572 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.082662 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.085017 (Thread-4): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-28 15:29:38.086621 (Thread-1): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-28 15:29:38.087605 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.089044 (Thread-4): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-28 15:29:38.089593 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.091269 (Thread-1): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-28 15:29:38.092710 (Thread-2): Finished running node model.subsurface.d_premises_types
2021-01-28 15:29:38.094171 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-28 15:29:38.095020 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.101802 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-28 15:29:38.102580 (Thread-2): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-28 15:29:38.103223 (Thread-4): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-28 15:29:38.104639 (Thread-3): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-28 15:29:38.105751 (Thread-1): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-28 15:29:38.107522 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-28 15:29:38.124088 (Thread-3): Began running node model.subsurface.d_municipalities
2021-01-28 15:29:38.159216 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-28 15:29:38.166502 (Thread-2): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-28 15:29:38.183089 (Thread-3): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:29:38.189099 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-28 15:29:38.195741 (Thread-3): Compiling model.subsurface.d_municipalities
2021-01-28 15:29:38.196417 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.209171 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.216724 (Thread-4): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-28 15:29:38.232824 (Thread-4): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-28 15:29:38.249687 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.258709 (Thread-3): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-28 15:29:38.259811 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-28 15:29:38.265783 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.280764 (Thread-1): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-28 15:29:38.277889 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.279215 (Thread-4): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-28 15:29:38.276407 (Thread-2): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-28 15:29:38.281494 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_department_label
2021-01-28 15:29:38.282171 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.305923 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_label".
2021-01-28 15:29:38.323625 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-28 15:29:38.325277 (Thread-3): Finished running node model.subsurface.d_municipalities
2021-01-28 15:29:38.326117 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.327691 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_department_label
2021-01-28 15:29:38.328877 (Thread-3): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-28 15:29:38.329648 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.331859 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.339285 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-28 15:29:38.351819 (Thread-2): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-28 15:29:38.367694 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.375701 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_label"
2021-01-28 15:29:38.380480 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.377235 (Thread-2): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-28 15:29:38.379145 (Thread-4): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-28 15:29:38.376367 (Thread-3): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-28 15:29:38.381610 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.383256 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-28 15:29:38.383984 (Thread-4): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-28 15:29:38.396331 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_department_label
2021-01-28 15:29:38.412862 (Thread-2): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-28 15:29:38.425158 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-28 15:29:38.426213 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-28 15:29:38.427201 (Thread-1): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-28 15:29:38.439912 (Thread-4): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-28 15:29:38.447919 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-28 15:29:38.467667 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.472558 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-28 15:29:38.483853 (Thread-1): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-28 15:29:38.504866 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.512965 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-28 15:29:38.531012 (Thread-3): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-28 15:29:38.537086 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.557764 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-28 15:29:38.558653 (Thread-3): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-28 15:29:38.559098 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.560429 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.562724 (Thread-3): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-28 15:29:38.563387 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.565165 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.567363 (Thread-2): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-28 15:29:38.568029 (Thread-3): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-28 15:29:38.570320 (Thread-4): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-28 15:29:38.571096 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.572624 (Thread-2): Began running node model.subsurface.f_land_values
2021-01-28 15:29:38.589815 (Thread-4): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-28 15:29:38.612243 (Thread-1): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-28 15:29:38.617501 (Thread-3): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-28 15:29:38.618612 (Thread-2): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:29:38.619802 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-28 15:29:38.620610 (Thread-1): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-28 15:29:38.621984 (Thread-2): Compiling model.subsurface.f_land_values
2021-01-28 15:29:38.622832 (Thread-4): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-28 15:29:38.623408 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.625116 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-28 15:29:38.652510 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.669288 (Thread-1): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-28 15:29:38.696428 (Thread-3): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-28 15:29:38.704008 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-28 15:29:38.720820 (Thread-3): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-28 15:29:38.749130 (Thread-3): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-28 15:29:38.772542 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-28 15:29:38.773231 (Thread-3): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-28 15:29:38.779931 (Thread-2): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-28 15:29:38.787192 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.818907 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.808410 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.831669 (Thread-4): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-28 15:29:38.841221 (Thread-3): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-28 15:29:38.841680 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.845622 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.844055 (Thread-4): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-28 15:29:38.842746 (Thread-1): finished collecting timing info
2021-01-28 15:29:38.847588 (Thread-2): Finished running node model.subsurface.f_land_values
2021-01-28 15:29:38.849110 (Thread-4): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-28 15:29:38.850361 (Thread-1): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-28 15:29:38.851240 (Thread-2): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-28 15:29:38.851886 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.853665 (Thread-4): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-28 15:29:38.857339 (Thread-1): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-28 15:29:38.858898 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-28 15:29:38.859572 (Thread-3): finished collecting timing info
2021-01-28 15:29:38.872028 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-28 15:29:38.877768 (Thread-2): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-28 15:29:38.894621 (Thread-3): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-28 15:29:38.905733 (Thread-4): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-28 15:29:38.906212 (Thread-1): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-28 15:29:38.918179 (Thread-3): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-28 15:29:38.958412 (Thread-2): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-28 15:29:38.965594 (Thread-3): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-28 15:29:38.981143 (Thread-4): finished collecting timing info
2021-01-28 15:29:38.990154 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-28 15:29:38.990867 (Thread-3): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-28 15:29:38.991403 (Thread-2): finished collecting timing info
2021-01-28 15:29:38.992661 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.005072 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.022034 (Thread-4): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-28 15:29:39.031824 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.041280 (Thread-3): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-28 15:29:39.042655 (Thread-2): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-28 15:29:39.043598 (Thread-4): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-28 15:29:39.044667 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.046503 (Thread-2): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-28 15:29:39.047347 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.049583 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-28 15:29:39.050923 (Thread-1): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-28 15:29:39.052188 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-28 15:29:39.052918 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.054095 (Thread-4): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-28 15:29:39.054814 (Thread-1): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-28 15:29:39.055399 (Thread-2): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-28 15:29:39.057049 (Thread-3): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-28 15:29:39.074382 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-28 15:29:39.102725 (Thread-3): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-28 15:29:39.120814 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-28 15:29:39.127090 (Thread-1): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-28 15:29:39.138612 (Thread-3): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-28 15:29:39.145769 (Thread-2): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-28 15:29:39.147635 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.164903 (Thread-3): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-28 15:29:39.187190 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-28 15:29:39.188072 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.194900 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.208158 (Thread-4): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-28 15:29:39.219667 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.235288 (Thread-3): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-28 15:29:39.235688 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.237639 (Thread-4): Began running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-28 15:29:39.239159 (Thread-2): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-28 15:29:39.240686 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.242707 (Thread-4): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 15:29:39.243618 (Thread-2): Began running node analysis.subsurface.transactions_seasonality
2021-01-28 15:29:39.244240 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.246143 (Thread-1): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-28 15:29:39.247186 (Thread-4): Compiling analysis.subsurface.most_expensive_departments_for_flats
2021-01-28 15:29:39.248293 (Thread-2): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 15:29:39.248934 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.250204 (Thread-1): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-28 15:29:39.261795 (Thread-2): Compiling analysis.subsurface.transactions_seasonality
2021-01-28 15:29:39.278234 (Thread-3): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-28 15:29:39.299773 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-28 15:29:39.308519 (Thread-4): Writing injected SQL for node "analysis.subsurface.most_expensive_departments_for_flats"
2021-01-28 15:29:39.325182 (Thread-3): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-28 15:29:39.341265 (Thread-1): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-28 15:29:39.342057 (Thread-2): Writing injected SQL for node "analysis.subsurface.transactions_seasonality"
2021-01-28 15:29:39.343821 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-28 15:29:39.350171 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.377482 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.378623 (Thread-3): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-28 15:29:39.386531 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-28 15:29:39.387289 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.388624 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.401633 (Thread-4): Finished running node analysis.subsurface.most_expensive_departments_for_flats
2021-01-28 15:29:39.408243 (Thread-2): Finished running node analysis.subsurface.transactions_seasonality
2021-01-28 15:29:39.419690 (Thread-4): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-28 15:29:39.430908 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.435314 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-28 15:29:39.435906 (Thread-2): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-28 15:29:39.437641 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-28 15:29:39.438251 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.441166 (Thread-4): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-28 15:29:39.441589 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.443717 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-28 15:29:39.445040 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-28 15:29:39.461724 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.477736 (Thread-2): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-28 15:29:39.486038 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-28 15:29:39.487240 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-28 15:29:39.489199 (Thread-3): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-28 15:29:39.512109 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-28 15:29:39.524062 (Thread-3): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-28 15:29:39.531153 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-28 15:29:39.532031 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.533207 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-28 15:29:39.534578 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-28 15:29:39.535729 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.553025 (Thread-3): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-28 15:29:39.560042 (Thread-4): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-28 15:29:39.587400 (Thread-4): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-28 15:29:39.565913 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.591691 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-28 15:29:39.599099 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-28 15:29:39.605026 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.627674 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-28 15:29:39.628410 (Thread-4): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-28 15:29:39.630071 (Thread-2): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-28 15:29:39.631231 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.648805 (Thread-2): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-28 15:29:39.665070 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.671883 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-28 15:29:39.672359 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.674242 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-28 15:29:39.675598 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-28 15:29:39.676766 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.678365 (Thread-2): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-28 15:29:39.679174 (Thread-1): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-28 15:29:39.679642 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.682065 (Thread-3): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-28 15:29:39.693932 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-28 15:29:39.699863 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.715763 (Thread-3): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-28 15:29:39.725017 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-28 15:29:39.725999 (Thread-1): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-28 15:29:39.727294 (Thread-4): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-28 15:29:39.740226 (Thread-4): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-28 15:29:39.728400 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-28 15:29:39.741524 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-28 15:29:39.752753 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.769583 (Thread-3): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-28 15:29:39.772080 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-28 15:29:39.772757 (Thread-4): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-28 15:29:39.773414 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.839677 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.841692 (Thread-2): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-28 15:29:39.850065 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-28 15:29:39.850703 (Thread-1): finished collecting timing info
2021-01-28 15:29:39.857937 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-28 15:29:39.858803 (Thread-2): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-28 15:29:39.861773 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-28 15:29:39.863407 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.865366 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-28 15:29:39.866425 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-28 15:29:39.867272 (Thread-3): finished collecting timing info
2021-01-28 15:29:39.868341 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.869808 (Thread-2): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-28 15:29:39.871069 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-28 15:29:39.872396 (Thread-3): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-28 15:29:39.873067 (Thread-4): finished collecting timing info
2021-01-28 15:29:39.890390 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-28 15:29:39.906323 (Thread-3): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-28 15:29:39.916054 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-28 15:29:39.917803 (Thread-4): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-28 15:29:39.924837 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-28 15:29:39.931240 (Thread-4): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-28 15:29:39.932620 (Thread-3): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-28 15:29:39.948764 (Thread-2): finished collecting timing info
2021-01-28 15:29:39.962078 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-28 15:29:39.962589 (Thread-4): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-28 15:29:39.973710 (Thread-2): finished collecting timing info
2021-01-28 15:29:40.001321 (Thread-4): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-28 15:29:40.003240 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-28 15:29:40.004581 (Thread-2): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-28 15:29:40.010647 (Thread-1): finished collecting timing info
2021-01-28 15:29:40.026970 (Thread-2): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-28 15:29:40.034017 (Thread-1): finished collecting timing info
2021-01-28 15:29:40.035088 (Thread-3): finished collecting timing info
2021-01-28 15:29:40.050753 (Thread-2): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-28 15:29:40.057714 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-28 15:29:40.060974 (Thread-4): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-28 15:29:40.061689 (Thread-3): finished collecting timing info
2021-01-28 15:29:40.063167 (Thread-2): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-28 15:29:40.063931 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-28 15:29:40.066026 (Thread-3): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-28 15:29:40.073052 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-28 15:29:40.099048 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-28 15:29:40.079218 (Thread-4): finished collecting timing info
2021-01-28 15:29:40.115804 (Thread-4): finished collecting timing info
2021-01-28 15:29:40.144290 (Thread-4): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-28 15:29:40.164251 (Thread-2): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-28 15:29:40.175148 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-28 15:29:40.176774 (Thread-2): finished collecting timing info
2021-01-28 15:29:40.178045 (Thread-1): finished collecting timing info
2021-01-28 15:29:40.179144 (Thread-2): finished collecting timing info
2021-01-28 15:29:40.180304 (Thread-1): finished collecting timing info
2021-01-28 15:29:40.182253 (Thread-2): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-28 15:29:40.185122 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-28 15:29:40.229407 (MainThread): Connection 'master' was properly closed.
2021-01-28 15:29:40.229909 (MainThread): Connection 'test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_' was properly closed.
2021-01-28 15:29:40.230227 (MainThread): Connection 'test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_' was properly closed.
2021-01-28 15:29:40.230563 (MainThread): Connection 'test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_' was properly closed.
2021-01-28 15:29:40.230895 (MainThread): Connection 'test.subsurface.not_null_f_land_values_zip_code' was properly closed.
2021-01-28 15:29:40.699910 (MainThread): 16:29:40 | Done.
2021-01-28 15:29:40.707308 (MainThread): Acquiring new dremio connection "generate_catalog".
2021-01-28 15:29:40.707535 (MainThread): 16:29:40 | Building catalog
2021-01-28 15:29:41.237570 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "@fab4.information_schema".
2021-01-28 15:29:41.239023 (ThreadPoolExecutor-1_1): Acquiring new dremio connection "fs.information_schema".
2021-01-28 15:29:41.289411 (ThreadPoolExecutor-1_0): Using dremio connection "@fab4.information_schema".
2021-01-28 15:29:41.290292 (ThreadPoolExecutor-1_1): Using dremio connection "fs.information_schema".
2021-01-28 15:29:41.290703 (ThreadPoolExecutor-1_0): On @fab4.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('@fab4')
    and (table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-28 15:29:41.291161 (ThreadPoolExecutor-1_1): On fs.information_schema: with cols(table_database,
    table_schema,
    table_name,
    table_type,
    table_comment,
    column_name,
    column_index,
    column_type,
    column_comment,
    table_owner) as (
  select lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, 1, position('.' in columns.table_schema) - 1)
        else columns.table_schema
    end)
    ,lower(case when position('.' in columns.table_schema) > 0
        then substring(columns.table_schema, position('.' in columns.table_schema) + 1)
        else 'no_schema'
    end)
    ,lower(columns.table_name)
    ,lower(t.table_type)
    ,cast(null as varchar)
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,cast(null as varchar)
    ,cast(null as varchar)
  from information_schema.columns
      join information_schema."tables" as t
          on (t.table_schema = columns.table_schema
              and t.table_name = columns.table_name)
  union all
  select
    lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
    ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
    ,lower(name)
    ,'materializedview'
    ,initcap(type) || ' Reflection'
    ,lower(column_name)
    ,ordinal_position
    ,lower(data_type)
    ,case
        when strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Display'
        when strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Dimension'
        when strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0 then 'Measure'
    end
    || case
        when strpos(',' || replace(sortColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Sort'
        else ''
    end
    || case
        when strpos(',' || replace(partitionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Partition'
        else ''
    end
    || case
        when strpos(',' || replace(distributionColumns, ' ', '') || ',', ',' || column_name || ',') > 0 then ', Distribute'
        else ''
    end
    ,cast(null as varchar)
  from sys.reflections
  join information_schema.columns
      on (columns.table_schema || '.' || columns.table_name = replace(dataset, '"', '')
          and (strpos(',' || replace(displayColumns, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(dimensions, ' ', '') || ',', ',' || column_name || ',') > 0
              or strpos(',' || replace(measures, ' ', '') || ',', ',' || column_name || ',') > 0))
  )
  select *
  from cols
  where table_type <> 'SYSTEM_TABLE'
    and table_database = lower('fs')
    and (table_schema = lower('geo') or table_schema = lower('no_schema'))
  order by
      table_schema,
      table_name,
      column_index
2021-01-28 15:29:41.291701 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-28 15:29:41.292123 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-01-28 15:29:41.292582 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:29:41.293161 (ThreadPoolExecutor-1_1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:29:41.714722 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 15:29:41.715147 (ThreadPoolExecutor-1_1): Connected to db: None
2021-01-28 15:29:45.737785 (ThreadPoolExecutor-1_1): SQL status: OK in 4.45 seconds
2021-01-28 15:29:45.741328 (ThreadPoolExecutor-1_1): On fs.information_schema: ROLLBACK
2021-01-28 15:29:45.741576 (ThreadPoolExecutor-1_1): On fs.information_schema: Close
2021-01-28 15:29:45.830948 (ThreadPoolExecutor-1_0): SQL status: OK in 4.54 seconds
2021-01-28 15:29:45.905502 (ThreadPoolExecutor-1_0): On @fab4.information_schema: ROLLBACK
2021-01-28 15:29:45.905931 (ThreadPoolExecutor-1_0): On @fab4.information_schema: Close
2021-01-28 15:29:46.408737 (MainThread): 16:29:46 | Catalog written to /root/git/subsurface/target/catalog.json
2021-01-28 15:29:46.409362 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21a42a47b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219201ae48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219201a128>]}
2021-01-28 15:29:46.409866 (MainThread): Flushing usage events
2021-01-28 15:29:46.990685 (MainThread): Connection 'generate_catalog' was properly closed.
2021-01-28 15:29:46.992103 (MainThread): Connection '@fab4.information_schema' was properly closed.
2021-01-28 15:29:46.992466 (MainThread): Connection 'fs.information_schema' was properly closed.
2021-01-28 15:29:57.955621 (MainThread): Running with dbt=0.18.1
2021-01-28 15:29:58.071859 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-01-28 15:29:58.073864 (MainThread): Tracking: tracking
2021-01-28 15:29:58.089407 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468127bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4681282cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4681282358>]}
2021-01-28 15:29:58.094927 (MainThread): Serving docs at 0.0.0.0:8080
2021-01-28 15:29:58.095234 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-01-28 15:29:58.095403 (MainThread): Press Ctrl+C to exit.


2021-01-28 15:29:58.102081 (MainThread): subprocess 8919 is still running
2021-01-28 15:30:42.938278 (MainThread): Flushing usage events
2021-01-28 15:30:43.651086 (MainThread): ctrl-c
2021-01-28 15:45:05.848534 (MainThread): Running with dbt=0.18.1
2021-01-28 15:45:05.966978 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-28 15:45:05.969655 (MainThread): Tracking: tracking
2021-01-28 15:45:05.991413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fd3ae780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570e5c8128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570e5c6438>]}
2021-01-28 15:45:06.096564 (MainThread): Partial parsing not enabled
2021-01-28 15:45:06.099636 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:45:06.110865 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:45:06.115141 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 15:45:06.154735 (MainThread): Parsing macros/catalog.sql
2021-01-28 15:45:06.159399 (MainThread): Parsing macros/adapters.sql
2021-01-28 15:45:06.204314 (MainThread): Parsing macros/helpers.sql
2021-01-28 15:45:06.237328 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:45:06.241220 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:45:06.243415 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 15:45:06.248986 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:45:06.276810 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:45:06.285325 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:45:06.297083 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 15:45:06.310883 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:45:06.338178 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 15:45:06.353153 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 15:45:06.371809 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 15:45:06.373993 (MainThread): Parsing macros/core.sql
2021-01-28 15:45:06.381843 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 15:45:06.463160 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 15:45:06.480350 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 15:45:06.482351 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 15:45:06.485764 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 15:45:06.489954 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 15:45:06.493215 (MainThread): Parsing macros/etc/query.sql
2021-01-28 15:45:06.495417 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 15:45:06.566188 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 15:45:06.592691 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 15:45:06.596727 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:45:06.609245 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:45:06.650306 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 15:45:06.701594 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 15:45:06.705075 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 15:45:06.738338 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:45:06.751188 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 15:45:06.761603 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:45:06.774020 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 15:45:06.779511 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 15:45:06.782576 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 15:45:06.786120 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 15:45:06.799975 (MainThread): Partial parsing not enabled
2021-01-28 15:45:06.881075 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:45:06.926211 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:45:06.948591 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:45:06.971575 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:45:06.995194 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:45:07.027294 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:45:07.090752 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 15:45:07.142146 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 15:45:07.214327 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:45:07.259945 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:45:09.096296 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 15:45:09.670389 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 15:45:09.675177 (MainThread): 
2021-01-28 15:45:09.675822 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:45:09.684620 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-28 15:45:09.727829 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-28 15:45:09.728189 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 15:45:09.728524 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 15:45:09.728810 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:10.086209 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-28 15:45:11.132065 (ThreadPoolExecutor-0_0): SQL status: OK in 1.40 seconds
2021-01-28 15:45:11.167164 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-28 15:45:11.358710 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 15:45:11.384239 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 15:45:11.384694 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 15:45:11.385022 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 15:45:11.385315 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:11.610423 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 15:45:12.084103 (ThreadPoolExecutor-1_0): SQL status: OK in 0.70 seconds
2021-01-28 15:45:12.131720 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 15:45:12.132129 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-28 15:45:12.134811 (MainThread): 16:45:12 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 15:45:12.135116 (MainThread): 16:45:12 | 
2021-01-28 15:45:12.142315 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-28 15:45:12.144837 (Thread-1): 16:45:12 | 1 of 3 START seed file @fab4.crop_types.............................. [RUN]
2021-01-28 15:45:12.145784 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-28 15:45:12.146064 (Thread-1): finished collecting timing info
2021-01-28 15:45:12.152872 (Thread-3): Began running node seed.subsurface.premises_types
2021-01-28 15:45:12.158712 (Thread-2): Began running node seed.subsurface.transfer_types
2021-01-28 15:45:12.161195 (Thread-3): 16:45:12 | 2 of 3 START seed file @fab4.premises_types.......................... [RUN]
2021-01-28 15:45:12.177602 (Thread-2): 16:45:12 | 3 of 3 START seed file @fab4.transfer_types.......................... [RUN]
2021-01-28 15:45:12.194391 (Thread-3): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-28 15:45:12.210971 (Thread-3): finished collecting timing info
2021-01-28 15:45:12.222991 (Thread-2): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:45:12.245253 (Thread-2): finished collecting timing info
2021-01-28 15:45:12.328869 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:45:12.331048 (Thread-3): On "seed.subsurface.premises_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:45:12.353109 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:45:12.354960 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:45:12.355397 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:45:12.358973 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:45:12.358509 (Thread-3): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:45:12.359338 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:12.358143 (Thread-2): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:45:12.369271 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:45:12.369593 (Thread-2): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:45:12.369814 (Thread-2): Opening a new connection, currently in state init
2021-01-28 15:45:12.370043 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:12.359743 (Thread-3): Opening a new connection, currently in state init
2021-01-28 15:45:12.370331 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:12.964106 (Thread-1): Connected to db: None
2021-01-28 15:45:12.986911 (Thread-3): Connected to db: None
2021-01-28 15:45:13.023177 (Thread-2): Connected to db: None
2021-01-28 15:45:13.648222 (Thread-1): SQL status: OK in 1.29 seconds
2021-01-28 15:45:13.650063 (Thread-3): SQL status: OK in 1.29 seconds
2021-01-28 15:45:13.655671 (Thread-2): SQL status: OK in 1.29 seconds
2021-01-28 15:45:13.705273 (Thread-1): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 15:45:13.705977 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:45:13.711918 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:45:13.712167 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:45:13.734027 (Thread-3): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 15:45:13.734817 (Thread-3): On "seed.subsurface.premises_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:45:13.740203 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:45:13.740422 (Thread-3): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:45:13.748101 (Thread-2): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 15:45:13.748729 (Thread-2): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:45:13.754059 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:45:13.754270 (Thread-2): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:45:14.336127 (Thread-1): SQL status: OK in 0.62 seconds
2021-01-28 15:45:14.349331 (Thread-2): SQL status: OK in 0.59 seconds
2021-01-28 15:45:14.404604 (Thread-3): SQL status: OK in 0.66 seconds
2021-01-28 15:45:14.406490 (Thread-2): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 15:45:14.416652 (Thread-1): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 15:45:14.449562 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:45:14.449927 (Thread-2): On seed.subsurface.transfer_types: drop table if exists "$scratch"."dbt"."@fab4"."transfer_types_blue"
2021-01-28 15:45:14.453025 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:45:14.453244 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."dbt"."@fab4"."crop_types_blue"
2021-01-28 15:45:14.465983 (Thread-3): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 15:45:14.471941 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:45:14.472248 (Thread-3): On seed.subsurface.premises_types: drop table if exists "$scratch"."dbt"."@fab4"."premises_types_blue"
2021-01-28 15:45:14.532863 (Thread-1): SQL status: OK in 0.08 seconds
2021-01-28 15:45:14.546177 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_types"
2021-01-28 15:45:14.548509 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:45:14.548769 (Thread-1): On seed.subsurface.crop_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."crop_types_blue"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_label as varchar)
        as crop_label
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'B'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_label )

  )

  
2021-01-28 15:45:14.552914 (Thread-3): SQL status: OK in 0.08 seconds
2021-01-28 15:45:14.557455 (Thread-3): Writing runtime SQL for node "seed.subsurface.premises_types"
2021-01-28 15:45:14.558542 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:45:14.558834 (Thread-3): On seed.subsurface.premises_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."premises_types_blue"
  as (
    select
    cast(premises_code as varchar)
        as premises_code,cast(premises_label_fr as varchar)
        as premises_label_fr,cast(premises_label_en as varchar)
        as premises_label_en
  from
    (values
      
        (
            '1'
          ,
            'Maison'
          ,
            'House'
          ),
      
        (
            '2'
          ,
            'Appartement'
          ,
            'Flat'
          ),
      
        (
            '3'
          ,
            'Dépendance'
          ,
            'Outbuilding'
          ),
      
        (
            '4'
          ,
            'Local industriel. commercial ou assimilé'
          ,
            'Industrial premises. commercial or similar'
          )
      ) temp_table ( premises_code, premises_label_fr, premises_label_en )

  )

  
2021-01-28 15:45:14.573979 (Thread-2): SQL status: OK in 0.12 seconds
2021-01-28 15:45:14.577268 (Thread-2): Writing runtime SQL for node "seed.subsurface.transfer_types"
2021-01-28 15:45:14.578086 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:45:14.578302 (Thread-2): On seed.subsurface.transfer_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."transfer_types_blue"
  as (
    select
    cast(transfer_label_fr as varchar)
        as transfer_label_fr,cast(transfer_label_en as varchar)
        as transfer_label_en
  from
    (values
      
        (
            'Expropriation'
          ,
            'Expropriation'
          ),
      
        (
            'Vente'
          ,
            'Sale'
          ),
      
        (
            'Echange'
          ,
            'Exchange'
          ),
      
        (
            'Adjudication'
          ,
            'Sale by tender'
          ),
      
        (
            'Vente en l''état futur d''achèvement'
          ,
            'Sale before completion'
          ),
      
        (
            'Vente terrain à bâtir'
          ,
            'Building plot sale'
          )
      ) temp_table ( transfer_label_fr, transfer_label_en )

  )

  
2021-01-28 15:45:15.036370 (Thread-1): SQL status: OK in 0.49 seconds
2021-01-28 15:45:15.046294 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:45:15.046600 (Thread-1): On seed.subsurface.crop_types: 
    
  create or replace view "@fab4"."crop_types" as (
    select * from "$scratch"."dbt"."@fab4"."crop_types_blue"
  )

  
2021-01-28 15:45:15.050582 (Thread-2): SQL status: OK in 0.47 seconds
2021-01-28 15:45:15.053357 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:45:15.053606 (Thread-2): On seed.subsurface.transfer_types: 
    
  create or replace view "@fab4"."transfer_types" as (
    select * from "$scratch"."dbt"."@fab4"."transfer_types_blue"
  )

  
2021-01-28 15:45:15.251627 (Thread-3): SQL status: OK in 0.69 seconds
2021-01-28 15:45:15.257642 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:45:15.258035 (Thread-3): On seed.subsurface.premises_types: 
    
  create or replace view "@fab4"."premises_types" as (
    select * from "$scratch"."dbt"."@fab4"."premises_types_blue"
  )

  
2021-01-28 15:45:15.399948 (Thread-2): SQL status: OK in 0.35 seconds
2021-01-28 15:45:15.407901 (Thread-2): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:45:15.408247 (Thread-2): On seed.subsurface.transfer_types: drop table if exists "$scratch"."dbt"."@fab4"."transfer_types_green"
2021-01-28 15:45:15.412079 (Thread-1): SQL status: OK in 0.37 seconds
2021-01-28 15:45:15.420110 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:45:15.420457 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."dbt"."@fab4"."crop_types_green"
2021-01-28 15:45:15.475133 (Thread-3): SQL status: OK in 0.22 seconds
2021-01-28 15:45:15.482616 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:45:15.482934 (Thread-3): On seed.subsurface.premises_types: drop table if exists "$scratch"."dbt"."@fab4"."premises_types_green"
2021-01-28 15:45:15.483632 (Thread-2): SQL status: OK in 0.08 seconds
2021-01-28 15:45:15.506005 (Thread-2): finished collecting timing info
2021-01-28 15:45:15.506824 (Thread-2): On seed.subsurface.transfer_types: ROLLBACK
2021-01-28 15:45:15.507082 (Thread-2): On seed.subsurface.transfer_types: Close
2021-01-28 15:45:15.507834 (Thread-1): SQL status: OK in 0.09 seconds
2021-01-28 15:45:15.519543 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6996cc96-2941-4c47-a253-05a13e351183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fc40c240>]}
2021-01-28 15:45:15.520202 (Thread-2): 16:45:15 | 3 of 3 OK loaded seed file no_schema.transfer_types.................. [OK in 3.30s]
2021-01-28 15:45:15.520606 (Thread-2): Finished running node seed.subsurface.transfer_types
2021-01-28 15:45:15.516107 (Thread-1): finished collecting timing info
2021-01-28 15:45:15.521404 (Thread-1): On seed.subsurface.crop_types: ROLLBACK
2021-01-28 15:45:15.521752 (Thread-1): On seed.subsurface.crop_types: Close
2021-01-28 15:45:15.524488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6996cc96-2941-4c47-a253-05a13e351183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fc467668>]}
2021-01-28 15:45:15.524978 (Thread-1): 16:45:15 | 1 of 3 OK loaded seed file no_schema.crop_types...................... [OK in 3.38s]
2021-01-28 15:45:15.525276 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-28 15:45:15.536786 (Thread-3): SQL status: OK in 0.05 seconds
2021-01-28 15:45:15.545140 (Thread-3): finished collecting timing info
2021-01-28 15:45:15.545943 (Thread-3): On seed.subsurface.premises_types: ROLLBACK
2021-01-28 15:45:15.546184 (Thread-3): On seed.subsurface.premises_types: Close
2021-01-28 15:45:15.549909 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6996cc96-2941-4c47-a253-05a13e351183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fc4ab9e8>]}
2021-01-28 15:45:15.550722 (Thread-3): 16:45:15 | 2 of 3 OK loaded seed file no_schema.premises_types.................. [OK in 3.36s]
2021-01-28 15:45:15.551187 (Thread-3): Finished running node seed.subsurface.premises_types
2021-01-28 15:45:15.624982 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:45:15.625500 (MainThread): On master: ROLLBACK
2021-01-28 15:45:15.625720 (MainThread): Opening a new connection, currently in state init
2021-01-28 15:45:15.625918 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:15.923805 (MainThread): Connected to db: None
2021-01-28 15:45:15.924652 (MainThread): On master: ROLLBACK
2021-01-28 15:45:15.925012 (MainThread): On master: Close
2021-01-28 15:45:15.927695 (MainThread): 16:45:15 | 
2021-01-28 15:45:15.928220 (MainThread): 16:45:15 | Finished running 3 seeds in 6.25s.
2021-01-28 15:45:15.928725 (MainThread): Connection 'master' was properly closed.
2021-01-28 15:45:15.929126 (MainThread): Connection 'seed.subsurface.crop_types' was properly closed.
2021-01-28 15:45:15.929474 (MainThread): Connection 'seed.subsurface.premises_types' was properly closed.
2021-01-28 15:45:15.929840 (MainThread): Connection 'seed.subsurface.transfer_types' was properly closed.
2021-01-28 15:45:15.976145 (MainThread): 
2021-01-28 15:45:15.976942 (MainThread): Completed successfully
2021-01-28 15:45:15.977534 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-28 15:45:15.978329 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fc4d7908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fc467e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56fc40c6a0>]}
2021-01-28 15:45:15.979127 (MainThread): Flushing usage events
2021-01-28 15:45:25.421802 (MainThread): Running with dbt=0.18.1
2021-01-28 15:45:25.535955 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 15:45:25.537523 (MainThread): Tracking: tracking
2021-01-28 15:45:25.553037 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdf4a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdf4a0b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdf4a048>]}
2021-01-28 15:45:25.602719 (MainThread): Partial parsing not enabled
2021-01-28 15:45:25.604311 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:45:25.609796 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:45:25.611819 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 15:45:25.640264 (MainThread): Parsing macros/catalog.sql
2021-01-28 15:45:25.644572 (MainThread): Parsing macros/adapters.sql
2021-01-28 15:45:25.683980 (MainThread): Parsing macros/helpers.sql
2021-01-28 15:45:25.713494 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:45:25.717031 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:45:25.719004 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 15:45:25.723967 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:45:25.748224 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:45:25.756237 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:45:25.766796 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 15:45:25.778901 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:45:25.803000 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 15:45:25.816243 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 15:45:25.832699 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 15:45:25.834599 (MainThread): Parsing macros/core.sql
2021-01-28 15:45:25.841196 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 15:45:25.913379 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 15:45:25.928639 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 15:45:25.930357 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 15:45:25.933454 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 15:45:25.937111 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 15:45:25.940132 (MainThread): Parsing macros/etc/query.sql
2021-01-28 15:45:25.942132 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 15:45:26.006687 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 15:45:26.029987 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 15:45:26.033316 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:45:26.044393 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:45:26.079793 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 15:45:26.124150 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 15:45:26.127315 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 15:45:26.157036 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:45:26.168613 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 15:45:26.177496 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:45:26.188210 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 15:45:26.193111 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 15:45:26.195952 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 15:45:26.199358 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 15:45:26.212481 (MainThread): Partial parsing not enabled
2021-01-28 15:45:26.292155 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:45:26.334705 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:45:26.355874 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:45:26.376783 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:45:26.400408 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:45:26.421903 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:45:26.450657 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 15:45:26.474279 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 15:45:26.507307 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:45:26.528636 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:45:28.203635 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 15:45:28.767831 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 15:45:28.772575 (MainThread): 
2021-01-28 15:45:28.773177 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:45:28.788948 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-28 15:45:28.841685 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-28 15:45:28.841879 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 15:45:28.842031 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 15:45:28.842170 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:29.114632 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-28 15:45:29.385670 (ThreadPoolExecutor-0_0): SQL status: OK in 0.54 seconds
2021-01-28 15:45:29.419733 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-28 15:45:29.686593 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 15:45:29.710207 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 15:45:29.710626 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 15:45:29.710971 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 15:45:29.711245 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:29.888024 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 15:45:30.284404 (ThreadPoolExecutor-1_0): SQL status: OK in 0.57 seconds
2021-01-28 15:45:30.324109 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 15:45:30.324537 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-28 15:45:30.326989 (MainThread): 16:45:30 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 15:45:30.327336 (MainThread): 16:45:30 | 
2021-01-28 15:45:30.331638 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-28 15:45:30.332048 (Thread-4): Began running node model.subsurface.stg__municipalities
2021-01-28 15:45:30.334873 (Thread-1): 16:45:30 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-28 15:45:30.335171 (Thread-3): Began running node model.subsurface.d_crop_types
2021-01-28 15:45:30.340473 (Thread-3): 16:45:30 | 3 of 6 START view model @fab4.d_crop_types........................... [RUN]
2021-01-28 15:45:30.335489 (Thread-2): Began running node model.subsurface.d_premises_types
2021-01-28 15:45:30.338340 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:45:30.337651 (Thread-4): 16:45:30 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-28 15:45:30.341167 (Thread-3): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:45:30.345672 (Thread-2): 16:45:30 | 4 of 6 START view model @fab4.d_premises_types....................... [RUN]
2021-01-28 15:45:30.346122 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-28 15:45:30.346747 (Thread-3): Compiling model.subsurface.d_crop_types
2021-01-28 15:45:30.347908 (Thread-4): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:45:30.359571 (Thread-2): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:45:30.400984 (Thread-4): Compiling model.subsurface.stg__municipalities
2021-01-28 15:45:30.416630 (Thread-2): Compiling model.subsurface.d_premises_types
2021-01-28 15:45:30.438961 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-28 15:45:30.495777 (Thread-1): finished collecting timing info
2021-01-28 15:45:30.497535 (Thread-3): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-28 15:45:30.526488 (Thread-4): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-28 15:45:30.571574 (Thread-2): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-28 15:45:30.591666 (Thread-4): finished collecting timing info
2021-01-28 15:45:30.604189 (Thread-2): finished collecting timing info
2021-01-28 15:45:30.634858 (Thread-3): finished collecting timing info
2021-01-28 15:45:30.694301 (Thread-3): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-28 15:45:30.702293 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-28 15:45:30.709658 (Thread-2): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-28 15:45:30.721967 (Thread-4): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-28 15:45:30.723267 (Thread-3): Using dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:45:30.723947 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:45:30.725149 (Thread-4): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:45:30.725601 (Thread-3): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 15:45:30.726244 (Thread-2): Using dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:45:30.726710 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-28 15:45:30.727204 (Thread-4): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-28 15:45:30.727714 (Thread-3): Opening a new connection, currently in state init
2021-01-28 15:45:30.728161 (Thread-2): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 15:45:30.728656 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:45:30.729178 (Thread-4): Opening a new connection, currently in state init
2021-01-28 15:45:30.729664 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:30.730105 (Thread-2): Opening a new connection, currently in state init
2021-01-28 15:45:30.730566 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:30.731033 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:30.731840 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:31.488352 (Thread-2): Connected to db: None
2021-01-28 15:45:31.536825 (Thread-4): Connected to db: None
2021-01-28 15:45:31.537972 (Thread-3): Connected to db: None
2021-01-28 15:45:31.561813 (Thread-1): Connected to db: None
2021-01-28 15:45:31.723136 (Thread-2): SQL status: OK in 0.99 seconds
2021-01-28 15:45:31.733417 (Thread-2): finished collecting timing info
2021-01-28 15:45:31.734173 (Thread-2): On model.subsurface.d_premises_types: ROLLBACK
2021-01-28 15:45:31.734411 (Thread-2): On model.subsurface.d_premises_types: Close
2021-01-28 15:45:31.736205 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b76be5b-06f6-4439-8b07-c763a993aa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcddc0048>]}
2021-01-28 15:45:31.738720 (Thread-2): 16:45:31 | 4 of 6 OK created view model @fab4.d_premises_types.................. [OK in 1.38s]
2021-01-28 15:45:31.739054 (Thread-2): Finished running node model.subsurface.d_premises_types
2021-01-28 15:45:31.740390 (Thread-3): SQL status: OK in 1.01 seconds
2021-01-28 15:45:31.751140 (Thread-3): finished collecting timing info
2021-01-28 15:45:31.752213 (Thread-3): On model.subsurface.d_crop_types: ROLLBACK
2021-01-28 15:45:31.752600 (Thread-3): On model.subsurface.d_crop_types: Close
2021-01-28 15:45:31.756754 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b76be5b-06f6-4439-8b07-c763a993aa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdd1d5c0>]}
2021-01-28 15:45:31.761006 (Thread-3): 16:45:31 | 3 of 6 OK created view model @fab4.d_crop_types...................... [OK in 1.41s]
2021-01-28 15:45:31.761680 (Thread-3): Finished running node model.subsurface.d_crop_types
2021-01-28 15:45:31.774262 (Thread-1): Error running SQL: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "fs"."valeurs_foncieres"
  )

2021-01-28 15:45:31.774800 (Thread-1): Rolling back transaction.
2021-01-28 15:45:31.775197 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-28 15:45:31.775574 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-28 15:45:31.777279 (Thread-1): finished collecting timing info
2021-01-28 15:45:31.781167 (Thread-4): Error running SQL: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "fs"."geo"."communes.csv"
  )

2021-01-28 15:45:31.781425 (Thread-4): Rolling back transaction.
2021-01-28 15:45:31.781684 (Thread-4): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-28 15:45:31.781884 (Thread-4): On model.subsurface.stg__municipalities: Close
2021-01-28 15:45:31.785506 (Thread-4): finished collecting timing info
2021-01-28 15:45:31.786693 (Thread-4): Runtime Error in model stg__municipalities (models/staging/stg__municipalities.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__municipalities" as (\n    select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n   "fs"."geo"."communes.csv"\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValida...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__municipalities" as (\n    select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n   "fs"."geo"."communes.csv"\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValida...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/usr/local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/usr/local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib64/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__municipalities (models/staging/stg__municipalities.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__municipalities" as (\n    select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n   "fs"."geo"."communes.csv"\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValida...[see log] (1040) (SQLExecDirectW)')
2021-01-28 15:45:31.789936 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b76be5b-06f6-4439-8b07-c763a993aa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdcfb978>]}
2021-01-28 15:45:31.792613 (Thread-4): 16:45:31 | 2 of 6 ERROR creating view model @fab4.stg__municipalities........... [ERROR in 1.44s]
2021-01-28 15:45:31.792934 (Thread-4): Finished running node model.subsurface.stg__municipalities
2021-01-28 15:45:31.779194 (Thread-1): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    select\n  cast(regexp_replace(nullif("Date mutation", \'\'), \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,cast(replace(nullif("Valeur fonciere", \'\'), \',\', \'.\') as decimal) as transaction_amount\n  ,nullif("Nature mutation", \'\') as transfer_label_fr\n  ,nullif("type de voie", \'\') ...[see log] (1040) (SQLExecDirectW)')
Traceback (most recent call last):
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 58, in exception_handler
    yield
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 165, in add_query
    cursor.execute(sql)
pyodbc.Error: ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    select\n  cast(regexp_replace(nullif("Date mutation", \'\'), \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,cast(replace(nullif("Valeur fonciere", \'\'), \',\', \'.\') as decimal) as transaction_amount\n  ,nullif("Nature mutation", \'\') as transfer_label_fr\n  ,nullif("type de voie", \'\') ...[see log] (1040) (SQLExecDirectW)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 18, in macro
  File "/usr/local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 64, in macro
  File "/usr/local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 187, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 172, in add_query
    return connection, cursor
  File "/usr/lib64/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/root/dev/git/dbt-dremio/dbt/adapters/dremio/connections.py", line 82, in exception_handler
    raise dbt.exceptions.RuntimeException(e)
dbt.exceptions.RuntimeException: Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
  ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    select\n  cast(regexp_replace(nullif("Date mutation", \'\'), \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,cast(replace(nullif("Valeur fonciere", \'\'), \',\', \'.\') as decimal) as transaction_amount\n  ,nullif("Nature mutation", \'\') as transfer_label_fr\n  ,nullif("type de voie", \'\') ...[see log] (1040) (SQLExecDirectW)')
2021-01-28 15:45:31.795095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b76be5b-06f6-4439-8b07-c763a993aa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdcf2048>]}
2021-01-28 15:45:31.799544 (Thread-1): 16:45:31 | 1 of 6 ERROR creating view model @fab4.stg__land_values.............. [ERROR in 1.46s]
2021-01-28 15:45:31.800282 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-28 15:45:31.803899 (Thread-2): Began running node model.subsurface.d_municipalities
2021-01-28 15:45:31.804384 (Thread-2): 16:45:31 | 5 of 6 SKIP relation no_schema.d_municipalities...................... [SKIP]
2021-01-28 15:45:31.804726 (Thread-2): Finished running node model.subsurface.d_municipalities
2021-01-28 15:45:31.805027 (Thread-2): Began running node model.subsurface.f_land_values
2021-01-28 15:45:31.805280 (Thread-2): 16:45:31 | 6 of 6 SKIP relation no_schema.f_land_values......................... [SKIP]
2021-01-28 15:45:31.805560 (Thread-2): Finished running node model.subsurface.f_land_values
2021-01-28 15:45:31.868307 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:45:31.868961 (MainThread): On master: ROLLBACK
2021-01-28 15:45:31.869268 (MainThread): Opening a new connection, currently in state init
2021-01-28 15:45:31.869620 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:45:32.100490 (MainThread): Connected to db: None
2021-01-28 15:45:32.101063 (MainThread): On master: ROLLBACK
2021-01-28 15:45:32.101269 (MainThread): On master: Close
2021-01-28 15:45:32.103292 (MainThread): 16:45:32 | 
2021-01-28 15:45:32.103722 (MainThread): 16:45:32 | Finished running 6 view models in 3.33s.
2021-01-28 15:45:32.103994 (MainThread): Connection 'master' was properly closed.
2021-01-28 15:45:32.104183 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-28 15:45:32.104363 (MainThread): Connection 'model.subsurface.d_crop_types' was properly closed.
2021-01-28 15:45:32.104638 (MainThread): Connection 'model.subsurface.stg__municipalities' was properly closed.
2021-01-28 15:45:32.104821 (MainThread): Connection 'model.subsurface.d_premises_types' was properly closed.
2021-01-28 15:45:32.154342 (MainThread): 
2021-01-28 15:45:32.154858 (MainThread): Completed with 2 errors and 0 warnings:
2021-01-28 15:45:32.155202 (MainThread): 
2021-01-28 15:45:32.155531 (MainThread): Runtime Error in model stg__municipalities (models/staging/stg__municipalities.sql)
2021-01-28 15:45:32.155802 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__municipalities" as (\n    select\n    com_code as municipality_code\n    ,com_nom as municipality_label\n    ,dep_code as department_code\n    ,dep_nom_num as department_label\n    ,reg_code as region_code\n    ,reg_nom as region_label\nfrom\n   "fs"."geo"."communes.csv"\n  )\n\n[30038]Query execution error. Details:[ \nSYSTEM ERROR: SqlValida...[see log] (1040) (SQLExecDirectW)')
2021-01-28 15:45:32.156080 (MainThread): 
2021-01-28 15:45:32.156349 (MainThread): Runtime Error in model stg__land_values (models/staging/stg__land_values.sql)
2021-01-28 15:45:32.156652 (MainThread):   ('HY000', '[HY000] [Dremio][Connector] (1040) Dremio failed to execute the query: \n  create or replace view "@fab4"."stg__land_values" as (\n    select\n  cast(regexp_replace(nullif("Date mutation", \'\'), \'([0-9]{2})/([0-9]{2})/([0-9]{4})\', \'$3-$2-$1\') as date) as transaction_date\n  ,cast(replace(nullif("Valeur fonciere", \'\'), \',\', \'.\') as decimal) as transaction_amount\n  ,nullif("Nature mutation", \'\') as transfer_label_fr\n  ,nullif("type de voie", \'\') ...[see log] (1040) (SQLExecDirectW)')
2021-01-28 15:45:32.156942 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=2 TOTAL=6
2021-01-28 15:45:32.157418 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcddd2828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcddd24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdd5f9e8>]}
2021-01-28 15:45:32.157930 (MainThread): Flushing usage events
2021-01-28 15:49:23.930538 (MainThread): Running with dbt=0.18.1
2021-01-28 15:49:24.049964 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 15:49:24.051392 (MainThread): Tracking: tracking
2021-01-28 15:49:24.072271 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4b251320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4be20e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4be20eb8>]}
2021-01-28 15:49:24.125562 (MainThread): Partial parsing not enabled
2021-01-28 15:49:24.127188 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:49:24.132702 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:49:24.134712 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 15:49:24.163211 (MainThread): Parsing macros/catalog.sql
2021-01-28 15:49:24.167252 (MainThread): Parsing macros/adapters.sql
2021-01-28 15:49:24.206899 (MainThread): Parsing macros/helpers.sql
2021-01-28 15:49:24.236048 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:49:24.239547 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:49:24.241491 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 15:49:24.246343 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:49:24.270987 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:49:24.278511 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:49:24.288902 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 15:49:24.300958 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:49:24.325062 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 15:49:24.338295 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 15:49:24.354584 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 15:49:24.356535 (MainThread): Parsing macros/core.sql
2021-01-28 15:49:24.363137 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 15:49:24.436516 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 15:49:24.451665 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 15:49:24.453366 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 15:49:24.456478 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 15:49:24.460280 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 15:49:24.463297 (MainThread): Parsing macros/etc/query.sql
2021-01-28 15:49:24.465269 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 15:49:24.534939 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 15:49:24.558099 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 15:49:24.561486 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:49:24.572739 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:49:24.608216 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 15:49:24.653337 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 15:49:24.656502 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 15:49:24.686061 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:49:24.697604 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 15:49:24.706388 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:49:24.717189 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 15:49:24.722181 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 15:49:24.725037 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 15:49:24.728544 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 15:49:24.742065 (MainThread): Partial parsing not enabled
2021-01-28 15:49:24.825086 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:49:24.870599 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:49:24.893726 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:49:24.916575 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:49:24.940601 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:49:24.962783 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:49:24.993779 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 15:49:25.019688 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 15:49:25.054612 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:49:25.077920 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:49:26.836631 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 15:49:27.403387 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 15:49:27.408278 (MainThread): 
2021-01-28 15:49:27.408951 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:49:27.424865 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-28 15:49:27.479423 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-28 15:49:27.479881 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 15:49:27.480225 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 15:49:27.480540 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:27.823251 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-28 15:49:28.062686 (ThreadPoolExecutor-0_0): SQL status: OK in 0.58 seconds
2021-01-28 15:49:28.104932 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-28 15:49:28.424106 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 15:49:28.449390 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 15:49:28.449834 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 15:49:28.450171 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 15:49:28.450544 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:28.699271 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 15:49:29.082146 (ThreadPoolExecutor-1_0): SQL status: OK in 0.63 seconds
2021-01-28 15:49:29.135092 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 15:49:29.135647 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-28 15:49:29.140677 (MainThread): 16:49:29 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 15:49:29.141190 (MainThread): 16:49:29 | 
2021-01-28 15:49:29.148224 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-28 15:49:29.151103 (Thread-1): 16:49:29 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-28 15:49:29.151737 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:49:29.152010 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-28 15:49:29.158719 (Thread-4): Began running node model.subsurface.stg__municipalities
2021-01-28 15:49:29.159274 (Thread-3): Began running node model.subsurface.d_crop_types
2021-01-28 15:49:29.195064 (Thread-3): 16:49:29 | 3 of 6 START view model @fab4.d_crop_types........................... [RUN]
2021-01-28 15:49:29.179240 (Thread-4): 16:49:29 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-28 15:49:29.169737 (Thread-2): Began running node model.subsurface.d_premises_types
2021-01-28 15:49:29.197870 (Thread-2): 16:49:29 | 4 of 6 START view model @fab4.d_premises_types....................... [RUN]
2021-01-28 15:49:29.204526 (Thread-2): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:49:29.203925 (Thread-3): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:49:29.225738 (Thread-3): Compiling model.subsurface.d_crop_types
2021-01-28 15:49:29.206010 (Thread-4): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:49:29.225301 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-28 15:49:29.204969 (Thread-2): Compiling model.subsurface.d_premises_types
2021-01-28 15:49:29.237052 (Thread-4): Compiling model.subsurface.stg__municipalities
2021-01-28 15:49:29.264031 (Thread-3): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-28 15:49:29.274215 (Thread-1): finished collecting timing info
2021-01-28 15:49:29.293315 (Thread-2): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-28 15:49:29.327775 (Thread-3): finished collecting timing info
2021-01-28 15:49:29.343624 (Thread-4): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-28 15:49:29.429937 (Thread-2): finished collecting timing info
2021-01-28 15:49:29.469565 (Thread-4): finished collecting timing info
2021-01-28 15:49:29.524973 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-28 15:49:29.529176 (Thread-2): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-28 15:49:29.530331 (Thread-3): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-28 15:49:29.539816 (Thread-4): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-28 15:49:29.542788 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:49:29.544025 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "subsurface_datalake"."valeurs_foncieres"
  )

2021-01-28 15:49:29.543755 (Thread-2): Using dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:49:29.543160 (Thread-3): Using dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:49:29.544577 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:49:29.545096 (Thread-2): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 15:49:29.545587 (Thread-3): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 15:49:29.546123 (Thread-4): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:49:29.546578 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:29.546889 (Thread-2): Opening a new connection, currently in state init
2021-01-28 15:49:29.547270 (Thread-3): Opening a new connection, currently in state init
2021-01-28 15:49:29.547725 (Thread-4): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "subsurface_datalake"."geo"."communes.csv"
  )

2021-01-28 15:49:29.548447 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:29.548972 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:29.549580 (Thread-4): Opening a new connection, currently in state init
2021-01-28 15:49:29.550322 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:30.143907 (Thread-1): Connected to db: None
2021-01-28 15:49:30.184296 (Thread-3): Connected to db: None
2021-01-28 15:49:30.186899 (Thread-4): Connected to db: None
2021-01-28 15:49:30.212997 (Thread-2): Connected to db: None
2021-01-28 15:49:30.339233 (Thread-3): SQL status: OK in 0.79 seconds
2021-01-28 15:49:30.356930 (Thread-3): finished collecting timing info
2021-01-28 15:49:30.358169 (Thread-3): On model.subsurface.d_crop_types: ROLLBACK
2021-01-28 15:49:30.358592 (Thread-3): On model.subsurface.d_crop_types: Close
2021-01-28 15:49:30.363409 (Thread-4): SQL status: OK in 0.81 seconds
2021-01-28 15:49:30.368817 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9bcd2-5a5d-4974-9cf8-9c28503ff46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4b0d9f28>]}
2021-01-28 15:49:30.373228 (Thread-3): 16:49:30 | 3 of 6 OK created view model @fab4.d_crop_types...................... [OK in 1.16s]
2021-01-28 15:49:30.373835 (Thread-3): Finished running node model.subsurface.d_crop_types
2021-01-28 15:49:30.383044 (Thread-4): finished collecting timing info
2021-01-28 15:49:30.384079 (Thread-4): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-28 15:49:30.384592 (Thread-4): On model.subsurface.stg__municipalities: Close
2021-01-28 15:49:30.388582 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9bcd2-5a5d-4974-9cf8-9c28503ff46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4aec1a90>]}
2021-01-28 15:49:30.391065 (Thread-4): 16:49:30 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 1.18s]
2021-01-28 15:49:30.391368 (Thread-4): Finished running node model.subsurface.stg__municipalities
2021-01-28 15:49:30.392602 (Thread-3): Began running node model.subsurface.d_municipalities
2021-01-28 15:49:30.394770 (Thread-3): 16:49:30 | 5 of 6 START view model @fab4.d_municipalities....................... [RUN]
2021-01-28 15:49:30.395403 (Thread-3): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:49:30.395695 (Thread-3): Compiling model.subsurface.d_municipalities
2021-01-28 15:49:30.414999 (Thread-3): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-28 15:49:30.415988 (Thread-3): finished collecting timing info
2021-01-28 15:49:30.426149 (Thread-3): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-28 15:49:30.427105 (Thread-3): Using dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:49:30.427317 (Thread-3): On model.subsurface.d_municipalities: 
  create or replace view "@fab4"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-28 15:49:30.427617 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:49:30.427822 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:30.553504 (Thread-2): SQL status: OK in 1.01 seconds
2021-01-28 15:49:30.556002 (Thread-1): SQL status: OK in 1.01 seconds
2021-01-28 15:49:30.562028 (Thread-1): finished collecting timing info
2021-01-28 15:49:30.562616 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-28 15:49:30.562826 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-28 15:49:30.564467 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9bcd2-5a5d-4974-9cf8-9c28503ff46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4b0a4e80>]}
2021-01-28 15:49:30.566634 (Thread-1): 16:49:30 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 1.41s]
2021-01-28 15:49:30.566937 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-28 15:49:30.569651 (Thread-4): Began running node model.subsurface.f_land_values
2021-01-28 15:49:30.571854 (Thread-4): 16:49:30 | 6 of 6 START view model @fab4.f_land_values.......................... [RUN]
2021-01-28 15:49:30.572533 (Thread-4): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:49:30.572783 (Thread-4): Compiling model.subsurface.f_land_values
2021-01-28 15:49:30.585513 (Thread-2): finished collecting timing info
2021-01-28 15:49:30.586155 (Thread-2): On model.subsurface.d_premises_types: ROLLBACK
2021-01-28 15:49:30.586375 (Thread-2): On model.subsurface.d_premises_types: Close
2021-01-28 15:49:30.588628 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9bcd2-5a5d-4974-9cf8-9c28503ff46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4b030940>]}
2021-01-28 15:49:30.590909 (Thread-2): 16:49:30 | 4 of 6 OK created view model @fab4.d_premises_types.................. [OK in 1.38s]
2021-01-28 15:49:30.591214 (Thread-2): Finished running node model.subsurface.d_premises_types
2021-01-28 15:49:30.598104 (Thread-3): Connected to db: None
2021-01-28 15:49:30.622005 (Thread-4): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-28 15:49:30.622905 (Thread-4): finished collecting timing info
2021-01-28 15:49:30.636225 (Thread-4): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-28 15:49:30.637554 (Thread-4): Using dremio connection "model.subsurface.f_land_values".
2021-01-28 15:49:30.637763 (Thread-4): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-28 15:49:30.637958 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:49:30.638160 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:30.882767 (Thread-3): SQL status: OK in 0.46 seconds
2021-01-28 15:49:30.893998 (Thread-3): finished collecting timing info
2021-01-28 15:49:30.895382 (Thread-3): On model.subsurface.d_municipalities: ROLLBACK
2021-01-28 15:49:30.895790 (Thread-3): On model.subsurface.d_municipalities: Close
2021-01-28 15:49:30.901254 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9bcd2-5a5d-4974-9cf8-9c28503ff46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4b0554e0>]}
2021-01-28 15:49:30.903864 (Thread-3): 16:49:30 | 5 of 6 OK created view model @fab4.d_municipalities.................. [OK in 0.51s]
2021-01-28 15:49:30.904183 (Thread-3): Finished running node model.subsurface.d_municipalities
2021-01-28 15:49:30.922404 (Thread-4): Connected to db: None
2021-01-28 15:49:31.241003 (Thread-4): SQL status: OK in 0.60 seconds
2021-01-28 15:49:31.247305 (Thread-4): finished collecting timing info
2021-01-28 15:49:31.247909 (Thread-4): On model.subsurface.f_land_values: ROLLBACK
2021-01-28 15:49:31.248110 (Thread-4): On model.subsurface.f_land_values: Close
2021-01-28 15:49:31.249734 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9bcd2-5a5d-4974-9cf8-9c28503ff46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4b076160>]}
2021-01-28 15:49:31.252011 (Thread-4): 16:49:31 | 6 of 6 OK created view model @fab4.f_land_values..................... [OK in 0.68s]
2021-01-28 15:49:31.252304 (Thread-4): Finished running node model.subsurface.f_land_values
2021-01-28 15:49:31.302269 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:49:31.303097 (MainThread): On master: ROLLBACK
2021-01-28 15:49:31.303510 (MainThread): Opening a new connection, currently in state init
2021-01-28 15:49:31.303847 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:49:31.558849 (MainThread): Connected to db: None
2021-01-28 15:49:31.559710 (MainThread): On master: ROLLBACK
2021-01-28 15:49:31.560058 (MainThread): On master: Close
2021-01-28 15:49:31.562622 (MainThread): 16:49:31 | 
2021-01-28 15:49:31.563117 (MainThread): 16:49:31 | Finished running 6 view models in 4.15s.
2021-01-28 15:49:31.563565 (MainThread): Connection 'master' was properly closed.
2021-01-28 15:49:31.563874 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-28 15:49:31.564153 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-28 15:49:31.564513 (MainThread): Connection 'model.subsurface.d_premises_types' was properly closed.
2021-01-28 15:49:31.564817 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-28 15:49:31.653744 (MainThread): 
2021-01-28 15:49:31.654604 (MainThread): Completed successfully
2021-01-28 15:49:31.655153 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-28 15:49:31.655948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4b05d630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4b0a4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4be2c978>]}
2021-01-28 15:49:31.656719 (MainThread): Flushing usage events
2021-01-28 15:51:12.512976 (MainThread): Running with dbt=0.18.1
2021-01-28 15:51:12.630679 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-28 15:51:12.632630 (MainThread): Tracking: tracking
2021-01-28 15:51:12.649154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1458b6048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1464d4748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1464d4860>]}
2021-01-28 15:51:12.701835 (MainThread): Partial parsing not enabled
2021-01-28 15:51:12.703523 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:51:12.709257 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:51:12.711313 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 15:51:12.739557 (MainThread): Parsing macros/catalog.sql
2021-01-28 15:51:12.743772 (MainThread): Parsing macros/adapters.sql
2021-01-28 15:51:12.784399 (MainThread): Parsing macros/helpers.sql
2021-01-28 15:51:12.813869 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:51:12.817373 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:51:12.819342 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 15:51:12.824348 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:51:12.848667 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:51:12.856342 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:51:12.866956 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 15:51:12.879381 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:51:12.906064 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 15:51:12.919567 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 15:51:12.936305 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 15:51:12.938264 (MainThread): Parsing macros/core.sql
2021-01-28 15:51:12.949577 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 15:51:13.025166 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 15:51:13.040591 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 15:51:13.042327 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 15:51:13.045358 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 15:51:13.048994 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 15:51:13.051913 (MainThread): Parsing macros/etc/query.sql
2021-01-28 15:51:13.053864 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 15:51:13.122420 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 15:51:13.146622 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 15:51:13.150224 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:51:13.161888 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:51:13.200967 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 15:51:13.247240 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 15:51:13.250522 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 15:51:13.281247 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:51:13.292803 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 15:51:13.301910 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:51:13.312723 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 15:51:13.317694 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 15:51:13.320547 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 15:51:13.324049 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 15:51:13.337598 (MainThread): Partial parsing not enabled
2021-01-28 15:51:13.418223 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:51:13.462367 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:51:13.484886 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:51:13.507541 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:51:13.531827 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:51:13.554194 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:51:13.584260 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 15:51:13.612624 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 15:51:13.647180 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:51:13.669579 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:51:15.596839 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 15:51:16.191833 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 15:51:16.197743 (MainThread): 
2021-01-28 15:51:16.198369 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:51:16.529115 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 15:51:16.572549 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 15:51:16.573048 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 15:51:16.573386 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-28 15:51:16.573745 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:16.907596 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 15:51:17.356183 (ThreadPoolExecutor-1_0): SQL status: OK in 0.78 seconds
2021-01-28 15:51:17.434635 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 15:51:17.435251 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-28 15:51:17.440148 (MainThread): 16:51:17 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 15:51:17.440670 (MainThread): 16:51:17 | 
2021-01-28 15:51:17.451404 (Thread-1): Began running node test.subsurface.not_null_crop_types_crop_code
2021-01-28 15:51:17.452150 (Thread-3): Began running node test.subsurface.not_null_crop_types_crop_label
2021-01-28 15:51:17.452823 (Thread-1): 16:51:17 | 1 of 48 START test not_null_crop_types_crop_code..................... [RUN]
2021-01-28 15:51:17.456514 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-28 15:51:17.456974 (Thread-1): Compiling test.subsurface.not_null_crop_types_crop_code
2021-01-28 15:51:17.455097 (Thread-3): 16:51:17 | 2 of 48 START test not_null_crop_types_crop_label.................... [RUN]
2021-01-28 15:51:17.454361 (Thread-4): Began running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-28 15:51:17.484168 (Thread-4): 16:51:17 | 4 of 48 START test not_null_d_municipalities_municipality_code....... [RUN]
2021-01-28 15:51:17.453275 (Thread-2): Began running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-28 15:51:17.508368 (Thread-2): 16:51:17 | 3 of 48 START test not_null_d_crop_types_crop_code................... [RUN]
2021-01-28 15:51:17.497394 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-28 15:51:17.524908 (Thread-4): Compiling test.subsurface.not_null_d_municipalities_municipality_code
2021-01-28 15:51:17.490858 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-28 15:51:17.536606 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-28 15:51:17.557672 (Thread-3): Compiling test.subsurface.not_null_crop_types_crop_label
2021-01-28 15:51:17.560991 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_code"
2021-01-28 15:51:17.578680 (Thread-2): Compiling test.subsurface.not_null_d_crop_types_crop_code
2021-01-28 15:51:17.585021 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_d_municipalities_municipality_code"
2021-01-28 15:51:17.605489 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_crop_types_crop_label"
2021-01-28 15:51:17.644583 (Thread-1): finished collecting timing info
2021-01-28 15:51:17.646352 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_d_crop_types_crop_code"
2021-01-28 15:51:17.647168 (Thread-1): Using dremio connection "test.subsurface.not_null_crop_types_crop_code".
2021-01-28 15:51:17.647602 (Thread-3): finished collecting timing info
2021-01-28 15:51:17.650956 (Thread-3): Using dremio connection "test.subsurface.not_null_crop_types_crop_label".
2021-01-28 15:51:17.650002 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_code is null



2021-01-28 15:51:17.648714 (Thread-4): finished collecting timing info
2021-01-28 15:51:17.651333 (Thread-2): finished collecting timing info
2021-01-28 15:51:17.652376 (Thread-3): On test.subsurface.not_null_crop_types_crop_label: 
    
    



select count(*) as validation_errors
from "@fab4"."crop_types"
where crop_label is null



2021-01-28 15:51:17.652865 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:51:17.653413 (Thread-4): Using dremio connection "test.subsurface.not_null_d_municipalities_municipality_code".
2021-01-28 15:51:17.654194 (Thread-2): Using dremio connection "test.subsurface.not_null_d_crop_types_crop_code".
2021-01-28 15:51:17.654656 (Thread-3): Opening a new connection, currently in state init
2021-01-28 15:51:17.655069 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:17.655525 (Thread-4): On test.subsurface.not_null_d_municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."d_municipalities"
where municipality_code is null



2021-01-28 15:51:17.655930 (Thread-2): On test.subsurface.not_null_d_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."d_crop_types"
where crop_code is null



2021-01-28 15:51:17.656350 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:17.657101 (Thread-4): Opening a new connection, currently in state init
2021-01-28 15:51:17.657568 (Thread-2): Opening a new connection, currently in state init
2021-01-28 15:51:17.659658 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:17.660061 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:18.304139 (Thread-1): Connected to db: None
2021-01-28 15:51:18.305640 (Thread-3): Connected to db: None
2021-01-28 15:51:18.327620 (Thread-4): Connected to db: None
2021-01-28 15:51:18.357997 (Thread-2): Connected to db: None
2021-01-28 15:51:18.858133 (Thread-1): SQL status: OK in 1.21 seconds
2021-01-28 15:51:18.859057 (Thread-3): SQL status: OK in 1.20 seconds
2021-01-28 15:51:18.892089 (Thread-2): SQL status: OK in 1.23 seconds
2021-01-28 15:51:18.903809 (Thread-4): SQL status: OK in 1.25 seconds
2021-01-28 15:51:18.908680 (Thread-3): finished collecting timing info
2021-01-28 15:51:18.909501 (Thread-3): On test.subsurface.not_null_crop_types_crop_label: ROLLBACK
2021-01-28 15:51:18.909725 (Thread-3): On test.subsurface.not_null_crop_types_crop_label: Close
2021-01-28 15:51:18.910866 (Thread-3): 16:51:18 | 2 of 48 PASS not_null_crop_types_crop_label.......................... [PASS in 1.42s]
2021-01-28 15:51:18.911183 (Thread-3): Finished running node test.subsurface.not_null_crop_types_crop_label
2021-01-28 15:51:18.911575 (Thread-3): Began running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-28 15:51:18.911850 (Thread-3): 16:51:18 | 5 of 48 START test not_null_d_premises_types_premises_code........... [RUN]
2021-01-28 15:51:18.912349 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-28 15:51:18.912605 (Thread-3): Compiling test.subsurface.not_null_d_premises_types_premises_code
2021-01-28 15:51:18.933720 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_d_premises_types_premises_code"
2021-01-28 15:51:18.934603 (Thread-3): finished collecting timing info
2021-01-28 15:51:18.935243 (Thread-3): Using dremio connection "test.subsurface.not_null_d_premises_types_premises_code".
2021-01-28 15:51:18.935479 (Thread-3): On test.subsurface.not_null_d_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."d_premises_types"
where premises_code is null



2021-01-28 15:51:18.935679 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:51:18.935854 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:19.099058 (Thread-1): finished collecting timing info
2021-01-28 15:51:19.100639 (Thread-2): finished collecting timing info
2021-01-28 15:51:19.101266 (Thread-4): finished collecting timing info
2021-01-28 15:51:19.102685 (Thread-4): On test.subsurface.not_null_d_municipalities_municipality_code: ROLLBACK
2021-01-28 15:51:19.102339 (Thread-2): On test.subsurface.not_null_d_crop_types_crop_code: ROLLBACK
2021-01-28 15:51:19.101980 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: ROLLBACK
2021-01-28 15:51:19.103630 (Thread-1): On test.subsurface.not_null_crop_types_crop_code: Close
2021-01-28 15:51:19.103356 (Thread-2): On test.subsurface.not_null_d_crop_types_crop_code: Close
2021-01-28 15:51:19.103143 (Thread-4): On test.subsurface.not_null_d_municipalities_municipality_code: Close
2021-01-28 15:51:19.105104 (Thread-4): 16:51:19 | 4 of 48 PASS not_null_d_municipalities_municipality_code............. [PASS in 1.61s]
2021-01-28 15:51:19.105517 (Thread-4): Finished running node test.subsurface.not_null_d_municipalities_municipality_code
2021-01-28 15:51:19.105917 (Thread-4): Began running node test.subsurface.not_null_f_land_values_built_surface
2021-01-28 15:51:19.106198 (Thread-4): 16:51:19 | 6 of 48 START test not_null_f_land_values_built_surface.............. [RUN]
2021-01-28 15:51:19.106780 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-28 15:51:19.107048 (Thread-4): Compiling test.subsurface.not_null_f_land_values_built_surface
2021-01-28 15:51:19.121165 (Thread-1): 16:51:19 | 1 of 48 PASS not_null_crop_types_crop_code........................... [PASS in 1.67s]
2021-01-28 15:51:19.121600 (Thread-1): Finished running node test.subsurface.not_null_crop_types_crop_code
2021-01-28 15:51:19.121964 (Thread-1): Began running node test.subsurface.not_null_f_land_values_crop_code
2021-01-28 15:51:19.122239 (Thread-1): 16:51:19 | 7 of 48 START test not_null_f_land_values_crop_code.................. [RUN]
2021-01-28 15:51:19.122835 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-28 15:51:19.123108 (Thread-1): Compiling test.subsurface.not_null_f_land_values_crop_code
2021-01-28 15:51:19.139599 (Thread-2): 16:51:19 | 3 of 48 PASS not_null_d_crop_types_crop_code......................... [PASS in 1.60s]
2021-01-28 15:51:19.140217 (Thread-2): Finished running node test.subsurface.not_null_d_crop_types_crop_code
2021-01-28 15:51:19.140933 (Thread-2): Began running node test.subsurface.not_null_f_land_values_land_surface
2021-01-28 15:51:19.141367 (Thread-2): 16:51:19 | 8 of 48 START test not_null_f_land_values_land_surface............... [RUN]
2021-01-28 15:51:19.142605 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-28 15:51:19.143130 (Thread-2): Compiling test.subsurface.not_null_f_land_values_land_surface
2021-01-28 15:51:19.164926 (Thread-3): Connected to db: None
2021-01-28 15:51:19.192986 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_f_land_values_built_surface"
2021-01-28 15:51:19.206176 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_crop_code"
2021-01-28 15:51:19.207298 (Thread-4): finished collecting timing info
2021-01-28 15:51:19.214589 (Thread-4): Using dremio connection "test.subsurface.not_null_f_land_values_built_surface".
2021-01-28 15:51:19.214917 (Thread-1): finished collecting timing info
2021-01-28 15:51:19.218657 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_crop_code".
2021-01-28 15:51:19.219002 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where crop_code is null



2021-01-28 15:51:19.217074 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_f_land_values_land_surface"
2021-01-28 15:51:19.217879 (Thread-4): On test.subsurface.not_null_f_land_values_built_surface: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where built_surface is null



2021-01-28 15:51:19.219303 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:51:19.220292 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:19.220831 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:19.222669 (Thread-2): finished collecting timing info
2021-01-28 15:51:19.223855 (Thread-2): Using dremio connection "test.subsurface.not_null_f_land_values_land_surface".
2021-01-28 15:51:19.224191 (Thread-2): On test.subsurface.not_null_f_land_values_land_surface: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where land_surface is null



2021-01-28 15:51:19.221283 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:19.224540 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:19.228585 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:19.698635 (Thread-3): SQL status: OK in 0.76 seconds
2021-01-28 15:51:19.730568 (Thread-3): finished collecting timing info
2021-01-28 15:51:19.731859 (Thread-3): On test.subsurface.not_null_d_premises_types_premises_code: ROLLBACK
2021-01-28 15:51:19.732260 (Thread-3): On test.subsurface.not_null_d_premises_types_premises_code: Close
2021-01-28 15:51:19.734054 (Thread-3): 16:51:19 | 5 of 48 PASS not_null_d_premises_types_premises_code................. [PASS in 0.82s]
2021-01-28 15:51:19.734574 (Thread-3): Finished running node test.subsurface.not_null_d_premises_types_premises_code
2021-01-28 15:51:19.735114 (Thread-3): Began running node test.subsurface.not_null_f_land_values_lane
2021-01-28 15:51:19.735540 (Thread-1): Connected to db: None
2021-01-28 15:51:19.735950 (Thread-3): 16:51:19 | 9 of 48 START test not_null_f_land_values_lane....................... [RUN]
2021-01-28 15:51:19.738126 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-28 15:51:19.738565 (Thread-3): Compiling test.subsurface.not_null_f_land_values_lane
2021-01-28 15:51:19.764717 (Thread-4): Connected to db: None
2021-01-28 15:51:19.765266 (Thread-2): Connected to db: None
2021-01-28 15:51:19.781276 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane"
2021-01-28 15:51:19.783653 (Thread-3): finished collecting timing info
2021-01-28 15:51:19.784838 (Thread-3): Using dremio connection "test.subsurface.not_null_f_land_values_lane".
2021-01-28 15:51:19.785152 (Thread-3): On test.subsurface.not_null_f_land_values_lane: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane is null



2021-01-28 15:51:19.785469 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:51:19.785781 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:20.213961 (Thread-3): Connected to db: None
2021-01-28 15:51:26.802204 (Thread-1): SQL status: OK in 7.58 seconds
2021-01-28 15:51:26.858233 (Thread-1): finished collecting timing info
2021-01-28 15:51:26.858997 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: ROLLBACK
2021-01-28 15:51:26.859173 (Thread-1): On test.subsurface.not_null_f_land_values_crop_code: Close
2021-01-28 15:51:26.860162 (Thread-1): 16:51:26 | 7 of 48 PASS not_null_f_land_values_crop_code........................ [PASS in 7.74s]
2021-01-28 15:51:26.860406 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_crop_code
2021-01-28 15:51:26.860720 (Thread-1): Began running node test.subsurface.not_null_f_land_values_lane_code
2021-01-28 15:51:26.860929 (Thread-1): 16:51:26 | 10 of 48 START test not_null_f_land_values_lane_code................. [RUN]
2021-01-28 15:51:26.861342 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-28 15:51:26.866587 (Thread-1): Compiling test.subsurface.not_null_f_land_values_lane_code
2021-01-28 15:51:26.888494 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_code"
2021-01-28 15:51:26.889671 (Thread-1): finished collecting timing info
2021-01-28 15:51:26.890279 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_lane_code".
2021-01-28 15:51:26.890492 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane_code is null



2021-01-28 15:51:26.890664 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:51:26.890819 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:27.192816 (Thread-4): SQL status: OK in 7.97 seconds
2021-01-28 15:51:27.202092 (Thread-1): Connected to db: None
2021-01-28 15:51:27.232079 (Thread-4): finished collecting timing info
2021-01-28 15:51:27.232873 (Thread-4): On test.subsurface.not_null_f_land_values_built_surface: ROLLBACK
2021-01-28 15:51:27.233053 (Thread-4): On test.subsurface.not_null_f_land_values_built_surface: Close
2021-01-28 15:51:27.237237 (Thread-4): 16:51:27 | 6 of 48 PASS not_null_f_land_values_built_surface.................... [PASS in 8.13s]
2021-01-28 15:51:27.237579 (Thread-4): Finished running node test.subsurface.not_null_f_land_values_built_surface
2021-01-28 15:51:27.237880 (Thread-4): Began running node test.subsurface.not_null_f_land_values_lane_type
2021-01-28 15:51:27.238095 (Thread-4): 16:51:27 | 11 of 48 START test not_null_f_land_values_lane_type................. [RUN]
2021-01-28 15:51:27.238552 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-28 15:51:27.238755 (Thread-4): Compiling test.subsurface.not_null_f_land_values_lane_type
2021-01-28 15:51:27.272740 (Thread-2): SQL status: OK in 8.05 seconds
2021-01-28 15:51:27.280237 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lane_type"
2021-01-28 15:51:27.281497 (Thread-4): finished collecting timing info
2021-01-28 15:51:27.282682 (Thread-4): Using dremio connection "test.subsurface.not_null_f_land_values_lane_type".
2021-01-28 15:51:27.283008 (Thread-4): On test.subsurface.not_null_f_land_values_lane_type: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lane_type is null



2021-01-28 15:51:27.283347 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:27.283810 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:27.452027 (Thread-2): finished collecting timing info
2021-01-28 15:51:27.452808 (Thread-2): On test.subsurface.not_null_f_land_values_land_surface: ROLLBACK
2021-01-28 15:51:27.452999 (Thread-2): On test.subsurface.not_null_f_land_values_land_surface: Close
2021-01-28 15:51:27.454040 (Thread-2): 16:51:27 | 8 of 48 PASS not_null_f_land_values_land_surface..................... [PASS in 8.31s]
2021-01-28 15:51:27.454292 (Thread-2): Finished running node test.subsurface.not_null_f_land_values_land_surface
2021-01-28 15:51:27.454603 (Thread-2): Began running node test.subsurface.not_null_f_land_values_lots_count
2021-01-28 15:51:27.454823 (Thread-2): 16:51:27 | 12 of 48 START test not_null_f_land_values_lots_count................ [RUN]
2021-01-28 15:51:27.455231 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-28 15:51:27.455421 (Thread-2): Compiling test.subsurface.not_null_f_land_values_lots_count
2021-01-28 15:51:27.476151 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_f_land_values_lots_count"
2021-01-28 15:51:27.477273 (Thread-2): finished collecting timing info
2021-01-28 15:51:27.477866 (Thread-2): Using dremio connection "test.subsurface.not_null_f_land_values_lots_count".
2021-01-28 15:51:27.478030 (Thread-2): On test.subsurface.not_null_f_land_values_lots_count: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where lots_count is null



2021-01-28 15:51:27.478180 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:27.478327 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:27.654955 (Thread-4): Connected to db: None
2021-01-28 15:51:27.761937 (Thread-2): Connected to db: None
2021-01-28 15:51:31.561036 (Thread-3): SQL status: OK in 11.78 seconds
2021-01-28 15:51:31.619645 (Thread-3): finished collecting timing info
2021-01-28 15:51:31.620541 (Thread-3): On test.subsurface.not_null_f_land_values_lane: ROLLBACK
2021-01-28 15:51:31.620757 (Thread-3): On test.subsurface.not_null_f_land_values_lane: Close
2021-01-28 15:51:31.621899 (Thread-3): 16:51:31 | 9 of 48 PASS not_null_f_land_values_lane............................. [PASS in 11.88s]
2021-01-28 15:51:31.622203 (Thread-3): Finished running node test.subsurface.not_null_f_land_values_lane
2021-01-28 15:51:31.622555 (Thread-3): Began running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-28 15:51:31.622864 (Thread-3): 16:51:31 | 13 of 48 START test not_null_f_land_values_main_rooms_count.......... [RUN]
2021-01-28 15:51:31.623389 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-28 15:51:31.623647 (Thread-3): Compiling test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-28 15:51:31.647555 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_f_land_values_main_rooms_count"
2021-01-28 15:51:31.648390 (Thread-3): finished collecting timing info
2021-01-28 15:51:31.649081 (Thread-3): Using dremio connection "test.subsurface.not_null_f_land_values_main_rooms_count".
2021-01-28 15:51:31.649271 (Thread-3): On test.subsurface.not_null_f_land_values_main_rooms_count: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where main_rooms_count is null



2021-01-28 15:51:31.649480 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:51:31.649659 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:31.777042 (Thread-4): SQL status: OK in 4.49 seconds
2021-01-28 15:51:31.843883 (Thread-4): finished collecting timing info
2021-01-28 15:51:31.844801 (Thread-4): On test.subsurface.not_null_f_land_values_lane_type: ROLLBACK
2021-01-28 15:51:31.845021 (Thread-4): On test.subsurface.not_null_f_land_values_lane_type: Close
2021-01-28 15:51:31.846136 (Thread-4): 16:51:31 | 11 of 48 PASS not_null_f_land_values_lane_type....................... [PASS in 4.61s]
2021-01-28 15:51:31.846494 (Thread-4): Finished running node test.subsurface.not_null_f_land_values_lane_type
2021-01-28 15:51:31.846846 (Thread-4): Began running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-28 15:51:31.847120 (Thread-4): 16:51:31 | 14 of 48 START test not_null_f_land_values_municipality_code......... [RUN]
2021-01-28 15:51:31.847664 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-28 15:51:31.847900 (Thread-4): Compiling test.subsurface.not_null_f_land_values_municipality_code
2021-01-28 15:51:31.870547 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_f_land_values_municipality_code"
2021-01-28 15:51:31.871401 (Thread-4): finished collecting timing info
2021-01-28 15:51:31.872093 (Thread-4): Using dremio connection "test.subsurface.not_null_f_land_values_municipality_code".
2021-01-28 15:51:31.872287 (Thread-4): On test.subsurface.not_null_f_land_values_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where municipality_code is null



2021-01-28 15:51:31.872495 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:31.872681 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:32.099934 (Thread-3): Connected to db: None
2021-01-28 15:51:32.227850 (Thread-4): Connected to db: None
2021-01-28 15:51:34.411071 (Thread-1): SQL status: OK in 7.52 seconds
2021-01-28 15:51:34.577359 (Thread-1): finished collecting timing info
2021-01-28 15:51:34.578232 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: ROLLBACK
2021-01-28 15:51:34.578473 (Thread-1): On test.subsurface.not_null_f_land_values_lane_code: Close
2021-01-28 15:51:34.579630 (Thread-1): 16:51:34 | 10 of 48 PASS not_null_f_land_values_lane_code....................... [PASS in 7.72s]
2021-01-28 15:51:34.579921 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_lane_code
2021-01-28 15:51:34.580277 (Thread-1): Began running node test.subsurface.not_null_f_land_values_premises_code
2021-01-28 15:51:34.580552 (Thread-1): 16:51:34 | 15 of 48 START test not_null_f_land_values_premises_code............. [RUN]
2021-01-28 15:51:34.581056 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-28 15:51:34.581278 (Thread-1): Compiling test.subsurface.not_null_f_land_values_premises_code
2021-01-28 15:51:34.605307 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_premises_code"
2021-01-28 15:51:34.606252 (Thread-1): finished collecting timing info
2021-01-28 15:51:34.606955 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_premises_code".
2021-01-28 15:51:34.607170 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where premises_code is null



2021-01-28 15:51:34.607349 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:51:34.607559 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:35.020858 (Thread-1): Connected to db: None
2021-01-28 15:51:36.910776 (Thread-3): SQL status: OK in 5.26 seconds
2021-01-28 15:51:37.019046 (Thread-3): finished collecting timing info
2021-01-28 15:51:37.019800 (Thread-3): On test.subsurface.not_null_f_land_values_main_rooms_count: ROLLBACK
2021-01-28 15:51:37.019987 (Thread-3): On test.subsurface.not_null_f_land_values_main_rooms_count: Close
2021-01-28 15:51:37.021115 (Thread-3): 16:51:37 | 13 of 48 PASS not_null_f_land_values_main_rooms_count................ [PASS in 5.40s]
2021-01-28 15:51:37.021359 (Thread-3): Finished running node test.subsurface.not_null_f_land_values_main_rooms_count
2021-01-28 15:51:37.021696 (Thread-3): Began running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-28 15:51:37.022285 (Thread-3): 16:51:37 | 16 of 48 START test not_null_f_land_values_transaction_amount........ [RUN]
2021-01-28 15:51:37.022727 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-28 15:51:37.022919 (Thread-3): Compiling test.subsurface.not_null_f_land_values_transaction_amount
2021-01-28 15:51:37.044519 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_amount"
2021-01-28 15:51:37.045239 (Thread-3): finished collecting timing info
2021-01-28 15:51:37.045838 (Thread-3): Using dremio connection "test.subsurface.not_null_f_land_values_transaction_amount".
2021-01-28 15:51:37.046006 (Thread-3): On test.subsurface.not_null_f_land_values_transaction_amount: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transaction_amount is null



2021-01-28 15:51:37.046152 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:51:37.046292 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:37.247778 (Thread-3): Connected to db: None
2021-01-28 15:51:38.710237 (Thread-1): SQL status: OK in 4.10 seconds
2021-01-28 15:51:38.859316 (Thread-1): finished collecting timing info
2021-01-28 15:51:38.860154 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: ROLLBACK
2021-01-28 15:51:38.860345 (Thread-1): On test.subsurface.not_null_f_land_values_premises_code: Close
2021-01-28 15:51:38.864156 (Thread-1): 16:51:38 | 15 of 48 PASS not_null_f_land_values_premises_code................... [PASS in 4.28s]
2021-01-28 15:51:38.864428 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_premises_code
2021-01-28 15:51:38.864780 (Thread-1): Began running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-28 15:51:38.865010 (Thread-1): 16:51:38 | 17 of 48 START test not_null_f_land_values_transaction_date.......... [RUN]
2021-01-28 15:51:38.865488 (Thread-1): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-28 15:51:38.865710 (Thread-1): Compiling test.subsurface.not_null_f_land_values_transaction_date
2021-01-28 15:51:38.883081 (Thread-1): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transaction_date"
2021-01-28 15:51:38.883825 (Thread-1): finished collecting timing info
2021-01-28 15:51:38.884329 (Thread-1): Using dremio connection "test.subsurface.not_null_f_land_values_transaction_date".
2021-01-28 15:51:38.884501 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transaction_date is null



2021-01-28 15:51:38.884652 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:51:38.884791 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:39.178798 (Thread-1): Connected to db: None
2021-01-28 15:51:43.323749 (Thread-2): SQL status: OK in 15.85 seconds
2021-01-28 15:51:43.363190 (Thread-2): finished collecting timing info
2021-01-28 15:51:43.364002 (Thread-2): On test.subsurface.not_null_f_land_values_lots_count: ROLLBACK
2021-01-28 15:51:43.364182 (Thread-2): On test.subsurface.not_null_f_land_values_lots_count: Close
2021-01-28 15:51:43.365178 (Thread-2): 16:51:43 | 12 of 48 FAIL 1 not_null_f_land_values_lots_count.................... [FAIL 1 in 15.91s]
2021-01-28 15:51:43.365482 (Thread-2): Finished running node test.subsurface.not_null_f_land_values_lots_count
2021-01-28 15:51:43.365782 (Thread-2): Began running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-28 15:51:43.365999 (Thread-2): 16:51:43 | 18 of 48 START test not_null_f_land_values_transfer_label............ [RUN]
2021-01-28 15:51:43.366419 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-28 15:51:43.366642 (Thread-2): Compiling test.subsurface.not_null_f_land_values_transfer_label
2021-01-28 15:51:43.386605 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_f_land_values_transfer_label"
2021-01-28 15:51:43.387351 (Thread-2): finished collecting timing info
2021-01-28 15:51:43.388008 (Thread-2): Using dremio connection "test.subsurface.not_null_f_land_values_transfer_label".
2021-01-28 15:51:43.388171 (Thread-2): On test.subsurface.not_null_f_land_values_transfer_label: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where transfer_label is null



2021-01-28 15:51:43.388323 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:43.388499 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:43.577832 (Thread-2): Connected to db: None
2021-01-28 15:51:44.142751 (Thread-3): SQL status: OK in 7.10 seconds
2021-01-28 15:51:44.256401 (Thread-3): finished collecting timing info
2021-01-28 15:51:44.257187 (Thread-3): On test.subsurface.not_null_f_land_values_transaction_amount: ROLLBACK
2021-01-28 15:51:44.257365 (Thread-3): On test.subsurface.not_null_f_land_values_transaction_amount: Close
2021-01-28 15:51:44.258351 (Thread-3): 16:51:44 | 16 of 48 PASS not_null_f_land_values_transaction_amount.............. [PASS in 7.24s]
2021-01-28 15:51:44.258627 (Thread-3): Finished running node test.subsurface.not_null_f_land_values_transaction_amount
2021-01-28 15:51:44.258911 (Thread-3): Began running node test.subsurface.not_null_f_land_values_zip_code
2021-01-28 15:51:44.259137 (Thread-3): 16:51:44 | 19 of 48 START test not_null_f_land_values_zip_code.................. [RUN]
2021-01-28 15:51:44.259608 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-28 15:51:44.259803 (Thread-3): Compiling test.subsurface.not_null_f_land_values_zip_code
2021-01-28 15:51:44.279846 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_f_land_values_zip_code"
2021-01-28 15:51:44.280564 (Thread-2): SQL status: OK in 0.89 seconds
2021-01-28 15:51:44.281474 (Thread-3): finished collecting timing info
2021-01-28 15:51:44.281995 (Thread-3): Using dremio connection "test.subsurface.not_null_f_land_values_zip_code".
2021-01-28 15:51:44.282153 (Thread-3): On test.subsurface.not_null_f_land_values_zip_code: 
    
    



select count(*) as validation_errors
from "@fab4"."f_land_values"
where zip_code is null



2021-01-28 15:51:44.282310 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:51:44.282482 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:44.406084 (Thread-2): finished collecting timing info
2021-01-28 15:51:44.406877 (Thread-2): On test.subsurface.not_null_f_land_values_transfer_label: ROLLBACK
2021-01-28 15:51:44.407055 (Thread-2): On test.subsurface.not_null_f_land_values_transfer_label: Close
2021-01-28 15:51:44.408034 (Thread-2): 16:51:44 | 18 of 48 PASS not_null_f_land_values_transfer_label.................. [PASS in 1.04s]
2021-01-28 15:51:44.408276 (Thread-2): Finished running node test.subsurface.not_null_f_land_values_transfer_label
2021-01-28 15:51:44.408592 (Thread-2): Began running node test.subsurface.not_null_premises_types_premises_code
2021-01-28 15:51:44.408814 (Thread-2): 16:51:44 | 20 of 48 START test not_null_premises_types_premises_code............ [RUN]
2021-01-28 15:51:44.409229 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-28 15:51:44.409420 (Thread-2): Compiling test.subsurface.not_null_premises_types_premises_code
2021-01-28 15:51:44.428918 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_code"
2021-01-28 15:51:44.429679 (Thread-2): finished collecting timing info
2021-01-28 15:51:44.430242 (Thread-2): Using dremio connection "test.subsurface.not_null_premises_types_premises_code".
2021-01-28 15:51:44.430403 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_code is null



2021-01-28 15:51:44.430596 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:44.430741 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:44.601664 (Thread-3): Connected to db: None
2021-01-28 15:51:44.628827 (Thread-2): Connected to db: None
2021-01-28 15:51:44.880788 (Thread-2): SQL status: OK in 0.45 seconds
2021-01-28 15:51:44.995871 (Thread-2): finished collecting timing info
2021-01-28 15:51:44.996636 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: ROLLBACK
2021-01-28 15:51:44.996816 (Thread-2): On test.subsurface.not_null_premises_types_premises_code: Close
2021-01-28 15:51:44.997797 (Thread-2): 16:51:44 | 20 of 48 PASS not_null_premises_types_premises_code.................. [PASS in 0.59s]
2021-01-28 15:51:44.998046 (Thread-2): Finished running node test.subsurface.not_null_premises_types_premises_code
2021-01-28 15:51:44.998330 (Thread-2): Began running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-28 15:51:44.999546 (Thread-2): 16:51:44 | 21 of 48 START test not_null_premises_types_premises_label_en........ [RUN]
2021-01-28 15:51:44.999982 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-28 15:51:45.000173 (Thread-2): Compiling test.subsurface.not_null_premises_types_premises_label_en
2021-01-28 15:51:45.021443 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_en"
2021-01-28 15:51:45.022204 (Thread-2): finished collecting timing info
2021-01-28 15:51:45.022812 (Thread-2): Using dremio connection "test.subsurface.not_null_premises_types_premises_label_en".
2021-01-28 15:51:45.022980 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_en: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_label_en is null



2021-01-28 15:51:45.023128 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:45.023271 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:45.236839 (Thread-2): Connected to db: None
2021-01-28 15:51:45.865764 (Thread-2): SQL status: OK in 0.84 seconds
2021-01-28 15:51:45.928093 (Thread-2): finished collecting timing info
2021-01-28 15:51:45.928875 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_en: ROLLBACK
2021-01-28 15:51:45.929052 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_en: Close
2021-01-28 15:51:45.930877 (Thread-2): 16:51:45 | 21 of 48 PASS not_null_premises_types_premises_label_en.............. [PASS in 0.93s]
2021-01-28 15:51:45.931127 (Thread-2): Finished running node test.subsurface.not_null_premises_types_premises_label_en
2021-01-28 15:51:45.931473 (Thread-2): Began running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-28 15:51:45.931990 (Thread-2): 16:51:45 | 22 of 48 START test not_null_premises_types_premises_label_fr........ [RUN]
2021-01-28 15:51:45.932414 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-28 15:51:45.932651 (Thread-2): Compiling test.subsurface.not_null_premises_types_premises_label_fr
2021-01-28 15:51:45.949615 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_premises_types_premises_label_fr"
2021-01-28 15:51:45.950328 (Thread-2): finished collecting timing info
2021-01-28 15:51:45.950983 (Thread-2): Using dremio connection "test.subsurface.not_null_premises_types_premises_label_fr".
2021-01-28 15:51:45.951144 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."premises_types"
where premises_label_fr is null



2021-01-28 15:51:45.951291 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:45.951511 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:46.319839 (Thread-2): Connected to db: None
2021-01-28 15:51:46.843800 (Thread-4): SQL status: OK in 14.97 seconds
2021-01-28 15:51:46.922785 (Thread-2): SQL status: OK in 0.97 seconds
2021-01-28 15:51:46.975330 (Thread-4): finished collecting timing info
2021-01-28 15:51:46.976166 (Thread-4): On test.subsurface.not_null_f_land_values_municipality_code: ROLLBACK
2021-01-28 15:51:46.976382 (Thread-4): On test.subsurface.not_null_f_land_values_municipality_code: Close
2021-01-28 15:51:46.980317 (Thread-4): 16:51:46 | 14 of 48 PASS not_null_f_land_values_municipality_code............... [PASS in 15.13s]
2021-01-28 15:51:46.980608 (Thread-4): Finished running node test.subsurface.not_null_f_land_values_municipality_code
2021-01-28 15:51:46.980908 (Thread-4): Began running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-28 15:51:46.981245 (Thread-4): 16:51:46 | 23 of 48 START test not_null_stg__land_values_lots_count............. [RUN]
2021-01-28 15:51:46.981747 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-28 15:51:46.981985 (Thread-4): Compiling test.subsurface.not_null_stg__land_values_lots_count
2021-01-28 15:51:47.000072 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_lots_count"
2021-01-28 15:51:47.000884 (Thread-4): finished collecting timing info
2021-01-28 15:51:47.001501 (Thread-4): Using dremio connection "test.subsurface.not_null_stg__land_values_lots_count".
2021-01-28 15:51:47.001695 (Thread-4): On test.subsurface.not_null_stg__land_values_lots_count: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where lots_count is null



2021-01-28 15:51:47.001879 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:47.002034 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:47.293073 (Thread-2): finished collecting timing info
2021-01-28 15:51:47.293876 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_fr: ROLLBACK
2021-01-28 15:51:47.294069 (Thread-2): On test.subsurface.not_null_premises_types_premises_label_fr: Close
2021-01-28 15:51:47.295323 (Thread-2): 16:51:47 | 22 of 48 PASS not_null_premises_types_premises_label_fr.............. [PASS in 1.36s]
2021-01-28 15:51:47.295604 (Thread-2): Finished running node test.subsurface.not_null_premises_types_premises_label_fr
2021-01-28 15:51:47.295907 (Thread-2): Began running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-28 15:51:47.296150 (Thread-2): 16:51:47 | 24 of 48 START test not_null_stg__land_values_municipality_code...... [RUN]
2021-01-28 15:51:47.296631 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-28 15:51:47.296869 (Thread-2): Compiling test.subsurface.not_null_stg__land_values_municipality_code
2021-01-28 15:51:47.315137 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_municipality_code"
2021-01-28 15:51:47.315970 (Thread-2): finished collecting timing info
2021-01-28 15:51:47.316663 (Thread-2): Using dremio connection "test.subsurface.not_null_stg__land_values_municipality_code".
2021-01-28 15:51:47.316850 (Thread-2): On test.subsurface.not_null_stg__land_values_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where municipality_code is null



2021-01-28 15:51:47.317019 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:47.317175 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:47.595971 (Thread-4): Connected to db: None
2021-01-28 15:51:47.636041 (Thread-2): Connected to db: None
2021-01-28 15:51:50.346989 (Thread-3): SQL status: OK in 6.06 seconds
2021-01-28 15:51:50.446254 (Thread-3): finished collecting timing info
2021-01-28 15:51:50.447062 (Thread-3): On test.subsurface.not_null_f_land_values_zip_code: ROLLBACK
2021-01-28 15:51:50.447249 (Thread-3): On test.subsurface.not_null_f_land_values_zip_code: Close
2021-01-28 15:51:50.448246 (Thread-3): 16:51:50 | 19 of 48 PASS not_null_f_land_values_zip_code........................ [PASS in 6.19s]
2021-01-28 15:51:50.448528 (Thread-3): Finished running node test.subsurface.not_null_f_land_values_zip_code
2021-01-28 15:51:50.448821 (Thread-3): Began running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-28 15:51:50.449046 (Thread-3): 16:51:50 | 25 of 48 START test not_null_stg__land_values_transaction_date....... [RUN]
2021-01-28 15:51:50.449494 (Thread-3): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-28 15:51:50.449721 (Thread-3): Compiling test.subsurface.not_null_stg__land_values_transaction_date
2021-01-28 15:51:50.471514 (Thread-3): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transaction_date"
2021-01-28 15:51:50.472234 (Thread-3): finished collecting timing info
2021-01-28 15:51:50.472845 (Thread-3): Using dremio connection "test.subsurface.not_null_stg__land_values_transaction_date".
2021-01-28 15:51:50.473014 (Thread-3): On test.subsurface.not_null_stg__land_values_transaction_date: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transaction_date is null



2021-01-28 15:51:50.473164 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:51:50.473316 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:50.833826 (Thread-3): Connected to db: None
2021-01-28 15:51:54.146790 (Thread-2): SQL status: OK in 6.83 seconds
2021-01-28 15:51:54.258077 (Thread-2): finished collecting timing info
2021-01-28 15:51:54.258870 (Thread-2): On test.subsurface.not_null_stg__land_values_municipality_code: ROLLBACK
2021-01-28 15:51:54.259048 (Thread-2): On test.subsurface.not_null_stg__land_values_municipality_code: Close
2021-01-28 15:51:54.260977 (Thread-2): 16:51:54 | 24 of 48 PASS not_null_stg__land_values_municipality_code............ [PASS in 6.96s]
2021-01-28 15:51:54.261231 (Thread-2): Finished running node test.subsurface.not_null_stg__land_values_municipality_code
2021-01-28 15:51:54.261535 (Thread-2): Began running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-28 15:51:54.261753 (Thread-2): 16:51:54 | 26 of 48 START test not_null_stg__land_values_transfer_label_fr...... [RUN]
2021-01-28 15:51:54.262161 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-28 15:51:54.262350 (Thread-2): Compiling test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-28 15:51:54.280372 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__land_values_transfer_label_fr"
2021-01-28 15:51:54.281120 (Thread-2): finished collecting timing info
2021-01-28 15:51:54.281676 (Thread-2): Using dremio connection "test.subsurface.not_null_stg__land_values_transfer_label_fr".
2021-01-28 15:51:54.281837 (Thread-2): On test.subsurface.not_null_stg__land_values_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__land_values"
where transfer_label_fr is null



2021-01-28 15:51:54.281991 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:54.282131 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:54.600840 (Thread-2): Connected to db: None
2021-01-28 15:51:54.968794 (Thread-4): SQL status: OK in 7.97 seconds
2021-01-28 15:51:55.054142 (Thread-4): finished collecting timing info
2021-01-28 15:51:55.055035 (Thread-4): On test.subsurface.not_null_stg__land_values_lots_count: ROLLBACK
2021-01-28 15:51:55.055247 (Thread-4): On test.subsurface.not_null_stg__land_values_lots_count: Close
2021-01-28 15:51:55.056421 (Thread-4): 16:51:55 | 23 of 48 FAIL 1 not_null_stg__land_values_lots_count................. [FAIL 1 in 8.07s]
2021-01-28 15:51:55.056752 (Thread-4): Finished running node test.subsurface.not_null_stg__land_values_lots_count
2021-01-28 15:51:55.057101 (Thread-4): Began running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-28 15:51:55.057358 (Thread-4): 16:51:55 | 27 of 48 START test not_null_stg__municipalities_department_code..... [RUN]
2021-01-28 15:51:55.057907 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-28 15:51:55.058132 (Thread-4): Compiling test.subsurface.not_null_stg__municipalities_department_code
2021-01-28 15:51:55.088084 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_code"
2021-01-28 15:51:55.088995 (Thread-4): finished collecting timing info
2021-01-28 15:51:55.089794 (Thread-4): Using dremio connection "test.subsurface.not_null_stg__municipalities_department_code".
2021-01-28 15:51:55.089998 (Thread-4): On test.subsurface.not_null_stg__municipalities_department_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where department_code is null



2021-01-28 15:51:55.090178 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:55.090354 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:55.353828 (Thread-4): Connected to db: None
2021-01-28 15:51:55.943801 (Thread-4): SQL status: OK in 0.85 seconds
2021-01-28 15:51:56.001023 (Thread-4): finished collecting timing info
2021-01-28 15:51:56.001787 (Thread-4): On test.subsurface.not_null_stg__municipalities_department_code: ROLLBACK
2021-01-28 15:51:56.001963 (Thread-4): On test.subsurface.not_null_stg__municipalities_department_code: Close
2021-01-28 15:51:56.005099 (Thread-4): 16:51:56 | 27 of 48 PASS not_null_stg__municipalities_department_code........... [PASS in 0.95s]
2021-01-28 15:51:56.005348 (Thread-4): Finished running node test.subsurface.not_null_stg__municipalities_department_code
2021-01-28 15:51:56.005653 (Thread-4): Began running node test.subsurface.not_null_stg__municipalities_department_label
2021-01-28 15:51:56.005866 (Thread-4): 16:51:56 | 28 of 48 START test not_null_stg__municipalities_department_label.... [RUN]
2021-01-28 15:51:56.006264 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_department_label".
2021-01-28 15:51:56.006476 (Thread-4): Compiling test.subsurface.not_null_stg__municipalities_department_label
2021-01-28 15:51:56.025849 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_department_label"
2021-01-28 15:51:56.027081 (Thread-4): finished collecting timing info
2021-01-28 15:51:56.027661 (Thread-4): Using dremio connection "test.subsurface.not_null_stg__municipalities_department_label".
2021-01-28 15:51:56.027815 (Thread-4): On test.subsurface.not_null_stg__municipalities_department_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where department_label is null



2021-01-28 15:51:56.027964 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:56.028103 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:56.222788 (Thread-2): SQL status: OK in 1.94 seconds
2021-01-28 15:51:56.247788 (Thread-2): finished collecting timing info
2021-01-28 15:51:56.248555 (Thread-2): On test.subsurface.not_null_stg__land_values_transfer_label_fr: ROLLBACK
2021-01-28 15:51:56.248755 (Thread-2): On test.subsurface.not_null_stg__land_values_transfer_label_fr: Close
2021-01-28 15:51:56.250680 (Thread-2): 16:51:56 | 26 of 48 PASS not_null_stg__land_values_transfer_label_fr............ [PASS in 1.99s]
2021-01-28 15:51:56.250928 (Thread-2): Finished running node test.subsurface.not_null_stg__land_values_transfer_label_fr
2021-01-28 15:51:56.251209 (Thread-2): Began running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-28 15:51:56.251420 (Thread-2): 16:51:56 | 29 of 48 START test not_null_stg__municipalities_municipality_code... [RUN]
2021-01-28 15:51:56.251876 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-28 15:51:56.252068 (Thread-2): Compiling test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-28 15:51:56.270517 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_code"
2021-01-28 15:51:56.271229 (Thread-2): finished collecting timing info
2021-01-28 15:51:56.271832 (Thread-2): Using dremio connection "test.subsurface.not_null_stg__municipalities_municipality_code".
2021-01-28 15:51:56.271992 (Thread-2): On test.subsurface.not_null_stg__municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where municipality_code is null



2021-01-28 15:51:56.272135 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:56.272276 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:56.385685 (Thread-4): Connected to db: None
2021-01-28 15:51:56.515455 (Thread-2): Connected to db: None
2021-01-28 15:51:56.800972 (Thread-2): SQL status: OK in 0.53 seconds
2021-01-28 15:51:56.836909 (Thread-4): SQL status: OK in 0.81 seconds
2021-01-28 15:51:56.921250 (Thread-4): finished collecting timing info
2021-01-28 15:51:56.922027 (Thread-4): On test.subsurface.not_null_stg__municipalities_department_label: ROLLBACK
2021-01-28 15:51:56.922205 (Thread-4): On test.subsurface.not_null_stg__municipalities_department_label: Close
2021-01-28 15:51:56.923167 (Thread-4): 16:51:56 | 28 of 48 PASS not_null_stg__municipalities_department_label.......... [PASS in 0.92s]
2021-01-28 15:51:56.923458 (Thread-4): Finished running node test.subsurface.not_null_stg__municipalities_department_label
2021-01-28 15:51:56.923757 (Thread-4): Began running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-28 15:51:56.923977 (Thread-4): 16:51:56 | 30 of 48 START test not_null_stg__municipalities_municipality_label.. [RUN]
2021-01-28 15:51:56.924381 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-28 15:51:56.924594 (Thread-4): Compiling test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-28 15:51:56.934268 (Thread-2): finished collecting timing info
2021-01-28 15:51:56.934851 (Thread-2): On test.subsurface.not_null_stg__municipalities_municipality_code: ROLLBACK
2021-01-28 15:51:56.935022 (Thread-2): On test.subsurface.not_null_stg__municipalities_municipality_code: Close
2021-01-28 15:51:56.935882 (Thread-2): 16:51:56 | 29 of 48 PASS not_null_stg__municipalities_municipality_code......... [PASS in 0.68s]
2021-01-28 15:51:56.936115 (Thread-2): Finished running node test.subsurface.not_null_stg__municipalities_municipality_code
2021-01-28 15:51:56.936379 (Thread-2): Began running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-28 15:51:56.936619 (Thread-2): 16:51:56 | 31 of 48 START test not_null_stg__municipalities_region_code......... [RUN]
2021-01-28 15:51:56.937025 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-28 15:51:56.937205 (Thread-2): Compiling test.subsurface.not_null_stg__municipalities_region_code
2021-01-28 15:51:56.958232 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_municipality_label"
2021-01-28 15:51:56.969932 (Thread-4): finished collecting timing info
2021-01-28 15:51:56.970527 (Thread-4): Using dremio connection "test.subsurface.not_null_stg__municipalities_municipality_label".
2021-01-28 15:51:56.970697 (Thread-4): On test.subsurface.not_null_stg__municipalities_municipality_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where municipality_label is null



2021-01-28 15:51:56.970847 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:56.970992 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:56.969214 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_code"
2021-01-28 15:51:56.972871 (Thread-2): finished collecting timing info
2021-01-28 15:51:56.973320 (Thread-2): Using dremio connection "test.subsurface.not_null_stg__municipalities_region_code".
2021-01-28 15:51:56.973515 (Thread-2): On test.subsurface.not_null_stg__municipalities_region_code: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where region_code is null



2021-01-28 15:51:56.973671 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:56.973806 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:57.307029 (Thread-2): Connected to db: None
2021-01-28 15:51:57.314831 (Thread-4): Connected to db: None
2021-01-28 15:51:57.666989 (Thread-4): SQL status: OK in 0.70 seconds
2021-01-28 15:51:57.729224 (Thread-4): finished collecting timing info
2021-01-28 15:51:57.729999 (Thread-4): On test.subsurface.not_null_stg__municipalities_municipality_label: ROLLBACK
2021-01-28 15:51:57.730176 (Thread-4): On test.subsurface.not_null_stg__municipalities_municipality_label: Close
2021-01-28 15:51:57.731132 (Thread-4): 16:51:57 | 30 of 48 PASS not_null_stg__municipalities_municipality_label........ [PASS in 0.81s]
2021-01-28 15:51:57.731378 (Thread-4): Finished running node test.subsurface.not_null_stg__municipalities_municipality_label
2021-01-28 15:51:57.731697 (Thread-4): Began running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-28 15:51:57.731910 (Thread-4): 16:51:57 | 32 of 48 START test not_null_stg__municipalities_region_label........ [RUN]
2021-01-28 15:51:57.732337 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-28 15:51:57.732543 (Thread-4): Compiling test.subsurface.not_null_stg__municipalities_region_label
2021-01-28 15:51:57.752533 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_stg__municipalities_region_label"
2021-01-28 15:51:57.753278 (Thread-4): finished collecting timing info
2021-01-28 15:51:57.753859 (Thread-4): Using dremio connection "test.subsurface.not_null_stg__municipalities_region_label".
2021-01-28 15:51:57.754028 (Thread-4): On test.subsurface.not_null_stg__municipalities_region_label: 
    
    



select count(*) as validation_errors
from "@fab4"."stg__municipalities"
where region_label is null



2021-01-28 15:51:57.754175 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:57.754317 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:57.922762 (Thread-2): SQL status: OK in 0.95 seconds
2021-01-28 15:51:58.028049 (Thread-2): finished collecting timing info
2021-01-28 15:51:58.028828 (Thread-2): On test.subsurface.not_null_stg__municipalities_region_code: ROLLBACK
2021-01-28 15:51:58.029005 (Thread-2): On test.subsurface.not_null_stg__municipalities_region_code: Close
2021-01-28 15:51:58.033161 (Thread-2): 16:51:58 | 31 of 48 PASS not_null_stg__municipalities_region_code............... [PASS in 1.10s]
2021-01-28 15:51:58.033420 (Thread-2): Finished running node test.subsurface.not_null_stg__municipalities_region_code
2021-01-28 15:51:58.033745 (Thread-2): Began running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-28 15:51:58.033967 (Thread-2): 16:51:58 | 33 of 48 START test not_null_transfer_types_transfer_label_en........ [RUN]
2021-01-28 15:51:58.034374 (Thread-2): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-28 15:51:58.034586 (Thread-2): Compiling test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-28 15:51:58.051945 (Thread-2): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_en"
2021-01-28 15:51:58.052609 (Thread-2): finished collecting timing info
2021-01-28 15:51:58.053101 (Thread-2): Using dremio connection "test.subsurface.not_null_transfer_types_transfer_label_en".
2021-01-28 15:51:58.053286 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: 
    
    



select count(*) as validation_errors
from "@fab4"."transfer_types"
where transfer_label_en is null



2021-01-28 15:51:58.053430 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:58.053630 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:58.216823 (Thread-4): Connected to db: None
2021-01-28 15:51:58.347827 (Thread-2): Connected to db: None
2021-01-28 15:51:58.527766 (Thread-4): SQL status: OK in 0.77 seconds
2021-01-28 15:51:58.566782 (Thread-2): SQL status: OK in 0.51 seconds
2021-01-28 15:51:58.621064 (Thread-4): finished collecting timing info
2021-01-28 15:51:58.621856 (Thread-4): On test.subsurface.not_null_stg__municipalities_region_label: ROLLBACK
2021-01-28 15:51:58.622035 (Thread-4): On test.subsurface.not_null_stg__municipalities_region_label: Close
2021-01-28 15:51:58.626220 (Thread-4): 16:51:58 | 32 of 48 PASS not_null_stg__municipalities_region_label.............. [PASS in 0.89s]
2021-01-28 15:51:58.626534 (Thread-4): Finished running node test.subsurface.not_null_stg__municipalities_region_label
2021-01-28 15:51:58.626839 (Thread-4): Began running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-28 15:51:58.627062 (Thread-4): 16:51:58 | 34 of 48 START test not_null_transfer_types_transfer_label_fr........ [RUN]
2021-01-28 15:51:58.627509 (Thread-4): Acquiring new dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-28 15:51:58.627717 (Thread-4): Compiling test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-28 15:51:58.650476 (Thread-4): Writing injected SQL for node "test.subsurface.not_null_transfer_types_transfer_label_fr"
2021-01-28 15:51:58.651194 (Thread-4): finished collecting timing info
2021-01-28 15:51:58.652187 (Thread-4): Using dremio connection "test.subsurface.not_null_transfer_types_transfer_label_fr".
2021-01-28 15:51:58.652351 (Thread-4): On test.subsurface.not_null_transfer_types_transfer_label_fr: 
    
    



select count(*) as validation_errors
from "@fab4"."transfer_types"
where transfer_label_fr is null



2021-01-28 15:51:58.652528 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:58.652676 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:58.653379 (Thread-2): finished collecting timing info
2021-01-28 15:51:58.653906 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: ROLLBACK
2021-01-28 15:51:58.654088 (Thread-2): On test.subsurface.not_null_transfer_types_transfer_label_en: Close
2021-01-28 15:51:58.655030 (Thread-2): 16:51:58 | 33 of 48 PASS not_null_transfer_types_transfer_label_en.............. [PASS in 0.62s]
2021-01-28 15:51:58.655271 (Thread-2): Finished running node test.subsurface.not_null_transfer_types_transfer_label_en
2021-01-28 15:51:58.655571 (Thread-2): Began running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-28 15:51:58.655785 (Thread-2): 16:51:58 | 35 of 48 START test relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_ [RUN]
2021-01-28 15:51:58.656215 (Thread-2): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-28 15:51:58.656741 (Thread-2): Compiling test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-28 15:51:58.676852 (Thread-2): Writing injected SQL for node "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_"
2021-01-28 15:51:58.677600 (Thread-2): finished collecting timing info
2021-01-28 15:51:58.678127 (Thread-2): Using dremio connection "test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_".
2021-01-28 15:51:58.678322 (Thread-2): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: 
    
    




select count(*) as validation_errors
from (
    select crop_code as id from "@fab4"."f_land_values"
) as child
left join (
    select crop_code as id from "@fab4"."d_crop_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-28 15:51:58.678493 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:51:58.678643 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:59.001504 (Thread-2): Connected to db: None
2021-01-28 15:51:59.020824 (Thread-4): Connected to db: None
2021-01-28 15:51:59.367786 (Thread-4): SQL status: OK in 0.72 seconds
2021-01-28 15:51:59.425617 (Thread-4): finished collecting timing info
2021-01-28 15:51:59.426364 (Thread-4): On test.subsurface.not_null_transfer_types_transfer_label_fr: ROLLBACK
2021-01-28 15:51:59.426560 (Thread-4): On test.subsurface.not_null_transfer_types_transfer_label_fr: Close
2021-01-28 15:51:59.427486 (Thread-4): 16:51:59 | 34 of 48 PASS not_null_transfer_types_transfer_label_fr.............. [PASS in 0.80s]
2021-01-28 15:51:59.427731 (Thread-4): Finished running node test.subsurface.not_null_transfer_types_transfer_label_fr
2021-01-28 15:51:59.428014 (Thread-4): Began running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-28 15:51:59.428224 (Thread-4): 16:51:59 | 36 of 48 START test relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_ [RUN]
2021-01-28 15:51:59.428670 (Thread-4): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-28 15:51:59.428863 (Thread-4): Compiling test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-28 15:51:59.452041 (Thread-4): Writing injected SQL for node "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_"
2021-01-28 15:51:59.452798 (Thread-4): finished collecting timing info
2021-01-28 15:51:59.453318 (Thread-4): Using dremio connection "test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_".
2021-01-28 15:51:59.453543 (Thread-4): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: 
    
    




select count(*) as validation_errors
from (
    select municipality_code as id from "@fab4"."f_land_values"
) as child
left join (
    select municipality_code as id from "@fab4"."d_municipalities"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-28 15:51:59.453697 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:51:59.453877 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:51:59.662810 (Thread-4): Connected to db: None
2021-01-28 15:52:01.047587 (Thread-1): SQL status: OK in 22.16 seconds
2021-01-28 15:52:01.095601 (Thread-1): finished collecting timing info
2021-01-28 15:52:01.096858 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: ROLLBACK
2021-01-28 15:52:01.097206 (Thread-1): On test.subsurface.not_null_f_land_values_transaction_date: Close
2021-01-28 15:52:01.098837 (Thread-1): 16:52:01 | 17 of 48 PASS not_null_f_land_values_transaction_date................ [PASS in 22.23s]
2021-01-28 15:52:01.099282 (Thread-1): Finished running node test.subsurface.not_null_f_land_values_transaction_date
2021-01-28 15:52:01.099826 (Thread-1): Began running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-28 15:52:01.100245 (Thread-1): 16:52:01 | 37 of 48 START test relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_ [RUN]
2021-01-28 15:52:01.101070 (Thread-1): Acquiring new dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-28 15:52:01.101419 (Thread-1): Compiling test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-28 15:52:01.132511 (Thread-1): Writing injected SQL for node "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_"
2021-01-28 15:52:01.133416 (Thread-1): finished collecting timing info
2021-01-28 15:52:01.134116 (Thread-1): Using dremio connection "test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_".
2021-01-28 15:52:01.134291 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: 
    
    




select count(*) as validation_errors
from (
    select premises_code as id from "@fab4"."f_land_values"
) as child
left join (
    select premises_code as id from "@fab4"."d_premises_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-28 15:52:01.134501 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:52:01.134670 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:01.392820 (Thread-1): Connected to db: None
2021-01-28 15:52:08.222271 (Thread-2): SQL status: OK in 9.54 seconds
2021-01-28 15:52:08.265625 (Thread-2): finished collecting timing info
2021-01-28 15:52:08.266372 (Thread-2): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: ROLLBACK
2021-01-28 15:52:08.266573 (Thread-2): On test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_: Close
2021-01-28 15:52:08.267601 (Thread-2): 16:52:08 | 35 of 48 PASS relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_ [PASS in 9.61s]
2021-01-28 15:52:08.267850 (Thread-2): Finished running node test.subsurface.relationships_f_land_values_crop_code__crop_code__ref_d_crop_types_
2021-01-28 15:52:08.268134 (Thread-2): Began running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-28 15:52:08.268358 (Thread-2): 16:52:08 | 38 of 48 START test relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_ [RUN]
2021-01-28 15:52:08.268798 (Thread-2): Acquiring new dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-28 15:52:08.268990 (Thread-2): Compiling test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-28 15:52:08.295428 (Thread-2): Writing injected SQL for node "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_"
2021-01-28 15:52:08.296226 (Thread-2): finished collecting timing info
2021-01-28 15:52:08.296838 (Thread-2): Using dremio connection "test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_".
2021-01-28 15:52:08.297004 (Thread-2): On test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_: 
    
    




select count(*) as validation_errors
from (
    select transfer_label_fr as id from "@fab4"."stg__land_values"
) as child
left join (
    select transfer_label_fr as id from "@fab4"."transfer_types"
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-01-28 15:52:08.297152 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:52:08.297294 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:08.425486 (Thread-2): Connected to db: None
2021-01-28 15:52:08.479953 (Thread-3): SQL status: OK in 18.01 seconds
2021-01-28 15:52:08.526034 (Thread-3): finished collecting timing info
2021-01-28 15:52:08.526785 (Thread-3): On test.subsurface.not_null_stg__land_values_transaction_date: ROLLBACK
2021-01-28 15:52:08.526973 (Thread-3): On test.subsurface.not_null_stg__land_values_transaction_date: Close
2021-01-28 15:52:08.527897 (Thread-3): 16:52:08 | 25 of 48 PASS not_null_stg__land_values_transaction_date............. [PASS in 18.08s]
2021-01-28 15:52:08.528147 (Thread-3): Finished running node test.subsurface.not_null_stg__land_values_transaction_date
2021-01-28 15:52:08.528449 (Thread-3): Began running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-28 15:52:08.528708 (Thread-3): 16:52:08 | 39 of 48 START test stg__land_values_built_surface_implies_premises_code [RUN]
2021-01-28 15:52:08.529422 (Thread-3): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:52:08.529680 (Thread-3): Compiling test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-28 15:52:08.556270 (Thread-3): Writing injected SQL for node "test.subsurface.stg__land_values_built_surface_implies_premises_code"
2021-01-28 15:52:08.557147 (Thread-3): finished collecting timing info
2021-01-28 15:52:08.557756 (Thread-3): Using dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:52:08.557921 (Thread-3): On test.subsurface.stg__land_values_built_surface_implies_premises_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  built_surface is not null
  and premises_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-28 15:52:08.558072 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:52:08.558215 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:08.774938 (Thread-3): Connected to db: None
2021-01-28 15:52:09.004770 (Thread-1): SQL status: OK in 7.87 seconds
2021-01-28 15:52:09.069093 (Thread-1): finished collecting timing info
2021-01-28 15:52:09.069871 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: ROLLBACK
2021-01-28 15:52:09.070076 (Thread-1): On test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_: Close
2021-01-28 15:52:09.074247 (Thread-1): 16:52:09 | 37 of 48 PASS relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_ [PASS in 7.97s]
2021-01-28 15:52:09.074546 (Thread-1): Finished running node test.subsurface.relationships_f_land_values_premises_code__premises_code__ref_d_premises_types_
2021-01-28 15:52:09.074841 (Thread-1): Began running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-28 15:52:09.075056 (Thread-1): 16:52:09 | 40 of 48 START test stg__land_values_land_surface_implies_crop_code.. [RUN]
2021-01-28 15:52:09.075516 (Thread-1): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:52:09.075719 (Thread-1): Compiling test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-28 15:52:09.095251 (Thread-1): Writing injected SQL for node "test.subsurface.stg__land_values_land_surface_implies_crop_code"
2021-01-28 15:52:09.096073 (Thread-1): finished collecting timing info
2021-01-28 15:52:09.096672 (Thread-1): Using dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:52:09.096839 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: 
with dbt__CTE__INTERNAL_test as (
select
  *
from
  "@fab4"."stg__land_values"
where
  land_surface is not null
  and crop_code is null
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-28 15:52:09.096989 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:52:09.097134 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:09.275927 (Thread-1): Connected to db: None
2021-01-28 15:52:11.430990 (Thread-2): SQL status: OK in 3.13 seconds
2021-01-28 15:52:11.446048 (Thread-2): finished collecting timing info
2021-01-28 15:52:11.446833 (Thread-2): On test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_: ROLLBACK
2021-01-28 15:52:11.447023 (Thread-2): On test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_: Close
2021-01-28 15:52:11.449583 (Thread-2): 16:52:11 | 38 of 48 PASS relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_ [PASS in 3.18s]
2021-01-28 15:52:11.449874 (Thread-2): Finished running node test.subsurface.relationships_stg__land_values_transfer_label_fr__transfer_label_fr__ref_transfer_types_
2021-01-28 15:52:11.450164 (Thread-2): Began running node test.subsurface.unique_crop_types_crop_code
2021-01-28 15:52:11.450377 (Thread-2): 16:52:11 | 41 of 48 START test unique_crop_types_crop_code...................... [RUN]
2021-01-28 15:52:11.450820 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-28 15:52:11.451022 (Thread-2): Compiling test.subsurface.unique_crop_types_crop_code
2021-01-28 15:52:11.468549 (Thread-2): Writing injected SQL for node "test.subsurface.unique_crop_types_crop_code"
2021-01-28 15:52:11.469240 (Thread-2): finished collecting timing info
2021-01-28 15:52:11.469836 (Thread-2): Using dremio connection "test.subsurface.unique_crop_types_crop_code".
2021-01-28 15:52:11.470001 (Thread-2): On test.subsurface.unique_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from (

    select
        crop_code

    from "@fab4"."crop_types"
    where crop_code is not null
    group by crop_code
    having count(*) > 1

) validation_errors



2021-01-28 15:52:11.470146 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:52:11.470288 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:11.578799 (Thread-3): SQL status: OK in 3.02 seconds
2021-01-28 15:52:11.593361 (Thread-3): finished collecting timing info
2021-01-28 15:52:11.594480 (Thread-3): On test.subsurface.stg__land_values_built_surface_implies_premises_code: ROLLBACK
2021-01-28 15:52:11.594668 (Thread-3): On test.subsurface.stg__land_values_built_surface_implies_premises_code: Close
2021-01-28 15:52:11.596240 (Thread-3): 16:52:11 | 39 of 48 PASS stg__land_values_built_surface_implies_premises_code... [PASS in 3.07s]
2021-01-28 15:52:11.596518 (Thread-3): Finished running node test.subsurface.stg__land_values_built_surface_implies_premises_code
2021-01-28 15:52:11.596814 (Thread-3): Began running node test.subsurface.unique_d_crop_types_crop_code
2021-01-28 15:52:11.597048 (Thread-3): 16:52:11 | 42 of 48 START test unique_d_crop_types_crop_code.................... [RUN]
2021-01-28 15:52:11.597496 (Thread-3): Acquiring new dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-28 15:52:11.597725 (Thread-3): Compiling test.subsurface.unique_d_crop_types_crop_code
2021-01-28 15:52:11.615382 (Thread-3): Writing injected SQL for node "test.subsurface.unique_d_crop_types_crop_code"
2021-01-28 15:52:11.616141 (Thread-3): finished collecting timing info
2021-01-28 15:52:11.616681 (Thread-3): Using dremio connection "test.subsurface.unique_d_crop_types_crop_code".
2021-01-28 15:52:11.616880 (Thread-3): On test.subsurface.unique_d_crop_types_crop_code: 
    
    



select count(*) as validation_errors
from (

    select
        crop_code

    from "@fab4"."d_crop_types"
    where crop_code is not null
    group by crop_code
    having count(*) > 1

) validation_errors



2021-01-28 15:52:11.617029 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:52:11.617174 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:11.723915 (Thread-2): Connected to db: None
2021-01-28 15:52:11.805952 (Thread-3): Connected to db: None
2021-01-28 15:52:12.288505 (Thread-2): SQL status: OK in 0.82 seconds
2021-01-28 15:52:12.316933 (Thread-3): SQL status: OK in 0.70 seconds
2021-01-28 15:52:12.335200 (Thread-2): finished collecting timing info
2021-01-28 15:52:12.335954 (Thread-2): On test.subsurface.unique_crop_types_crop_code: ROLLBACK
2021-01-28 15:52:12.336150 (Thread-2): On test.subsurface.unique_crop_types_crop_code: Close
2021-01-28 15:52:12.337107 (Thread-2): 16:52:12 | 41 of 48 PASS unique_crop_types_crop_code............................ [PASS in 0.89s]
2021-01-28 15:52:12.337357 (Thread-2): Finished running node test.subsurface.unique_crop_types_crop_code
2021-01-28 15:52:12.337671 (Thread-2): Began running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-28 15:52:12.337888 (Thread-2): 16:52:12 | 43 of 48 START test unique_d_municipalities_municipality_code........ [RUN]
2021-01-28 15:52:12.338299 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-28 15:52:12.338515 (Thread-2): Compiling test.subsurface.unique_d_municipalities_municipality_code
2021-01-28 15:52:12.357290 (Thread-2): Writing injected SQL for node "test.subsurface.unique_d_municipalities_municipality_code"
2021-01-28 15:52:12.358133 (Thread-2): finished collecting timing info
2021-01-28 15:52:12.358768 (Thread-2): Using dremio connection "test.subsurface.unique_d_municipalities_municipality_code".
2021-01-28 15:52:12.358946 (Thread-2): On test.subsurface.unique_d_municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from (

    select
        municipality_code

    from "@fab4"."d_municipalities"
    where municipality_code is not null
    group by municipality_code
    having count(*) > 1

) validation_errors



2021-01-28 15:52:12.359109 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:52:12.359264 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:12.498184 (Thread-3): finished collecting timing info
2021-01-28 15:52:12.498980 (Thread-3): On test.subsurface.unique_d_crop_types_crop_code: ROLLBACK
2021-01-28 15:52:12.499157 (Thread-3): On test.subsurface.unique_d_crop_types_crop_code: Close
2021-01-28 15:52:12.500125 (Thread-3): 16:52:12 | 42 of 48 PASS unique_d_crop_types_crop_code.......................... [PASS in 0.90s]
2021-01-28 15:52:12.500377 (Thread-3): Finished running node test.subsurface.unique_d_crop_types_crop_code
2021-01-28 15:52:12.500698 (Thread-3): Began running node test.subsurface.unique_d_premises_types_premises_code
2021-01-28 15:52:12.500914 (Thread-3): 16:52:12 | 44 of 48 START test unique_d_premises_types_premises_code............ [RUN]
2021-01-28 15:52:12.501325 (Thread-3): Acquiring new dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-28 15:52:12.501533 (Thread-3): Compiling test.subsurface.unique_d_premises_types_premises_code
2021-01-28 15:52:12.511612 (Thread-1): SQL status: OK in 3.41 seconds
2021-01-28 15:52:12.529040 (Thread-3): Writing injected SQL for node "test.subsurface.unique_d_premises_types_premises_code"
2021-01-28 15:52:12.529828 (Thread-3): finished collecting timing info
2021-01-28 15:52:12.530363 (Thread-3): Using dremio connection "test.subsurface.unique_d_premises_types_premises_code".
2021-01-28 15:52:12.531756 (Thread-3): On test.subsurface.unique_d_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from (

    select
        premises_code

    from "@fab4"."d_premises_types"
    where premises_code is not null
    group by premises_code
    having count(*) > 1

) validation_errors



2021-01-28 15:52:12.531916 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:52:12.532066 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:12.534022 (Thread-1): finished collecting timing info
2021-01-28 15:52:12.534579 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: ROLLBACK
2021-01-28 15:52:12.534751 (Thread-1): On test.subsurface.stg__land_values_land_surface_implies_crop_code: Close
2021-01-28 15:52:12.535654 (Thread-1): 16:52:12 | 40 of 48 PASS stg__land_values_land_surface_implies_crop_code........ [PASS in 3.46s]
2021-01-28 15:52:12.535896 (Thread-1): Finished running node test.subsurface.stg__land_values_land_surface_implies_crop_code
2021-01-28 15:52:12.536175 (Thread-1): Began running node test.subsurface.unique_premises_types_premises_code
2021-01-28 15:52:12.536387 (Thread-1): 16:52:12 | 45 of 48 START test unique_premises_types_premises_code.............. [RUN]
2021-01-28 15:52:12.536859 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-28 15:52:12.537260 (Thread-1): Compiling test.subsurface.unique_premises_types_premises_code
2021-01-28 15:52:12.554511 (Thread-1): Writing injected SQL for node "test.subsurface.unique_premises_types_premises_code"
2021-01-28 15:52:12.555258 (Thread-1): finished collecting timing info
2021-01-28 15:52:12.555839 (Thread-1): Using dremio connection "test.subsurface.unique_premises_types_premises_code".
2021-01-28 15:52:12.556001 (Thread-1): On test.subsurface.unique_premises_types_premises_code: 
    
    



select count(*) as validation_errors
from (

    select
        premises_code

    from "@fab4"."premises_types"
    where premises_code is not null
    group by premises_code
    having count(*) > 1

) validation_errors



2021-01-28 15:52:12.556146 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:52:12.556287 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:12.888697 (Thread-2): Connected to db: None
2021-01-28 15:52:12.915322 (Thread-3): Connected to db: None
2021-01-28 15:52:12.937744 (Thread-1): Connected to db: None
2021-01-28 15:52:13.317055 (Thread-1): SQL status: OK in 0.76 seconds
2021-01-28 15:52:13.350371 (Thread-1): finished collecting timing info
2021-01-28 15:52:13.351292 (Thread-1): On test.subsurface.unique_premises_types_premises_code: ROLLBACK
2021-01-28 15:52:13.351543 (Thread-1): On test.subsurface.unique_premises_types_premises_code: Close
2021-01-28 15:52:13.352738 (Thread-1): 16:52:13 | 45 of 48 PASS unique_premises_types_premises_code.................... [PASS in 0.82s]
2021-01-28 15:52:13.353063 (Thread-1): Finished running node test.subsurface.unique_premises_types_premises_code
2021-01-28 15:52:13.353419 (Thread-1): Began running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-28 15:52:13.353746 (Thread-1): 16:52:13 | 46 of 48 START test unique_stg__municipalities_municipality_code..... [RUN]
2021-01-28 15:52:13.354303 (Thread-1): Acquiring new dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-28 15:52:13.354566 (Thread-1): Compiling test.subsurface.unique_stg__municipalities_municipality_code
2021-01-28 15:52:13.383661 (Thread-1): Writing injected SQL for node "test.subsurface.unique_stg__municipalities_municipality_code"
2021-01-28 15:52:13.384596 (Thread-1): finished collecting timing info
2021-01-28 15:52:13.385314 (Thread-1): Using dremio connection "test.subsurface.unique_stg__municipalities_municipality_code".
2021-01-28 15:52:13.385565 (Thread-1): On test.subsurface.unique_stg__municipalities_municipality_code: 
    
    



select count(*) as validation_errors
from (

    select
        municipality_code

    from "@fab4"."stg__municipalities"
    where municipality_code is not null
    group by municipality_code
    having count(*) > 1

) validation_errors



2021-01-28 15:52:13.385772 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:52:13.385962 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:13.516143 (Thread-3): SQL status: OK in 0.98 seconds
2021-01-28 15:52:13.556572 (Thread-2): SQL status: OK in 1.20 seconds
2021-01-28 15:52:13.569802 (Thread-1): Connected to db: None
2021-01-28 15:52:13.573081 (Thread-2): finished collecting timing info
2021-01-28 15:52:13.573849 (Thread-2): On test.subsurface.unique_d_municipalities_municipality_code: ROLLBACK
2021-01-28 15:52:13.574052 (Thread-2): On test.subsurface.unique_d_municipalities_municipality_code: Close
2021-01-28 15:52:13.575079 (Thread-2): 16:52:13 | 43 of 48 PASS unique_d_municipalities_municipality_code.............. [PASS in 1.24s]
2021-01-28 15:52:13.575350 (Thread-2): Finished running node test.subsurface.unique_d_municipalities_municipality_code
2021-01-28 15:52:13.575718 (Thread-2): Began running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-28 15:52:13.575954 (Thread-2): 16:52:13 | 47 of 48 START test unique_transfer_types_transfer_label_en.......... [RUN]
2021-01-28 15:52:13.576402 (Thread-2): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-28 15:52:13.576647 (Thread-2): Compiling test.subsurface.unique_transfer_types_transfer_label_en
2021-01-28 15:52:13.597114 (Thread-2): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_en"
2021-01-28 15:52:13.597893 (Thread-2): finished collecting timing info
2021-01-28 15:52:13.600250 (Thread-2): Using dremio connection "test.subsurface.unique_transfer_types_transfer_label_en".
2021-01-28 15:52:13.600488 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_en: 
    
    



select count(*) as validation_errors
from (

    select
        transfer_label_en

    from "@fab4"."transfer_types"
    where transfer_label_en is not null
    group by transfer_label_en
    having count(*) > 1

) validation_errors



2021-01-28 15:52:13.600665 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:52:13.600834 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:13.601896 (Thread-3): finished collecting timing info
2021-01-28 15:52:13.602491 (Thread-3): On test.subsurface.unique_d_premises_types_premises_code: ROLLBACK
2021-01-28 15:52:13.602719 (Thread-3): On test.subsurface.unique_d_premises_types_premises_code: Close
2021-01-28 15:52:13.603735 (Thread-3): 16:52:13 | 44 of 48 PASS unique_d_premises_types_premises_code.................. [PASS in 1.10s]
2021-01-28 15:52:13.604023 (Thread-3): Finished running node test.subsurface.unique_d_premises_types_premises_code
2021-01-28 15:52:13.604333 (Thread-3): Began running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-28 15:52:13.604586 (Thread-3): 16:52:13 | 48 of 48 START test unique_transfer_types_transfer_label_fr.......... [RUN]
2021-01-28 15:52:13.605040 (Thread-3): Acquiring new dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-28 15:52:13.605245 (Thread-3): Compiling test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-28 15:52:13.626166 (Thread-3): Writing injected SQL for node "test.subsurface.unique_transfer_types_transfer_label_fr"
2021-01-28 15:52:13.626979 (Thread-3): finished collecting timing info
2021-01-28 15:52:13.627599 (Thread-3): Using dremio connection "test.subsurface.unique_transfer_types_transfer_label_fr".
2021-01-28 15:52:13.627782 (Thread-3): On test.subsurface.unique_transfer_types_transfer_label_fr: 
    
    



select count(*) as validation_errors
from (

    select
        transfer_label_fr

    from "@fab4"."transfer_types"
    where transfer_label_fr is not null
    group by transfer_label_fr
    having count(*) > 1

) validation_errors



2021-01-28 15:52:13.627942 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 15:52:13.628095 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:52:13.927950 (Thread-2): Connected to db: None
2021-01-28 15:52:13.963839 (Thread-3): Connected to db: None
2021-01-28 15:52:13.984315 (Thread-1): SQL status: OK in 0.60 seconds
2021-01-28 15:52:14.005257 (Thread-1): finished collecting timing info
2021-01-28 15:52:14.006092 (Thread-1): On test.subsurface.unique_stg__municipalities_municipality_code: ROLLBACK
2021-01-28 15:52:14.006285 (Thread-1): On test.subsurface.unique_stg__municipalities_municipality_code: Close
2021-01-28 15:52:14.007338 (Thread-1): 16:52:14 | 46 of 48 PASS unique_stg__municipalities_municipality_code........... [PASS in 0.65s]
2021-01-28 15:52:14.007638 (Thread-1): Finished running node test.subsurface.unique_stg__municipalities_municipality_code
2021-01-28 15:52:14.206028 (Thread-2): SQL status: OK in 0.61 seconds
2021-01-28 15:52:14.221254 (Thread-2): finished collecting timing info
2021-01-28 15:52:14.222084 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_en: ROLLBACK
2021-01-28 15:52:14.222276 (Thread-2): On test.subsurface.unique_transfer_types_transfer_label_en: Close
2021-01-28 15:52:14.223322 (Thread-2): 16:52:14 | 47 of 48 PASS unique_transfer_types_transfer_label_en................ [PASS in 0.65s]
2021-01-28 15:52:14.223623 (Thread-2): Finished running node test.subsurface.unique_transfer_types_transfer_label_en
2021-01-28 15:52:14.285641 (Thread-3): SQL status: OK in 0.66 seconds
2021-01-28 15:52:14.299235 (Thread-3): finished collecting timing info
2021-01-28 15:52:14.300072 (Thread-3): On test.subsurface.unique_transfer_types_transfer_label_fr: ROLLBACK
2021-01-28 15:52:14.300265 (Thread-3): On test.subsurface.unique_transfer_types_transfer_label_fr: Close
2021-01-28 15:52:14.301330 (Thread-3): 16:52:14 | 48 of 48 PASS unique_transfer_types_transfer_label_fr................ [PASS in 0.70s]
2021-01-28 15:52:14.301637 (Thread-3): Finished running node test.subsurface.unique_transfer_types_transfer_label_fr
2021-01-28 15:52:19.586248 (Thread-4): SQL status: OK in 20.13 seconds
2021-01-28 15:52:19.596666 (Thread-4): finished collecting timing info
2021-01-28 15:52:19.597965 (Thread-4): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: ROLLBACK
2021-01-28 15:52:19.598295 (Thread-4): On test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_: Close
2021-01-28 15:52:19.600010 (Thread-4): 16:52:19 | 36 of 48 PASS relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_ [PASS in 20.17s]
2021-01-28 15:52:19.600507 (Thread-4): Finished running node test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_
2021-01-28 15:52:19.654928 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:52:19.656088 (MainThread): 16:52:19 | 
2021-01-28 15:52:19.656596 (MainThread): 16:52:19 | Finished running 48 tests in 63.46s.
2021-01-28 15:52:19.656970 (MainThread): Connection 'master' was properly closed.
2021-01-28 15:52:19.657232 (MainThread): Connection 'test.subsurface.unique_stg__municipalities_municipality_code' was properly closed.
2021-01-28 15:52:19.657552 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_fr' was properly closed.
2021-01-28 15:52:19.657819 (MainThread): Connection 'test.subsurface.relationships_f_land_values_municipality_code__municipality_code__ref_d_municipalities_' was properly closed.
2021-01-28 15:52:19.658094 (MainThread): Connection 'test.subsurface.unique_transfer_types_transfer_label_en' was properly closed.
2021-01-28 15:52:20.163190 (MainThread): 
2021-01-28 15:52:20.163894 (MainThread): Completed with 2 errors and 0 warnings:
2021-01-28 15:52:20.164316 (MainThread): 
2021-01-28 15:52:20.164890 (MainThread): Failure in test not_null_f_land_values_lots_count (models/marts/schema.yml)
2021-01-28 15:52:20.165345 (MainThread):   Got 1 result, expected 0.
2021-01-28 15:52:20.165797 (MainThread): 
2021-01-28 15:52:20.166175 (MainThread):   compiled SQL at target/compiled/subsurface/models/marts/schema.yml/schema_test/not_null_f_land_values_lots_count.sql
2021-01-28 15:52:20.166595 (MainThread): 
2021-01-28 15:52:20.167020 (MainThread): Failure in test not_null_stg__land_values_lots_count (models/staging/schema.yml)
2021-01-28 15:52:20.167669 (MainThread):   Got 1 result, expected 0.
2021-01-28 15:52:20.168079 (MainThread): 
2021-01-28 15:52:20.168520 (MainThread):   compiled SQL at target/compiled/subsurface/models/staging/schema.yml/schema_test/not_null_stg__land_values_lots_count.sql
2021-01-28 15:52:20.169043 (MainThread): 
Done. PASS=46 WARN=0 ERROR=2 SKIP=0 TOTAL=48
2021-01-28 15:52:20.169771 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1457e8048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1456a86a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1456a1048>]}
2021-01-28 15:52:20.170490 (MainThread): Flushing usage events
2021-01-28 15:56:01.384269 (MainThread): Running with dbt=0.18.1
2021-01-28 15:56:01.518975 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-28 15:56:01.520898 (MainThread): Tracking: tracking
2021-01-28 15:56:01.536379 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d185693c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d18569048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d19184dd8>]}
2021-01-28 15:56:01.593128 (MainThread): Partial parsing not enabled
2021-01-28 15:56:01.594999 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:56:01.601130 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:56:01.603415 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 15:56:01.633070 (MainThread): Parsing macros/catalog.sql
2021-01-28 15:56:01.637187 (MainThread): Parsing macros/adapters.sql
2021-01-28 15:56:01.681174 (MainThread): Parsing macros/helpers.sql
2021-01-28 15:56:01.714604 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:56:01.718551 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:56:01.720764 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 15:56:01.726356 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:56:01.753984 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:56:01.762657 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:56:01.774775 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 15:56:01.787227 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:56:01.812038 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 15:56:01.825366 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 15:56:01.841907 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 15:56:01.843920 (MainThread): Parsing macros/core.sql
2021-01-28 15:56:01.850622 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 15:56:01.924927 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 15:56:01.940354 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 15:56:01.942108 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 15:56:01.945163 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 15:56:01.948915 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 15:56:01.951881 (MainThread): Parsing macros/etc/query.sql
2021-01-28 15:56:01.953865 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 15:56:02.026068 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 15:56:02.050334 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 15:56:02.053744 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:56:02.065481 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:56:02.104202 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 15:56:02.150140 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 15:56:02.153285 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 15:56:02.183556 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:56:02.195226 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 15:56:02.204318 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:56:02.215145 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 15:56:02.220200 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 15:56:02.223151 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 15:56:02.226635 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 15:56:02.240728 (MainThread): Partial parsing not enabled
2021-01-28 15:56:02.322686 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:56:02.366274 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:56:02.388207 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:56:02.410724 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:56:02.434549 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:56:02.456680 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:56:02.486122 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 15:56:02.510323 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 15:56:02.545032 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:56:02.567568 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:56:04.415397 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 15:56:05.080849 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 15:56:05.088074 (MainThread): 
2021-01-28 15:56:05.088965 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:56:05.103644 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-28 15:56:05.126677 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-28 15:56:05.126857 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 15:56:05.127010 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 15:56:05.127135 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:05.379808 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-28 15:56:05.526964 (ThreadPoolExecutor-0_0): SQL status: OK in 0.40 seconds
2021-01-28 15:56:05.553705 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-28 15:56:05.827358 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 15:56:05.852088 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 15:56:05.852455 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 15:56:05.852810 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 15:56:05.853077 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:06.071404 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 15:56:06.391456 (ThreadPoolExecutor-1_0): SQL status: OK in 0.54 seconds
2021-01-28 15:56:06.392860 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 15:56:06.393302 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-28 15:56:06.397925 (MainThread): 16:56:06 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 15:56:06.398531 (MainThread): 16:56:06 | 
2021-01-28 15:56:06.407149 (Thread-2): Began running node seed.subsurface.crop_types
2021-01-28 15:56:06.407868 (Thread-1): Began running node seed.subsurface.premises_types
2021-01-28 15:56:06.408318 (Thread-3): Began running node seed.subsurface.transfer_types
2021-01-28 15:56:06.412569 (Thread-2): 16:56:06 | 1 of 3 START seed file @fab4.crop_types.............................. [RUN]
2021-01-28 15:56:06.416958 (Thread-1): 16:56:06 | 2 of 3 START seed file @fab4.premises_types.......................... [RUN]
2021-01-28 15:56:06.420801 (Thread-3): 16:56:06 | 3 of 3 START seed file @fab4.transfer_types.......................... [RUN]
2021-01-28 15:56:06.422296 (Thread-2): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-28 15:56:06.422745 (Thread-2): finished collecting timing info
2021-01-28 15:56:06.431079 (Thread-1): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-28 15:56:06.432267 (Thread-3): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:56:06.453767 (Thread-3): finished collecting timing info
2021-01-28 15:56:06.432674 (Thread-1): finished collecting timing info
2021-01-28 15:56:06.864772 (Thread-1): On "seed.subsurface.premises_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:56:06.873172 (Thread-2): On "seed.subsurface.crop_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:56:06.894635 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:56:06.916077 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:56:06.926589 (Thread-1): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:56:06.927008 (Thread-3): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:56:06.927503 (Thread-2): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:56:06.928059 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:56:06.939366 (Thread-2): Opening a new connection, currently in state init
2021-01-28 15:56:06.940930 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:56:06.941327 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:06.941784 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:06.942172 (Thread-3): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:56:06.943081 (Thread-3): Opening a new connection, currently in state init
2021-01-28 15:56:06.943419 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:07.436091 (Thread-2): Connected to db: None
2021-01-28 15:56:07.445263 (Thread-1): Connected to db: None
2021-01-28 15:56:07.448514 (Thread-3): Connected to db: None
2021-01-28 15:56:07.931982 (Thread-1): SQL status: OK in 1.00 seconds
2021-01-28 15:56:07.941051 (Thread-2): SQL status: OK in 1.00 seconds
2021-01-28 15:56:07.973300 (Thread-3): SQL status: OK in 1.03 seconds
2021-01-28 15:56:08.005969 (Thread-1): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_blue">]
2021-01-28 15:56:08.007296 (Thread-1): On "seed.subsurface.premises_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:56:08.015285 (Thread-2): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_blue">]
2021-01-28 15:56:08.030954 (Thread-2): On "seed.subsurface.crop_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:56:08.020641 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:56:08.042159 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:56:08.044189 (Thread-2): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:56:08.043709 (Thread-1): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:56:08.056729 (Thread-3): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_blue">]
2021-01-28 15:56:08.057843 (Thread-3): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 15:56:08.069051 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:56:08.074772 (Thread-3): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 15:56:08.463184 (Thread-1): SQL status: OK in 0.42 seconds
2021-01-28 15:56:08.464045 (Thread-3): SQL status: OK in 0.39 seconds
2021-01-28 15:56:08.466501 (Thread-2): SQL status: OK in 0.42 seconds
2021-01-28 15:56:08.480468 (Thread-1): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_blue">]
2021-01-28 15:56:08.504783 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:56:08.505755 (Thread-3): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_blue">]
2021-01-28 15:56:08.506010 (Thread-1): On seed.subsurface.premises_types: drop table if exists "$scratch"."dbt"."@fab4"."premises_types_green"
2021-01-28 15:56:08.511711 (Thread-2): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_blue">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_blue">]
2021-01-28 15:56:08.516260 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:56:08.520809 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:56:08.521496 (Thread-2): On seed.subsurface.crop_types: drop table if exists "$scratch"."dbt"."@fab4"."crop_types_green"
2021-01-28 15:56:08.521193 (Thread-3): On seed.subsurface.transfer_types: drop table if exists "$scratch"."dbt"."@fab4"."transfer_types_green"
2021-01-28 15:56:08.549784 (Thread-1): SQL status: OK in 0.03 seconds
2021-01-28 15:56:08.559782 (Thread-3): SQL status: OK in 0.04 seconds
2021-01-28 15:56:08.561720 (Thread-2): SQL status: OK in 0.04 seconds
2021-01-28 15:56:08.569215 (Thread-2): Writing runtime SQL for node "seed.subsurface.crop_types"
2021-01-28 15:56:08.570294 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:56:08.572993 (Thread-2): On seed.subsurface.crop_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."crop_types_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_label as varchar)
        as crop_label
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'B'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_label )

  )

  
2021-01-28 15:56:08.572775 (Thread-1): Writing runtime SQL for node "seed.subsurface.premises_types"
2021-01-28 15:56:08.577221 (Thread-3): Writing runtime SQL for node "seed.subsurface.transfer_types"
2021-01-28 15:56:08.579047 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:56:08.579261 (Thread-3): On seed.subsurface.transfer_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."transfer_types_green"
  as (
    select
    cast(transfer_label_fr as varchar)
        as transfer_label_fr,cast(transfer_label_en as varchar)
        as transfer_label_en
  from
    (values
      
        (
            'Expropriation'
          ,
            'Expropriation'
          ),
      
        (
            'Vente'
          ,
            'Sale'
          ),
      
        (
            'Echange'
          ,
            'Exchange'
          ),
      
        (
            'Adjudication'
          ,
            'Sale by tender'
          ),
      
        (
            'Vente en l''état futur d''achèvement'
          ,
            'Sale before completion'
          ),
      
        (
            'Vente terrain à bâtir'
          ,
            'Building plot sale'
          )
      ) temp_table ( transfer_label_fr, transfer_label_en )

  )

  
2021-01-28 15:56:08.578320 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:56:08.580260 (Thread-1): On seed.subsurface.premises_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."premises_types_green"
  as (
    select
    cast(premises_code as varchar)
        as premises_code,cast(premises_label_fr as varchar)
        as premises_label_fr,cast(premises_label_en as varchar)
        as premises_label_en
  from
    (values
      
        (
            '1'
          ,
            'Maison'
          ,
            'House'
          ),
      
        (
            '2'
          ,
            'Appartement'
          ,
            'Flat'
          ),
      
        (
            '3'
          ,
            'Dépendance'
          ,
            'Outbuilding'
          ),
      
        (
            '4'
          ,
            'Local industriel. commercial ou assimilé'
          ,
            'Industrial premises. commercial or similar'
          )
      ) temp_table ( premises_code, premises_label_fr, premises_label_en )

  )

  
2021-01-28 15:56:08.796998 (Thread-1): SQL status: OK in 0.22 seconds
2021-01-28 15:56:08.809769 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:56:08.810119 (Thread-1): On seed.subsurface.premises_types: 
    
  create or replace view "@fab4"."premises_types" as (
    select * from "$scratch"."dbt"."@fab4"."premises_types_green"
  )

  
2021-01-28 15:56:08.810829 (Thread-3): SQL status: OK in 0.23 seconds
2021-01-28 15:56:08.814562 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:56:08.814841 (Thread-3): On seed.subsurface.transfer_types: 
    
  create or replace view "@fab4"."transfer_types" as (
    select * from "$scratch"."dbt"."@fab4"."transfer_types_green"
  )

  
2021-01-28 15:56:09.175382 (Thread-1): SQL status: OK in 0.36 seconds
2021-01-28 15:56:09.179274 (Thread-3): SQL status: OK in 0.36 seconds
2021-01-28 15:56:09.191874 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 15:56:09.192313 (Thread-3): On seed.subsurface.transfer_types: drop table if exists "$scratch"."dbt"."@fab4"."transfer_types_blue"
2021-01-28 15:56:09.205823 (Thread-1): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 15:56:09.206245 (Thread-1): On seed.subsurface.premises_types: drop table if exists "$scratch"."dbt"."@fab4"."premises_types_blue"
2021-01-28 15:56:09.207391 (Thread-2): SQL status: OK in 0.63 seconds
2021-01-28 15:56:09.212032 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:56:09.212493 (Thread-2): On seed.subsurface.crop_types: 
    
  create or replace view "@fab4"."crop_types" as (
    select * from "$scratch"."dbt"."@fab4"."crop_types_green"
  )

  
2021-01-28 15:56:09.263292 (Thread-3): SQL status: OK in 0.07 seconds
2021-01-28 15:56:09.300018 (Thread-3): finished collecting timing info
2021-01-28 15:56:09.301517 (Thread-3): On seed.subsurface.transfer_types: ROLLBACK
2021-01-28 15:56:09.302148 (Thread-1): SQL status: OK in 0.10 seconds
2021-01-28 15:56:09.302848 (Thread-3): On seed.subsurface.transfer_types: Close
2021-01-28 15:56:09.315596 (Thread-1): finished collecting timing info
2021-01-28 15:56:09.317165 (Thread-1): On seed.subsurface.premises_types: ROLLBACK
2021-01-28 15:56:09.317605 (Thread-1): On seed.subsurface.premises_types: Close
2021-01-28 15:56:09.320482 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77724ad-0d89-4c3d-8c76-afd7dc9405e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d183698d0>]}
2021-01-28 15:56:09.322716 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77724ad-0d89-4c3d-8c76-afd7dc9405e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d18369fd0>]}
2021-01-28 15:56:09.326260 (Thread-3): 16:56:09 | 3 of 3 OK loaded seed file no_schema.transfer_types.................. [OK in 2.89s]
2021-01-28 15:56:09.327146 (Thread-1): 16:56:09 | 2 of 3 OK loaded seed file no_schema.premises_types.................. [OK in 2.89s]
2021-01-28 15:56:09.330836 (Thread-1): Finished running node seed.subsurface.premises_types
2021-01-28 15:56:09.330160 (Thread-3): Finished running node seed.subsurface.transfer_types
2021-01-28 15:56:09.480554 (Thread-2): SQL status: OK in 0.27 seconds
2021-01-28 15:56:09.493310 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 15:56:09.493842 (Thread-2): On seed.subsurface.crop_types: drop table if exists "$scratch"."dbt"."@fab4"."crop_types_blue"
2021-01-28 15:56:09.524327 (Thread-2): SQL status: OK in 0.03 seconds
2021-01-28 15:56:09.540951 (Thread-2): finished collecting timing info
2021-01-28 15:56:09.542232 (Thread-2): On seed.subsurface.crop_types: ROLLBACK
2021-01-28 15:56:09.542687 (Thread-2): On seed.subsurface.crop_types: Close
2021-01-28 15:56:09.545610 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77724ad-0d89-4c3d-8c76-afd7dc9405e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d181d8978>]}
2021-01-28 15:56:09.546535 (Thread-2): 16:56:09 | 1 of 3 OK loaded seed file no_schema.crop_types...................... [OK in 3.12s]
2021-01-28 15:56:09.547145 (Thread-2): Finished running node seed.subsurface.crop_types
2021-01-28 15:56:09.607240 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:56:09.607964 (MainThread): On master: ROLLBACK
2021-01-28 15:56:09.608301 (MainThread): Opening a new connection, currently in state init
2021-01-28 15:56:09.608676 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:09.841207 (MainThread): Connected to db: None
2021-01-28 15:56:09.841999 (MainThread): On master: ROLLBACK
2021-01-28 15:56:09.842320 (MainThread): On master: Close
2021-01-28 15:56:09.844666 (MainThread): 16:56:09 | 
2021-01-28 15:56:09.845142 (MainThread): 16:56:09 | Finished running 3 seeds in 4.76s.
2021-01-28 15:56:09.845601 (MainThread): Connection 'master' was properly closed.
2021-01-28 15:56:09.845904 (MainThread): Connection 'seed.subsurface.premises_types' was properly closed.
2021-01-28 15:56:09.846179 (MainThread): Connection 'seed.subsurface.crop_types' was properly closed.
2021-01-28 15:56:09.846618 (MainThread): Connection 'seed.subsurface.transfer_types' was properly closed.
2021-01-28 15:56:09.892228 (MainThread): 
2021-01-28 15:56:09.892902 (MainThread): Completed successfully
2021-01-28 15:56:09.893366 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-28 15:56:09.894560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d1831a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d18300ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d18300f28>]}
2021-01-28 15:56:09.895751 (MainThread): Flushing usage events
2021-01-28 15:56:17.180063 (MainThread): Running with dbt=0.18.1
2021-01-28 15:56:17.293830 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 15:56:17.295345 (MainThread): Tracking: tracking
2021-01-28 15:56:17.310013 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917fc6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3918b95e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3918b95eb8>]}
2021-01-28 15:56:17.359388 (MainThread): Partial parsing not enabled
2021-01-28 15:56:17.360917 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:56:17.366256 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:56:17.368297 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 15:56:17.396744 (MainThread): Parsing macros/catalog.sql
2021-01-28 15:56:17.400849 (MainThread): Parsing macros/adapters.sql
2021-01-28 15:56:17.440095 (MainThread): Parsing macros/helpers.sql
2021-01-28 15:56:17.469338 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 15:56:17.472925 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 15:56:17.474831 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 15:56:17.479812 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:56:17.504460 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:56:17.512242 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:56:17.523139 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 15:56:17.535588 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:56:17.559918 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 15:56:17.573001 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 15:56:17.589502 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 15:56:17.591369 (MainThread): Parsing macros/core.sql
2021-01-28 15:56:17.597973 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 15:56:17.671202 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 15:56:17.686256 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 15:56:17.688003 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 15:56:17.691007 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 15:56:17.694709 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 15:56:17.697549 (MainThread): Parsing macros/etc/query.sql
2021-01-28 15:56:17.699221 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 15:56:17.761537 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 15:56:17.785271 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 15:56:17.788687 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 15:56:17.799829 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 15:56:17.835006 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 15:56:17.879499 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 15:56:17.883052 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 15:56:17.913221 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 15:56:17.924743 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 15:56:17.933762 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 15:56:17.944560 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 15:56:17.949368 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 15:56:17.952095 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 15:56:17.955538 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 15:56:17.969001 (MainThread): Partial parsing not enabled
2021-01-28 15:56:18.047853 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:56:18.091899 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:56:18.113346 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:56:18.134910 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:56:18.158370 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:56:18.180100 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:56:18.209129 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 15:56:18.233337 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 15:56:18.266299 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 15:56:18.288587 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 15:56:19.989590 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 15:56:20.557497 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 15:56:20.562299 (MainThread): 
2021-01-28 15:56:20.562940 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:56:20.578958 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-28 15:56:20.621663 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-28 15:56:20.622002 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 15:56:20.622287 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 15:56:20.622635 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:20.940757 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-28 15:56:21.090948 (ThreadPoolExecutor-0_0): SQL status: OK in 0.47 seconds
2021-01-28 15:56:21.118112 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-28 15:56:21.380244 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 15:56:21.410120 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 15:56:21.410573 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 15:56:21.410948 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 15:56:21.411239 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:21.587311 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 15:56:21.901369 (ThreadPoolExecutor-1_0): SQL status: OK in 0.49 seconds
2021-01-28 15:56:21.925423 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 15:56:21.925830 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-28 15:56:21.927994 (MainThread): 16:56:21 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 15:56:21.928274 (MainThread): 16:56:21 | 
2021-01-28 15:56:21.939249 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-28 15:56:21.941584 (Thread-1): 16:56:21 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-28 15:56:21.943284 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:56:21.943578 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-28 15:56:21.942246 (Thread-3): Began running node model.subsurface.d_crop_types
2021-01-28 15:56:21.941896 (Thread-2): Began running node model.subsurface.stg__municipalities
2021-01-28 15:56:21.942577 (Thread-4): Began running node model.subsurface.d_premises_types
2021-01-28 15:56:21.965980 (Thread-3): 16:56:21 | 3 of 6 START view model @fab4.d_crop_types........................... [RUN]
2021-01-28 15:56:21.987962 (Thread-2): 16:56:21 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-28 15:56:22.004243 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-28 15:56:22.008324 (Thread-4): 16:56:22 | 4 of 6 START view model @fab4.d_premises_types....................... [RUN]
2021-01-28 15:56:22.009495 (Thread-3): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:56:22.010360 (Thread-2): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:56:22.012898 (Thread-2): Compiling model.subsurface.stg__municipalities
2021-01-28 15:56:22.012493 (Thread-3): Compiling model.subsurface.d_crop_types
2021-01-28 15:56:22.012114 (Thread-4): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:56:22.013193 (Thread-1): finished collecting timing info
2021-01-28 15:56:22.034985 (Thread-4): Compiling model.subsurface.d_premises_types
2021-01-28 15:56:22.046549 (Thread-3): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-28 15:56:22.126824 (Thread-4): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-28 15:56:22.133644 (Thread-2): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-28 15:56:22.146091 (Thread-3): finished collecting timing info
2021-01-28 15:56:22.156276 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-28 15:56:22.157628 (Thread-2): finished collecting timing info
2021-01-28 15:56:22.158681 (Thread-4): finished collecting timing info
2021-01-28 15:56:22.186538 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-28 15:56:22.192242 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "subsurface_datalake"."valeurs_foncieres"
  )

2021-01-28 15:56:22.207326 (Thread-4): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-28 15:56:22.210156 (Thread-2): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-28 15:56:22.212855 (Thread-3): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-28 15:56:22.213315 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 15:56:22.214807 (Thread-4): Using dremio connection "model.subsurface.d_premises_types".
2021-01-28 15:56:22.216643 (Thread-2): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-28 15:56:22.217084 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:22.218137 (Thread-3): Using dremio connection "model.subsurface.d_crop_types".
2021-01-28 15:56:22.219936 (Thread-3): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 15:56:22.219000 (Thread-2): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "subsurface_datalake"."geo"."communes.csv"
  )

2021-01-28 15:56:22.220759 (Thread-2): Opening a new connection, currently in state init
2021-01-28 15:56:22.220310 (Thread-3): Opening a new connection, currently in state init
2021-01-28 15:56:22.221128 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:22.218548 (Thread-4): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 15:56:22.221582 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:22.222167 (Thread-4): Opening a new connection, currently in state init
2021-01-28 15:56:22.222763 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:22.908358 (Thread-1): Connected to db: None
2021-01-28 15:56:22.945459 (Thread-4): Connected to db: None
2021-01-28 15:56:22.962868 (Thread-2): Connected to db: None
2021-01-28 15:56:22.972027 (Thread-3): Connected to db: None
2021-01-28 15:56:23.339939 (Thread-4): SQL status: OK in 1.12 seconds
2021-01-28 15:56:23.355634 (Thread-4): finished collecting timing info
2021-01-28 15:56:23.356744 (Thread-4): On model.subsurface.d_premises_types: ROLLBACK
2021-01-28 15:56:23.357102 (Thread-4): On model.subsurface.d_premises_types: Close
2021-01-28 15:56:23.363364 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de412492-9678-44bf-b971-e473ae1c62eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917d77e80>]}
2021-01-28 15:56:23.368962 (Thread-4): 16:56:23 | 4 of 6 OK created view model @fab4.d_premises_types.................. [OK in 1.35s]
2021-01-28 15:56:23.369570 (Thread-4): Finished running node model.subsurface.d_premises_types
2021-01-28 15:56:23.412129 (Thread-2): SQL status: OK in 1.19 seconds
2021-01-28 15:56:23.419778 (Thread-2): finished collecting timing info
2021-01-28 15:56:23.420535 (Thread-2): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-28 15:56:23.420790 (Thread-2): On model.subsurface.stg__municipalities: Close
2021-01-28 15:56:23.421180 (Thread-1): SQL status: OK in 1.21 seconds
2021-01-28 15:56:23.427112 (Thread-1): finished collecting timing info
2021-01-28 15:56:23.427658 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-28 15:56:23.427855 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-28 15:56:23.429767 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de412492-9678-44bf-b971-e473ae1c62eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917e3b780>]}
2021-01-28 15:56:23.431947 (Thread-2): 16:56:23 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 1.42s]
2021-01-28 15:56:23.432233 (Thread-2): Finished running node model.subsurface.stg__municipalities
2021-01-28 15:56:23.433635 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de412492-9678-44bf-b971-e473ae1c62eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917deb4e0>]}
2021-01-28 15:56:23.435705 (Thread-1): 16:56:23 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 1.49s]
2021-01-28 15:56:23.436754 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-28 15:56:23.437954 (Thread-4): Began running node model.subsurface.d_municipalities
2021-01-28 15:56:23.440345 (Thread-4): 16:56:23 | 5 of 6 START view model @fab4.d_municipalities....................... [RUN]
2021-01-28 15:56:23.441064 (Thread-4): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:56:23.441332 (Thread-4): Compiling model.subsurface.d_municipalities
2021-01-28 15:56:23.449731 (Thread-2): Began running node model.subsurface.f_land_values
2021-01-28 15:56:23.458845 (Thread-2): 16:56:23 | 6 of 6 START view model @fab4.f_land_values.......................... [RUN]
2021-01-28 15:56:23.467492 (Thread-2): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 15:56:23.467925 (Thread-2): Compiling model.subsurface.f_land_values
2021-01-28 15:56:23.466024 (Thread-4): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-28 15:56:23.487206 (Thread-4): finished collecting timing info
2021-01-28 15:56:23.523377 (Thread-4): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-28 15:56:23.524380 (Thread-4): Using dremio connection "model.subsurface.d_municipalities".
2021-01-28 15:56:23.524610 (Thread-4): On model.subsurface.d_municipalities: 
  create or replace view "@fab4"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-28 15:56:23.524800 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 15:56:23.525001 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:23.541193 (Thread-2): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-28 15:56:23.541991 (Thread-2): finished collecting timing info
2021-01-28 15:56:23.552992 (Thread-2): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-28 15:56:23.553684 (Thread-2): Using dremio connection "model.subsurface.f_land_values".
2021-01-28 15:56:23.553878 (Thread-2): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-28 15:56:23.554092 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 15:56:23.554270 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:23.668827 (Thread-3): SQL status: OK in 1.45 seconds
2021-01-28 15:56:23.679760 (Thread-3): finished collecting timing info
2021-01-28 15:56:23.681882 (Thread-3): On model.subsurface.d_crop_types: ROLLBACK
2021-01-28 15:56:23.682266 (Thread-3): On model.subsurface.d_crop_types: Close
2021-01-28 15:56:23.684988 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de412492-9678-44bf-b971-e473ae1c62eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917c44ef0>]}
2021-01-28 15:56:23.689194 (Thread-3): 16:56:23 | 3 of 6 OK created view model @fab4.d_crop_types...................... [OK in 1.67s]
2021-01-28 15:56:23.689882 (Thread-3): Finished running node model.subsurface.d_crop_types
2021-01-28 15:56:23.815026 (Thread-4): Connected to db: None
2021-01-28 15:56:23.822163 (Thread-2): Connected to db: None
2021-01-28 15:56:24.093053 (Thread-4): SQL status: OK in 0.57 seconds
2021-01-28 15:56:24.101764 (Thread-4): finished collecting timing info
2021-01-28 15:56:24.102423 (Thread-4): On model.subsurface.d_municipalities: ROLLBACK
2021-01-28 15:56:24.102696 (Thread-4): On model.subsurface.d_municipalities: Close
2021-01-28 15:56:24.104544 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de412492-9678-44bf-b971-e473ae1c62eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917e0eb70>]}
2021-01-28 15:56:24.106955 (Thread-4): 16:56:24 | 5 of 6 OK created view model @fab4.d_municipalities.................. [OK in 0.66s]
2021-01-28 15:56:24.107268 (Thread-4): Finished running node model.subsurface.d_municipalities
2021-01-28 15:56:24.240752 (Thread-2): SQL status: OK in 0.69 seconds
2021-01-28 15:56:24.248316 (Thread-2): finished collecting timing info
2021-01-28 15:56:24.249171 (Thread-2): On model.subsurface.f_land_values: ROLLBACK
2021-01-28 15:56:24.249423 (Thread-2): On model.subsurface.f_land_values: Close
2021-01-28 15:56:24.252814 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de412492-9678-44bf-b971-e473ae1c62eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917d77400>]}
2021-01-28 15:56:24.255726 (Thread-2): 16:56:24 | 6 of 6 OK created view model @fab4.f_land_values..................... [OK in 0.79s]
2021-01-28 15:56:24.256066 (Thread-2): Finished running node model.subsurface.f_land_values
2021-01-28 15:56:24.306967 (MainThread): Acquiring new dremio connection "master".
2021-01-28 15:56:24.307477 (MainThread): On master: ROLLBACK
2021-01-28 15:56:24.307682 (MainThread): Opening a new connection, currently in state init
2021-01-28 15:56:24.307866 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 15:56:24.574958 (MainThread): Connected to db: None
2021-01-28 15:56:24.575540 (MainThread): On master: ROLLBACK
2021-01-28 15:56:24.575759 (MainThread): On master: Close
2021-01-28 15:56:24.577524 (MainThread): 16:56:24 | 
2021-01-28 15:56:24.577850 (MainThread): 16:56:24 | Finished running 6 view models in 4.01s.
2021-01-28 15:56:24.578101 (MainThread): Connection 'master' was properly closed.
2021-01-28 15:56:24.578285 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-28 15:56:24.578495 (MainThread): Connection 'model.subsurface.d_crop_types' was properly closed.
2021-01-28 15:56:24.578683 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-28 15:56:24.578856 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-28 15:56:24.625591 (MainThread): 
2021-01-28 15:56:24.625949 (MainThread): Completed successfully
2021-01-28 15:56:24.626250 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-28 15:56:24.626739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917ddc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917dd8438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3917cb3c50>]}
2021-01-28 15:56:24.627150 (MainThread): Flushing usage events
2021-01-28 16:02:41.598154 (MainThread): Running with dbt=0.18.1
2021-01-28 16:02:41.715734 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-28 16:02:41.717280 (MainThread): Tracking: tracking
2021-01-28 16:02:41.729025 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892cbc2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892cbc20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892cbc2048>]}
2021-01-28 16:02:41.779473 (MainThread): Partial parsing not enabled
2021-01-28 16:02:41.781006 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 16:02:41.786846 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 16:02:41.788971 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 16:02:41.817009 (MainThread): Parsing macros/catalog.sql
2021-01-28 16:02:41.821147 (MainThread): Parsing macros/adapters.sql
2021-01-28 16:02:41.860779 (MainThread): Parsing macros/helpers.sql
2021-01-28 16:02:41.890134 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 16:02:41.893741 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 16:02:41.895777 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 16:02:41.900853 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:02:41.925956 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:02:41.933686 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:02:41.944296 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 16:02:41.956739 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:02:41.981196 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 16:02:41.994067 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 16:02:42.010192 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 16:02:42.012079 (MainThread): Parsing macros/core.sql
2021-01-28 16:02:42.018593 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 16:02:42.090906 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 16:02:42.106549 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 16:02:42.108376 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 16:02:42.111480 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 16:02:42.115155 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 16:02:42.118325 (MainThread): Parsing macros/etc/query.sql
2021-01-28 16:02:42.120287 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 16:02:42.184781 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 16:02:42.208398 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 16:02:42.211842 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:02:42.223414 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:02:42.259798 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 16:02:42.304547 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 16:02:42.307693 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 16:02:42.337564 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:02:42.349149 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 16:02:42.358087 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:02:42.368780 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 16:02:42.373660 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 16:02:42.376541 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 16:02:42.379889 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 16:02:42.393365 (MainThread): Partial parsing not enabled
2021-01-28 16:02:42.472012 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 16:02:42.514980 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 16:02:42.536567 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 16:02:42.558332 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 16:02:42.584276 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 16:02:42.610210 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 16:02:42.641505 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 16:02:42.665748 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 16:02:42.698580 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 16:02:42.720571 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 16:02:44.386189 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 16:02:44.954925 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 16:02:44.959725 (MainThread): 
2021-01-28 16:02:44.960341 (MainThread): Acquiring new dremio connection "master".
2021-01-28 16:02:44.969159 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-28 16:02:45.010630 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-28 16:02:45.010973 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 16:02:45.011252 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 16:02:45.011549 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:02:45.274596 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-28 16:02:45.420733 (ThreadPoolExecutor-0_0): SQL status: OK in 0.41 seconds
2021-01-28 16:02:45.453195 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-28 16:02:45.668775 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 16:02:45.692772 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 16:02:45.693108 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 16:02:45.693418 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 16:02:45.693754 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:02:45.947929 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 16:02:46.233466 (ThreadPoolExecutor-1_0): SQL status: OK in 0.54 seconds
2021-01-28 16:02:46.283825 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 16:02:46.284472 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-28 16:02:46.289359 (MainThread): 17:02:46 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 16:02:46.289967 (MainThread): 17:02:46 | 
2021-01-28 16:02:46.297822 (Thread-1): Began running node seed.subsurface.crop_types
2021-01-28 16:02:46.301873 (Thread-1): 17:02:46 | 1 of 3 START seed file @fab4.crop_types.............................. [RUN]
2021-01-28 16:02:46.303126 (Thread-1): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-28 16:02:46.303674 (Thread-1): finished collecting timing info
2021-01-28 16:02:46.305482 (Thread-2): Began running node seed.subsurface.premises_types
2021-01-28 16:02:46.326003 (Thread-2): 17:02:46 | 2 of 3 START seed file @fab4.premises_types.......................... [RUN]
2021-01-28 16:02:46.306095 (Thread-3): Began running node seed.subsurface.transfer_types
2021-01-28 16:02:46.332536 (Thread-2): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-28 16:02:46.351947 (Thread-3): 17:02:46 | 3 of 3 START seed file @fab4.transfer_types.......................... [RUN]
2021-01-28 16:02:46.364216 (Thread-2): finished collecting timing info
2021-01-28 16:02:46.395754 (Thread-3): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:02:46.401848 (Thread-3): finished collecting timing info
2021-01-28 16:02:46.687208 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 16:02:46.725587 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:02:46.731310 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 16:02:46.744542 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:02:46.752514 (Thread-2): On "seed.subsurface.premises_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 16:02:46.755573 (Thread-3): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 16:02:46.756182 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:02:46.769182 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:02:46.783921 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:02:46.784320 (Thread-2): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 16:02:46.784877 (Thread-3): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 16:02:46.785467 (Thread-2): Opening a new connection, currently in state init
2021-01-28 16:02:46.786013 (Thread-3): Opening a new connection, currently in state init
2021-01-28 16:02:46.786578 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:02:46.787030 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:02:47.294876 (Thread-1): Connected to db: None
2021-01-28 16:02:47.300296 (Thread-3): Connected to db: None
2021-01-28 16:02:47.320632 (Thread-2): Connected to db: None
2021-01-28 16:02:47.541963 (Thread-3): SQL status: OK in 0.76 seconds
2021-01-28 16:02:47.571916 (Thread-3): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 16:02:47.572731 (Thread-3): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 16:02:47.578572 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:02:47.578791 (Thread-3): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 16:02:47.587953 (Thread-2): SQL status: OK in 0.80 seconds
2021-01-28 16:02:47.611113 (Thread-1): SQL status: OK in 0.87 seconds
2021-01-28 16:02:47.628793 (Thread-2): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 16:02:47.629581 (Thread-2): On "seed.subsurface.premises_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 16:02:47.635241 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:02:47.635510 (Thread-2): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 16:02:47.644315 (Thread-1): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 16:02:47.644929 (Thread-1): On "seed.subsurface.crop_types": cache miss for schema "$scratch.dbt.@fab4", this is inefficient
2021-01-28 16:02:47.650657 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:02:47.650865 (Thread-1): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.@fab4')
      and table_type <> 'system_table'
  
2021-01-28 16:02:47.783818 (Thread-3): SQL status: OK in 0.20 seconds
2021-01-28 16:02:47.802752 (Thread-3): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 16:02:47.819793 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:02:47.820094 (Thread-3): On seed.subsurface.transfer_types: drop table if exists "$scratch"."dbt"."@fab4"."transfer_types_blue"
2021-01-28 16:02:47.840677 (Thread-1): SQL status: OK in 0.19 seconds
2021-01-28 16:02:47.861471 (Thread-1): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 16:02:47.865968 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:02:47.866196 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."dbt"."@fab4"."crop_types_blue"
2021-01-28 16:02:47.894804 (Thread-3): SQL status: OK in 0.07 seconds
2021-01-28 16:02:47.905510 (Thread-3): Writing runtime SQL for node "seed.subsurface.transfer_types"
2021-01-28 16:02:47.906379 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:02:47.906605 (Thread-3): On seed.subsurface.transfer_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."transfer_types_blue"
  as (
    select
    cast(transfer_label_fr as varchar)
        as transfer_label_fr,cast(transfer_label_en as varchar)
        as transfer_label_en
  from
    (values
      
        (
            'Expropriation'
          ,
            'Expropriation'
          ),
      
        (
            'Vente'
          ,
            'Sale'
          ),
      
        (
            'Echange'
          ,
            'Exchange'
          ),
      
        (
            'Adjudication'
          ,
            'Sale by tender'
          ),
      
        (
            'Vente en l''état futur d''achèvement'
          ,
            'Sale before completion'
          ),
      
        (
            'Vente terrain à bâtir'
          ,
            'Building plot sale'
          )
      ) temp_table ( transfer_label_fr, transfer_label_en )

  )

  
2021-01-28 16:02:47.907529 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-28 16:02:47.910108 (Thread-1): Writing runtime SQL for node "seed.subsurface.crop_types"
2021-01-28 16:02:47.910777 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:02:47.910978 (Thread-1): On seed.subsurface.crop_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."crop_types_blue"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_label as varchar)
        as crop_label
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'B'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_label )

  )

  
2021-01-28 16:02:47.926661 (Thread-2): SQL status: OK in 0.29 seconds
2021-01-28 16:02:47.971273 (Thread-2): with database=$scratch, schema=dbt.@fab4, relations=[<DremioRelation "$scratch"."dbt"."@fab4"."crop_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."premises_types_green">, <DremioRelation "$scratch"."dbt"."@fab4"."transfer_types_green">]
2021-01-28 16:02:47.976081 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:02:47.976352 (Thread-2): On seed.subsurface.premises_types: drop table if exists "$scratch"."dbt"."@fab4"."premises_types_blue"
2021-01-28 16:02:47.992192 (Thread-2): SQL status: OK in 0.02 seconds
2021-01-28 16:02:47.995377 (Thread-2): Writing runtime SQL for node "seed.subsurface.premises_types"
2021-01-28 16:02:47.996141 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:02:47.996375 (Thread-2): On seed.subsurface.premises_types: 
    

  create table
    "$scratch"."dbt"."@fab4"."premises_types_blue"
  as (
    select
    cast(premises_code as varchar)
        as premises_code,cast(premises_label_fr as varchar)
        as premises_label_fr,cast(premises_label_en as varchar)
        as premises_label_en
  from
    (values
      
        (
            '1'
          ,
            'Maison'
          ,
            'House'
          ),
      
        (
            '2'
          ,
            'Appartement'
          ,
            'Flat'
          ),
      
        (
            '3'
          ,
            'Dépendance'
          ,
            'Outbuilding'
          ),
      
        (
            '4'
          ,
            'Local industriel. commercial ou assimilé'
          ,
            'Industrial premises. commercial or similar'
          )
      ) temp_table ( premises_code, premises_label_fr, premises_label_en )

  )

  
2021-01-28 16:02:48.093570 (Thread-3): SQL status: OK in 0.19 seconds
2021-01-28 16:02:48.104326 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:02:48.104612 (Thread-3): On seed.subsurface.transfer_types: 
    
  create or replace view "@fab4"."transfer_types" as (
    select * from "$scratch"."dbt"."@fab4"."transfer_types_blue"
  )

  
2021-01-28 16:02:48.118490 (Thread-1): SQL status: OK in 0.21 seconds
2021-01-28 16:02:48.121337 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:02:48.121550 (Thread-1): On seed.subsurface.crop_types: 
    
  create or replace view "@fab4"."crop_types" as (
    select * from "$scratch"."dbt"."@fab4"."crop_types_blue"
  )

  
2021-01-28 16:02:48.130811 (Thread-2): SQL status: OK in 0.13 seconds
2021-01-28 16:02:48.133783 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:02:48.134000 (Thread-2): On seed.subsurface.premises_types: 
    
  create or replace view "@fab4"."premises_types" as (
    select * from "$scratch"."dbt"."@fab4"."premises_types_blue"
  )

  
2021-01-28 16:02:48.242928 (Thread-1): SQL status: OK in 0.12 seconds
2021-01-28 16:02:48.250479 (Thread-1): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:02:48.250770 (Thread-1): On seed.subsurface.crop_types: drop table if exists "$scratch"."dbt"."@fab4"."crop_types_green"
2021-01-28 16:02:48.254636 (Thread-3): SQL status: OK in 0.15 seconds
2021-01-28 16:02:48.260713 (Thread-3): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:02:48.260948 (Thread-3): On seed.subsurface.transfer_types: drop table if exists "$scratch"."dbt"."@fab4"."transfer_types_green"
2021-01-28 16:02:48.271720 (Thread-2): SQL status: OK in 0.14 seconds
2021-01-28 16:02:48.277875 (Thread-2): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:02:48.278128 (Thread-2): On seed.subsurface.premises_types: drop table if exists "$scratch"."dbt"."@fab4"."premises_types_green"
2021-01-28 16:02:48.293775 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-28 16:02:48.313202 (Thread-1): finished collecting timing info
2021-01-28 16:02:48.313928 (Thread-1): On seed.subsurface.crop_types: ROLLBACK
2021-01-28 16:02:48.314142 (Thread-1): On seed.subsurface.crop_types: Close
2021-01-28 16:02:48.315286 (Thread-2): SQL status: OK in 0.04 seconds
2021-01-28 16:02:48.321878 (Thread-2): finished collecting timing info
2021-01-28 16:02:48.323518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2468d18-d8b9-4f83-a8e5-bf88ddfcaf19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892c826748>]}
2021-01-28 16:02:48.323832 (Thread-2): On seed.subsurface.premises_types: ROLLBACK
2021-01-28 16:02:48.324391 (Thread-1): 17:02:48 | 1 of 3 OK loaded seed file no_schema.crop_types...................... [OK in 2.02s]
2021-01-28 16:02:48.324759 (Thread-2): On seed.subsurface.premises_types: Close
2021-01-28 16:02:48.324942 (Thread-3): SQL status: OK in 0.06 seconds
2021-01-28 16:02:48.325338 (Thread-1): Finished running node seed.subsurface.crop_types
2021-01-28 16:02:48.331567 (Thread-3): finished collecting timing info
2021-01-28 16:02:48.333475 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2468d18-d8b9-4f83-a8e5-bf88ddfcaf19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892c9f3e80>]}
2021-01-28 16:02:48.333940 (Thread-3): On seed.subsurface.transfer_types: ROLLBACK
2021-01-28 16:02:48.334429 (Thread-2): 17:02:48 | 2 of 3 OK loaded seed file no_schema.premises_types.................. [OK in 2.00s]
2021-01-28 16:02:48.334802 (Thread-3): On seed.subsurface.transfer_types: Close
2021-01-28 16:02:48.335179 (Thread-2): Finished running node seed.subsurface.premises_types
2021-01-28 16:02:48.336800 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2468d18-d8b9-4f83-a8e5-bf88ddfcaf19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892ca4c0f0>]}
2021-01-28 16:02:48.337171 (Thread-3): 17:02:48 | 3 of 3 OK loaded seed file no_schema.transfer_types.................. [OK in 1.94s]
2021-01-28 16:02:48.337404 (Thread-3): Finished running node seed.subsurface.transfer_types
2021-01-28 16:02:48.385137 (MainThread): Acquiring new dremio connection "master".
2021-01-28 16:02:48.385585 (MainThread): On master: ROLLBACK
2021-01-28 16:02:48.385778 (MainThread): Opening a new connection, currently in state init
2021-01-28 16:02:48.385950 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:02:48.596003 (MainThread): Connected to db: None
2021-01-28 16:02:48.596676 (MainThread): On master: ROLLBACK
2021-01-28 16:02:48.597020 (MainThread): On master: Close
2021-01-28 16:02:48.599182 (MainThread): 17:02:48 | 
2021-01-28 16:02:48.599700 (MainThread): 17:02:48 | Finished running 3 seeds in 3.64s.
2021-01-28 16:02:48.600069 (MainThread): Connection 'master' was properly closed.
2021-01-28 16:02:48.600320 (MainThread): Connection 'seed.subsurface.crop_types' was properly closed.
2021-01-28 16:02:48.600671 (MainThread): Connection 'seed.subsurface.premises_types' was properly closed.
2021-01-28 16:02:48.600920 (MainThread): Connection 'seed.subsurface.transfer_types' was properly closed.
2021-01-28 16:02:48.642778 (MainThread): 
2021-01-28 16:02:48.643298 (MainThread): Completed successfully
2021-01-28 16:02:48.643923 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-28 16:02:48.644566 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892c96b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892c8c7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892c8c7b00>]}
2021-01-28 16:02:48.645166 (MainThread): Flushing usage events
2021-01-28 16:03:21.020591 (MainThread): Running with dbt=0.18.1
2021-01-28 16:03:21.138664 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='unmanaged', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 16:03:21.140239 (MainThread): Tracking: tracking
2021-01-28 16:03:21.155398 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3d15e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3d15e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3d15e048>]}
2021-01-28 16:03:21.206798 (MainThread): Partial parsing not enabled
2021-01-28 16:03:21.208385 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 16:03:21.213869 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 16:03:21.215913 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 16:03:21.245413 (MainThread): Parsing macros/catalog.sql
2021-01-28 16:03:21.249766 (MainThread): Parsing macros/adapters.sql
2021-01-28 16:03:21.291890 (MainThread): Parsing macros/helpers.sql
2021-01-28 16:03:21.322073 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 16:03:21.325620 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 16:03:21.327610 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 16:03:21.332774 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:03:21.357394 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:03:21.365282 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:03:21.376001 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 16:03:21.388444 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:03:21.413494 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 16:03:21.427035 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 16:03:21.443930 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 16:03:21.445937 (MainThread): Parsing macros/core.sql
2021-01-28 16:03:21.452687 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 16:03:21.526347 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 16:03:21.542179 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 16:03:21.543934 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 16:03:21.547008 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 16:03:21.550733 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 16:03:21.553756 (MainThread): Parsing macros/etc/query.sql
2021-01-28 16:03:21.555765 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 16:03:21.618542 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 16:03:21.642229 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 16:03:21.645676 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:03:21.657492 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:03:21.693341 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 16:03:21.738274 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 16:03:21.741485 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 16:03:21.771097 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:03:21.783161 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 16:03:21.792172 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:03:21.803288 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 16:03:21.808204 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 16:03:21.811074 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 16:03:21.814550 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 16:03:21.828192 (MainThread): Partial parsing not enabled
2021-01-28 16:03:21.908298 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 16:03:21.951385 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 16:03:21.972918 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 16:03:21.994965 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 16:03:22.020258 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 16:03:22.046511 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 16:03:22.077560 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 16:03:22.101848 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 16:03:22.135630 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 16:03:22.158110 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 16:03:23.866393 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 16:03:24.452485 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 16:03:24.457368 (MainThread): 
2021-01-28 16:03:24.458007 (MainThread): Acquiring new dremio connection "master".
2021-01-28 16:03:24.474252 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_@fab4".
2021-01-28 16:03:24.519391 (ThreadPoolExecutor-0_0): Using dremio connection "list_@fab4".
2021-01-28 16:03:24.519799 (ThreadPoolExecutor-0_0): On list_@fab4: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, '@fab4')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 16:03:24.520084 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 16:03:24.520365 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:24.837497 (ThreadPoolExecutor-0_0): Connected to db: None
2021-01-28 16:03:24.981099 (ThreadPoolExecutor-0_0): SQL status: OK in 0.46 seconds
2021-01-28 16:03:25.005622 (ThreadPoolExecutor-0_0): On list_@fab4: Close
2021-01-28 16:03:25.257778 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_@fab4_no_schema".
2021-01-28 16:03:25.271535 (ThreadPoolExecutor-1_0): Using dremio connection "list_@fab4_no_schema".
2021-01-28 16:03:25.271762 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '@fab4')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 16:03:25.271975 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 16:03:25.272148 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:25.490146 (ThreadPoolExecutor-1_0): Connected to db: None
2021-01-28 16:03:25.791021 (ThreadPoolExecutor-1_0): SQL status: OK in 0.52 seconds
2021-01-28 16:03:25.838069 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: ROLLBACK
2021-01-28 16:03:25.838728 (ThreadPoolExecutor-1_0): On list_@fab4_no_schema: Close
2021-01-28 16:03:25.842004 (MainThread): 17:03:25 | Concurrency: 4 threads (target='unmanaged')
2021-01-28 16:03:25.842333 (MainThread): 17:03:25 | 
2021-01-28 16:03:25.847202 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-28 16:03:25.847665 (Thread-4): Began running node model.subsurface.stg__municipalities
2021-01-28 16:03:25.852007 (Thread-1): 17:03:25 | 1 of 6 START view model @fab4.stg__land_values....................... [RUN]
2021-01-28 16:03:25.852606 (Thread-2): Began running node model.subsurface.d_crop_types
2021-01-28 16:03:25.855026 (Thread-4): 17:03:25 | 2 of 6 START view model @fab4.stg__municipalities.................... [RUN]
2021-01-28 16:03:25.860970 (Thread-4): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 16:03:25.856553 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 16:03:25.860255 (Thread-2): 17:03:25 | 3 of 6 START view model @fab4.d_crop_types........................... [RUN]
2021-01-28 16:03:25.855281 (Thread-3): Began running node model.subsurface.d_premises_types
2021-01-28 16:03:25.861235 (Thread-4): Compiling model.subsurface.stg__municipalities
2021-01-28 16:03:25.861698 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-28 16:03:25.862864 (Thread-2): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 16:03:25.866613 (Thread-3): 17:03:25 | 4 of 6 START view model @fab4.d_premises_types....................... [RUN]
2021-01-28 16:03:25.893197 (Thread-2): Compiling model.subsurface.d_crop_types
2021-01-28 16:03:25.930473 (Thread-3): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 16:03:25.976480 (Thread-3): Compiling model.subsurface.d_premises_types
2021-01-28 16:03:26.010779 (Thread-4): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-28 16:03:26.022619 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-28 16:03:26.036884 (Thread-2): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-28 16:03:26.044140 (Thread-3): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-28 16:03:26.045265 (Thread-4): finished collecting timing info
2021-01-28 16:03:26.052344 (Thread-2): finished collecting timing info
2021-01-28 16:03:26.064917 (Thread-1): finished collecting timing info
2021-01-28 16:03:26.075174 (Thread-3): finished collecting timing info
2021-01-28 16:03:26.301991 (Thread-4): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-28 16:03:26.306672 (Thread-2): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-28 16:03:26.307359 (Thread-3): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-28 16:03:26.312310 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-28 16:03:26.315845 (Thread-4): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-28 16:03:26.316567 (Thread-3): Using dremio connection "model.subsurface.d_premises_types".
2021-01-28 16:03:26.316917 (Thread-4): On model.subsurface.stg__municipalities: 
  create or replace view "@fab4"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "subsurface_datalake"."geo"."communes.csv"
  )

2021-01-28 16:03:26.317545 (Thread-3): On model.subsurface.d_premises_types: 
  create or replace view "@fab4"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "@fab4"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 16:03:26.318290 (Thread-2): Using dremio connection "model.subsurface.d_crop_types".
2021-01-28 16:03:26.318997 (Thread-4): Opening a new connection, currently in state init
2021-01-28 16:03:26.319574 (Thread-3): Opening a new connection, currently in state init
2021-01-28 16:03:26.320318 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-28 16:03:26.320946 (Thread-2): On model.subsurface.d_crop_types: 
  create or replace view "@fab4"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "@fab4"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 16:03:26.321588 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:26.322019 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:26.322628 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "@fab4"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "subsurface_datalake"."valeurs_foncieres"
  )

2021-01-28 16:03:26.323159 (Thread-2): Opening a new connection, currently in state init
2021-01-28 16:03:26.324901 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:26.324312 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:03:26.325761 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:27.076290 (Thread-3): Connected to db: None
2021-01-28 16:03:27.078085 (Thread-1): Connected to db: None
2021-01-28 16:03:27.091929 (Thread-4): Connected to db: None
2021-01-28 16:03:27.126090 (Thread-2): Connected to db: None
2021-01-28 16:03:27.192037 (Thread-3): SQL status: OK in 0.87 seconds
2021-01-28 16:03:27.209356 (Thread-3): finished collecting timing info
2021-01-28 16:03:27.210588 (Thread-3): On model.subsurface.d_premises_types: ROLLBACK
2021-01-28 16:03:27.210974 (Thread-3): On model.subsurface.d_premises_types: Close
2021-01-28 16:03:27.214843 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5637bc-f184-49cc-a93e-31ed64d4eb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3cf16cf8>]}
2021-01-28 16:03:27.219260 (Thread-3): 17:03:27 | 4 of 6 OK created view model @fab4.d_premises_types.................. [OK in 1.28s]
2021-01-28 16:03:27.219819 (Thread-3): Finished running node model.subsurface.d_premises_types
2021-01-28 16:03:27.231930 (Thread-4): SQL status: OK in 0.91 seconds
2021-01-28 16:03:27.243966 (Thread-4): finished collecting timing info
2021-01-28 16:03:27.245237 (Thread-4): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-28 16:03:27.245657 (Thread-4): On model.subsurface.stg__municipalities: Close
2021-01-28 16:03:27.250748 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5637bc-f184-49cc-a93e-31ed64d4eb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3ce660f0>]}
2021-01-28 16:03:27.255107 (Thread-4): 17:03:27 | 2 of 6 OK created view model @fab4.stg__municipalities............... [OK in 1.39s]
2021-01-28 16:03:27.255703 (Thread-4): Finished running node model.subsurface.stg__municipalities
2021-01-28 16:03:27.257922 (Thread-3): Began running node model.subsurface.d_municipalities
2021-01-28 16:03:27.261910 (Thread-3): 17:03:27 | 5 of 6 START view model @fab4.d_municipalities....................... [RUN]
2021-01-28 16:03:27.263090 (Thread-3): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 16:03:27.263554 (Thread-3): Compiling model.subsurface.d_municipalities
2021-01-28 16:03:27.296712 (Thread-3): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-28 16:03:27.297706 (Thread-3): finished collecting timing info
2021-01-28 16:03:27.308105 (Thread-3): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-28 16:03:27.308918 (Thread-3): Using dremio connection "model.subsurface.d_municipalities".
2021-01-28 16:03:27.309124 (Thread-3): On model.subsurface.d_municipalities: 
  create or replace view "@fab4"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "@fab4"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-28 16:03:27.309325 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 16:03:27.309632 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:27.314936 (Thread-1): SQL status: OK in 0.99 seconds
2021-01-28 16:03:27.321058 (Thread-1): finished collecting timing info
2021-01-28 16:03:27.332758 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-28 16:03:27.333003 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-28 16:03:27.334754 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5637bc-f184-49cc-a93e-31ed64d4eb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3d0d1be0>]}
2021-01-28 16:03:27.337071 (Thread-1): 17:03:27 | 1 of 6 OK created view model @fab4.stg__land_values.................. [OK in 1.48s]
2021-01-28 16:03:27.337358 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-28 16:03:27.340720 (Thread-4): Began running node model.subsurface.f_land_values
2021-01-28 16:03:27.342875 (Thread-4): 17:03:27 | 6 of 6 START view model @fab4.f_land_values.......................... [RUN]
2021-01-28 16:03:27.343544 (Thread-4): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 16:03:27.343784 (Thread-4): Compiling model.subsurface.f_land_values
2021-01-28 16:03:27.379091 (Thread-4): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-28 16:03:27.379928 (Thread-4): finished collecting timing info
2021-01-28 16:03:27.391095 (Thread-4): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-28 16:03:27.391761 (Thread-4): Using dremio connection "model.subsurface.f_land_values".
2021-01-28 16:03:27.391953 (Thread-4): On model.subsurface.f_land_values: 
  create or replace view "@fab4"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "@fab4"."stg__land_values" as stg__land_values
  join "@fab4"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-28 16:03:27.392143 (Thread-4): Opening a new connection, currently in state closed
2021-01-28 16:03:27.392371 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:27.450925 (Thread-2): SQL status: OK in 1.13 seconds
2021-01-28 16:03:27.459665 (Thread-2): finished collecting timing info
2021-01-28 16:03:27.460498 (Thread-2): On model.subsurface.d_crop_types: ROLLBACK
2021-01-28 16:03:27.460783 (Thread-2): On model.subsurface.d_crop_types: Close
2021-01-28 16:03:27.462914 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5637bc-f184-49cc-a93e-31ed64d4eb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3ce66588>]}
2021-01-28 16:03:27.465998 (Thread-2): 17:03:27 | 3 of 6 OK created view model @fab4.d_crop_types...................... [OK in 1.60s]
2021-01-28 16:03:27.466373 (Thread-2): Finished running node model.subsurface.d_crop_types
2021-01-28 16:03:27.636398 (Thread-3): Connected to db: None
2021-01-28 16:03:27.654877 (Thread-4): Connected to db: None
2021-01-28 16:03:27.775937 (Thread-3): SQL status: OK in 0.47 seconds
2021-01-28 16:03:27.784117 (Thread-3): finished collecting timing info
2021-01-28 16:03:27.784738 (Thread-3): On model.subsurface.d_municipalities: ROLLBACK
2021-01-28 16:03:27.784942 (Thread-3): On model.subsurface.d_municipalities: Close
2021-01-28 16:03:27.786989 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5637bc-f184-49cc-a93e-31ed64d4eb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3cf5a4a8>]}
2021-01-28 16:03:27.789192 (Thread-3): 17:03:27 | 5 of 6 OK created view model @fab4.d_municipalities.................. [OK in 0.52s]
2021-01-28 16:03:27.789517 (Thread-3): Finished running node model.subsurface.d_municipalities
2021-01-28 16:03:27.880097 (Thread-4): SQL status: OK in 0.49 seconds
2021-01-28 16:03:27.886964 (Thread-4): finished collecting timing info
2021-01-28 16:03:27.887620 (Thread-4): On model.subsurface.f_land_values: ROLLBACK
2021-01-28 16:03:27.887835 (Thread-4): On model.subsurface.f_land_values: Close
2021-01-28 16:03:27.890286 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5637bc-f184-49cc-a93e-31ed64d4eb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3cfd4390>]}
2021-01-28 16:03:27.892881 (Thread-4): 17:03:27 | 6 of 6 OK created view model @fab4.f_land_values..................... [OK in 0.55s]
2021-01-28 16:03:27.893187 (Thread-4): Finished running node model.subsurface.f_land_values
2021-01-28 16:03:27.920206 (MainThread): Acquiring new dremio connection "master".
2021-01-28 16:03:27.920589 (MainThread): On master: ROLLBACK
2021-01-28 16:03:27.920779 (MainThread): Opening a new connection, currently in state init
2021-01-28 16:03:27.920948 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:03:28.076270 (MainThread): Connected to db: None
2021-01-28 16:03:28.076817 (MainThread): On master: ROLLBACK
2021-01-28 16:03:28.077014 (MainThread): On master: Close
2021-01-28 16:03:28.078633 (MainThread): 17:03:28 | 
2021-01-28 16:03:28.078964 (MainThread): 17:03:28 | Finished running 6 view models in 3.62s.
2021-01-28 16:03:28.079215 (MainThread): Connection 'master' was properly closed.
2021-01-28 16:03:28.079390 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-28 16:03:28.079603 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-28 16:03:28.079771 (MainThread): Connection 'model.subsurface.d_crop_types' was properly closed.
2021-01-28 16:03:28.079933 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-28 16:03:28.135039 (MainThread): 
2021-01-28 16:03:28.135513 (MainThread): Completed successfully
2021-01-28 16:03:28.135849 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-28 16:03:28.136307 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3cefee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3cefe4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3cefe9b0>]}
2021-01-28 16:03:28.136789 (MainThread): Flushing usage events
2021-01-28 16:04:18.145964 (MainThread): Running with dbt=0.18.1
2021-01-28 16:04:18.262780 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-01-28 16:04:18.264143 (MainThread): Tracking: tracking
2021-01-28 16:04:18.279071 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f9d83630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f9d884e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f9d888d0>]}
2021-01-28 16:04:18.330718 (MainThread): Partial parsing not enabled
2021-01-28 16:04:18.332328 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 16:04:18.337877 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 16:04:18.339950 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 16:04:18.370617 (MainThread): Parsing macros/catalog.sql
2021-01-28 16:04:18.374817 (MainThread): Parsing macros/adapters.sql
2021-01-28 16:04:18.416123 (MainThread): Parsing macros/helpers.sql
2021-01-28 16:04:18.447747 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 16:04:18.451388 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 16:04:18.453458 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 16:04:18.458487 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:04:18.483381 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:04:18.491345 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:04:18.502069 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 16:04:18.514594 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:04:18.538863 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 16:04:18.552105 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 16:04:18.569244 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 16:04:18.571141 (MainThread): Parsing macros/core.sql
2021-01-28 16:04:18.577793 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 16:04:18.650915 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 16:04:18.666584 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 16:04:18.668307 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 16:04:18.671472 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 16:04:18.675103 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 16:04:18.678054 (MainThread): Parsing macros/etc/query.sql
2021-01-28 16:04:18.679995 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 16:04:18.745250 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 16:04:18.768397 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 16:04:18.771877 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:04:18.783751 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:04:18.819427 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 16:04:18.864665 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 16:04:18.867732 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 16:04:18.897607 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:04:18.909573 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 16:04:18.918580 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:04:18.929252 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 16:04:18.933833 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 16:04:18.936733 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 16:04:18.940234 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 16:04:18.953994 (MainThread): Partial parsing not enabled
2021-01-28 16:04:19.036602 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 16:04:19.078789 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 16:04:19.100634 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 16:04:19.122716 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 16:04:19.148098 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 16:04:19.174114 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 16:04:19.205587 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 16:04:19.229781 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 16:04:19.263674 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 16:04:19.286263 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 16:04:21.057029 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 16:04:21.633136 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 16:04:21.637992 (MainThread): 
2021-01-28 16:04:21.638674 (MainThread): Acquiring new dremio connection "master".
2021-01-28 16:04:21.647336 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface_space".
2021-01-28 16:04:21.692894 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface_space".
2021-01-28 16:04:21.693256 (ThreadPoolExecutor-0_0): On list_subsurface_space: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface_space')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 16:04:21.693606 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 16:04:21.693887 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:22.046934 (ThreadPoolExecutor-0_0): Connected to db: subsurface_space
2021-01-28 16:04:22.234922 (ThreadPoolExecutor-0_0): SQL status: OK in 0.54 seconds
2021-01-28 16:04:22.267146 (ThreadPoolExecutor-0_0): On list_subsurface_space: Close
2021-01-28 16:04:22.506850 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_space_stage".
2021-01-28 16:04:22.508197 (ThreadPoolExecutor-1_1): Acquiring new dremio connection "list_subsurface_space_no_schema".
2021-01-28 16:04:22.515792 (ThreadPoolExecutor-1_2): Acquiring new dremio connection "list_subsurface_space_reference".
2021-01-28 16:04:22.569751 (ThreadPoolExecutor-1_2): Using dremio connection "list_subsurface_space_reference".
2021-01-28 16:04:22.570858 (ThreadPoolExecutor-1_1): Using dremio connection "list_subsurface_space_no_schema".
2021-01-28 16:04:22.575559 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_space_stage".
2021-01-28 16:04:22.575843 (ThreadPoolExecutor-1_2): On list_subsurface_space_reference: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface_space')
      and ilike(table_schema, 'reference')
      and table_type <> 'system_table'
  
2021-01-28 16:04:22.576229 (ThreadPoolExecutor-1_1): On list_subsurface_space_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface_space')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 16:04:22.576670 (ThreadPoolExecutor-1_0): On list_subsurface_space_stage: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface_space')
      and ilike(table_schema, 'stage')
      and table_type <> 'system_table'
  
2021-01-28 16:04:22.576995 (ThreadPoolExecutor-1_2): Opening a new connection, currently in state init
2021-01-28 16:04:22.577350 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-01-28 16:04:22.577798 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 16:04:22.578130 (ThreadPoolExecutor-1_2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:22.578533 (ThreadPoolExecutor-1_1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:22.578986 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:23.187568 (ThreadPoolExecutor-1_2): Connected to db: subsurface_space
2021-01-28 16:04:23.204277 (ThreadPoolExecutor-1_0): Connected to db: subsurface_space
2021-01-28 16:04:23.204806 (ThreadPoolExecutor-1_1): Connected to db: subsurface_space
2021-01-28 16:04:23.541731 (ThreadPoolExecutor-1_1): SQL status: OK in 0.96 seconds
2021-01-28 16:04:23.542837 (ThreadPoolExecutor-1_1): On list_subsurface_space_no_schema: ROLLBACK
2021-01-28 16:04:23.543121 (ThreadPoolExecutor-1_1): On list_subsurface_space_no_schema: Close
2021-01-28 16:04:23.566809 (ThreadPoolExecutor-1_0): SQL status: OK in 0.99 seconds
2021-01-28 16:04:23.567778 (ThreadPoolExecutor-1_0): On list_subsurface_space_stage: ROLLBACK
2021-01-28 16:04:23.567998 (ThreadPoolExecutor-1_0): On list_subsurface_space_stage: Close
2021-01-28 16:04:23.587803 (ThreadPoolExecutor-1_2): SQL status: OK in 1.01 seconds
2021-01-28 16:04:23.588775 (ThreadPoolExecutor-1_2): On list_subsurface_space_reference: ROLLBACK
2021-01-28 16:04:23.588995 (ThreadPoolExecutor-1_2): On list_subsurface_space_reference: Close
2021-01-28 16:04:23.591945 (MainThread): 17:04:23 | Concurrency: 4 threads (target='managed')
2021-01-28 16:04:23.592253 (MainThread): 17:04:23 | 
2021-01-28 16:04:23.598089 (Thread-2): Began running node seed.subsurface.crop_types
2021-01-28 16:04:23.600615 (Thread-2): 17:04:23 | 1 of 3 START seed file reference.crop_types.......................... [RUN]
2021-01-28 16:04:23.601263 (Thread-2): Acquiring new dremio connection "seed.subsurface.crop_types".
2021-01-28 16:04:23.601562 (Thread-2): finished collecting timing info
2021-01-28 16:04:23.615662 (Thread-3): Began running node seed.subsurface.premises_types
2021-01-28 16:04:23.624490 (Thread-3): 17:04:23 | 2 of 3 START seed file reference.premises_types...................... [RUN]
2021-01-28 16:04:23.624790 (Thread-1): Began running node seed.subsurface.transfer_types
2021-01-28 16:04:23.633018 (Thread-1): 17:04:23 | 3 of 3 START seed file reference.transfer_types...................... [RUN]
2021-01-28 16:04:23.633261 (Thread-3): Acquiring new dremio connection "seed.subsurface.premises_types".
2021-01-28 16:04:23.634191 (Thread-3): finished collecting timing info
2021-01-28 16:04:23.633855 (Thread-1): Acquiring new dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:04:23.653412 (Thread-1): finished collecting timing info
2021-01-28 16:04:24.006736 (Thread-3): On "seed.subsurface.premises_types": cache miss for schema "$scratch.dbt.subsurface_space.reference", this is inefficient
2021-01-28 16:04:24.013823 (Thread-1): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.dbt.subsurface_space.reference", this is inefficient
2021-01-28 16:04:24.019927 (Thread-2): On "seed.subsurface.crop_types": cache miss for schema "$scratch.dbt.subsurface_space.reference", this is inefficient
2021-01-28 16:04:24.031992 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:04:24.041614 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:04:24.051819 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:04:24.052252 (Thread-3): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.subsurface_space.reference')
      and table_type <> 'system_table'
  
2021-01-28 16:04:24.052761 (Thread-1): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.subsurface_space.reference')
      and table_type <> 'system_table'
  
2021-01-28 16:04:24.053222 (Thread-2): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.subsurface_space.reference')
      and table_type <> 'system_table'
  
2021-01-28 16:04:24.053697 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 16:04:24.054146 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:04:24.054623 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 16:04:24.055091 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:24.055515 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:24.055948 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:24.571929 (Thread-3): Connected to db: subsurface_space
2021-01-28 16:04:24.578504 (Thread-2): Connected to db: subsurface_space
2021-01-28 16:04:24.580906 (Thread-1): Connected to db: subsurface_space
2021-01-28 16:04:24.957037 (Thread-1): SQL status: OK in 0.90 seconds
2021-01-28 16:04:24.957920 (Thread-1): with database=$scratch, schema=dbt.subsurface_space.reference, relations=[]
2021-01-28 16:04:24.958546 (Thread-1): On "seed.subsurface.transfer_types": cache miss for schema "$scratch.dbt.subsurface_space.reference", this is inefficient
2021-01-28 16:04:24.964794 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:04:24.965070 (Thread-1): On seed.subsurface.transfer_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.subsurface_space.reference')
      and table_type <> 'system_table'
  
2021-01-28 16:04:24.965599 (Thread-2): SQL status: OK in 0.91 seconds
2021-01-28 16:04:24.966201 (Thread-2): with database=$scratch, schema=dbt.subsurface_space.reference, relations=[]
2021-01-28 16:04:24.966728 (Thread-2): On "seed.subsurface.crop_types": cache miss for schema "$scratch.dbt.subsurface_space.reference", this is inefficient
2021-01-28 16:04:24.972281 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:04:24.972543 (Thread-2): On seed.subsurface.crop_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.subsurface_space.reference')
      and table_type <> 'system_table'
  
2021-01-28 16:04:24.973960 (Thread-3): SQL status: OK in 0.92 seconds
2021-01-28 16:04:24.974622 (Thread-3): with database=$scratch, schema=dbt.subsurface_space.reference, relations=[]
2021-01-28 16:04:24.975104 (Thread-3): On "seed.subsurface.premises_types": cache miss for schema "$scratch.dbt.subsurface_space.reference", this is inefficient
2021-01-28 16:04:24.980774 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:04:24.981007 (Thread-3): On seed.subsurface.premises_types: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, '$scratch')
      and ilike(table_schema, 'dbt.subsurface_space.reference')
      and table_type <> 'system_table'
  
2021-01-28 16:04:25.291992 (Thread-3): SQL status: OK in 0.31 seconds
2021-01-28 16:04:25.292932 (Thread-3): with database=$scratch, schema=dbt.subsurface_space.reference, relations=[]
2021-01-28 16:04:25.307750 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:04:25.308081 (Thread-3): On seed.subsurface.premises_types: drop table if exists "$scratch"."dbt"."subsurface_space"."reference"."premises_types_green"
2021-01-28 16:04:25.309622 (Thread-1): SQL status: OK in 0.34 seconds
2021-01-28 16:04:25.310270 (Thread-1): with database=$scratch, schema=dbt.subsurface_space.reference, relations=[]
2021-01-28 16:04:25.314865 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:04:25.315091 (Thread-1): On seed.subsurface.transfer_types: drop table if exists "$scratch"."dbt"."subsurface_space"."reference"."transfer_types_green"
2021-01-28 16:04:25.320129 (Thread-2): SQL status: OK in 0.35 seconds
2021-01-28 16:04:25.320820 (Thread-2): with database=$scratch, schema=dbt.subsurface_space.reference, relations=[]
2021-01-28 16:04:25.325190 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:04:25.326521 (Thread-2): On seed.subsurface.crop_types: drop table if exists "$scratch"."dbt"."subsurface_space"."reference"."crop_types_green"
2021-01-28 16:04:25.343800 (Thread-2): SQL status: OK in 0.02 seconds
2021-01-28 16:04:25.355071 (Thread-2): Writing runtime SQL for node "seed.subsurface.crop_types"
2021-01-28 16:04:25.356046 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:04:25.356245 (Thread-2): On seed.subsurface.crop_types: 
    

  create table
    "$scratch"."dbt"."subsurface_space"."reference"."crop_types_green"
  as (
    select
    cast(crop_code as varchar)
        as crop_code,cast(crop_label as varchar)
        as crop_label
  from
    (values
      
        (
            'AB'
          ,
            'Terrains à bâtir'
          ),
      
        (
            'AG'
          ,
            'Terrains d''agrément'
          ),
      
        (
            'B'
          ,
            'Bois'
          ),
      
        (
            'BF'
          ,
            'Futaies Feuillues'
          ),
      
        (
            'BM'
          ,
            'Futaies Mixtes'
          ),
      
        (
            'BO'
          ,
            'Oseraies'
          ),
      
        (
            'BP'
          ,
            'Peupleraies'
          ),
      
        (
            'BR'
          ,
            'Futaies résineuses'
          ),
      
        (
            'BS'
          ,
            'Taillis sous Futaies'
          ),
      
        (
            'BT'
          ,
            'Taillis simples'
          ),
      
        (
            'CA'
          ,
            'Carrières'
          ),
      
        (
            'CH'
          ,
            'Chemins de fer & Canaux de Navigation'
          ),
      
        (
            'E'
          ,
            'Eaux'
          ),
      
        (
            'J'
          ,
            'Jardins'
          ),
      
        (
            'L'
          ,
            'Landes'
          ),
      
        (
            'LB'
          ,
            'Landes Boisées'
          ),
      
        (
            'P'
          ,
            'Prés'
          ),
      
        (
            'PA'
          ,
            'Pâtures ou Pâturages'
          ),
      
        (
            'PC'
          ,
            'Pacages ou Pâtis'
          ),
      
        (
            'PE'
          ,
            'Prés d''embouche'
          ),
      
        (
            'PH'
          ,
            'Herbages'
          ),
      
        (
            'PP'
          ,
            'Prés Pâtures ou Herbages plantés'
          ),
      
        (
            'S'
          ,
            'Sols'
          ),
      
        (
            'T'
          ,
            'Terre'
          ),
      
        (
            'TP'
          ,
            'Terres plantées'
          ),
      
        (
            'VE'
          ,
            'Vergers'
          ),
      
        (
            'VI'
          ,
            'Vignes'
          )
      ) temp_table ( crop_code, crop_label )

  )

  
2021-01-28 16:04:25.356614 (Thread-3): SQL status: OK in 0.05 seconds
2021-01-28 16:04:25.359613 (Thread-3): Writing runtime SQL for node "seed.subsurface.premises_types"
2021-01-28 16:04:25.360271 (Thread-1): SQL status: OK in 0.04 seconds
2021-01-28 16:04:25.360615 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:04:25.364977 (Thread-3): On seed.subsurface.premises_types: 
    

  create table
    "$scratch"."dbt"."subsurface_space"."reference"."premises_types_green"
  as (
    select
    cast(premises_code as varchar)
        as premises_code,cast(premises_label_fr as varchar)
        as premises_label_fr,cast(premises_label_en as varchar)
        as premises_label_en
  from
    (values
      
        (
            '1'
          ,
            'Maison'
          ,
            'House'
          ),
      
        (
            '2'
          ,
            'Appartement'
          ,
            'Flat'
          ),
      
        (
            '3'
          ,
            'Dépendance'
          ,
            'Outbuilding'
          ),
      
        (
            '4'
          ,
            'Local industriel. commercial ou assimilé'
          ,
            'Industrial premises. commercial or similar'
          )
      ) temp_table ( premises_code, premises_label_fr, premises_label_en )

  )

  
2021-01-28 16:04:25.364698 (Thread-1): Writing runtime SQL for node "seed.subsurface.transfer_types"
2021-01-28 16:04:25.366527 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:04:25.366734 (Thread-1): On seed.subsurface.transfer_types: 
    

  create table
    "$scratch"."dbt"."subsurface_space"."reference"."transfer_types_green"
  as (
    select
    cast(transfer_label_fr as varchar)
        as transfer_label_fr,cast(transfer_label_en as varchar)
        as transfer_label_en
  from
    (values
      
        (
            'Expropriation'
          ,
            'Expropriation'
          ),
      
        (
            'Vente'
          ,
            'Sale'
          ),
      
        (
            'Echange'
          ,
            'Exchange'
          ),
      
        (
            'Adjudication'
          ,
            'Sale by tender'
          ),
      
        (
            'Vente en l''état futur d''achèvement'
          ,
            'Sale before completion'
          ),
      
        (
            'Vente terrain à bâtir'
          ,
            'Building plot sale'
          )
      ) temp_table ( transfer_label_fr, transfer_label_en )

  )

  
2021-01-28 16:04:25.519935 (Thread-3): SQL status: OK in 0.15 seconds
2021-01-28 16:04:25.530083 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:04:25.530775 (Thread-3): On seed.subsurface.premises_types: 
    
  create or replace view "subsurface_space"."reference"."premises_types" as (
    select * from "$scratch"."dbt"."subsurface_space"."reference"."premises_types_green"
  )

  
2021-01-28 16:04:25.546145 (Thread-1): SQL status: OK in 0.18 seconds
2021-01-28 16:04:25.549275 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:04:25.549586 (Thread-1): On seed.subsurface.transfer_types: 
    
  create or replace view "subsurface_space"."reference"."transfer_types" as (
    select * from "$scratch"."dbt"."subsurface_space"."reference"."transfer_types_green"
  )

  
2021-01-28 16:04:25.570683 (Thread-2): SQL status: OK in 0.21 seconds
2021-01-28 16:04:25.574023 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:04:25.574256 (Thread-2): On seed.subsurface.crop_types: 
    
  create or replace view "subsurface_space"."reference"."crop_types" as (
    select * from "$scratch"."dbt"."subsurface_space"."reference"."crop_types_green"
  )

  
2021-01-28 16:04:25.806051 (Thread-2): SQL status: OK in 0.23 seconds
2021-01-28 16:04:25.814236 (Thread-2): Using dremio connection "seed.subsurface.crop_types".
2021-01-28 16:04:25.814605 (Thread-2): On seed.subsurface.crop_types: drop table if exists "$scratch"."dbt"."subsurface_space"."reference"."crop_types_blue"
2021-01-28 16:04:25.820675 (Thread-1): SQL status: OK in 0.27 seconds
2021-01-28 16:04:25.827024 (Thread-1): Using dremio connection "seed.subsurface.transfer_types".
2021-01-28 16:04:25.827282 (Thread-1): On seed.subsurface.transfer_types: drop table if exists "$scratch"."dbt"."subsurface_space"."reference"."transfer_types_blue"
2021-01-28 16:04:25.827558 (Thread-3): SQL status: OK in 0.30 seconds
2021-01-28 16:04:25.833236 (Thread-3): Using dremio connection "seed.subsurface.premises_types".
2021-01-28 16:04:25.833495 (Thread-3): On seed.subsurface.premises_types: drop table if exists "$scratch"."dbt"."subsurface_space"."reference"."premises_types_blue"
2021-01-28 16:04:25.852106 (Thread-1): SQL status: OK in 0.02 seconds
2021-01-28 16:04:25.862723 (Thread-2): SQL status: OK in 0.05 seconds
2021-01-28 16:04:25.872590 (Thread-1): finished collecting timing info
2021-01-28 16:04:25.873517 (Thread-3): SQL status: OK in 0.04 seconds
2021-01-28 16:04:25.887157 (Thread-2): finished collecting timing info
2021-01-28 16:04:25.888400 (Thread-1): On seed.subsurface.transfer_types: ROLLBACK
2021-01-28 16:04:25.892171 (Thread-2): On seed.subsurface.crop_types: ROLLBACK
2021-01-28 16:04:25.899938 (Thread-1): On seed.subsurface.transfer_types: Close
2021-01-28 16:04:25.901666 (Thread-3): finished collecting timing info
2021-01-28 16:04:25.902587 (Thread-2): On seed.subsurface.crop_types: Close
2021-01-28 16:04:25.903264 (Thread-3): On seed.subsurface.premises_types: ROLLBACK
2021-01-28 16:04:25.904937 (Thread-3): On seed.subsurface.premises_types: Close
2021-01-28 16:04:25.909287 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f1cc77-ce6b-4e99-8c16-e50e39f084aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8e5c128>]}
2021-01-28 16:04:25.910124 (Thread-2): 17:04:25 | 1 of 3 OK loaded seed file reference.crop_types...................... [OK in 2.31s]
2021-01-28 16:04:25.912759 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f1cc77-ce6b-4e99-8c16-e50e39f084aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f90db588>]}
2021-01-28 16:04:25.913166 (Thread-2): Finished running node seed.subsurface.crop_types
2021-01-28 16:04:25.915179 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f1cc77-ce6b-4e99-8c16-e50e39f084aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8ef7f28>]}
2021-01-28 16:04:25.915940 (Thread-1): 17:04:25 | 3 of 3 OK loaded seed file reference.transfer_types.................. [OK in 2.28s]
2021-01-28 16:04:25.917586 (Thread-3): 17:04:25 | 2 of 3 OK loaded seed file reference.premises_types.................. [OK in 2.29s]
2021-01-28 16:04:25.918324 (Thread-1): Finished running node seed.subsurface.transfer_types
2021-01-28 16:04:25.918930 (Thread-3): Finished running node seed.subsurface.premises_types
2021-01-28 16:04:25.938379 (MainThread): Acquiring new dremio connection "master".
2021-01-28 16:04:25.938986 (MainThread): On master: ROLLBACK
2021-01-28 16:04:25.939292 (MainThread): Opening a new connection, currently in state init
2021-01-28 16:04:25.939635 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:26.198229 (MainThread): Connected to db: subsurface_space
2021-01-28 16:04:26.199354 (MainThread): On master: ROLLBACK
2021-01-28 16:04:26.199974 (MainThread): On master: Close
2021-01-28 16:04:26.203963 (MainThread): 17:04:26 | 
2021-01-28 16:04:26.204750 (MainThread): 17:04:26 | Finished running 3 seeds in 4.57s.
2021-01-28 16:04:26.205391 (MainThread): Connection 'master' was properly closed.
2021-01-28 16:04:26.205986 (MainThread): Connection 'seed.subsurface.crop_types' was properly closed.
2021-01-28 16:04:26.206549 (MainThread): Connection 'seed.subsurface.premises_types' was properly closed.
2021-01-28 16:04:26.207045 (MainThread): Connection 'seed.subsurface.transfer_types' was properly closed.
2021-01-28 16:04:26.260296 (MainThread): 
2021-01-28 16:04:26.260751 (MainThread): Completed successfully
2021-01-28 16:04:26.261032 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-28 16:04:26.261499 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fdd5f278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8f47828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8f47780>]}
2021-01-28 16:04:26.261947 (MainThread): Flushing usage events
2021-01-28 16:04:36.956217 (MainThread): Running with dbt=0.18.1
2021-01-28 16:04:37.078275 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target='managed', test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 16:04:37.080006 (MainThread): Tracking: tracking
2021-01-28 16:04:37.094746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bce0c8588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bce0cc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bce0cc9b0>]}
2021-01-28 16:04:37.170793 (MainThread): Partial parsing not enabled
2021-01-28 16:04:37.173110 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 16:04:37.181429 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 16:04:37.184605 (MainThread): Parsing macros/non_regression_test.sql
2021-01-28 16:04:37.214802 (MainThread): Parsing macros/catalog.sql
2021-01-28 16:04:37.218913 (MainThread): Parsing macros/adapters.sql
2021-01-28 16:04:37.258752 (MainThread): Parsing macros/helpers.sql
2021-01-28 16:04:37.288271 (MainThread): Parsing macros/get_custom_database.sql
2021-01-28 16:04:37.291744 (MainThread): Parsing macros/get_custom_schema.sql
2021-01-28 16:04:37.293706 (MainThread): Parsing macros/drop_orphaned_tables.sql
2021-01-28 16:04:37.298678 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:04:37.322916 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:04:37.330573 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:04:37.341101 (MainThread): Parsing macros/materializations/file/file.sql
2021-01-28 16:04:37.353194 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:04:37.376979 (MainThread): Parsing macros/materializations/raw_reflection/raw_reflection.sql
2021-01-28 16:04:37.390055 (MainThread): Parsing macros/materializations/aggregation_reflection/aggregation_reflection.sql
2021-01-28 16:04:37.406770 (MainThread): Parsing macros/operations/drop_orphan_tables.sql
2021-01-28 16:04:37.408757 (MainThread): Parsing macros/core.sql
2021-01-28 16:04:37.415201 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 16:04:37.486552 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 16:04:37.501741 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 16:04:37.503532 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 16:04:37.506571 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 16:04:37.510372 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 16:04:37.513231 (MainThread): Parsing macros/etc/query.sql
2021-01-28 16:04:37.515168 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 16:04:37.580091 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 16:04:37.603215 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 16:04:37.606551 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:04:37.617582 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:04:37.652597 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 16:04:37.697103 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 16:04:37.700211 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 16:04:37.729556 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:04:37.741006 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 16:04:37.749886 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:04:37.760335 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 16:04:37.765145 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 16:04:37.767956 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 16:04:37.771463 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 16:04:37.785341 (MainThread): Partial parsing not enabled
2021-01-28 16:04:37.866094 (MainThread): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 16:04:37.907326 (MainThread): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 16:04:37.929071 (MainThread): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 16:04:37.950903 (MainThread): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 16:04:37.975946 (MainThread): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 16:04:38.001793 (MainThread): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 16:04:38.032912 (MainThread): Acquiring new dremio connection "analysis.subsurface.most_expensive_departments_for_flats".
2021-01-28 16:04:38.056882 (MainThread): Acquiring new dremio connection "analysis.subsurface.transactions_seasonality".
2021-01-28 16:04:38.090063 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_built_surface_implies_premises_code".
2021-01-28 16:04:38.111713 (MainThread): Acquiring new dremio connection "test.subsurface.stg__land_values_land_surface_implies_crop_code".
2021-01-28 16:04:39.980041 (MainThread): WARNING: Found documentation for resource "most_expansive_departments_for_flats" which was not found or is disabled
2021-01-28 16:04:40.555950 (MainThread): Found 6 models, 48 tests, 0 snapshots, 2 analyses, 167 macros, 0 operations, 3 seed files, 2 sources
2021-01-28 16:04:40.561103 (MainThread): 
2021-01-28 16:04:40.561757 (MainThread): Acquiring new dremio connection "master".
2021-01-28 16:04:40.579697 (ThreadPoolExecutor-0_0): Acquiring new dremio connection "list_subsurface_space".
2021-01-28 16:04:40.581544 (ThreadPoolExecutor-0_1): Acquiring new dremio connection "list_subsurface_space".
2021-01-28 16:04:40.622619 (ThreadPoolExecutor-0_0): Using dremio connection "list_subsurface_space".
2021-01-28 16:04:40.628300 (ThreadPoolExecutor-0_0): On list_subsurface_space: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface_space')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 16:04:40.636704 (ThreadPoolExecutor-0_1): Using dremio connection "list_subsurface_space".
2021-01-28 16:04:40.637114 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 16:04:40.637584 (ThreadPoolExecutor-0_1): On list_subsurface_space: 
    
    with schemata as (
        select lower(case when position('.' in schema_name) > 0
                then substring(schema_name, 1, position('.' in schema_name) - 1)
                else schema_name
            end) as catalog_name
            ,lower(case when position('.' in schema_name) > 0
                then substring(schema_name, position('.' in schema_name) + 1)
                else 'no_schema'
            end) as schema_name
        from information_schema.schemata
    )
    select distinct schema_name
    from schemata
    where ilike(catalog_name, 'subsurface_space')
      -- and schema_name <> 'no_schema'
  
  
2021-01-28 16:04:40.637990 (ThreadPoolExecutor-0_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:40.638399 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2021-01-28 16:04:40.639934 (ThreadPoolExecutor-0_1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:41.133695 (ThreadPoolExecutor-0_0): Connected to db: subsurface_space
2021-01-28 16:04:41.144235 (ThreadPoolExecutor-0_1): Connected to db: subsurface_space
2021-01-28 16:04:41.294980 (ThreadPoolExecutor-0_0): SQL status: OK in 0.66 seconds
2021-01-28 16:04:41.333363 (ThreadPoolExecutor-0_0): On list_subsurface_space: Close
2021-01-28 16:04:41.335868 (ThreadPoolExecutor-0_1): SQL status: OK in 0.70 seconds
2021-01-28 16:04:41.357960 (ThreadPoolExecutor-0_1): On list_subsurface_space: Close
2021-01-28 16:04:41.555218 (ThreadPoolExecutor-1_0): Acquiring new dremio connection "list_subsurface_space_stage".
2021-01-28 16:04:41.565075 (ThreadPoolExecutor-1_1): Acquiring new dremio connection "list_subsurface_space_reference".
2021-01-28 16:04:41.578514 (ThreadPoolExecutor-1_2): Acquiring new dremio connection "list_subsurface_space_no_schema".
2021-01-28 16:04:41.602705 (ThreadPoolExecutor-1_1): Using dremio connection "list_subsurface_space_reference".
2021-01-28 16:04:41.604025 (ThreadPoolExecutor-1_2): Using dremio connection "list_subsurface_space_no_schema".
2021-01-28 16:04:41.610965 (ThreadPoolExecutor-1_2): On list_subsurface_space_no_schema: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface_space')
      and ilike(table_schema, 'no_schema')
      and table_type <> 'system_table'
  
2021-01-28 16:04:41.610577 (ThreadPoolExecutor-1_1): On list_subsurface_space_reference: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface_space')
      and ilike(table_schema, 'reference')
      and table_type <> 'system_table'
  
2021-01-28 16:04:41.611301 (ThreadPoolExecutor-1_2): Opening a new connection, currently in state init
2021-01-28 16:04:41.611913 (ThreadPoolExecutor-1_2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:41.611603 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state closed
2021-01-28 16:04:41.612399 (ThreadPoolExecutor-1_1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:41.610286 (ThreadPoolExecutor-1_0): Using dremio connection "list_subsurface_space_stage".
2021-01-28 16:04:41.612877 (ThreadPoolExecutor-1_0): On list_subsurface_space_stage: with t1(table_catalog, table_name, table_schema, table_type) as (
    select lower(case when position('.' in table_schema) > 0
            then substring(table_schema, 1, position('.' in table_schema) - 1)
            else table_schema
        end)
        ,lower(table_name)
        ,lower(case when position('.' in table_schema) > 0
            then substring(table_schema, position('.' in table_schema) + 1)
            else 'no_schema'
        end)
        ,lower(table_type)
    from information_schema."tables"
    )
    ,r1(identifier_position, database_end_position, dataset, name, type) as (
        select
            case when "RIGHT"(dataset, 1) = '"'
                then length(dataset) - strpos(substr(reverse(dataset), 2), '"')
                else length(dataset) - strpos(reverse(dataset), '.') + 2
            end
            ,case when "LEFT"(dataset, 1) = '"'
                then strpos(substr(dataset, 2), '"') + 1
                else strpos(dataset, '.') - 1
            end
            ,dataset
            ,name
            ,type
        from sys.reflections
    )
    ,r2(table_catalog, table_name, table_schema, table_type) as (
    select
        lower(replace(substr(dataset, 1, database_end_position), '"', ''))
        ,lower(name)
        ,case when identifier_position - database_end_position > 2
            then lower(replace(substr(dataset, database_end_position + 2, identifier_position - database_end_position - 3), '"', ''))
            else 'no_schema'
        end
        -- ,lower(type) || 'reflection'
        ,'materializedview'
--        ,replace(substr(dataset, identifier_position), '"', '') as identifier
    from r1
    )
    ,u(table_catalog, table_name, table_schema, table_type) as (
      select *
      from t1
      union all
      select *
      from r2
    )

    select *
    from u
    where ilike(table_catalog, 'subsurface_space')
      and ilike(table_schema, 'stage')
      and table_type <> 'system_table'
  
2021-01-28 16:04:41.613170 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 16:04:41.613426 (ThreadPoolExecutor-1_0): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:42.072719 (ThreadPoolExecutor-1_1): Connected to db: subsurface_space
2021-01-28 16:04:42.083772 (ThreadPoolExecutor-1_2): Connected to db: subsurface_space
2021-01-28 16:04:42.085325 (ThreadPoolExecutor-1_0): Connected to db: subsurface_space
2021-01-28 16:04:42.282646 (ThreadPoolExecutor-1_1): SQL status: OK in 0.67 seconds
2021-01-28 16:04:42.337729 (ThreadPoolExecutor-1_1): On list_subsurface_space_reference: ROLLBACK
2021-01-28 16:04:42.338311 (ThreadPoolExecutor-1_1): On list_subsurface_space_reference: Close
2021-01-28 16:04:42.366044 (ThreadPoolExecutor-1_2): SQL status: OK in 0.75 seconds
2021-01-28 16:04:42.367014 (ThreadPoolExecutor-1_2): On list_subsurface_space_no_schema: ROLLBACK
2021-01-28 16:04:42.367242 (ThreadPoolExecutor-1_2): On list_subsurface_space_no_schema: Close
2021-01-28 16:04:42.419770 (ThreadPoolExecutor-1_0): SQL status: OK in 0.81 seconds
2021-01-28 16:04:42.420732 (ThreadPoolExecutor-1_0): On list_subsurface_space_stage: ROLLBACK
2021-01-28 16:04:42.420952 (ThreadPoolExecutor-1_0): On list_subsurface_space_stage: Close
2021-01-28 16:04:42.424090 (MainThread): 17:04:42 | Concurrency: 4 threads (target='managed')
2021-01-28 16:04:42.424608 (MainThread): 17:04:42 | 
2021-01-28 16:04:42.431360 (Thread-1): Began running node model.subsurface.stg__land_values
2021-01-28 16:04:42.431907 (Thread-4): Began running node model.subsurface.stg__municipalities
2021-01-28 16:04:42.434723 (Thread-1): 17:04:42 | 1 of 6 START view model stage.stg__land_values....................... [RUN]
2021-01-28 16:04:42.434917 (Thread-2): Began running node model.subsurface.d_crop_types
2021-01-28 16:04:42.435124 (Thread-3): Began running node model.subsurface.d_premises_types
2021-01-28 16:04:42.439065 (Thread-4): 17:04:42 | 2 of 6 START view model stage.stg__municipalities.................... [RUN]
2021-01-28 16:04:42.439942 (Thread-1): Acquiring new dremio connection "model.subsurface.stg__land_values".
2021-01-28 16:04:42.443942 (Thread-2): 17:04:42 | 3 of 6 START view model d_crop_types................................. [RUN]
2021-01-28 16:04:42.446711 (Thread-3): 17:04:42 | 4 of 6 START view model d_premises_types............................. [RUN]
2021-01-28 16:04:42.447325 (Thread-1): Compiling model.subsurface.stg__land_values
2021-01-28 16:04:42.464910 (Thread-4): Acquiring new dremio connection "model.subsurface.stg__municipalities".
2021-01-28 16:04:42.493703 (Thread-4): Compiling model.subsurface.stg__municipalities
2021-01-28 16:04:42.476617 (Thread-3): Acquiring new dremio connection "model.subsurface.d_premises_types".
2021-01-28 16:04:42.520972 (Thread-3): Compiling model.subsurface.d_premises_types
2021-01-28 16:04:42.504531 (Thread-1): Writing injected SQL for node "model.subsurface.stg__land_values"
2021-01-28 16:04:42.470513 (Thread-2): Acquiring new dremio connection "model.subsurface.d_crop_types".
2021-01-28 16:04:42.563551 (Thread-2): Compiling model.subsurface.d_crop_types
2021-01-28 16:04:42.566034 (Thread-3): Writing injected SQL for node "model.subsurface.d_premises_types"
2021-01-28 16:04:42.577543 (Thread-4): Writing injected SQL for node "model.subsurface.stg__municipalities"
2021-01-28 16:04:42.610067 (Thread-4): finished collecting timing info
2021-01-28 16:04:42.578206 (Thread-1): finished collecting timing info
2021-01-28 16:04:42.608955 (Thread-2): Writing injected SQL for node "model.subsurface.d_crop_types"
2021-01-28 16:04:42.652376 (Thread-3): finished collecting timing info
2021-01-28 16:04:42.695333 (Thread-2): finished collecting timing info
2021-01-28 16:04:42.814878 (Thread-1): Writing runtime SQL for node "model.subsurface.stg__land_values"
2021-01-28 16:04:42.823062 (Thread-3): Writing runtime SQL for node "model.subsurface.d_premises_types"
2021-01-28 16:04:42.827569 (Thread-2): Writing runtime SQL for node "model.subsurface.d_crop_types"
2021-01-28 16:04:42.828683 (Thread-4): Writing runtime SQL for node "model.subsurface.stg__municipalities"
2021-01-28 16:04:42.830851 (Thread-1): Using dremio connection "model.subsurface.stg__land_values".
2021-01-28 16:04:42.831725 (Thread-3): Using dremio connection "model.subsurface.d_premises_types".
2021-01-28 16:04:42.832774 (Thread-1): On model.subsurface.stg__land_values: 
  create or replace view "subsurface_space"."stage"."stg__land_values" as (
    select
  cast(regexp_replace(nullif("Date mutation", ''), '([0-9]{2})/([0-9]{2})/([0-9]{4})', '$3-$2-$1') as date) as transaction_date
  ,cast(replace(nullif("Valeur fonciere", ''), ',', '.') as decimal) as transaction_amount
  ,nullif("Nature mutation", '') as transfer_label_fr
  ,nullif("type de voie", '') as lane_type
  ,lpad(nullif("Code voie", ''), 4, '0') as lane_code
  ,nullif("Voie", '') as lane
  ,lpad(nullif("Code postal", ''), 5, '0') as zip_code
  ,case when "Code departement" not like '97%'
    then lpad(nullif("Code departement", ''), 2, '0') || lpad(nullif("Code commune", ''), 3, '0')
    else lpad(nullif("Code departement", ''), 3, '0') || lpad(nullif("Code commune", ''), 2, '0')
  end as municipality_code
  ,cast(nullif("Nombre de lots", '') as decimal) as lots_count
  ,nullif("code type local", '') as premises_code
  ,cast(nullif("Surface reelle bati", '') as decimal) as built_surface
  ,cast(nullif("Surface terrain", '') as decimal) as land_surface
  ,cast(nullif("Nombre pieces principales", '') as decimal) as main_rooms_count
  ,nullif("Nature culture", '') as crop_code
from
  "subsurface_datalake"."valeurs_foncieres"
  )

2021-01-28 16:04:42.833856 (Thread-3): On model.subsurface.d_premises_types: 
  create or replace view "subsurface_space"."d_premises_types" as (
    select
  premises_code
  ,premises_label_en as premises_label
from
  "subsurface_space"."reference"."premises_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 16:04:42.834617 (Thread-4): Using dremio connection "model.subsurface.stg__municipalities".
2021-01-28 16:04:42.835106 (Thread-2): Using dremio connection "model.subsurface.d_crop_types".
2021-01-28 16:04:42.835526 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:04:42.835979 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 16:04:42.836460 (Thread-4): On model.subsurface.stg__municipalities: 
  create or replace view "subsurface_space"."stage"."stg__municipalities" as (
    select
    com_code as municipality_code
    ,com_nom as municipality_label
    ,dep_code as department_code
    ,dep_nom_num as department_label
    ,reg_code as region_code
    ,reg_nom as region_label
from
  "subsurface_datalake"."geo"."communes.csv"
  )

2021-01-28 16:04:42.836956 (Thread-2): On model.subsurface.d_crop_types: 
  create or replace view "subsurface_space"."d_crop_types" as (
    select
  crop_code
  ,crop_label
from
  "subsurface_space"."reference"."crop_types"

union all

select
  'N/A'
  ,'N/A'
  )

2021-01-28 16:04:42.837413 (Thread-1): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:42.837918 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:42.838379 (Thread-4): Opening a new connection, currently in state init
2021-01-28 16:04:42.838905 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 16:04:42.839941 (Thread-4): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:42.840362 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:43.460509 (Thread-2): Connected to db: subsurface_space
2021-01-28 16:04:43.461895 (Thread-3): Connected to db: subsurface_space
2021-01-28 16:04:43.465878 (Thread-4): Connected to db: subsurface_space
2021-01-28 16:04:43.477993 (Thread-1): Connected to db: subsurface_space
2021-01-28 16:04:43.778381 (Thread-3): SQL status: OK in 0.94 seconds
2021-01-28 16:04:43.789661 (Thread-3): finished collecting timing info
2021-01-28 16:04:43.790378 (Thread-3): On model.subsurface.d_premises_types: ROLLBACK
2021-01-28 16:04:43.790663 (Thread-3): On model.subsurface.d_premises_types: Close
2021-01-28 16:04:43.792776 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6ac668-695e-464e-ad41-12bc6aa70f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcd2303c8>]}
2021-01-28 16:04:43.795497 (Thread-3): 17:04:43 | 4 of 6 OK created view model d_premises_types........................ [OK in 1.32s]
2021-01-28 16:04:43.795841 (Thread-3): Finished running node model.subsurface.d_premises_types
2021-01-28 16:04:43.850218 (Thread-2): SQL status: OK in 1.01 seconds
2021-01-28 16:04:43.858963 (Thread-2): finished collecting timing info
2021-01-28 16:04:43.859760 (Thread-2): On model.subsurface.d_crop_types: ROLLBACK
2021-01-28 16:04:43.860027 (Thread-2): On model.subsurface.d_crop_types: Close
2021-01-28 16:04:43.862078 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6ac668-695e-464e-ad41-12bc6aa70f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcd1d1588>]}
2021-01-28 16:04:43.865031 (Thread-2): 17:04:43 | 3 of 6 OK created view model d_crop_types............................ [OK in 1.40s]
2021-01-28 16:04:43.865403 (Thread-2): Finished running node model.subsurface.d_crop_types
2021-01-28 16:04:43.918943 (Thread-4): SQL status: OK in 1.08 seconds
2021-01-28 16:04:43.928729 (Thread-4): finished collecting timing info
2021-01-28 16:04:43.929627 (Thread-4): On model.subsurface.stg__municipalities: ROLLBACK
2021-01-28 16:04:43.929953 (Thread-4): On model.subsurface.stg__municipalities: Close
2021-01-28 16:04:43.933118 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6ac668-695e-464e-ad41-12bc6aa70f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bce0cc518>]}
2021-01-28 16:04:43.936550 (Thread-4): 17:04:43 | 2 of 6 OK created view model stage.stg__municipalities............... [OK in 1.48s]
2021-01-28 16:04:43.936969 (Thread-4): Finished running node model.subsurface.stg__municipalities
2021-01-28 16:04:43.938494 (Thread-3): Began running node model.subsurface.d_municipalities
2021-01-28 16:04:43.941653 (Thread-3): 17:04:43 | 5 of 6 START view model d_municipalities............................. [RUN]
2021-01-28 16:04:43.942539 (Thread-3): Acquiring new dremio connection "model.subsurface.d_municipalities".
2021-01-28 16:04:43.942885 (Thread-3): Compiling model.subsurface.d_municipalities
2021-01-28 16:04:43.971655 (Thread-3): Writing injected SQL for node "model.subsurface.d_municipalities"
2021-01-28 16:04:43.972902 (Thread-3): finished collecting timing info
2021-01-28 16:04:43.987425 (Thread-3): Writing runtime SQL for node "model.subsurface.d_municipalities"
2021-01-28 16:04:43.988640 (Thread-3): Using dremio connection "model.subsurface.d_municipalities".
2021-01-28 16:04:43.988928 (Thread-3): On model.subsurface.d_municipalities: 
  create or replace view "subsurface_space"."d_municipalities" as (
    select
  municipality_code
  ,municipality_label
  ,department_code
  ,department_label
  ,region_code
  ,region_label
from
  "subsurface_space"."stage"."stg__municipalities"

union all

select
  'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  ,'N/A'
  )

2021-01-28 16:04:43.989221 (Thread-3): Opening a new connection, currently in state closed
2021-01-28 16:04:43.989589 (Thread-3): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:44.173859 (Thread-1): SQL status: OK in 1.34 seconds
2021-01-28 16:04:44.181239 (Thread-1): finished collecting timing info
2021-01-28 16:04:44.181969 (Thread-1): On model.subsurface.stg__land_values: ROLLBACK
2021-01-28 16:04:44.182217 (Thread-1): On model.subsurface.stg__land_values: Close
2021-01-28 16:04:44.185093 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6ac668-695e-464e-ad41-12bc6aa70f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcd306b38>]}
2021-01-28 16:04:44.187753 (Thread-1): 17:04:44 | 1 of 6 OK created view model stage.stg__land_values.................. [OK in 1.74s]
2021-01-28 16:04:44.188086 (Thread-1): Finished running node model.subsurface.stg__land_values
2021-01-28 16:04:44.189050 (Thread-2): Began running node model.subsurface.f_land_values
2021-01-28 16:04:44.191198 (Thread-2): 17:04:44 | 6 of 6 START view model f_land_values................................ [RUN]
2021-01-28 16:04:44.191816 (Thread-2): Acquiring new dremio connection "model.subsurface.f_land_values".
2021-01-28 16:04:44.192067 (Thread-2): Compiling model.subsurface.f_land_values
2021-01-28 16:04:44.220738 (Thread-3): Connected to db: subsurface_space
2021-01-28 16:04:44.229203 (Thread-2): Writing injected SQL for node "model.subsurface.f_land_values"
2021-01-28 16:04:44.230100 (Thread-2): finished collecting timing info
2021-01-28 16:04:44.241275 (Thread-2): Writing runtime SQL for node "model.subsurface.f_land_values"
2021-01-28 16:04:44.242058 (Thread-2): Using dremio connection "model.subsurface.f_land_values".
2021-01-28 16:04:44.242245 (Thread-2): On model.subsurface.f_land_values: 
  create or replace view "subsurface_space"."f_land_values" as (
    select
  transaction_date
  ,coalesce(transaction_amount, 0) as transaction_amount
  ,transfer_types.transfer_label_en as transfer_label
  ,coalesce(lane_type, 'N/A') as lane_type
  ,coalesce(lane_code, 'N/A') as lane_code
  ,coalesce(lane, 'N/A') as lane
  ,coalesce(zip_code, 'N/A') as zip_code
  ,municipality_code
  ,lots_count
  ,coalesce(premises_code, 'N/A') as premises_code
  ,coalesce(built_surface, 0) as built_surface
  ,coalesce(land_surface, 0) as land_surface
  ,coalesce(main_rooms_count, 0) as main_rooms_count
  ,coalesce(crop_code, 'N/A') as crop_code
from
  "subsurface_space"."stage"."stg__land_values" as stg__land_values
  join "subsurface_space"."reference"."transfer_types" transfer_types on transfer_types.transfer_label_fr = stg__land_values.transfer_label_fr
  )

2021-01-28 16:04:44.242422 (Thread-2): Opening a new connection, currently in state closed
2021-01-28 16:04:44.242675 (Thread-2): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:44.535824 (Thread-2): Connected to db: subsurface_space
2021-01-28 16:04:44.544776 (Thread-3): SQL status: OK in 0.56 seconds
2021-01-28 16:04:44.555318 (Thread-3): finished collecting timing info
2021-01-28 16:04:44.556351 (Thread-3): On model.subsurface.d_municipalities: ROLLBACK
2021-01-28 16:04:44.556750 (Thread-3): On model.subsurface.d_municipalities: Close
2021-01-28 16:04:44.562670 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6ac668-695e-464e-ad41-12bc6aa70f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcd1a20f0>]}
2021-01-28 16:04:44.566724 (Thread-3): 17:04:44 | 5 of 6 OK created view model d_municipalities........................ [OK in 0.62s]
2021-01-28 16:04:44.567214 (Thread-3): Finished running node model.subsurface.d_municipalities
2021-01-28 16:04:44.856914 (Thread-2): SQL status: OK in 0.61 seconds
2021-01-28 16:04:44.863503 (Thread-2): finished collecting timing info
2021-01-28 16:04:44.864086 (Thread-2): On model.subsurface.f_land_values: ROLLBACK
2021-01-28 16:04:44.864289 (Thread-2): On model.subsurface.f_land_values: Close
2021-01-28 16:04:44.865858 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6ac668-695e-464e-ad41-12bc6aa70f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcd11b240>]}
2021-01-28 16:04:44.868057 (Thread-2): 17:04:44 | 6 of 6 OK created view model f_land_values........................... [OK in 0.67s]
2021-01-28 16:04:44.868340 (Thread-2): Finished running node model.subsurface.f_land_values
2021-01-28 16:04:44.917017 (MainThread): Acquiring new dremio connection "master".
2021-01-28 16:04:44.917614 (MainThread): On master: ROLLBACK
2021-01-28 16:04:44.917928 (MainThread): Opening a new connection, currently in state init
2021-01-28 16:04:44.918261 (MainThread): Using connection string: ConnectionType=Direct;AuthenticationType=Plain;Driver={Dremio ODBC Driver 64-bit};HOST=localhost;PORT=31010;UID=fab4;PWD=fab4fab4
2021-01-28 16:04:45.188194 (MainThread): Connected to db: subsurface_space
2021-01-28 16:04:45.189078 (MainThread): On master: ROLLBACK
2021-01-28 16:04:45.189584 (MainThread): On master: Close
2021-01-28 16:04:45.191902 (MainThread): 17:04:45 | 
2021-01-28 16:04:45.192534 (MainThread): 17:04:45 | Finished running 6 view models in 4.63s.
2021-01-28 16:04:45.192970 (MainThread): Connection 'master' was properly closed.
2021-01-28 16:04:45.193270 (MainThread): Connection 'model.subsurface.d_municipalities' was properly closed.
2021-01-28 16:04:45.193648 (MainThread): Connection 'model.subsurface.stg__land_values' was properly closed.
2021-01-28 16:04:45.193939 (MainThread): Connection 'model.subsurface.f_land_values' was properly closed.
2021-01-28 16:04:45.194217 (MainThread): Connection 'model.subsurface.stg__municipalities' was properly closed.
2021-01-28 16:04:45.283785 (MainThread): 
2021-01-28 16:04:45.284531 (MainThread): Completed successfully
2021-01-28 16:04:45.285110 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-28 16:04:45.285880 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcd0f14a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcd27e048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcd2a5a20>]}
2021-01-28 16:04:45.286650 (MainThread): Flushing usage events
